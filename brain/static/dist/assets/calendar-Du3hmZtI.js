import{c as Ss,r as d,j as r,b as $,f as Rs,R as H,h as Ct,i as Ts,k as Rr,e as ks,P as Yn,l as Is,d as As,u as Un,X as Tr,a as kr}from"./index-DSd9N_39.js";import{v as Ms,w as Ls,B as Y,f as $n,D as Rt,c as Tt,I as K,k as kt,l as An,T as Kn,x as Os,y as Ir,u as Oe,a as q,g as B,S as Mn,L as Fs,h as zs,d as or,e as ir,z as Ps}from"./layout-DCrKkJLD.js";import{C as Ar,a as Mr,b as _s,d as Ys,c as Us}from"./card-DIfhSDiX.js";import{C as It,E as $s}from"./checkbox-OkHfCWFE.js";import{S as se,a as ae,b as oe,c as ie,d as I}from"./select-BQ5OXIgv.js";import{c as rt,P as Bt,a as st,b as Ks,i as Hs,C as Lr,d as Gs}from"./isTomorrow-BFM9yrAF.js";import{t as ve,c as Ln,m as Hn,a as Gn,g as Vs,i as Or,f as V,s as bn}from"./format-D7m0hUtg.js";import{C as Bs}from"./clock-C258m9NQ.js";import{L as qs}from"./link-C05d7DAZ.js";import{L as Qs}from"./loader-circle-Dyev_n3p.js";import{S as Ws,B as vn,R as Fr}from"./badge-5eIsOY7k.js";import{S as Zs}from"./search-BmlIItvF.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],zr=Ss("text-align-start",Xs);function On(e,n){const t=ve(e);if(isNaN(n))return Ln(e,NaN);if(!n)return t;const s=t.getDate(),a=Ln(e,t.getTime());a.setMonth(t.getMonth()+n+1,0);const i=a.getDate();return s>=i?a:(t.setFullYear(a.getFullYear(),a.getMonth(),s),t)}function Js(e,n){const t=+ve(e);return Ln(e,t+n)}function ea(e,n){return Js(e,n*Hn)}function Pr(e,n){const t=n*7;return rt(e,t)}function ta(e){return n=>{const t=Math.trunc,s=t(n);return s===0?0:s}}function na(e,n){return+ve(e)-+ve(n)}function lr(e,n,t){const s=na(e,n)/Gn;return ta()(s)}function yn(e){const n=ve(e),t=n.getMonth();return n.setFullYear(n.getFullYear(),t+1,0),n.setHours(23,59,59,999),n}function Nn(e,n){const t=ve(e.start),s=ve(e.end);let a=+t>+s;const i=a?+t:+s,l=a?s:t;l.setHours(0,0,0,0);let c=1;const u=[];for(;+l<=i;)u.push(ve(l)),l.setDate(l.getDate()+c),l.setHours(0,0,0,0);return a?u.reverse():u}function wn(e){const n=ve(e);return n.setDate(1),n.setHours(0,0,0,0),n}function cr(e,n){const t=Vs(),s=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=ve(e),i=a.getDay(),l=(i<s?-7:0)+6-(i-s);return a.setDate(a.getDate()+l),a.setHours(23,59,59,999),a}function dr(e,n){const t=ve(e),s=ve(n);return t.getFullYear()===s.getFullYear()&&t.getMonth()===s.getMonth()}function ra(e,n){return rt(e,-1)}function _r(e,n){const s=ia(e);let a;if(s.date){const u=la(s.date,2);a=ca(u.restDateString,u.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const i=a.getTime();let l=0,c;if(s.time&&(l=da(s.time),isNaN(l)))return new Date(NaN);if(s.timezone){if(c=ua(s.timezone),isNaN(c))return new Date(NaN)}else{const u=new Date(i+l),g=new Date(0);return g.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),g.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),g}return new Date(i+l+c)}const Kt={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},sa=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,aa=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,oa=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ia(e){const n={},t=e.split(Kt.dateTimeDelimiter);let s;if(t.length>2)return n;if(/:/.test(t[0])?s=t[0]:(n.date=t[0],s=t[1],Kt.timeZoneDelimiter.test(n.date)&&(n.date=e.split(Kt.timeZoneDelimiter)[0],s=e.substr(n.date.length,e.length))),s){const a=Kt.timezone.exec(s);a?(n.time=s.replace(a[1],""),n.timezone=a[1]):n.time=s}return n}function la(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),s=e.match(t);if(!s)return{year:NaN,restDateString:""};const a=s[1]?parseInt(s[1]):null,i=s[2]?parseInt(s[2]):null;return{year:i===null?a:i*100,restDateString:e.slice((s[1]||s[2]).length)}}function ca(e,n){if(n===null)return new Date(NaN);const t=e.match(sa);if(!t)return new Date(NaN);const s=!!t[4],a=jt(t[1]),i=jt(t[2])-1,l=jt(t[3]),c=jt(t[4]),u=jt(t[5])-1;if(s)return xa(n,c,u)?fa(n,c,u):new Date(NaN);{const g=new Date(0);return!ha(n,i,l)||!ga(n,a)?new Date(NaN):(g.setUTCFullYear(n,i,Math.max(a,l)),g)}}function jt(e){return e?parseInt(e):1}function da(e){const n=e.match(aa);if(!n)return NaN;const t=jn(n[1]),s=jn(n[2]),a=jn(n[3]);return pa(t,s,a)?t*Hn+s*Gn+a*1e3:NaN}function jn(e){return e&&parseFloat(e.replace(",","."))||0}function ua(e){if(e==="Z")return 0;const n=e.match(oa);if(!n)return 0;const t=n[1]==="+"?-1:1,s=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return ba(s,a)?t*(s*Hn+a*Gn):NaN}function fa(e,n,t){const s=new Date(0);s.setUTCFullYear(e,0,4);const a=s.getUTCDay()||7,i=(n-1)*7+t+1-a;return s.setUTCDate(s.getUTCDate()+i),s}const ma=[31,null,31,30,31,30,31,31,30,31,30,31];function Yr(e){return e%400===0||e%4===0&&e%100!==0}function ha(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(ma[n]||(Yr(e)?29:28))}function ga(e,n){return n>=1&&n<=(Yr(e)?366:365)}function xa(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function pa(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function ba(e,n){return n>=0&&n<=59}function $e(e,n){const t=ve(e);return t.setHours(n),t}function Ke(e,n){const t=ve(e);return t.setMinutes(n),t}function ur(e,n){return On(e,-1)}function va(e,n){return Pr(e,-1)}var ya=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Na=ya.reduce((e,n)=>{const t=Ms(`Primitive.${n}`),s=d.forwardRef((a,i)=>{const{asChild:l,...c}=a,u=l?t:n;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),r.jsx(u,{...c,ref:i})});return s.displayName=`Primitive.${n}`,{...e,[n]:s}},{}),wa="Label",Ur=d.forwardRef((e,n)=>r.jsx(Na.label,{...e,ref:n,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));Ur.displayName=wa;var $r=Ur;const ja=Rs("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),O=d.forwardRef(({className:e,...n},t)=>r.jsx($r,{ref:t,className:$(ja(),e),...n}));O.displayName=$r.displayName;function Ca(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return d.useMemo(()=>s=>{n.forEach(a=>a(s))},n)}const en=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function ut(e){const n=Object.prototype.toString.call(e);return n==="[object Window]"||n==="[object global]"}function Vn(e){return"nodeType"in e}function fe(e){var n,t;return e?ut(e)?e:Vn(e)&&(n=(t=e.ownerDocument)==null?void 0:t.defaultView)!=null?n:window:window}function Bn(e){const{Document:n}=fe(e);return e instanceof n}function Ot(e){return ut(e)?!1:e instanceof fe(e).HTMLElement}function Kr(e){return e instanceof fe(e).SVGElement}function ft(e){return e?ut(e)?e.document:Vn(e)?Bn(e)?e:Ot(e)||Kr(e)?e.ownerDocument:document:document:document}const Te=en?d.useLayoutEffect:d.useEffect;function tn(e){const n=d.useRef(e);return Te(()=>{n.current=e}),d.useCallback(function(){for(var t=arguments.length,s=new Array(t),a=0;a<t;a++)s[a]=arguments[a];return n.current==null?void 0:n.current(...s)},[])}function Ea(){const e=d.useRef(null),n=d.useCallback((s,a)=>{e.current=setInterval(s,a)},[]),t=d.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[n,t]}function At(e,n){n===void 0&&(n=[e]);const t=d.useRef(e);return Te(()=>{t.current!==e&&(t.current=e)},n),t}function Ft(e,n){const t=d.useRef();return d.useMemo(()=>{const s=e(t.current);return t.current=s,s},[...n])}function qt(e){const n=tn(e),t=d.useRef(null),s=d.useCallback(a=>{a!==t.current&&n?.(a,t.current),t.current=a},[]);return[t,s]}function Qt(e){const n=d.useRef();return d.useEffect(()=>{n.current=e},[e]),n.current}let Cn={};function zt(e,n){return d.useMemo(()=>{if(n)return n;const t=Cn[e]==null?0:Cn[e]+1;return Cn[e]=t,e+"-"+t},[e,n])}function Hr(e){return function(n){for(var t=arguments.length,s=new Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];return s.reduce((i,l)=>{const c=Object.entries(l);for(const[u,g]of c){const f=i[u];f!=null&&(i[u]=f+e*g)}return i},{...n})}}const dt=Hr(1),Mt=Hr(-1);function Da(e){return"clientX"in e&&"clientY"in e}function nn(e){if(!e)return!1;const{KeyboardEvent:n}=fe(e.target);return n&&e instanceof n}function Sa(e){if(!e)return!1;const{TouchEvent:n}=fe(e.target);return n&&e instanceof n}function Wt(e){if(Sa(e)){if(e.touches&&e.touches.length){const{clientX:n,clientY:t}=e.touches[0];return{x:n,y:t}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:n,clientY:t}=e.changedTouches[0];return{x:n,y:t}}}return Da(e)?{x:e.clientX,y:e.clientY}:null}const He=Object.freeze({Translate:{toString(e){if(!e)return;const{x:n,y:t}=e;return"translate3d("+(n?Math.round(n):0)+"px, "+(t?Math.round(t):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:n,scaleY:t}=e;return"scaleX("+n+") scaleY("+t+")"}},Transform:{toString(e){if(e)return[He.Translate.toString(e),He.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:n,duration:t,easing:s}=e;return n+" "+t+"ms "+s}}}),fr="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Ra(e){return e.matches(fr)?e:e.querySelector(fr)}const Ta={display:"none"};function ka(e){let{id:n,value:t}=e;return H.createElement("div",{id:n,style:Ta},t)}function Ia(e){let{id:n,announcement:t,ariaLiveType:s="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return H.createElement("div",{id:n,style:a,role:"status","aria-live":s,"aria-atomic":!0},t)}function Aa(){const[e,n]=d.useState("");return{announce:d.useCallback(s=>{s!=null&&n(s)},[]),announcement:e}}const Gr=d.createContext(null);function Ma(e){const n=d.useContext(Gr);d.useEffect(()=>{if(!n)throw new Error("useDndMonitor must be used within a children of <DndContext>");return n(e)},[e,n])}function La(){const[e]=d.useState(()=>new Set),n=d.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[d.useCallback(s=>{let{type:a,event:i}=s;e.forEach(l=>{var c;return(c=l[a])==null?void 0:c.call(l,i)})},[e]),n]}const Oa={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Fa={onDragStart(e){let{active:n}=e;return"Picked up draggable item "+n.id+"."},onDragOver(e){let{active:n,over:t}=e;return t?"Draggable item "+n.id+" was moved over droppable area "+t.id+".":"Draggable item "+n.id+" is no longer over a droppable area."},onDragEnd(e){let{active:n,over:t}=e;return t?"Draggable item "+n.id+" was dropped over droppable area "+t.id:"Draggable item "+n.id+" was dropped."},onDragCancel(e){let{active:n}=e;return"Dragging was cancelled. Draggable item "+n.id+" was dropped."}};function za(e){let{announcements:n=Fa,container:t,hiddenTextDescribedById:s,screenReaderInstructions:a=Oa}=e;const{announce:i,announcement:l}=Aa(),c=zt("DndLiveRegion"),[u,g]=d.useState(!1);if(d.useEffect(()=>{g(!0)},[]),Ma(d.useMemo(()=>({onDragStart(b){let{active:p}=b;i(n.onDragStart({active:p}))},onDragMove(b){let{active:p,over:y}=b;n.onDragMove&&i(n.onDragMove({active:p,over:y}))},onDragOver(b){let{active:p,over:y}=b;i(n.onDragOver({active:p,over:y}))},onDragEnd(b){let{active:p,over:y}=b;i(n.onDragEnd({active:p,over:y}))},onDragCancel(b){let{active:p,over:y}=b;i(n.onDragCancel({active:p,over:y}))}}),[i,n])),!u)return null;const f=H.createElement(H.Fragment,null,H.createElement(ka,{id:s,value:a.draggable}),H.createElement(Ia,{id:c,announcement:l}));return t?Ct.createPortal(f,t):f}var W;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(W||(W={}));function Zt(){}function Fn(e,n){return d.useMemo(()=>({sensor:e,options:n??{}}),[e,n])}function Vr(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return d.useMemo(()=>[...n].filter(s=>s!=null),[...n])}const ke=Object.freeze({x:0,y:0});function Br(e,n){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function Pa(e,n){const t=Wt(e);if(!t)return"0 0";const s={x:(t.x-n.left)/n.width*100,y:(t.y-n.top)/n.height*100};return s.x+"% "+s.y+"%"}function qr(e,n){let{data:{value:t}}=e,{data:{value:s}}=n;return t-s}function _a(e,n){let{data:{value:t}}=e,{data:{value:s}}=n;return s-t}function mr(e){let{left:n,top:t,height:s,width:a}=e;return[{x:n,y:t},{x:n+a,y:t},{x:n,y:t+s},{x:n+a,y:t+s}]}function Qr(e,n){if(!e||e.length===0)return null;const[t]=e;return t[n]}function hr(e,n,t){return n===void 0&&(n=e.left),t===void 0&&(t=e.top),{x:n+e.width*.5,y:t+e.height*.5}}const Wr=e=>{let{collisionRect:n,droppableRects:t,droppableContainers:s}=e;const a=hr(n,n.left,n.top),i=[];for(const l of s){const{id:c}=l,u=t.get(c);if(u){const g=Br(hr(u),a);i.push({id:c,data:{droppableContainer:l,value:g}})}}return i.sort(qr)},Ya=e=>{let{collisionRect:n,droppableRects:t,droppableContainers:s}=e;const a=mr(n),i=[];for(const l of s){const{id:c}=l,u=t.get(c);if(u){const g=mr(u),f=a.reduce((p,y,T)=>p+Br(g[T],y),0),b=Number((f/4).toFixed(4));i.push({id:c,data:{droppableContainer:l,value:b}})}}return i.sort(qr)};function Ua(e,n){const t=Math.max(n.top,e.top),s=Math.max(n.left,e.left),a=Math.min(n.left+n.width,e.left+e.width),i=Math.min(n.top+n.height,e.top+e.height),l=a-s,c=i-t;if(s<a&&t<i){const u=n.width*n.height,g=e.width*e.height,f=l*c,b=f/(u+g-f);return Number(b.toFixed(4))}return 0}const $a=e=>{let{collisionRect:n,droppableRects:t,droppableContainers:s}=e;const a=[];for(const i of s){const{id:l}=i,c=t.get(l);if(c){const u=Ua(c,n);u>0&&a.push({id:l,data:{droppableContainer:i,value:u}})}}return a.sort(_a)};function Ka(e,n,t){return{...e,scaleX:n&&t?n.width/t.width:1,scaleY:n&&t?n.height/t.height:1}}function Zr(e,n){return e&&n?{x:e.left-n.left,y:e.top-n.top}:ke}function Ha(e){return function(t){for(var s=arguments.length,a=new Array(s>1?s-1:0),i=1;i<s;i++)a[i-1]=arguments[i];return a.reduce((l,c)=>({...l,top:l.top+e*c.y,bottom:l.bottom+e*c.y,left:l.left+e*c.x,right:l.right+e*c.x}),{...t})}}const Ga=Ha(1);function Xr(e){if(e.startsWith("matrix3d(")){const n=e.slice(9,-1).split(/, /);return{x:+n[12],y:+n[13],scaleX:+n[0],scaleY:+n[5]}}else if(e.startsWith("matrix(")){const n=e.slice(7,-1).split(/, /);return{x:+n[4],y:+n[5],scaleX:+n[0],scaleY:+n[3]}}return null}function Va(e,n,t){const s=Xr(n);if(!s)return e;const{scaleX:a,scaleY:i,x:l,y:c}=s,u=e.left-l-(1-a)*parseFloat(t),g=e.top-c-(1-i)*parseFloat(t.slice(t.indexOf(" ")+1)),f=a?e.width/a:e.width,b=i?e.height/i:e.height;return{width:f,height:b,top:g,right:u+f,bottom:g+b,left:u}}const Ba={ignoreTransform:!1};function mt(e,n){n===void 0&&(n=Ba);let t=e.getBoundingClientRect();if(n.ignoreTransform){const{transform:g,transformOrigin:f}=fe(e).getComputedStyle(e);g&&(t=Va(t,g,f))}const{top:s,left:a,width:i,height:l,bottom:c,right:u}=t;return{top:s,left:a,width:i,height:l,bottom:c,right:u}}function gr(e){return mt(e,{ignoreTransform:!0})}function qa(e){const n=e.innerWidth,t=e.innerHeight;return{top:0,left:0,right:n,bottom:t,width:n,height:t}}function Qa(e,n){return n===void 0&&(n=fe(e).getComputedStyle(e)),n.position==="fixed"}function Wa(e,n){n===void 0&&(n=fe(e).getComputedStyle(e));const t=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const i=n[a];return typeof i=="string"?t.test(i):!1})}function rn(e,n){const t=[];function s(a){if(n!=null&&t.length>=n||!a)return t;if(Bn(a)&&a.scrollingElement!=null&&!t.includes(a.scrollingElement))return t.push(a.scrollingElement),t;if(!Ot(a)||Kr(a)||t.includes(a))return t;const i=fe(e).getComputedStyle(a);return a!==e&&Wa(a,i)&&t.push(a),Qa(a,i)?t:s(a.parentNode)}return e?s(e):t}function Jr(e){const[n]=rn(e,1);return n??null}function En(e){return!en||!e?null:ut(e)?e:Vn(e)?Bn(e)||e===ft(e).scrollingElement?window:Ot(e)?e:null:null}function es(e){return ut(e)?e.scrollX:e.scrollLeft}function ts(e){return ut(e)?e.scrollY:e.scrollTop}function zn(e){return{x:es(e),y:ts(e)}}var ee;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(ee||(ee={}));function ns(e){return!en||!e?!1:e===document.scrollingElement}function rs(e){const n={x:0,y:0},t=ns(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-t.width,y:e.scrollHeight-t.height},a=e.scrollTop<=n.y,i=e.scrollLeft<=n.x,l=e.scrollTop>=s.y,c=e.scrollLeft>=s.x;return{isTop:a,isLeft:i,isBottom:l,isRight:c,maxScroll:s,minScroll:n}}const Za={x:.2,y:.2};function Xa(e,n,t,s,a){let{top:i,left:l,right:c,bottom:u}=t;s===void 0&&(s=10),a===void 0&&(a=Za);const{isTop:g,isBottom:f,isLeft:b,isRight:p}=rs(e),y={x:0,y:0},T={x:0,y:0},w={height:n.height*a.y,width:n.width*a.x};return!g&&i<=n.top+w.height?(y.y=ee.Backward,T.y=s*Math.abs((n.top+w.height-i)/w.height)):!f&&u>=n.bottom-w.height&&(y.y=ee.Forward,T.y=s*Math.abs((n.bottom-w.height-u)/w.height)),!p&&c>=n.right-w.width?(y.x=ee.Forward,T.x=s*Math.abs((n.right-w.width-c)/w.width)):!b&&l<=n.left+w.width&&(y.x=ee.Backward,T.x=s*Math.abs((n.left+w.width-l)/w.width)),{direction:y,speed:T}}function Ja(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:l}=window;return{top:0,left:0,right:i,bottom:l,width:i,height:l}}const{top:n,left:t,right:s,bottom:a}=e.getBoundingClientRect();return{top:n,left:t,right:s,bottom:a,width:e.clientWidth,height:e.clientHeight}}function ss(e){return e.reduce((n,t)=>dt(n,zn(t)),ke)}function eo(e){return e.reduce((n,t)=>n+es(t),0)}function to(e){return e.reduce((n,t)=>n+ts(t),0)}function as(e,n){if(n===void 0&&(n=mt),!e)return;const{top:t,left:s,bottom:a,right:i}=n(e);Jr(e)&&(a<=0||i<=0||t>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const no=[["x",["left","right"],eo],["y",["top","bottom"],to]];class qn{constructor(n,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=rn(t),a=ss(s);this.rect={...n},this.width=n.width,this.height=n.height;for(const[i,l,c]of no)for(const u of l)Object.defineProperty(this,u,{get:()=>{const g=c(s),f=a[i]-g;return this.rect[u]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Et{constructor(n){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(t=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...t)})},this.target=n}add(n,t,s){var a;(a=this.target)==null||a.addEventListener(n,t,s),this.listeners.push([n,t,s])}}function ro(e){const{EventTarget:n}=fe(e);return e instanceof n?e:ft(e)}function Dn(e,n){const t=Math.abs(e.x),s=Math.abs(e.y);return typeof n=="number"?Math.sqrt(t**2+s**2)>n:"x"in n&&"y"in n?t>n.x&&s>n.y:"x"in n?t>n.x:"y"in n?s>n.y:!1}var Ee;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Ee||(Ee={}));function xr(e){e.preventDefault()}function so(e){e.stopPropagation()}var P;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(P||(P={}));const os={start:[P.Space,P.Enter],cancel:[P.Esc],end:[P.Space,P.Enter,P.Tab]},ao=(e,n)=>{let{currentCoordinates:t}=n;switch(e.code){case P.Right:return{...t,x:t.x+25};case P.Left:return{...t,x:t.x-25};case P.Down:return{...t,y:t.y+25};case P.Up:return{...t,y:t.y-25}}};class Qn{constructor(n){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=n;const{event:{target:t}}=n;this.props=n,this.listeners=new Et(ft(t)),this.windowListeners=new Et(fe(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ee.Resize,this.handleCancel),this.windowListeners.add(Ee.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ee.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:n,onStart:t}=this.props,s=n.node.current;s&&as(s),t(ke)}handleKeyDown(n){if(nn(n)){const{active:t,context:s,options:a}=this.props,{keyboardCodes:i=os,coordinateGetter:l=ao,scrollBehavior:c="smooth"}=a,{code:u}=n;if(i.end.includes(u)){this.handleEnd(n);return}if(i.cancel.includes(u)){this.handleCancel(n);return}const{collisionRect:g}=s.current,f=g?{x:g.left,y:g.top}:ke;this.referenceCoordinates||(this.referenceCoordinates=f);const b=l(n,{active:t,context:s.current,currentCoordinates:f});if(b){const p=Mt(b,f),y={x:0,y:0},{scrollableAncestors:T}=s.current;for(const w of T){const j=n.code,{isTop:M,isRight:E,isLeft:v,isBottom:S,maxScroll:A,minScroll:R}=rs(w),L=Ja(w),x={x:Math.min(j===P.Right?L.right-L.width/2:L.right,Math.max(j===P.Right?L.left:L.left+L.width/2,b.x)),y:Math.min(j===P.Down?L.bottom-L.height/2:L.bottom,Math.max(j===P.Down?L.top:L.top+L.height/2,b.y))},h=j===P.Right&&!E||j===P.Left&&!v,D=j===P.Down&&!S||j===P.Up&&!M;if(h&&x.x!==b.x){const z=w.scrollLeft+p.x,te=j===P.Right&&z<=A.x||j===P.Left&&z>=R.x;if(te&&!p.y){w.scrollTo({left:z,behavior:c});return}te?y.x=w.scrollLeft-z:y.x=j===P.Right?w.scrollLeft-A.x:w.scrollLeft-R.x,y.x&&w.scrollBy({left:-y.x,behavior:c});break}else if(D&&x.y!==b.y){const z=w.scrollTop+p.y,te=j===P.Down&&z<=A.y||j===P.Up&&z>=R.y;if(te&&!p.x){w.scrollTo({top:z,behavior:c});return}te?y.y=w.scrollTop-z:y.y=j===P.Down?w.scrollTop-A.y:w.scrollTop-R.y,y.y&&w.scrollBy({top:-y.y,behavior:c});break}}this.handleMove(n,dt(Mt(b,this.referenceCoordinates),y))}}}handleMove(n,t){const{onMove:s}=this.props;n.preventDefault(),s(t)}handleEnd(n){const{onEnd:t}=this.props;n.preventDefault(),this.detach(),t()}handleCancel(n){const{onCancel:t}=this.props;n.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Qn.activators=[{eventName:"onKeyDown",handler:(e,n,t)=>{let{keyboardCodes:s=os,onActivation:a}=n,{active:i}=t;const{code:l}=e.nativeEvent;if(s.start.includes(l)){const c=i.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),a?.({event:e.nativeEvent}),!0)}return!1}}];function pr(e){return!!(e&&"distance"in e)}function br(e){return!!(e&&"delay"in e)}class Wn{constructor(n,t,s){var a;s===void 0&&(s=ro(n.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=n,this.events=t;const{event:i}=n,{target:l}=i;this.props=n,this.events=t,this.document=ft(l),this.documentListeners=new Et(this.document),this.listeners=new Et(s),this.windowListeners=new Et(fe(l)),this.initialCoordinates=(a=Wt(i))!=null?a:ke,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:n,props:{options:{activationConstraint:t,bypassActivationConstraint:s}}}=this;if(this.listeners.add(n.move.name,this.handleMove,{passive:!1}),this.listeners.add(n.end.name,this.handleEnd),n.cancel&&this.listeners.add(n.cancel.name,this.handleCancel),this.windowListeners.add(Ee.Resize,this.handleCancel),this.windowListeners.add(Ee.DragStart,xr),this.windowListeners.add(Ee.VisibilityChange,this.handleCancel),this.windowListeners.add(Ee.ContextMenu,xr),this.documentListeners.add(Ee.Keydown,this.handleKeydown),t){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(br(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(pr(t)){this.handlePending(t);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(n,t){const{active:s,onPending:a}=this.props;a(s,n,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:n}=this,{onStart:t}=this.props;n&&(this.activated=!0,this.documentListeners.add(Ee.Click,so,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ee.SelectionChange,this.removeTextSelection),t(n))}handleMove(n){var t;const{activated:s,initialCoordinates:a,props:i}=this,{onMove:l,options:{activationConstraint:c}}=i;if(!a)return;const u=(t=Wt(n))!=null?t:ke,g=Mt(a,u);if(!s&&c){if(pr(c)){if(c.tolerance!=null&&Dn(g,c.tolerance))return this.handleCancel();if(Dn(g,c.distance))return this.handleStart()}if(br(c)&&Dn(g,c.tolerance))return this.handleCancel();this.handlePending(c,g);return}n.cancelable&&n.preventDefault(),l(u)}handleEnd(){const{onAbort:n,onEnd:t}=this.props;this.detach(),this.activated||n(this.props.active),t()}handleCancel(){const{onAbort:n,onCancel:t}=this.props;this.detach(),this.activated||n(this.props.active),t()}handleKeydown(n){n.code===P.Esc&&this.handleCancel()}removeTextSelection(){var n;(n=this.document.getSelection())==null||n.removeAllRanges()}}const oo={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class sn extends Wn{constructor(n){const{event:t}=n,s=ft(t.target);super(n,oo,s)}}sn.activators=[{eventName:"onPointerDown",handler:(e,n)=>{let{nativeEvent:t}=e,{onActivation:s}=n;return!t.isPrimary||t.button!==0?!1:(s?.({event:t}),!0)}}];const io={move:{name:"mousemove"},end:{name:"mouseup"}};var Pn;(function(e){e[e.RightClick=2]="RightClick"})(Pn||(Pn={}));class lo extends Wn{constructor(n){super(n,io,ft(n.event.target))}}lo.activators=[{eventName:"onMouseDown",handler:(e,n)=>{let{nativeEvent:t}=e,{onActivation:s}=n;return t.button===Pn.RightClick?!1:(s?.({event:t}),!0)}}];const Sn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class co extends Wn{constructor(n){super(n,Sn)}static setup(){return window.addEventListener(Sn.move.name,n,{capture:!1,passive:!1}),function(){window.removeEventListener(Sn.move.name,n)};function n(){}}}co.activators=[{eventName:"onTouchStart",handler:(e,n)=>{let{nativeEvent:t}=e,{onActivation:s}=n;const{touches:a}=t;return a.length>1?!1:(s?.({event:t}),!0)}}];var Dt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Dt||(Dt={}));var Xt;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Xt||(Xt={}));function uo(e){let{acceleration:n,activator:t=Dt.Pointer,canScroll:s,draggingRect:a,enabled:i,interval:l=5,order:c=Xt.TreeOrder,pointerCoordinates:u,scrollableAncestors:g,scrollableAncestorRects:f,delta:b,threshold:p}=e;const y=mo({delta:b,disabled:!i}),[T,w]=Ea(),j=d.useRef({x:0,y:0}),M=d.useRef({x:0,y:0}),E=d.useMemo(()=>{switch(t){case Dt.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case Dt.DraggableRect:return a}},[t,a,u]),v=d.useRef(null),S=d.useCallback(()=>{const R=v.current;if(!R)return;const L=j.current.x*M.current.x,x=j.current.y*M.current.y;R.scrollBy(L,x)},[]),A=d.useMemo(()=>c===Xt.TreeOrder?[...g].reverse():g,[c,g]);d.useEffect(()=>{if(!i||!g.length||!E){w();return}for(const R of A){if(s?.(R)===!1)continue;const L=g.indexOf(R),x=f[L];if(!x)continue;const{direction:h,speed:D}=Xa(R,x,E,n,p);for(const z of["x","y"])y[z][h[z]]||(D[z]=0,h[z]=0);if(D.x>0||D.y>0){w(),v.current=R,T(S,l),j.current=D,M.current=h;return}}j.current={x:0,y:0},M.current={x:0,y:0},w()},[n,S,s,w,i,l,JSON.stringify(E),JSON.stringify(y),T,g,A,f,JSON.stringify(p)])}const fo={x:{[ee.Backward]:!1,[ee.Forward]:!1},y:{[ee.Backward]:!1,[ee.Forward]:!1}};function mo(e){let{delta:n,disabled:t}=e;const s=Qt(n);return Ft(a=>{if(t||!s||!a)return fo;const i={x:Math.sign(n.x-s.x),y:Math.sign(n.y-s.y)};return{x:{[ee.Backward]:a.x[ee.Backward]||i.x===-1,[ee.Forward]:a.x[ee.Forward]||i.x===1},y:{[ee.Backward]:a.y[ee.Backward]||i.y===-1,[ee.Forward]:a.y[ee.Forward]||i.y===1}}},[t,n,s])}function ho(e,n){const t=n!=null?e.get(n):void 0,s=t?t.node.current:null;return Ft(a=>{var i;return n==null?null:(i=s??a)!=null?i:null},[s,n])}function go(e,n){return d.useMemo(()=>e.reduce((t,s)=>{const{sensor:a}=s,i=a.activators.map(l=>({eventName:l.eventName,handler:n(l.handler,s)}));return[...t,...i]},[]),[e,n])}var Lt;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Lt||(Lt={}));var _n;(function(e){e.Optimized="optimized"})(_n||(_n={}));const vr=new Map;function xo(e,n){let{dragging:t,dependencies:s,config:a}=n;const[i,l]=d.useState(null),{frequency:c,measure:u,strategy:g}=a,f=d.useRef(e),b=j(),p=At(b),y=d.useCallback(function(M){M===void 0&&(M=[]),!p.current&&l(E=>E===null?M:E.concat(M.filter(v=>!E.includes(v))))},[p]),T=d.useRef(null),w=Ft(M=>{if(b&&!t)return vr;if(!M||M===vr||f.current!==e||i!=null){const E=new Map;for(let v of e){if(!v)continue;if(i&&i.length>0&&!i.includes(v.id)&&v.rect.current){E.set(v.id,v.rect.current);continue}const S=v.node.current,A=S?new qn(u(S),S):null;v.rect.current=A,A&&E.set(v.id,A)}return E}return M},[e,i,t,b,u]);return d.useEffect(()=>{f.current=e},[e]),d.useEffect(()=>{b||y()},[t,b]),d.useEffect(()=>{i&&i.length>0&&l(null)},[JSON.stringify(i)]),d.useEffect(()=>{b||typeof c!="number"||T.current!==null||(T.current=setTimeout(()=>{y(),T.current=null},c))},[c,b,y,...s]),{droppableRects:w,measureDroppableContainers:y,measuringScheduled:i!=null};function j(){switch(g){case Lt.Always:return!1;case Lt.BeforeDragging:return t;default:return!t}}}function Zn(e,n){return Ft(t=>e?t||(typeof n=="function"?n(e):e):null,[n,e])}function po(e,n){return Zn(e,n)}function bo(e){let{callback:n,disabled:t}=e;const s=tn(n),a=d.useMemo(()=>{if(t||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(s)},[s,t]);return d.useEffect(()=>()=>a?.disconnect(),[a]),a}function an(e){let{callback:n,disabled:t}=e;const s=tn(n),a=d.useMemo(()=>{if(t||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(s)},[t]);return d.useEffect(()=>()=>a?.disconnect(),[a]),a}function vo(e){return new qn(mt(e),e)}function yr(e,n,t){n===void 0&&(n=vo);const[s,a]=d.useState(null);function i(){a(u=>{if(!e)return null;if(e.isConnected===!1){var g;return(g=u??t)!=null?g:null}const f=n(e);return JSON.stringify(u)===JSON.stringify(f)?u:f})}const l=bo({callback(u){if(e)for(const g of u){const{type:f,target:b}=g;if(f==="childList"&&b instanceof HTMLElement&&b.contains(e)){i();break}}}}),c=an({callback:i});return Te(()=>{i(),e?(c?.observe(e),l?.observe(document.body,{childList:!0,subtree:!0})):(c?.disconnect(),l?.disconnect())},[e]),s}function yo(e){const n=Zn(e);return Zr(e,n)}const Nr=[];function No(e){const n=d.useRef(e),t=Ft(s=>e?s&&s!==Nr&&e&&n.current&&e.parentNode===n.current.parentNode?s:rn(e):Nr,[e]);return d.useEffect(()=>{n.current=e},[e]),t}function wo(e){const[n,t]=d.useState(null),s=d.useRef(e),a=d.useCallback(i=>{const l=En(i.target);l&&t(c=>c?(c.set(l,zn(l)),new Map(c)):null)},[]);return d.useEffect(()=>{const i=s.current;if(e!==i){l(i);const c=e.map(u=>{const g=En(u);return g?(g.addEventListener("scroll",a,{passive:!0}),[g,zn(g)]):null}).filter(u=>u!=null);t(c.length?new Map(c):null),s.current=e}return()=>{l(e),l(i)};function l(c){c.forEach(u=>{const g=En(u);g?.removeEventListener("scroll",a)})}},[a,e]),d.useMemo(()=>e.length?n?Array.from(n.values()).reduce((i,l)=>dt(i,l),ke):ss(e):ke,[e,n])}function wr(e,n){n===void 0&&(n=[]);const t=d.useRef(null);return d.useEffect(()=>{t.current=null},n),d.useEffect(()=>{const s=e!==ke;s&&!t.current&&(t.current=e),!s&&t.current&&(t.current=null)},[e]),t.current?Mt(e,t.current):ke}function jo(e){d.useEffect(()=>{if(!en)return;const n=e.map(t=>{let{sensor:s}=t;return s.setup==null?void 0:s.setup()});return()=>{for(const t of n)t?.()}},e.map(n=>{let{sensor:t}=n;return t}))}function Co(e,n){return d.useMemo(()=>e.reduce((t,s)=>{let{eventName:a,handler:i}=s;return t[a]=l=>{i(l,n)},t},{}),[e,n])}function is(e){return d.useMemo(()=>e?qa(e):null,[e])}const jr=[];function Eo(e,n){n===void 0&&(n=mt);const[t]=e,s=is(t?fe(t):null),[a,i]=d.useState(jr);function l(){i(()=>e.length?e.map(u=>ns(u)?s:new qn(n(u),u)):jr)}const c=an({callback:l});return Te(()=>{c?.disconnect(),l(),e.forEach(u=>c?.observe(u))},[e]),a}function ls(e){if(!e)return null;if(e.children.length>1)return e;const n=e.children[0];return Ot(n)?n:e}function Do(e){let{measure:n}=e;const[t,s]=d.useState(null),a=d.useCallback(g=>{for(const{target:f}of g)if(Ot(f)){s(b=>{const p=n(f);return b?{...b,width:p.width,height:p.height}:p});break}},[n]),i=an({callback:a}),l=d.useCallback(g=>{const f=ls(g);i?.disconnect(),f&&i?.observe(f),s(f?n(f):null)},[n,i]),[c,u]=qt(l);return d.useMemo(()=>({nodeRef:c,rect:t,setRef:u}),[t,c,u])}const So=[{sensor:sn,options:{}},{sensor:Qn,options:{}}],Ro={current:{}},Vt={draggable:{measure:gr},droppable:{measure:gr,strategy:Lt.WhileDragging,frequency:_n.Optimized},dragOverlay:{measure:mt}};class St extends Map{get(n){var t;return n!=null&&(t=super.get(n))!=null?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(n=>{let{disabled:t}=n;return!t})}getNodeFor(n){var t,s;return(t=(s=this.get(n))==null?void 0:s.node.current)!=null?t:void 0}}const To={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new St,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Zt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Vt,measureDroppableContainers:Zt,windowRect:null,measuringScheduled:!1},cs={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Zt,draggableNodes:new Map,over:null,measureDroppableContainers:Zt},Pt=d.createContext(cs),ds=d.createContext(To);function ko(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new St}}}function Io(e,n){switch(n.type){case W.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:n.initialCoordinates,active:n.active}};case W.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:n.coordinates.x-e.draggable.initialCoordinates.x,y:n.coordinates.y-e.draggable.initialCoordinates.y}}};case W.DragEnd:case W.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case W.RegisterDroppable:{const{element:t}=n,{id:s}=t,a=new St(e.droppable.containers);return a.set(s,t),{...e,droppable:{...e.droppable,containers:a}}}case W.SetDroppableDisabled:{const{id:t,key:s,disabled:a}=n,i=e.droppable.containers.get(t);if(!i||s!==i.key)return e;const l=new St(e.droppable.containers);return l.set(t,{...i,disabled:a}),{...e,droppable:{...e.droppable,containers:l}}}case W.UnregisterDroppable:{const{id:t,key:s}=n,a=e.droppable.containers.get(t);if(!a||s!==a.key)return e;const i=new St(e.droppable.containers);return i.delete(t),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function Ao(e){let{disabled:n}=e;const{active:t,activatorEvent:s,draggableNodes:a}=d.useContext(Pt),i=Qt(s),l=Qt(t?.id);return d.useEffect(()=>{if(!n&&!s&&i&&l!=null){if(!nn(i)||document.activeElement===i.target)return;const c=a.get(l);if(!c)return;const{activatorNode:u,node:g}=c;if(!u.current&&!g.current)return;requestAnimationFrame(()=>{for(const f of[u.current,g.current]){if(!f)continue;const b=Ra(f);if(b){b.focus();break}}})}},[s,n,a,l,i]),null}function us(e,n){let{transform:t,...s}=n;return e!=null&&e.length?e.reduce((a,i)=>i({transform:a,...s}),t):t}function Mo(e){return d.useMemo(()=>({draggable:{...Vt.draggable,...e?.draggable},droppable:{...Vt.droppable,...e?.droppable},dragOverlay:{...Vt.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function Lo(e){let{activeNode:n,measure:t,initialRect:s,config:a=!0}=e;const i=d.useRef(!1),{x:l,y:c}=typeof a=="boolean"?{x:a,y:a}:a;Te(()=>{if(!l&&!c||!n){i.current=!1;return}if(i.current||!s)return;const g=n?.node.current;if(!g||g.isConnected===!1)return;const f=t(g),b=Zr(f,s);if(l||(b.x=0),c||(b.y=0),i.current=!0,Math.abs(b.x)>0||Math.abs(b.y)>0){const p=Jr(g);p&&p.scrollBy({top:b.y,left:b.x})}},[n,l,c,s,t])}const on=d.createContext({...ke,scaleX:1,scaleY:1});var We;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(We||(We={}));const fs=d.memo(function(n){var t,s,a,i;let{id:l,accessibility:c,autoScroll:u=!0,children:g,sensors:f=So,collisionDetection:b=$a,measuring:p,modifiers:y,...T}=n;const w=d.useReducer(Io,void 0,ko),[j,M]=w,[E,v]=La(),[S,A]=d.useState(We.Uninitialized),R=S===We.Initialized,{draggable:{active:L,nodes:x,translate:h},droppable:{containers:D}}=j,z=L!=null?x.get(L):null,te=d.useRef({initial:null,translated:null}),me=d.useMemo(()=>{var X;return L!=null?{id:L,data:(X=z?.data)!=null?X:Ro,rect:te}:null},[L,z]),he=d.useRef(null),[Ge,ye]=d.useState(null),[Q,at]=d.useState(null),le=At(T,Object.values(T)),Ve=zt("DndDescribedBy",l),Fe=d.useMemo(()=>D.getEnabled(),[D]),Z=Mo(p),{droppableRects:De,measureDroppableContainers:Be,measuringScheduled:ot}=xo(Fe,{dragging:R,dependencies:[h.x,h.y],config:Z.droppable}),ge=ho(x,L),it=d.useMemo(()=>Q?Wt(Q):null,[Q]),Ie=hn(),Se=po(ge,Z.draggable.measure);Lo({activeNode:L!=null?x.get(L):null,config:Ie.layoutShiftCompensation,initialRect:Se,measure:Z.draggable.measure});const U=yr(ge,Z.draggable.measure,Se),Ze=yr(ge?ge.parentElement:null),ce=d.useRef({activatorEvent:null,active:null,activeNode:ge,collisionRect:null,collisions:null,droppableRects:De,draggableNodes:x,draggingNode:null,draggingNodeRect:null,droppableContainers:D,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ae=D.getNodeFor((t=ce.current.over)==null?void 0:t.id),Ne=Do({measure:Z.dragOverlay.measure}),Me=(s=Ne.nodeRef.current)!=null?s:ge,ze=R?(a=Ne.rect)!=null?a:U:null,Xe=!!(Ne.nodeRef.current&&Ne.rect),_t=yo(Xe?null:U),lt=is(Me?fe(Me):null),Pe=No(R?Ae??ge:null),ht=Eo(Pe),gt=us(y,{transform:{x:h.x-_t.x,y:h.y-_t.y,scaleX:1,scaleY:1},activatorEvent:Q,active:me,activeNodeRect:U,containerNodeRect:Ze,draggingNodeRect:ze,over:ce.current.over,overlayNodeRect:Ne.rect,scrollableAncestors:Pe,scrollableAncestorRects:ht,windowRect:lt}),xt=it?dt(it,h):null,Yt=wo(Pe),Ut=wr(Yt),cn=wr(Yt,[U]),_e=dt(gt,Ut),Ye=ze?Ga(ze,gt):null,ct=me&&Ye?b({active:me,collisionRect:Ye,droppableRects:De,droppableContainers:Fe,pointerCoordinates:xt}):null,dn=Qr(ct,"id"),[je,$t]=d.useState(null),pt=Xe?gt:dt(gt,cn),bt=Ka(pt,(i=je?.rect)!=null?i:null,U),vt=d.useRef(null),ne=d.useCallback((X,re)=>{let{sensor:de,options:Le}=re;if(he.current==null)return;const xe=x.get(he.current);if(!xe)return;const ue=X.nativeEvent,we=new de({active:he.current,activeNode:xe,event:ue,options:Le,context:ce,onAbort(G){if(!x.get(G))return;const{onDragAbort:Ce}=le.current,pe={id:G};Ce?.(pe),E({type:"onDragAbort",event:pe})},onPending(G,Re,Ce,pe){if(!x.get(G))return;const{onDragPending:et}=le.current,be={id:G,constraint:Re,initialCoordinates:Ce,offset:pe};et?.(be),E({type:"onDragPending",event:be})},onStart(G){const Re=he.current;if(Re==null)return;const Ce=x.get(Re);if(!Ce)return;const{onDragStart:pe}=le.current,Je={activatorEvent:ue,active:{id:Re,data:Ce.data,rect:te}};Ct.unstable_batchedUpdates(()=>{pe?.(Je),A(We.Initializing),M({type:W.DragStart,initialCoordinates:G,active:Re}),E({type:"onDragStart",event:Je}),ye(vt.current),at(ue)})},onMove(G){M({type:W.DragMove,coordinates:G})},onEnd:qe(W.DragEnd),onCancel:qe(W.DragCancel)});vt.current=we;function qe(G){return async function(){const{active:Ce,collisions:pe,over:Je,scrollAdjustedTranslate:et}=ce.current;let be=null;if(Ce&&et){const{cancelDrop:Qe}=le.current;be={activatorEvent:ue,active:Ce,collisions:pe,delta:et,over:Je},G===W.DragEnd&&typeof Qe=="function"&&await Promise.resolve(Qe(be))&&(G=W.DragCancel)}he.current=null,Ct.unstable_batchedUpdates(()=>{M({type:G}),A(We.Uninitialized),$t(null),ye(null),at(null),vt.current=null;const Qe=G===W.DragEnd?"onDragEnd":"onDragCancel";if(be){const Ue=le.current[Qe];Ue?.(be),E({type:Qe,event:be})}})}}},[x]),un=d.useCallback((X,re)=>(de,Le)=>{const xe=de.nativeEvent,ue=x.get(Le);if(he.current!==null||!ue||xe.dndKit||xe.defaultPrevented)return;const we={active:ue};X(de,re.options,we)===!0&&(xe.dndKit={capturedBy:re.sensor},he.current=Le,ne(de,re))},[x,ne]),yt=go(f,un);jo(f),Te(()=>{U&&S===We.Initializing&&A(We.Initialized)},[U,S]),d.useEffect(()=>{const{onDragMove:X}=le.current,{active:re,activatorEvent:de,collisions:Le,over:xe}=ce.current;if(!re||!de)return;const ue={active:re,activatorEvent:de,collisions:Le,delta:{x:_e.x,y:_e.y},over:xe};Ct.unstable_batchedUpdates(()=>{X?.(ue),E({type:"onDragMove",event:ue})})},[_e.x,_e.y]),d.useEffect(()=>{const{active:X,activatorEvent:re,collisions:de,droppableContainers:Le,scrollAdjustedTranslate:xe}=ce.current;if(!X||he.current==null||!re||!xe)return;const{onDragOver:ue}=le.current,we=Le.get(dn),qe=we&&we.rect.current?{id:we.id,rect:we.rect.current,data:we.data,disabled:we.disabled}:null,G={active:X,activatorEvent:re,collisions:de,delta:{x:xe.x,y:xe.y},over:qe};Ct.unstable_batchedUpdates(()=>{$t(qe),ue?.(G),E({type:"onDragOver",event:G})})},[dn]),Te(()=>{ce.current={activatorEvent:Q,active:me,activeNode:ge,collisionRect:Ye,collisions:ct,droppableRects:De,draggableNodes:x,draggingNode:Me,draggingNodeRect:ze,droppableContainers:D,over:je,scrollableAncestors:Pe,scrollAdjustedTranslate:_e},te.current={initial:ze,translated:Ye}},[me,ge,ct,Ye,x,Me,ze,De,D,je,Pe,_e]),uo({...Ie,delta:h,draggingRect:Ye,pointerCoordinates:xt,scrollableAncestors:Pe,scrollableAncestorRects:ht});const fn=d.useMemo(()=>({active:me,activeNode:ge,activeNodeRect:U,activatorEvent:Q,collisions:ct,containerNodeRect:Ze,dragOverlay:Ne,draggableNodes:x,droppableContainers:D,droppableRects:De,over:je,measureDroppableContainers:Be,scrollableAncestors:Pe,scrollableAncestorRects:ht,measuringConfiguration:Z,measuringScheduled:ot,windowRect:lt}),[me,ge,U,Q,ct,Ze,Ne,x,D,De,je,Be,Pe,ht,Z,ot,lt]),mn=d.useMemo(()=>({activatorEvent:Q,activators:yt,active:me,activeNodeRect:U,ariaDescribedById:{draggable:Ve},dispatch:M,draggableNodes:x,over:je,measureDroppableContainers:Be}),[Q,yt,me,U,M,Ve,x,je,Be]);return H.createElement(Gr.Provider,{value:v},H.createElement(Pt.Provider,{value:mn},H.createElement(ds.Provider,{value:fn},H.createElement(on.Provider,{value:bt},g)),H.createElement(Ao,{disabled:c?.restoreFocus===!1})),H.createElement(za,{...c,hiddenTextDescribedById:Ve}));function hn(){const X=Ge?.autoScrollEnabled===!1,re=typeof u=="object"?u.enabled===!1:u===!1,de=R&&!X&&!re;return typeof u=="object"?{...u,enabled:de}:{enabled:de}}}),Oo=d.createContext(null),Cr="button",Fo="Draggable";function zo(e){let{id:n,data:t,disabled:s=!1,attributes:a}=e;const i=zt(Fo),{activators:l,activatorEvent:c,active:u,activeNodeRect:g,ariaDescribedById:f,draggableNodes:b,over:p}=d.useContext(Pt),{role:y=Cr,roleDescription:T="draggable",tabIndex:w=0}=a??{},j=u?.id===n,M=d.useContext(j?on:Oo),[E,v]=qt(),[S,A]=qt(),R=Co(l,n),L=At(t);Te(()=>(b.set(n,{id:n,key:i,node:E,activatorNode:S,data:L}),()=>{const h=b.get(n);h&&h.key===i&&b.delete(n)}),[b,n]);const x=d.useMemo(()=>({role:y,tabIndex:w,"aria-disabled":s,"aria-pressed":j&&y===Cr?!0:void 0,"aria-roledescription":T,"aria-describedby":f.draggable}),[s,y,w,j,T,f.draggable]);return{active:u,activatorEvent:c,activeNodeRect:g,attributes:x,isDragging:j,listeners:s?void 0:R,node:E,over:p,setNodeRef:v,setActivatorNodeRef:A,transform:M}}function ms(){return d.useContext(ds)}const Po="Droppable",_o={timeout:25};function Yo(e){let{data:n,disabled:t=!1,id:s,resizeObserverConfig:a}=e;const i=zt(Po),{active:l,dispatch:c,over:u,measureDroppableContainers:g}=d.useContext(Pt),f=d.useRef({disabled:t}),b=d.useRef(!1),p=d.useRef(null),y=d.useRef(null),{disabled:T,updateMeasurementsFor:w,timeout:j}={..._o,...a},M=At(w??s),E=d.useCallback(()=>{if(!b.current){b.current=!0;return}y.current!=null&&clearTimeout(y.current),y.current=setTimeout(()=>{g(Array.isArray(M.current)?M.current:[M.current]),y.current=null},j)},[j]),v=an({callback:E,disabled:T||!l}),S=d.useCallback((x,h)=>{v&&(h&&(v.unobserve(h),b.current=!1),x&&v.observe(x))},[v]),[A,R]=qt(S),L=At(n);return d.useEffect(()=>{!v||!A.current||(v.disconnect(),b.current=!1,v.observe(A.current))},[A,v]),d.useEffect(()=>(c({type:W.RegisterDroppable,element:{id:s,key:i,disabled:t,node:A,rect:p,data:L}}),()=>c({type:W.UnregisterDroppable,key:i,id:s})),[s]),d.useEffect(()=>{t!==f.current.disabled&&(c({type:W.SetDroppableDisabled,id:s,key:i,disabled:t}),f.current.disabled=t)},[s,i,t,c]),{active:l,rect:p,isOver:u?.id===s,node:A,over:u,setNodeRef:R}}function Uo(e){let{animation:n,children:t}=e;const[s,a]=d.useState(null),[i,l]=d.useState(null),c=Qt(t);return!t&&!s&&c&&a(c),Te(()=>{if(!i)return;const u=s?.key,g=s?.props.id;if(u==null||g==null){a(null);return}Promise.resolve(n(g,i)).then(()=>{a(null)})},[n,s,i]),H.createElement(H.Fragment,null,t,s?d.cloneElement(s,{ref:l}):null)}const $o={x:0,y:0,scaleX:1,scaleY:1};function Ko(e){let{children:n}=e;return H.createElement(Pt.Provider,{value:cs},H.createElement(on.Provider,{value:$o},n))}const Ho={position:"fixed",touchAction:"none"},Go=e=>nn(e)?"transform 250ms ease":void 0,Vo=d.forwardRef((e,n)=>{let{as:t,activatorEvent:s,adjustScale:a,children:i,className:l,rect:c,style:u,transform:g,transition:f=Go}=e;if(!c)return null;const b=a?g:{...g,scaleX:1,scaleY:1},p={...Ho,width:c.width,height:c.height,top:c.top,left:c.left,transform:He.Transform.toString(b),transformOrigin:a&&s?Pa(s,c):void 0,transition:typeof f=="function"?f(s):f,...u};return H.createElement(t,{className:l,style:p,ref:n},i)}),Bo=e=>n=>{let{active:t,dragOverlay:s}=n;const a={},{styles:i,className:l}=e;if(i!=null&&i.active)for(const[c,u]of Object.entries(i.active))u!==void 0&&(a[c]=t.node.style.getPropertyValue(c),t.node.style.setProperty(c,u));if(i!=null&&i.dragOverlay)for(const[c,u]of Object.entries(i.dragOverlay))u!==void 0&&s.node.style.setProperty(c,u);return l!=null&&l.active&&t.node.classList.add(l.active),l!=null&&l.dragOverlay&&s.node.classList.add(l.dragOverlay),function(){for(const[u,g]of Object.entries(a))t.node.style.setProperty(u,g);l!=null&&l.active&&t.node.classList.remove(l.active)}},qo=e=>{let{transform:{initial:n,final:t}}=e;return[{transform:He.Transform.toString(n)},{transform:He.Transform.toString(t)}]},Qo={duration:250,easing:"ease",keyframes:qo,sideEffects:Bo({styles:{active:{opacity:"0"}}})};function Wo(e){let{config:n,draggableNodes:t,droppableContainers:s,measuringConfiguration:a}=e;return tn((i,l)=>{if(n===null)return;const c=t.get(i);if(!c)return;const u=c.node.current;if(!u)return;const g=ls(l);if(!g)return;const{transform:f}=fe(l).getComputedStyle(l),b=Xr(f);if(!b)return;const p=typeof n=="function"?n:Zo(n);return as(u,a.draggable.measure),p({active:{id:i,data:c.data,node:u,rect:a.draggable.measure(u)},draggableNodes:t,dragOverlay:{node:l,rect:a.dragOverlay.measure(g)},droppableContainers:s,measuringConfiguration:a,transform:b})})}function Zo(e){const{duration:n,easing:t,sideEffects:s,keyframes:a}={...Qo,...e};return i=>{let{active:l,dragOverlay:c,transform:u,...g}=i;if(!n)return;const f={x:c.rect.left-l.rect.left,y:c.rect.top-l.rect.top},b={scaleX:u.scaleX!==1?l.rect.width*u.scaleX/c.rect.width:1,scaleY:u.scaleY!==1?l.rect.height*u.scaleY/c.rect.height:1},p={x:u.x-f.x,y:u.y-f.y,...b},y=a({...g,active:l,dragOverlay:c,transform:{initial:u,final:p}}),[T]=y,w=y[y.length-1];if(JSON.stringify(T)===JSON.stringify(w))return;const j=s?.({active:l,dragOverlay:c,...g}),M=c.node.animate(y,{duration:n,easing:t,fill:"forwards"});return new Promise(E=>{M.onfinish=()=>{j?.(),E()}})}}let Er=0;function Xo(e){return d.useMemo(()=>{if(e!=null)return Er++,Er},[e])}const Jo=H.memo(e=>{let{adjustScale:n=!1,children:t,dropAnimation:s,style:a,transition:i,modifiers:l,wrapperElement:c="div",className:u,zIndex:g=999}=e;const{activatorEvent:f,active:b,activeNodeRect:p,containerNodeRect:y,draggableNodes:T,droppableContainers:w,dragOverlay:j,over:M,measuringConfiguration:E,scrollableAncestors:v,scrollableAncestorRects:S,windowRect:A}=ms(),R=d.useContext(on),L=Xo(b?.id),x=us(l,{activatorEvent:f,active:b,activeNodeRect:p,containerNodeRect:y,draggingNodeRect:j.rect,over:M,overlayNodeRect:j.rect,scrollableAncestors:v,scrollableAncestorRects:S,transform:R,windowRect:A}),h=Zn(p),D=Wo({config:s,draggableNodes:T,droppableContainers:w,measuringConfiguration:E}),z=h?j.setRef:void 0;return H.createElement(Ko,null,H.createElement(Uo,{animation:D},b&&L?H.createElement(Vo,{key:L,id:b.id,ref:z,as:c,activatorEvent:f,adjustScale:n,className:u,transition:i,rect:h,style:{zIndex:g,...a},transform:x},t):null))});function Xn(e,n,t){const s=e.slice();return s.splice(t<0?s.length+t:t,0,s.splice(n,1)[0]),s}function ei(e,n){return e.reduce((t,s,a)=>{const i=n.get(s);return i&&(t[a]=i),t},Array(e.length))}function Ht(e){return e!==null&&e>=0}function ti(e,n){if(e===n)return!0;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t]!==n[t])return!1;return!0}function ni(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const hs=e=>{let{rects:n,activeIndex:t,overIndex:s,index:a}=e;const i=Xn(n,s,t),l=n[a],c=i[a];return!c||!l?null:{x:c.left-l.left,y:c.top-l.top,scaleX:c.width/l.width,scaleY:c.height/l.height}},Gt={scaleX:1,scaleY:1},gs=e=>{var n;let{activeIndex:t,activeNodeRect:s,index:a,rects:i,overIndex:l}=e;const c=(n=i[t])!=null?n:s;if(!c)return null;if(a===t){const g=i[l];return g?{x:0,y:t<l?g.top+g.height-(c.top+c.height):g.top-c.top,...Gt}:null}const u=ri(i,a,t);return a>t&&a<=l?{x:0,y:-c.height-u,...Gt}:a<t&&a>=l?{x:0,y:c.height+u,...Gt}:{x:0,y:0,...Gt}};function ri(e,n,t){const s=e[n],a=e[n-1],i=e[n+1];return s?t<n?a?s.top-(a.top+a.height):i?i.top-(s.top+s.height):0:i?i.top-(s.top+s.height):a?s.top-(a.top+a.height):0:0}const xs="Sortable",ps=H.createContext({activeIndex:-1,containerId:xs,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:hs,disabled:{draggable:!1,droppable:!1}});function bs(e){let{children:n,id:t,items:s,strategy:a=hs,disabled:i=!1}=e;const{active:l,dragOverlay:c,droppableRects:u,over:g,measureDroppableContainers:f}=ms(),b=zt(xs,t),p=c.rect!==null,y=d.useMemo(()=>s.map(R=>typeof R=="object"&&"id"in R?R.id:R),[s]),T=l!=null,w=l?y.indexOf(l.id):-1,j=g?y.indexOf(g.id):-1,M=d.useRef(y),E=!ti(y,M.current),v=j!==-1&&w===-1||E,S=ni(i);Te(()=>{E&&T&&f(y)},[E,y,T,f]),d.useEffect(()=>{M.current=y},[y]);const A=d.useMemo(()=>({activeIndex:w,containerId:b,disabled:S,disableTransforms:v,items:y,overIndex:j,useDragOverlay:p,sortedRects:ei(y,u),strategy:a}),[w,b,S.draggable,S.droppable,v,y,j,u,p,a]);return H.createElement(ps.Provider,{value:A},n)}const si=e=>{let{id:n,items:t,activeIndex:s,overIndex:a}=e;return Xn(t,s,a).indexOf(n)},ai=e=>{let{containerId:n,isSorting:t,wasDragging:s,index:a,items:i,newIndex:l,previousItems:c,previousContainerId:u,transition:g}=e;return!g||!s||c!==i&&a===l?!1:t?!0:l!==a&&n===u},oi={duration:200,easing:"ease"},vs="transform",ii=He.Transition.toString({property:vs,duration:0,easing:"linear"}),li={roleDescription:"sortable"};function ci(e){let{disabled:n,index:t,node:s,rect:a}=e;const[i,l]=d.useState(null),c=d.useRef(t);return Te(()=>{if(!n&&t!==c.current&&s.current){const u=a.current;if(u){const g=mt(s.current,{ignoreTransform:!0}),f={x:u.left-g.left,y:u.top-g.top,scaleX:u.width/g.width,scaleY:u.height/g.height};(f.x||f.y)&&l(f)}}t!==c.current&&(c.current=t)},[n,t,s,a]),d.useEffect(()=>{i&&l(null)},[i]),i}function Jn(e){let{animateLayoutChanges:n=ai,attributes:t,disabled:s,data:a,getNewIndex:i=si,id:l,strategy:c,resizeObserverConfig:u,transition:g=oi}=e;const{items:f,containerId:b,activeIndex:p,disabled:y,disableTransforms:T,sortedRects:w,overIndex:j,useDragOverlay:M,strategy:E}=d.useContext(ps),v=di(s,y),S=f.indexOf(l),A=d.useMemo(()=>({sortable:{containerId:b,index:S,items:f},...a}),[b,a,S,f]),R=d.useMemo(()=>f.slice(f.indexOf(l)),[f,l]),{rect:L,node:x,isOver:h,setNodeRef:D}=Yo({id:l,data:A,disabled:v.droppable,resizeObserverConfig:{updateMeasurementsFor:R,...u}}),{active:z,activatorEvent:te,activeNodeRect:me,attributes:he,setNodeRef:Ge,listeners:ye,isDragging:Q,over:at,setActivatorNodeRef:le,transform:Ve}=zo({id:l,data:A,attributes:{...li,...t},disabled:v.draggable}),Fe=Ca(D,Ge),Z=!!z,De=Z&&!T&&Ht(p)&&Ht(j),Be=!M&&Q,ot=Be&&De?Ve:null,it=De?ot??(c??E)({rects:w,activeNodeRect:me,activeIndex:p,overIndex:j,index:S}):null,Ie=Ht(p)&&Ht(j)?i({id:l,items:f,activeIndex:p,overIndex:j}):S,Se=z?.id,U=d.useRef({activeId:Se,items:f,newIndex:Ie,containerId:b}),Ze=f!==U.current.items,ce=n({active:z,containerId:b,isDragging:Q,isSorting:Z,id:l,index:S,items:f,newIndex:U.current.newIndex,previousItems:U.current.items,previousContainerId:U.current.containerId,transition:g,wasDragging:U.current.activeId!=null}),Ae=ci({disabled:!ce,index:S,node:x,rect:L});return d.useEffect(()=>{Z&&U.current.newIndex!==Ie&&(U.current.newIndex=Ie),b!==U.current.containerId&&(U.current.containerId=b),f!==U.current.items&&(U.current.items=f)},[Z,Ie,b,f]),d.useEffect(()=>{if(Se===U.current.activeId)return;if(Se!=null&&U.current.activeId==null){U.current.activeId=Se;return}const Me=setTimeout(()=>{U.current.activeId=Se},50);return()=>clearTimeout(Me)},[Se]),{active:z,activeIndex:p,attributes:he,data:A,rect:L,index:S,newIndex:Ie,items:f,isOver:h,isSorting:Z,isDragging:Q,listeners:ye,node:x,overIndex:j,over:at,setNodeRef:Fe,setActivatorNodeRef:le,setDroppableNodeRef:D,setDraggableNodeRef:Ge,transform:Ae??it,transition:Ne()};function Ne(){if(Ae||Ze&&U.current.newIndex===S)return ii;if(!(Be&&!nn(te)||!g)&&(Z||ce))return He.Transition.toString({...g,property:vs})}}function di(e,n){var t,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(t=e?.draggable)!=null?t:n.draggable,droppable:(s=e?.droppable)!=null?s:n.droppable}}function Jt(e){if(!e)return!1;const n=e.data.current;return!!(n&&"sortable"in n&&typeof n.sortable=="object"&&"containerId"in n.sortable&&"items"in n.sortable&&"index"in n.sortable)}const ui=[P.Down,P.Right,P.Up,P.Left],fi=(e,n)=>{let{context:{active:t,collisionRect:s,droppableRects:a,droppableContainers:i,over:l,scrollableAncestors:c}}=n;if(ui.includes(e.code)){if(e.preventDefault(),!t||!s)return;const u=[];i.getEnabled().forEach(b=>{if(!b||b!=null&&b.disabled)return;const p=a.get(b.id);if(p)switch(e.code){case P.Down:s.top<p.top&&u.push(b);break;case P.Up:s.top>p.top&&u.push(b);break;case P.Left:s.left>p.left&&u.push(b);break;case P.Right:s.left<p.left&&u.push(b);break}});const g=Ya({collisionRect:s,droppableRects:a,droppableContainers:u});let f=Qr(g,"id");if(f===l?.id&&g.length>1&&(f=g[1].id),f!=null){const b=i.get(t.id),p=i.get(f),y=p?a.get(p.id):null,T=p?.node.current;if(T&&y&&b&&p){const j=rn(T).some((R,L)=>c[L]!==R),M=ys(b,p),E=mi(b,p),v=j||!M?{x:0,y:0}:{x:E?s.width-y.width:0,y:E?s.height-y.height:0},S={x:y.left,y:y.top};return v.x&&v.y?S:Mt(S,v)}}}};function ys(e,n){return!Jt(e)||!Jt(n)?!1:e.data.current.sortable.containerId===n.data.current.sortable.containerId}function mi(e,n){return!Jt(e)||!Jt(n)||!ys(e,n)?!1:e.data.current.sortable.index<n.data.current.sortable.index}function hi(e,n,{checkForDefaultPrevented:t=!0}={}){return function(a){if(e?.(a),t===!1||!a.defaultPrevented)return n?.(a)}}var gi=Ts[" useInsertionEffect ".trim().toString()]||Rr;function xi({prop:e,defaultProp:n,onChange:t=()=>{},caller:s}){const[a,i,l]=pi({defaultProp:n,onChange:t}),c=e!==void 0,u=c?e:a;{const f=d.useRef(e!==void 0);d.useEffect(()=>{const b=f.current;b!==c&&console.warn(`${s} is changing from ${b?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=c},[c,s])}const g=d.useCallback(f=>{if(c){const b=bi(f)?f(e):f;b!==e&&l.current?.(b)}else i(f)},[c,e,i,l]);return[u,g]}function pi({defaultProp:e,onChange:n}){const[t,s]=d.useState(e),a=d.useRef(t),i=d.useRef(n);return gi(()=>{i.current=n},[n]),d.useEffect(()=>{a.current!==t&&(i.current?.(t),a.current=t)},[t,a]),[t,s,i]}function bi(e){return typeof e=="function"}var ln="Collapsible",[vi]=ks(ln),[yi,er]=vi(ln),Ns=d.forwardRef((e,n)=>{const{__scopeCollapsible:t,open:s,defaultOpen:a,disabled:i,onOpenChange:l,...c}=e,[u,g]=xi({prop:s,defaultProp:a??!1,onChange:l,caller:ln});return r.jsx(yi,{scope:t,disabled:i,contentId:Ls(),open:u,onOpenToggle:d.useCallback(()=>g(f=>!f),[g]),children:r.jsx(Yn.div,{"data-state":nr(u),"data-disabled":i?"":void 0,...c,ref:n})})});Ns.displayName=ln;var ws="CollapsibleTrigger",js=d.forwardRef((e,n)=>{const{__scopeCollapsible:t,...s}=e,a=er(ws,t);return r.jsx(Yn.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":nr(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...s,ref:n,onClick:hi(e.onClick,a.onOpenToggle)})});js.displayName=ws;var tr="CollapsibleContent",Cs=d.forwardRef((e,n)=>{const{forceMount:t,...s}=e,a=er(tr,e.__scopeCollapsible);return r.jsx(Is,{present:t||a.open,children:({present:i})=>r.jsx(Ni,{...s,ref:n,present:i})})});Cs.displayName=tr;var Ni=d.forwardRef((e,n)=>{const{__scopeCollapsible:t,present:s,children:a,...i}=e,l=er(tr,t),[c,u]=d.useState(s),g=d.useRef(null),f=As(n,g),b=d.useRef(0),p=b.current,y=d.useRef(0),T=y.current,w=l.open||c,j=d.useRef(w),M=d.useRef(void 0);return d.useEffect(()=>{const E=requestAnimationFrame(()=>j.current=!1);return()=>cancelAnimationFrame(E)},[]),Rr(()=>{const E=g.current;if(E){M.current=M.current||{transitionDuration:E.style.transitionDuration,animationName:E.style.animationName},E.style.transitionDuration="0s",E.style.animationName="none";const v=E.getBoundingClientRect();b.current=v.height,y.current=v.width,j.current||(E.style.transitionDuration=M.current.transitionDuration,E.style.animationName=M.current.animationName),u(s)}},[l.open,s]),r.jsx(Yn.div,{"data-state":nr(l.open),"data-disabled":l.disabled?"":void 0,id:l.contentId,hidden:!w,...i,ref:f,style:{"--radix-collapsible-content-height":p?`${p}px`:void 0,"--radix-collapsible-content-width":T?`${T}px`:void 0,...e.style},children:w&&a})});function nr(e){return e?"open":"closed"}var wi=Ns;const ji=wi,Ci=js,Ei=Cs;function Di({dateStr:e}){if(!e)return null;try{const n=_r(e);if(!Or(n))return null;let t=V(n,"MMM d");st(n)&&(t="Today"),Ks(n)&&(t="Tomorrow");const s=Hs(n)&&!st(n);return r.jsxs("div",{className:`flex items-center gap-1 text-[10px] border px-1.5 py-0.5 rounded-full ${s?"text-red-400 border-red-400/50":"text-muted-foreground border-border"}`,children:[r.jsx(Os,{className:"w-3 h-3"}),t]})}catch{return null}}function Dr({task:e,onToggle:n,onDelete:t,onEdit:s}){const{attributes:a,listeners:i,setNodeRef:l,transform:c,transition:u,isDragging:g}=Jn({id:e.id,data:{type:"Task",...e}}),f={transform:He.Translate.toString(c),transition:u,opacity:g?.5:1};return r.jsx("div",{ref:l,style:f,...a,...i,className:"mb-2 touch-none select-none relative group",children:r.jsxs("div",{className:`
            p-3 rounded-xl border border-transparent hover:border-border/50 transition-all
            flex gap-3 items-start bg-transparent hover:bg-accent/5
            ${g?"ring-2 ring-primary/50 bg-accent/10 z-50":""}
        `,onClick:()=>s(e),children:[r.jsx("div",{onClick:b=>{b.stopPropagation(),n(e)},className:`
                mt-0.5 w-5 h-5 rounded-full border-2 flex items-center justify-center cursor-pointer transition-colors
                ${e.status==="completed"?"bg-primary border-primary":"border-muted-foreground/60 hover:border-primary"}
            `,children:e.status==="completed"&&r.jsx("div",{className:"w-2.5 h-1.5 border-b-2 border-l-2 border-black rotate-[-45deg] mb-0.5"})}),r.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[r.jsx("div",{className:`text-sm font-medium leading-tight truncate ${e.status==="completed"?"line-through text-muted-foreground":"text-foreground"}`,children:e.title}),(e.notes||e.due)&&r.jsxs("div",{className:"flex flex-wrap gap-2 items-center mt-1",children:[e.due&&r.jsx(Di,{dateStr:e.due}),e.notes&&r.jsxs("div",{className:"flex items-center text-[10px] text-muted-foreground gap-1",children:[r.jsx(zr,{className:"w-3 h-3"}),r.jsx("span",{className:"truncate max-w-[150px] opacity-70",children:e.notes.split(`
`)[0]})]})]})]})]})})}function Sr({task:e,isOpen:n,onClose:t,onSave:s,onDelete:a,isCreating:i,activeListId:l,availableLists:c=[]}){const[u,g]=d.useState(""),[f,b]=d.useState(""),[p,y]=d.useState(""),[T,w]=d.useState(""),[j,M]=d.useState("");d.useEffect(()=>{if(n){if(i)g(""),b(""),y(""),w(""),M(l||c[0]?.id||"");else if(e)if(g(e.title),b(e.notes||""),M(e.listId),e.due)try{const v=_r(e.due);Or(v)&&y(V(v,"yyyy-MM-dd"))}catch{}else y("")}},[n,e,i,l]);const E=()=>{if(!u)return;let v;p&&(v=T?`${p}T${T}:00Z`:`${p}T00:00:00Z`),s({title:u,notes:f,due:v,listId:j}),t()};return r.jsx(Rt,{open:n,onOpenChange:v=>!v&&t(),children:r.jsxs(Tt,{className:"sm:max-w-[500px] border-border bg-[#1E1E1E] text-white p-0 gap-0 overflow-hidden shadow-2xl rounded-xl",children:[r.jsx("div",{className:"p-6 pb-2",children:r.jsx(K,{value:u,onChange:v=>g(v.target.value),placeholder:"Add title",className:"text-2xl font-normal bg-transparent border-0 border-b border-white/20 rounded-none px-0 py-2 focus-visible:ring-0 focus-visible:border-blue-400 placeholder:text-muted-foreground/50 h-auto",autoFocus:i})}),r.jsxs("div",{className:"p-6 pt-2 space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Bs,{className:"w-5 h-5 text-muted-foreground shrink-0"}),r.jsxs("div",{className:"flex-1 flex gap-2",children:[r.jsx(K,{type:"date",value:p,onChange:v=>y(v.target.value),className:"bg-white/5 border-white/10 text-sm w-[150px]"}),r.jsx(K,{type:"time",value:T,onChange:v=>w(v.target.value),className:"bg-white/5 border-white/10 text-sm w-[120px]"})]})]}),r.jsxs("div",{className:"flex items-center gap-2 pl-7",children:[r.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2 cursor-not-allowed opacity-70",children:[r.jsx("div",{className:"w-4 h-4 rounded-full border border-current"}),"Does not repeat"]}),r.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2 ml-4 cursor-not-allowed opacity-70",children:[r.jsx("div",{className:"w-4 h-4 border border-current"}),"All day"]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(zr,{className:"w-5 h-5 text-muted-foreground shrink-0 mt-2"}),r.jsx(kt,{value:f,onChange:v=>b(v.target.value),placeholder:"Add description",className:"bg-transparent border-0 resize-none min-h-[100px] focus-visible:ring-0 p-0 text-sm leading-relaxed placeholder:text-muted-foreground/50"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-5 shrink-0"})," ",r.jsxs(se,{value:j,onValueChange:M,children:[r.jsx(ae,{className:"w-[150px] h-8 bg-white/5 border-white/10 text-xs",children:r.jsx(oe,{placeholder:"Select List"})}),r.jsx(ie,{children:c.map(v=>r.jsx(I,{value:v.id,children:v.title},v.id))})]})]})]}),r.jsxs(An,{className:"p-4 bg-white/5 flex justify-between items-center",children:[!i&&e?r.jsx(Y,{variant:"ghost",size:"icon",onClick:()=>{confirm("Delete?")&&(a(e.id,e.listId),t())},children:r.jsx(Kn,{className:"w-4 h-4 text-muted-foreground hover:text-red-400"})}):r.jsx("div",{}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(Y,{variant:"ghost",onClick:t,className:"hover:bg-white/10",children:"Cancel"}),r.jsx(Y,{onClick:E,disabled:!u,className:"bg-blue-600 hover:bg-blue-700 text-white rounded-full px-6",children:"Save"})]})]})]})})}function Si({listId:e,title:n,tasks:t,onAddTask:s,onEdit:a,onToggle:i,onDelete:l}){const{setNodeRef:c}=Jn({id:e,data:{type:"Container",listId:e}}),u=t.filter(f=>f.status!=="completed"),g=t.filter(f=>f.status==="completed");return r.jsxs("div",{ref:c,className:"flex-1 min-w-[260px] max-w-[300px] flex flex-col h-full bg-[#1A1A1A] rounded-2xl overflow-hidden border border-white/5 my-1",children:[r.jsxs("div",{className:"p-4 flex items-center justify-between pb-2",children:[r.jsx("h3",{className:"font-medium text-lg text-white tracking-wide truncate",children:n==="Reclaim"?" Reclaim":n}),r.jsx("div",{className:"flex gap-1",children:r.jsxs(Y,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-white",children:[r.jsx("div",{className:"w-1 h-1 bg-current rounded-full mb-0.5"}),r.jsx("div",{className:"w-1 h-1 bg-current rounded-full mb-0.5"}),r.jsx("div",{className:"w-1 h-1 bg-current rounded-full"})]})})]}),r.jsx("div",{className:"px-4 pb-2",children:r.jsxs("button",{onClick:()=>s(e),className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-white transition-colors group w-full text-left",children:[r.jsx("div",{className:"w-6 h-6 rounded-full bg-accent/20 flex items-center justify-center group-hover:bg-blue-500/20 group-hover:text-blue-400",children:r.jsx(Bt,{className:"w-4 h-4"})}),"Add a task"]})}),r.jsx("div",{className:"flex-1 overflow-y-auto px-2 py-2 overflow-x-hidden [&::-webkit-scrollbar]:w-1.5 [&::-webkit-scrollbar-thumb]:bg-white/20 [&::-webkit-scrollbar-thumb]:rounded-full hover:[&::-webkit-scrollbar-thumb]:bg-white/40 [&::-webkit-scrollbar-track]:bg-transparent",children:r.jsxs(bs,{items:t.map(f=>f.id),strategy:gs,children:[u.length>0?r.jsx("div",{className:"space-y-1",children:u.map(f=>r.jsx(Dr,{task:f,onToggle:i,onEdit:a,onDelete:l},f.id))}):g.length===0&&r.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center opacity-40",children:[r.jsx("div",{className:"mb-4 text-4xl grayscale",children:""}),r.jsx("p",{className:"text-sm font-medium",children:"No tasks yet"})]}),g.length>0&&r.jsx("div",{className:"mt-4 pt-2 border-t border-white/5",children:r.jsxs(ji,{children:[r.jsxs(Ci,{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground hover:text-white w-full py-2 px-2 hover:bg-white/5 rounded-md transition-colors",children:[r.jsx($n,{className:"w-4 h-4 transition-transform ui-open:rotate-90"}),"Completed (",g.length,")"]}),r.jsx(Ei,{className:"space-y-1 pl-2 mt-1",children:g.map(f=>r.jsx(Dr,{task:f,onToggle:i,onEdit:a,onDelete:l},f.id))})]})})]})})]})}function Ri({onClick:e}){return r.jsxs(Y,{onClick:e,variant:"outline",size:"sm",className:"rounded-none font-arcade text-xs border-primary text-primary hover:bg-primary hover:text-black",children:[r.jsx(Ir,{className:"w-4 h-4 mr-1"})," AI_ASSIST"]})}function Ti({isOpen:e,onClose:n}){const[t,s]=d.useState([]),[a,i]=d.useState(""),l=d.useRef(null),c=Un(),{data:u,isLoading:g,refetch:f}=Oe({queryKey:["google-status"],queryFn:B.google.getStatus,retry:1,enabled:e}),b=q({mutationFn:async()=>{const{authUrl:w}=await B.google.getAuthUrl();window.location.href=w}});d.useEffect(()=>{e&&f()},[e,f]),d.useEffect(()=>{l.current&&(l.current.scrollTop=l.current.scrollHeight)},[t,e]);const p=q({mutationFn:async w=>B.calendar.assistant(w),onSuccess:w=>{s(j=>[...j,{role:"assistant",content:w.response,isError:!w.success}]),c.invalidateQueries({queryKey:["events"]}),c.invalidateQueries({queryKey:["google-tasks"]}),c.invalidateQueries({queryKey:["google-calendar"]}),c.refetchQueries({queryKey:["google-calendar"]})},onError:w=>{s(j=>[...j,{role:"assistant",content:`Network Error: ${w}`,isError:!0}])}}),y=()=>{if(!a.trim())return;const w={role:"user",content:a};s(j=>[...j,w]),i(""),p.mutate(a)},T=w=>{w.key==="Enter"&&!w.shiftKey&&(w.preventDefault(),y())};return e?r.jsxs(Ar,{className:"fixed left-0 top-[68px] bottom-[40px] w-[380px] shadow-2xl z-50 flex flex-col border-r-2 border-primary bg-black text-white rounded-none animate-in fade-in slide-in-from-left-4 duration-300",children:[r.jsxs(Mr,{className:"p-3 border-b border-primary/50 flex flex-row items-center justify-between bg-primary/10",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ir,{className:"w-5 h-5 text-primary"}),r.jsxs("div",{children:[r.jsx(_s,{className:"text-sm font-arcade tracking-wider text-primary",children:"AI_ASSISTANT"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ys,{className:"text-[10px] text-muted-foreground font-terminal",children:"Calendar + Tasks Assistant"}),!g&&u?.connected&&r.jsx("span",{className:"text-[9px] font-arcade text-green-400",children:"CONNECTED"})]})]})]}),r.jsx(Y,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:n,children:r.jsx(Tr,{className:"h-4 w-4 text-muted-foreground hover:text-white"})})]}),r.jsx(Mn,{className:"flex-1 p-3",ref:l,children:r.jsxs("div",{className:"space-y-3",children:[!g&&!u?.connected&&r.jsxs("div",{className:"border border-yellow-500/50 bg-yellow-500/10 text-yellow-200 text-[10px] font-terminal px-3 py-2 flex items-center justify-between gap-3",children:[r.jsx("span",{children:"Calendar not connected."}),r.jsxs(Y,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none border-yellow-500 text-yellow-200 hover:bg-yellow-500/20 font-arcade text-[9px]",onClick:()=>b.mutate(),disabled:b.isPending,children:[r.jsx(qs,{className:"w-3 h-3 mr-1"}),b.isPending?"CONNECTING...":"CONNECT GOOGLE CALENDAR"]})]}),t.length===0&&r.jsxs("div",{className:"text-center text-muted-foreground text-xs mt-8 space-y-2",children:[r.jsx("p",{className:"font-terminal",children:"Ask me to create events or tasks."}),r.jsx("p",{className:"text-[10px] opacity-50 font-terminal",children:'"Add a workout tomorrow at 3pm"'}),r.jsx("p",{className:"text-[10px] opacity-50 font-terminal",children:'"Schedule PT study session Friday 2pm"'})]}),t.map((w,j)=>r.jsx("div",{className:`flex ${w.role==="user"?"justify-end":"justify-start"}`,children:r.jsx("div",{className:`max-w-[85%] px-3 py-2 text-xs font-terminal whitespace-pre-wrap ${w.role==="user"?"bg-primary text-black":w.isError?"bg-red-500/10 border border-red-500/50 text-red-300":"bg-white/10 text-white border border-white/10"}`,children:w.content})},j)),p.isPending&&r.jsx("div",{className:"flex justify-start",children:r.jsxs("div",{className:"bg-white/5 border border-white/10 px-3 py-2 text-[10px] flex items-center gap-2 text-muted-foreground font-terminal",children:[r.jsx(Qs,{className:"h-3 w-3 animate-spin"}),"Thinking..."]})})]})}),r.jsxs("div",{className:"p-3 border-t border-primary/50",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx(K,{value:a,onChange:w=>i(w.target.value),onKeyDown:T,placeholder:"Type a command...",className:"bg-black border-secondary font-terminal text-sm rounded-none focus-visible:ring-primary",disabled:p.isPending}),r.jsx(Y,{onClick:y,disabled:p.isPending||!a.trim(),className:"rounded-none bg-primary text-black hover:bg-primary/90",children:r.jsx(Ws,{className:"h-4 w-4"})})]}),r.jsx("div",{className:"text-[9px] text-center mt-1 text-muted-foreground/50 font-terminal",children:"OpenRouter  GPT-4o-mini"})]})]}):null}const Rn=["America/New_York","America/Chicago","America/Denver","America/Los_Angeles","America/Phoenix","America/Anchorage","America/Indiana/Indianapolis","America/Detroit","America/Boise","America/Juneau","Pacific/Honolulu"];function ki({open:e,onOpenChange:n,event:t,onEventChange:s,onSave:a,onDelete:i,courseOptions:l=[]}){const[c,u]=d.useState("details"),[g,f]=d.useState(""),b=d.useMemo(()=>{if(typeof Intl<"u"&&"supportedValuesOf"in Intl)try{const h=Intl.supportedValuesOf("timeZone").filter(D=>D.startsWith("America/")||D==="Pacific/Honolulu").slice().sort();return h.length>0?h:Rn}catch{return Rn}return Rn},[]);d.useEffect(()=>{if(!e||!t?.recurringEventId||!t.calendarId||t.recurrence&&t.recurrence.length>0)return;let h=!1;return fetch(`/api/google-calendar/events/${encodeURIComponent(t.recurringEventId)}?calendarId=${encodeURIComponent(t.calendarId)}`).then(D=>D.ok?D.json():null).then(D=>{h||!D?.recurrence||s({...t,recurrence:D.recurrence})}).catch(()=>{}),()=>{h=!0}},[e,t?.recurringEventId,t?.calendarId,t?.recurrence,s]);const p=h=>{switch(h){case"RRULE:FREQ=DAILY":return"Daily";case"RRULE:FREQ=WEEKLY":return"Weekly";case"RRULE:FREQ=MONTHLY":return"Monthly";case"RRULE:FREQ=YEARLY":return"Yearly";default:return h||"Unavailable"}},y=d.useMemo(()=>{if(!t)return"__none__";if(t.courseId)return String(t.courseId);if(t.course){const h=l.find(D=>D.name===t.course);if(h)return String(h.id)}return"__none__"},[t,l]);if(!t)return null;const T=!!t.start?.date&&!t.start?.dateTime,w=t.start?.timeZone||t.extendedProperties?.private?.timeZone||Intl.DateTimeFormat().resolvedOptions().timeZone||"UTC",j=b[0]||"America/New_York",M=b.includes(w)?w:j,E=(h,D)=>{s({...t,[h]:D})},v=h=>{if(h==="__none__"){s({...t,course:void 0,courseId:void 0,courseCode:void 0});return}const D=l.find(z=>String(z.id)===h);D&&s({...t,course:D.name,courseId:D.id,courseCode:D.code||void 0})},S=h=>{if(h){const D=(t.start?.dateTime||"").substring(0,10)||new Date().toISOString().substring(0,10),z=(t.end?.dateTime||"").substring(0,10)||D;s({...t,start:{date:D},end:{date:z}})}else{const D=t.start?.date||new Date().toISOString().substring(0,10);s({...t,start:{dateTime:`${D}T09:00`},end:{dateTime:`${D}T10:00`}})}},A=h=>{const D={...t.extendedProperties,private:{...t.extendedProperties?.private||{},timeZone:h}},z=t.start?.dateTime?{...t.start,timeZone:h}:t.start,te=t.end?.dateTime?{...t.end,timeZone:h}:t.end;s({...t,start:z,end:te,extendedProperties:D})},R=()=>{const h=g.trim();if(!h||!h.includes("@"))return;const D=t.attendees||[];D.some(z=>z.email===h)||(E("attendees",[...D,{email:h}]),f(""))},L=h=>{E("attendees",(t.attendees||[]).filter(D=>D.email!==h))},x=[{id:"details",label:"DETAILS"},{id:"time",label:"TIME"},{id:"recurrence",label:"REPEAT"},{id:"people",label:"PEOPLE"},{id:"settings",label:"SETTINGS"}];return r.jsx(Rt,{open:e,onOpenChange:n,children:r.jsx(Tt,{"data-modal":"calendar-edit-google",className:"font-arcade bg-black border-2 border-green-500 rounded-none max-w-lg p-0 overflow-hidden translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:r.jsxs("div",{className:"flex flex-col h-full max-h-[80vh]",children:[r.jsxs("div",{className:"bg-green-500/20 border-b border-green-500 p-4 flex items-center justify-between shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),r.jsx("span",{className:"text-green-500 font-bold tracking-wider",children:"EDIT_EVENT"})]}),r.jsxs("div",{className:"flex gap-1",children:[t.recurringEventId&&r.jsx(vn,{variant:"outline",className:"text-[10px] border-green-500 text-green-500",children:"INSTANCE"}),t.recurrence&&r.jsx(vn,{variant:"outline",className:"text-[10px] border-green-500 text-green-500",children:"SERIES"}),(t.conferenceData||t.hangoutLink)&&r.jsx(vn,{variant:"outline",className:"text-[10px] border-blue-400 text-blue-400",children:"ONLINE"})]})]}),r.jsx("div",{className:"flex border-b border-green-500/30 shrink-0",children:x.map(h=>r.jsx("button",{className:$("flex-1 py-2 text-[10px] font-arcade transition-colors",c===h.id?"text-green-500 border-b-2 border-green-500 bg-green-500/10":"text-zinc-500 hover:text-zinc-300"),onClick:()=>u(h.id),children:h.label},h.id))}),r.jsxs("div",{className:"p-5 space-y-4 overflow-y-auto flex-1",children:[c==="details"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"TITLE_"}),r.jsx(K,{value:t.summary||"",onChange:h=>E("summary",h.target.value),className:"bg-black border-green-500/50 focus:border-green-500 text-green-500 font-terminal text-lg h-12 rounded-none"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"DESCRIPTION_"}),r.jsx(kt,{value:t.description||"",onChange:h=>E("description",h.target.value),className:"bg-black border-green-500/50 text-green-500 font-terminal min-h-[80px] rounded-none resize-none"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"LOCATION_"}),r.jsx(K,{value:t.location||"",onChange:h=>E("location",h.target.value),className:"bg-black border-green-500/50 text-green-500 font-terminal rounded-none"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"EVENT_TYPE_"}),r.jsxs(se,{value:t.eventType||"study",onValueChange:h=>E("eventType",h),children:[r.jsx(ae,{className:"bg-black border-green-500/50 text-green-500 rounded-none h-8 font-terminal text-xs",children:r.jsx(oe,{})}),r.jsxs(ie,{className:"bg-black border-green-500 text-green-500 font-terminal z-[100010]",children:[r.jsx(I,{value:"study",children:"STUDY"}),r.jsx(I,{value:"lecture",children:"LECTURE"}),r.jsx(I,{value:"exam",children:"EXAM"}),r.jsx(I,{value:"synchronous",children:"SYNCHRONOUS"}),r.jsx(I,{value:"online",children:"ONLINE"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"COURSE_"}),r.jsxs(se,{value:y,onValueChange:v,children:[r.jsx(ae,{className:"bg-black border-green-500/50 text-green-500 rounded-none h-8 font-terminal text-xs",children:r.jsx(oe,{placeholder:"Select course"})}),r.jsxs(ie,{className:"bg-black border-green-500 text-green-500 font-terminal z-[100010]",children:[r.jsx(I,{value:"__none__",children:"None"}),l.length===0&&r.jsx(I,{value:"__empty__",disabled:!0,children:"No courses found"}),l.map(h=>r.jsx(I,{value:String(h.id),children:h.name},h.id))]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"WEIGHT_"}),r.jsx(K,{value:t.weight||"",onChange:h=>E("weight",h.target.value),placeholder:"e.g. High, Medium, Low",className:"bg-black border-green-500/50 text-green-500 font-terminal rounded-none"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"COLOR_ID_"}),r.jsxs(se,{value:t.colorId||"0",onValueChange:h=>E("colorId",h==="0"?void 0:h),children:[r.jsx(ae,{className:"bg-black border-green-500/50 text-green-500 rounded-none h-8 font-terminal text-xs",children:r.jsx(oe,{placeholder:"Default"})}),r.jsxs(ie,{className:"bg-black border-green-500 text-green-500 font-terminal z-[100010]",children:[r.jsx(I,{value:"0",children:"Default"}),r.jsx(I,{value:"1",children:"Lavender"}),r.jsx(I,{value:"2",children:"Sage"}),r.jsx(I,{value:"3",children:"Grape"}),r.jsx(I,{value:"4",children:"Flamingo"}),r.jsx(I,{value:"5",children:"Banana"}),r.jsx(I,{value:"6",children:"Tangerine"}),r.jsx(I,{value:"7",children:"Peacock"}),r.jsx(I,{value:"8",children:"Graphite"}),r.jsx(I,{value:"9",children:"Blueberry"}),r.jsx(I,{value:"10",children:"Basil"}),r.jsx(I,{value:"11",children:"Tomato"})]})]})]})]})]}),c==="time"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx(It,{id:"all-day",checked:T,onCheckedChange:h=>S(!!h),className:"border-green-500/50 data-[state=checked]:bg-green-500"}),r.jsx(O,{htmlFor:"all-day",className:"text-xs text-green-500/80 cursor-pointer",children:"ALL DAY EVENT"})]}),T?r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"START_DATE_"}),r.jsx(K,{type:"date",value:t.start?.date||"",onChange:h=>s({...t,start:{date:h.target.value}}),className:"bg-black border-green-500/50 text-green-500 font-terminal rounded-none"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"END_DATE_"}),r.jsx(K,{type:"date",value:t.end?.date||"",onChange:h=>s({...t,end:{date:h.target.value}}),className:"bg-black border-green-500/50 text-green-500 font-terminal rounded-none"})]})]}):r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"START_"}),r.jsx(K,{type:"datetime-local",value:t.start?.dateTime?.substring(0,16)||"",onChange:h=>s({...t,start:{dateTime:h.target.value}}),className:"bg-black border-green-500/50 text-green-500 font-terminal rounded-none"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"END_"}),r.jsx(K,{type:"datetime-local",value:t.end?.dateTime?.substring(0,16)||"",onChange:h=>s({...t,end:{dateTime:h.target.value}}),className:"bg-black border-green-500/50 text-green-500 font-terminal rounded-none"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"TIMEZONE_"}),r.jsxs(se,{value:M,onValueChange:A,children:[r.jsx(ae,{className:"bg-black border-green-500/50 text-green-500 rounded-none h-8 font-terminal text-xs",children:r.jsx(oe,{placeholder:"Select timezone"})}),r.jsx(ie,{className:"bg-black border-green-500 text-green-500 font-terminal z-[100010]",children:b.map(h=>r.jsx(I,{value:h,children:h},h))})]})]})]}),c==="recurrence"&&r.jsx(r.Fragment,{children:t.recurringEventId?r.jsxs("div",{className:"space-y-2",children:[r.jsx("p",{className:"text-xs text-yellow-500 font-terminal",children:"This is a single instance of a recurring event. Recurrence can only be edited on the series."}),r.jsxs("p",{className:"text-[10px] text-green-300 font-terminal",children:["Series pattern: ",p(t.recurrence?.[0])]})]}):r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs(O,{className:"text-xs text-green-500/80 flex items-center gap-2",children:["PATTERN_ ",r.jsx(Fr,{className:"w-3 h-3"})]}),r.jsxs(se,{value:t.recurrence?.[0]||"none",onValueChange:h=>E("recurrence",h==="none"?void 0:[h]),children:[r.jsx(ae,{className:"bg-black border-green-500/50 text-green-500 rounded-none h-8 font-terminal text-xs",children:r.jsx(oe,{placeholder:"No Recurrence"})}),r.jsxs(ie,{className:"bg-black border-green-500 text-green-500 font-terminal z-[100010]",children:[r.jsx(I,{value:"none",children:"None"}),r.jsx(I,{value:"RRULE:FREQ=DAILY",children:"Daily"}),r.jsx(I,{value:"RRULE:FREQ=WEEKLY",children:"Weekly"}),r.jsx(I,{value:"RRULE:FREQ=MONTHLY",children:"Monthly"}),r.jsx(I,{value:"RRULE:FREQ=YEARLY",children:"Yearly"})]})]})]}),t.recurrence&&!["RRULE:FREQ=DAILY","RRULE:FREQ=WEEKLY","RRULE:FREQ=MONTHLY","RRULE:FREQ=YEARLY"].includes(t.recurrence[0])&&r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"CUSTOM_RRULE_"}),r.jsx(kt,{value:t.recurrence[0],onChange:h=>E("recurrence",[h.target.value]),className:"bg-black border-green-500/30 text-green-100/70 text-[10px] font-mono h-12 rounded-none",placeholder:"RRULE:FREQ=WEEKLY;BYDAY=MO,WE"})]})]})}),c==="people"&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"ATTENDEES_"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(K,{value:g,onChange:h=>f(h.target.value),onKeyDown:h=>h.key==="Enter"&&R(),placeholder:"email@example.com",className:"bg-black border-green-500/50 text-green-500 font-terminal rounded-none text-xs flex-1"}),r.jsx(Y,{size:"sm",onClick:R,className:"rounded-none bg-green-500 text-black hover:bg-green-400 h-9 px-3",children:r.jsx(Bt,{className:"w-3 h-3"})})]})]}),r.jsxs("div",{className:"space-y-1",children:[(t.attendees||[]).map(h=>r.jsxs("div",{className:"flex items-center justify-between p-2 border border-zinc-800 text-xs font-terminal",children:[r.jsx("span",{className:"text-green-500",children:h.email}),r.jsxs("div",{className:"flex items-center gap-2",children:[h.responseStatus&&r.jsx("span",{className:$("text-[10px]",h.responseStatus==="accepted"?"text-green-400":h.responseStatus==="declined"?"text-red-400":"text-yellow-400"),children:h.responseStatus.toUpperCase()}),!h.self&&r.jsx("button",{onClick:()=>L(h.email),className:"text-red-500 hover:text-red-400",children:r.jsx(Tr,{className:"w-3 h-3"})})]})]},h.email)),(!t.attendees||t.attendees.length===0)&&r.jsx("p",{className:"text-xs text-zinc-500 font-terminal",children:"No attendees"})]})]}),c==="settings"&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"VISIBILITY_"}),r.jsxs(se,{value:t.visibility||"default",onValueChange:h=>E("visibility",h==="default"?void 0:h),children:[r.jsx(ae,{className:"bg-black border-green-500/50 text-green-500 rounded-none h-8 font-terminal text-xs",children:r.jsx(oe,{})}),r.jsxs(ie,{className:"bg-black border-green-500 text-green-500 font-terminal z-[100010]",children:[r.jsx(I,{value:"default",children:"Default"}),r.jsx(I,{value:"public",children:"Public"}),r.jsx(I,{value:"private",children:"Private"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"AVAILABILITY_"}),r.jsxs(se,{value:t.transparency||"opaque",onValueChange:h=>E("transparency",h),children:[r.jsx(ae,{className:"bg-black border-green-500/50 text-green-500 rounded-none h-8 font-terminal text-xs",children:r.jsx(oe,{})}),r.jsxs(ie,{className:"bg-black border-green-500 text-green-500 font-terminal z-[100010]",children:[r.jsx(I,{value:"opaque",children:"Busy"}),r.jsx(I,{value:"transparent",children:"Free"})]})]})]}),(t.conferenceData||t.hangoutLink)&&r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"CONFERENCE_"}),r.jsxs("div",{className:"p-2 border border-blue-500/30 rounded-none",children:[r.jsx("p",{className:"text-xs text-blue-400 font-terminal",children:t.conferenceData?.conferenceSolution?.name||"Google Meet"}),t.conferenceData?.entryPoints?.map((h,D)=>r.jsx("a",{href:h.uri,target:"_blank",rel:"noopener noreferrer",className:"text-[10px] text-blue-300 hover:underline block mt-1 font-mono",children:h.uri},D)),t.hangoutLink&&!t.conferenceData&&r.jsx("a",{href:t.hangoutLink,target:"_blank",rel:"noopener noreferrer",className:"text-[10px] text-blue-300 hover:underline block mt-1 font-mono",children:t.hangoutLink})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-green-500/80",children:"REMINDERS_"}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(It,{id:"use-default-reminders",checked:t.reminders?.useDefault!==!1,onCheckedChange:h=>E("reminders",h?{useDefault:!0}:{useDefault:!1,overrides:t.reminders?.overrides||[]}),className:"border-green-500/50 data-[state=checked]:bg-green-500"}),r.jsx(O,{htmlFor:"use-default-reminders",className:"text-xs text-green-500/80 cursor-pointer",children:"Use default reminders"})]})]})]})]}),r.jsxs("div",{className:"p-4 flex items-center justify-between gap-4 border-t border-green-500/20 shrink-0",children:[r.jsxs(Y,{variant:"destructive",size:"sm",onClick:i,className:"rounded-none bg-red-900/20 text-red-500 hover:bg-red-900/40 border border-red-900/50 font-arcade text-xs",children:[r.jsx(Kn,{className:"w-4 h-4 mr-2"})," DELETE"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(Y,{variant:"ghost",className:"bg-transparent border border-green-500/50 text-green-500 hover:bg-green-500/10 rounded-none font-arcade text-xs",onClick:()=>t.htmlLink&&window.open(t.htmlLink,"_blank"),children:[r.jsx($s,{className:"w-4 h-4 mr-2"})," OPEN"]}),r.jsx(Y,{className:"bg-green-500 text-black hover:bg-green-400 rounded-none font-arcade text-xs px-6",onClick:a,children:"SAVE"})]})]})]})})})}const Tn=["America/New_York","America/Chicago","America/Denver","America/Los_Angeles","America/Phoenix","America/Anchorage","America/Indiana/Indianapolis","America/Detroit","America/Boise","America/Juneau","Pacific/Honolulu"],Ii=[{value:"#ef4444",label:"Red"},{value:"#f97316",label:"Orange"},{value:"#eab308",label:"Yellow"},{value:"#22c55e",label:"Green"},{value:"#06b6d4",label:"Cyan"},{value:"#3b82f6",label:"Blue"},{value:"#8b5cf6",label:"Purple"},{value:"#ec4899",label:"Pink"},{value:"#6b7280",label:"Gray"}],Ai=[{id:"details",label:"DETAILS"},{id:"time",label:"TIME"},{id:"recurrence",label:"REPEAT"},{id:"people",label:"PEOPLE"},{id:"settings",label:"SETTINGS"}];function Mi({open:e,onOpenChange:n,event:t,onEventChange:s,onSave:a,onDelete:i,courseOptions:l=[]}){const[c,u]=d.useState("details"),[g,f]=d.useState(""),b=d.useMemo(()=>{if(typeof Intl<"u"&&"supportedValuesOf"in Intl)try{const x=Intl.supportedValuesOf("timeZone").filter(h=>h.startsWith("America/")||h==="Pacific/Honolulu").slice().sort();return x.length>0?x:Tn}catch{return Tn}return Tn},[]),p=d.useMemo(()=>{if(!t)return"__none__";if(t.courseId)return String(t.courseId);if(t.course){const x=l.find(h=>h.name===t.course);if(x)return String(x.id)}return"__none__"},[t,l]);if(!t)return null;const y=new Date(t.date),T=t.endDate?new Date(t.endDate):null,w=t.timeZone||Intl.DateTimeFormat().resolvedOptions().timeZone||"UTC",j=b[0]||"America/New_York",M=b.includes(w)?w:j,E=(()=>{const x=t.recurrence||"none";return x==="daily"?"RRULE:FREQ=DAILY":x==="weekly"?"RRULE:FREQ=WEEKLY":x==="monthly"?"RRULE:FREQ=MONTHLY":x==="yearly"?"RRULE:FREQ=YEARLY":x})(),v=["RRULE:FREQ=DAILY","RRULE:FREQ=WEEKLY","RRULE:FREQ=MONTHLY","RRULE:FREQ=YEARLY"],S=(x,h)=>{s({...t,[x]:h})},A=x=>{if(x==="__none__"){s({...t,course:null,courseId:null});return}const h=l.find(D=>String(D.id)===x);h&&s({...t,course:h.name,courseId:h.id})},R=()=>{const x=g.trim();if(!x||!x.includes("@"))return;const h=t.attendees||[];h.some(D=>D.email===x)||(S("attendees",[...h,{email:x}]),f(""))},L=x=>{S("attendees",(t.attendees||[]).filter(h=>h.email!==x))};return r.jsx(Rt,{open:e,onOpenChange:n,children:r.jsx(Tt,{"data-modal":"calendar-edit-local",className:"font-arcade bg-black border-2 border-primary rounded-none max-w-lg p-0 overflow-hidden translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:r.jsxs("div",{className:"flex flex-col h-full max-h-[80vh]",children:[r.jsxs("div",{className:"bg-primary/20 border-b border-primary p-4 flex items-center gap-2 shrink-0",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-primary animate-pulse"}),r.jsx("span",{className:"text-primary font-bold tracking-wider",children:"EDIT_EVENT"})]}),r.jsx("div",{className:"flex border-b border-primary/30 shrink-0",children:Ai.map(x=>r.jsx("button",{className:$("flex-1 py-2 text-[10px] font-arcade transition-colors",c===x.id?"text-primary border-b-2 border-primary bg-primary/10":"text-zinc-500 hover:text-zinc-300"),onClick:()=>u(x.id),children:x.label},x.id))}),r.jsxs("div",{className:"p-5 space-y-4 overflow-y-auto flex-1",children:[c==="details"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"TITLE_"}),r.jsx(K,{value:t.title,onChange:x=>S("title",x.target.value),className:"bg-black border-primary/50 focus:border-primary text-primary font-terminal text-lg h-12 rounded-none"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"DESCRIPTION_"}),r.jsx(kt,{value:t.notes||"",onChange:x=>S("notes",x.target.value),className:"bg-black border-primary/50 text-primary font-terminal min-h-[80px] rounded-none resize-none"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"LOCATION_"}),r.jsx(K,{value:t.location||"",onChange:x=>S("location",x.target.value||null),className:"bg-black border-primary/50 text-primary font-terminal rounded-none"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"EVENT_TYPE_"}),r.jsxs(se,{value:t.eventType||"study",onValueChange:x=>S("eventType",x),children:[r.jsx(ae,{className:"bg-black border-primary/50 text-primary rounded-none h-8 font-terminal text-xs",children:r.jsx(oe,{})}),r.jsxs(ie,{className:"bg-black border-primary text-primary font-terminal z-[100010]",children:[r.jsx(I,{value:"study",children:"STUDY"}),r.jsx(I,{value:"lecture",children:"LECTURE"}),r.jsx(I,{value:"exam",children:"EXAM"}),r.jsx(I,{value:"synchronous",children:"SYNCHRONOUS"}),r.jsx(I,{value:"online",children:"ONLINE"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"COURSE_"}),r.jsxs(se,{value:p,onValueChange:A,children:[r.jsx(ae,{className:"bg-black border-primary/50 text-primary rounded-none h-8 font-terminal text-xs",children:r.jsx(oe,{placeholder:"Select course"})}),r.jsxs(ie,{className:"bg-black border-primary text-primary font-terminal z-[100010]",children:[r.jsx(I,{value:"__none__",children:"None"}),l.length===0&&r.jsx(I,{value:"__empty__",disabled:!0,children:"No courses found"}),l.map(x=>r.jsx(I,{value:String(x.id),children:x.name},x.id))]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"WEIGHT_"}),r.jsx(K,{value:t.weight||"",onChange:x=>S("weight",x.target.value||null),placeholder:"e.g. High, Medium, Low",className:"bg-black border-primary/50 text-primary font-terminal rounded-none"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"COLOR_"}),r.jsx("div",{className:"flex gap-2 flex-wrap",children:Ii.map(x=>r.jsx("button",{className:$("w-7 h-7 rounded-sm border-2 transition-all",t.color===x.value?"border-white scale-110":"border-transparent hover:border-white/30"),style:{backgroundColor:x.value},onClick:()=>S("color",x.value),title:x.label},x.value))})]})]})]}),c==="time"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx(It,{id:"local-all-day",checked:t.allDay??!1,onCheckedChange:x=>S("allDay",!!x),className:"border-primary/50 data-[state=checked]:bg-primary"}),r.jsx(O,{htmlFor:"local-all-day",className:"text-xs text-primary/80 cursor-pointer",children:"ALL DAY EVENT"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"START_DATE_"}),r.jsx(K,{type:"date",value:V(y,"yyyy-MM-dd"),onChange:x=>{const[h,D]=[y.getHours(),y.getMinutes()];S("date",Ke($e(new Date(x.target.value),h),D))},className:"bg-black border-primary/50 text-primary font-terminal rounded-none"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"END_DATE_"}),r.jsx(K,{type:"date",value:T?V(T,"yyyy-MM-dd"):"",onChange:x=>{const h=x.target.value;S("endDate",h?new Date(h):null)},className:"bg-black border-primary/50 text-primary font-terminal rounded-none"})]})]}),!t.allDay&&r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"START_TIME_"}),r.jsx(K,{type:"time",value:V(y,"HH:mm"),onChange:x=>{const[h,D]=x.target.value.split(":").map(Number);S("date",Ke($e(y,h),D))},className:"bg-black border-primary/50 text-primary font-terminal rounded-none"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"END_TIME_"}),r.jsx(K,{type:"time",value:T?V(T,"HH:mm"):"",onChange:x=>{if(!x.target.value)return;const[h,D]=x.target.value.split(":").map(Number);S("endDate",Ke($e(T||y,h),D))},className:"bg-black border-primary/50 text-primary font-terminal rounded-none"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"TIMEZONE_"}),r.jsxs(se,{value:M,onValueChange:x=>S("timeZone",x),children:[r.jsx(ae,{className:"bg-black border-primary/50 text-primary rounded-none h-8 font-terminal text-xs",children:r.jsx(oe,{placeholder:"Select timezone"})}),r.jsx(ie,{className:"bg-black border-primary text-primary font-terminal z-[100010]",children:b.map(x=>r.jsx(I,{value:x,children:x},x))})]})]})]}),c==="recurrence"&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"PATTERN_"}),r.jsxs(se,{value:E,onValueChange:x=>S("recurrence",x==="none"?null:x),children:[r.jsx(ae,{className:"bg-black border-primary/50 text-primary rounded-none h-8 font-terminal text-xs",children:r.jsx(oe,{placeholder:"No Recurrence"})}),r.jsxs(ie,{className:"bg-black border-primary text-primary font-terminal z-[100010]",children:[r.jsx(I,{value:"none",children:"None"}),r.jsx(I,{value:"RRULE:FREQ=DAILY",children:"Daily"}),r.jsx(I,{value:"RRULE:FREQ=WEEKLY",children:"Weekly"}),r.jsx(I,{value:"RRULE:FREQ=MONTHLY",children:"Monthly"}),r.jsx(I,{value:"RRULE:FREQ=YEARLY",children:"Yearly"})]})]})]}),t.recurrence&&!v.includes(E)&&E!=="none"&&r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"CUSTOM_RRULE_"}),r.jsx(kt,{value:t.recurrence,onChange:x=>S("recurrence",x.target.value),className:"bg-black border-primary/30 text-primary text-[10px] font-mono h-12 rounded-none",placeholder:"RRULE:FREQ=WEEKLY;BYDAY=MO,WE"})]})]}),c==="people"&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"ATTENDEES_"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(K,{value:g,onChange:x=>f(x.target.value),onKeyDown:x=>x.key==="Enter"&&R(),placeholder:"email@example.com",className:"bg-black border-primary/50 text-primary font-terminal rounded-none text-xs flex-1"}),r.jsx(Y,{size:"sm",onClick:R,className:"rounded-none bg-primary text-black hover:bg-primary/90 h-9 px-3",children:"ADD"})]})]}),r.jsxs("div",{className:"space-y-1",children:[(t.attendees||[]).map(x=>r.jsxs("div",{className:"flex items-center justify-between p-2 border border-zinc-800 text-xs font-terminal",children:[r.jsx("span",{className:"text-primary",children:x.email}),r.jsxs("div",{className:"flex items-center gap-2",children:[x.responseStatus&&r.jsx("span",{className:$("text-[10px]",x.responseStatus==="accepted"?"text-green-400":x.responseStatus==="declined"?"text-red-400":"text-yellow-400"),children:x.responseStatus.toUpperCase()}),!x.self&&r.jsx("button",{onClick:()=>L(x.email),className:"text-red-500 hover:text-red-400",children:"X"})]})]},x.email)),(!t.attendees||t.attendees.length===0)&&r.jsx("p",{className:"text-xs text-zinc-500 font-terminal",children:"No attendees"})]})]}),c==="settings"&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"VISIBILITY_"}),r.jsxs(se,{value:t.visibility||"default",onValueChange:x=>S("visibility",x==="default"?null:x),children:[r.jsx(ae,{className:"bg-black border-primary/50 text-primary rounded-none h-8 font-terminal text-xs",children:r.jsx(oe,{})}),r.jsxs(ie,{className:"bg-black border-primary text-primary font-terminal z-[100010]",children:[r.jsx(I,{value:"default",children:"Default"}),r.jsx(I,{value:"public",children:"Public"}),r.jsx(I,{value:"private",children:"Private"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"AVAILABILITY_"}),r.jsxs(se,{value:t.transparency||"opaque",onValueChange:x=>S("transparency",x),children:[r.jsx(ae,{className:"bg-black border-primary/50 text-primary rounded-none h-8 font-terminal text-xs",children:r.jsx(oe,{})}),r.jsxs(ie,{className:"bg-black border-primary text-primary font-terminal z-[100010]",children:[r.jsx(I,{value:"opaque",children:"Busy"}),r.jsx(I,{value:"transparent",children:"Free"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"text-xs text-primary/80",children:"REMINDERS_"}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(It,{id:"use-default-reminders-local",checked:t.reminders?.useDefault!==!1,onCheckedChange:x=>S("reminders",x?{useDefault:!0}:{useDefault:!1,overrides:t.reminders?.overrides||[]}),className:"border-primary/50 data-[state=checked]:bg-primary"}),r.jsx(O,{htmlFor:"use-default-reminders-local",className:"text-xs text-primary/80 cursor-pointer",children:"Use default reminders"})]})]})]})]}),r.jsxs("div",{className:"p-4 flex items-center justify-between gap-4 border-t border-primary/20 shrink-0",children:[r.jsxs(Y,{variant:"destructive",size:"sm",onClick:i,className:"rounded-none bg-red-900/20 text-red-500 hover:bg-red-900/40 border border-red-900/50 font-arcade text-xs",children:[r.jsx(Kn,{className:"w-4 h-4 mr-2"})," DELETE"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(Y,{variant:"ghost",className:"bg-transparent border border-primary/50 text-primary hover:bg-primary/10 rounded-none font-arcade text-xs",onClick:()=>n(!1),children:"CANCEL"}),r.jsx(Y,{className:"bg-primary text-black hover:bg-primary/90 rounded-none font-arcade text-xs px-6",onClick:a,children:"SAVE"})]})]})]})})})}const Li=e=>{let{transform:n}=e;return{...n,x:0}},kn=e=>{if(!e)return new Date;const[n,t,s]=e.split("-").map(Number);return!n||!t||!s?new Date(e):new Date(n,t-1,s)},In=Array.from({length:24},(e,n)=>n),nt=60;function Oi({tasks:e,taskLists:n}){const t=Un(),{toast:s}=kr(),[a,i]=d.useState(null),[l,c]=d.useState(null),[u,g]=d.useState(0),[f,b]=d.useState(null),p=Vr(Fn(sn,{activationConstraint:{distance:8}}),Fn(Qn,{coordinateGetter:fi})),y=q({mutationFn:v=>B.googleTasks.move(v.taskId,v.listId,v.destListId,v.previous,v.parent),onSuccess:()=>t.invalidateQueries({queryKey:["google-tasks"]}),onError:()=>s({title:"Move Failed",variant:"destructive"})}),T=q({mutationFn:v=>B.googleTasks.update(v.id,v.listId,v.data),onSuccess:()=>{t.invalidateQueries({queryKey:["google-tasks"]}),c(null)}}),w=q({mutationFn:v=>B.googleTasks.create(v.listId,{title:v.title,status:"needsAction"}),onSuccess:()=>t.invalidateQueries({queryKey:["google-tasks"]})}),j=q({mutationFn:v=>B.googleTasks.delete(v.id,v.listId),onSuccess:()=>t.invalidateQueries({queryKey:["google-tasks"]})}),M=q({mutationFn:v=>B.googleTasks.update(v.id,v.listId,{status:v.status==="completed"?"needsAction":"completed"}),onSuccess:()=>t.invalidateQueries({queryKey:["google-tasks"]})}),E=v=>{const{active:S,over:A}=v;if(i(null),!A)return;const R=e.find(x=>x.id===S.id);if(!R)return;let L=null;if(A.data.current?.listId)L=A.data.current.listId;else if(A.data.current?.type==="Container")L=A.id;else{const x=e.find(h=>h.id===A.id);x&&(L=x.listId)}if(L&&(S.id!==A.id||R.listId!==L)){const x=e.filter(D=>D.listId===L).sort((D,z)=>(D.position||"").localeCompare(z.position||""));let h;if(S.id!==A.id){e.findIndex(z=>z.id===S.id);const D=x.findIndex(z=>z.id===A.id);D!==-1&&D>0&&(h=x[D-1].id)}y.mutate({taskId:R.id,listId:R.listId,destListId:L,previous:h})}};return r.jsxs(fs,{sensors:p,collisionDetection:Wr,onDragEnd:E,onDragStart:v=>i(v.active.id),children:[r.jsxs("div",{className:"flex h-full items-start justify-center gap-4 pt-4",children:[r.jsx(Y,{variant:"ghost",size:"icon",onClick:()=>g(v=>(v-1+n.length)%n.length),className:"h-10 w-10 mt-3 rounded-full border border-white/10 hover:bg-white/10 hover:text-white shrink-0",children:r.jsx(Lr,{className:"h-5 w-5"})}),n.length>0&&(()=>{const v=n[u],S=e.filter(A=>A.listId===v.id).sort((A,R)=>(A.position||"").localeCompare(R.position||""));return r.jsx("div",{className:"h-full w-[320px] shrink-0",children:r.jsx(Si,{listId:v.id,title:v.title,tasks:S,onAddTask:A=>b(A),onEdit:A=>c(A),onToggle:A=>M.mutate(A),onDelete:(A,R)=>{confirm("Delete task?")&&j.mutate({id:A,listId:R})}},v.id)})})(),r.jsx(Y,{variant:"ghost",size:"icon",onClick:()=>g(v=>(v+1)%n.length),className:"h-10 w-10 mt-3 rounded-full border border-white/10 hover:bg-white/10 hover:text-white shrink-0",children:r.jsx($n,{className:"h-5 w-5"})})]}),r.jsx(Jo,{children:a?r.jsx("div",{className:"opacity-80 rotate-2 cursor-grabbing",children:r.jsx("div",{className:"p-2 border bg-card text-primary font-arcade text-xs border-primary",children:e.find(v=>v.id===a)?.title||"Task"})}):null}),r.jsx(Sr,{task:l,isOpen:!!l,onClose:()=>c(null),onSave:v=>{l&&T.mutate({id:l.id,listId:l.listId,data:v})},onDelete:(v,S)=>j.mutate({id:v,listId:S}),availableLists:n}),r.jsx(Sr,{task:null,isOpen:!!f,isCreating:!0,activeListId:f||void 0,availableLists:n,onClose:()=>b(null),onSave:v=>{f&&v.title&&w.mutate({listId:f,title:v.title,...v})},onDelete:()=>{}})]})}function Fi({cal:e,isHidden:n,onToggle:t}){const{attributes:s,listeners:a,setNodeRef:i,transform:l,transition:c}=Jn({id:e.id}),u={transform:He.Transform.toString(l),transition:c};return r.jsxs("div",{ref:i,style:u,className:$("flex items-center gap-3 p-2 border border-zinc-800 hover:bg-zinc-900 transition-colors",n&&"opacity-50"),children:[r.jsx("div",{...s,...a,className:"cursor-grab text-zinc-500 hover:text-zinc-300",children:r.jsx(Ps,{className:"w-4 h-4"})}),r.jsx("div",{className:"w-4 h-4 rounded-sm",style:{backgroundColor:e.color}}),r.jsx("span",{className:"font-terminal text-sm flex-1 cursor-pointer",onClick:t,children:e.name}),r.jsx("span",{className:$("font-arcade text-[10px] px-2 py-0.5 cursor-pointer",n?"text-red-500":"text-green-500"),onClick:t,children:n?"HIDDEN":"VISIBLE"})]})}function Qi(){const e=Un(),{toast:n}=kr(),[t,s]=d.useState(new Date),[a,i]=d.useState("month"),[l,c]=d.useState(!1),[u,g]=d.useState(!1),[f,b]=d.useState(null),[p,y]=d.useState({title:"",date:"",endDate:"",startTime:"09:00",endTime:"10:00",allDay:!1,eventType:"study",color:"#ef4444",recurrence:"",calendarId:""}),[T,w]=d.useState(()=>{try{const o=localStorage.getItem("selectedCalendars");if(o){const m=JSON.parse(o);if(Array.isArray(m))return new Set(m)}}catch{}return new Set}),[j,M]=d.useState(!0),[E,v]=d.useState(!1),[S,A]=d.useState(""),[R,L]=d.useState(null),[x,h]=d.useState(!1),[D,z]=d.useState(!1),[te,me]=d.useState(!1),[he,Ge]=d.useState(!1),ye=typeof window<"u"&&new URLSearchParams(window.location.search).has("debugModals"),[Q,at]=d.useState(()=>{const o=localStorage.getItem("pinnedCalendars");return o?JSON.parse(o):[]}),[le,Ve]=d.useState(()=>{const o=localStorage.getItem("hiddenCalendars");return o?JSON.parse(o):[]}),[Fe,Z]=d.useState(!1),De=Vr(Fn(sn,{activationConstraint:{distance:5}})),[Be,ot]=d.useState(!1);d.useEffect(()=>{u&&!f&&(ye&&console.warn("[ModalDebug][Calendar] Edit modal open without event; closing."),g(!1))},[ye,f,u]),d.useEffect(()=>{x&&!R&&(ye&&console.warn("[ModalDebug][Calendar] Google edit modal open without event; closing."),h(!1))},[ye,R,x]),d.useEffect(()=>{ye&&console.info("[ModalDebug][Calendar] state",{showEditModal:u,selectedEvent:f?.id??null,showGoogleEditModal:x,selectedGoogleEvent:R?.id??null,showCalendarSettings:Fe,showEventModal:l})},[ye,f,R,Fe,u,l,x]);const ge=o=>{Ve(m=>{const N=m.includes(o),C=N?m.filter(k=>k!==o):[...m,o];return localStorage.setItem("hiddenCalendars",JSON.stringify(C)),N||w(k=>{const F=new Set(k);return F.delete(o),F}),C})},it=wn(t),Ie=yn(t),Se=bn(it,{weekStartsOn:0}),U=cr(Ie,{weekStartsOn:0}),Ze=Nn({start:Se,end:U}),ce=bn(t,{weekStartsOn:0}),Ae=Nn({start:ce,end:rt(ce,6)}),{data:Ne=[]}=Oe({queryKey:["events"],queryFn:B.events.getAll}),{data:Me=[],isLoading:ze,refetch:Xe}=Oe({queryKey:["google-calendar",t.getFullYear(),t.getMonth()],queryFn:async()=>{const o=wn(ur(t)).toISOString(),m=yn(On(t,1)).toISOString(),N=await fetch(`/api/google-calendar/events?timeMin=${encodeURIComponent(o)}&timeMax=${encodeURIComponent(m)}`);if(!N.ok)throw new Error("Failed to fetch");return N.json()}}),{data:_t=[]}=Oe({queryKey:["tasks"],queryFn:B.tasks.getAll}),{data:lt=[],isLoading:Pe,isError:ht,refetch:gt}=Oe({queryKey:["google-tasks"],queryFn:B.googleTasks.getAll,retry:1}),{data:xt=[]}=Oe({queryKey:["courses"],queryFn:B.courses.getActive}),{data:Yt=[]}=Oe({queryKey:["google-task-lists"],queryFn:B.googleTasks.getLists}),{data:Ut=[],refetch:cn}=Oe({queryKey:["google-calendar-list"],queryFn:async()=>{const o=await fetch("/api/google-calendar/calendars");if(!o.ok)throw new Error("Failed to fetch calendar list");return o.json()}}),{data:_e,refetch:Ye,isLoading:ct,error:dn}=Oe({queryKey:["google-status"],queryFn:B.google.getStatus,retry:1}),je=!!_e?.connected,$t=async()=>{if(!he){Ge(!0);try{const o=await Ye();if(o.data&&!o.data.connected){n({title:"SYNC_FAILED",description:"Google is not connected.",variant:"destructive"});return}const C=((await cn()).data||[]).map(F=>F.id).filter(Boolean);let k=null;if(C.length>0){const F=await fetch("/api/gcal/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({calendar_ids:C})});if(!F.ok)throw new Error("Failed to sync with Google.");const _=await F.json();if(_?.success===!1)throw new Error(_.error||"Sync failed.");k=_||null}if(C.length>0){const F=new Set(C);w(F),Ve([]),typeof window<"u"&&(localStorage.setItem("selectedCalendars",JSON.stringify(C)),localStorage.setItem("hiddenCalendars",JSON.stringify([]))),v(!1)}if(e.invalidateQueries({queryKey:["events"]}),await Xe(),k){const F=[typeof k.imported=="number"?`${k.imported} imported`:null,typeof k.updated=="number"?`${k.updated} updated`:null,typeof k.pushed=="number"?`${k.pushed} pushed`:null].filter(Boolean).join(", "),_=k.errors?.length?` (${k.errors.length} errors)`:"";n({title:"SYNCED",description:`Google sync complete${F?`: ${F}`:""}${_}.`})}else n({title:"SYNCED",description:"Google calendars refreshed."})}catch(o){n({title:"SYNC_FAILED",description:o instanceof Error?o.message:"Unable to sync Google calendars.",variant:"destructive"})}finally{Ge(!1)}}},pt=q({mutationFn:async()=>{const{authUrl:o}=await B.google.getAuthUrl();window.location.href=o}});q({mutationFn:B.google.disconnect,onSuccess:()=>{Ye(),e.invalidateQueries({queryKey:["google-calendar-events"]}),e.invalidateQueries({queryKey:["google-calendar-list"]}),e.invalidateQueries({queryKey:["google-tasks"]})}});const{data:bt=[]}=Oe({queryKey:["calendar-order"],queryFn:async()=>{const o=await fetch("/api/calendar-order?userId=default");return o.ok?o.json():[]}}),vt=q({mutationFn:async o=>{if(!(await fetch("/api/calendar-order",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:"default",order:o})})).ok)throw new Error("Failed to save calendar order")},onMutate:async o=>{await e.cancelQueries({queryKey:["calendar-order"]}),e.setQueryData(["calendar-order"],o)},onError:()=>{e.invalidateQueries({queryKey:["calendar-order"]})}}),ne=d.useMemo(()=>{const o=Ut.map(m=>({id:m.id,name:m.summary,color:m.backgroundColor||"#888888"}));if(bt.length>0){const m=new Map(bt.map((N,C)=>[N,C]));o.sort((N,C)=>{const k=m.get(N.id)??999,F=m.get(C.id)??999;return k-F})}return o},[Ut,bt]),un=d.useMemo(()=>ne.filter(o=>!le.includes(o.id)),[ne,le]),yt=d.useMemo(()=>{const o=xt.map(N=>({id:N.id,name:N.name,code:N.code??null})).filter(N=>!!N.name),m=new Map;return o.forEach(N=>{m.has(N.id)||m.set(N.id,N)}),Array.from(m.values()).sort((N,C)=>N.name.localeCompare(C.name))},[xt]);d.useEffect(()=>{if(ne.length>0&&T.size===0&&!localStorage.getItem("selectedCalendars")){const o=Q.length>0?Q:ne.slice(0,2).map(m=>m.id);w(new Set(o))}},[ne,Q]),d.useEffect(()=>{if(ne.length>0&&Q.length===0&&!localStorage.getItem("pinnedCalendars")){const o=ne.slice(0,2).map(m=>m.id);at(o),localStorage.setItem("pinnedCalendars",JSON.stringify(o))}},[ne,Q]);const fn=o=>{w(m=>{const N=new Set(m);return N.has(o)?N.delete(o):N.add(o),N}),v(!0)},mn=q({mutationFn:B.events.create,onSuccess:()=>{e.invalidateQueries({queryKey:["events"]}),c(!1),we()}}),hn=q({mutationFn:({id:o,data:m})=>B.events.update(o,m),onSuccess:()=>{e.invalidateQueries({queryKey:["events"]}),g(!1),b(null)}}),X=q({mutationFn:B.events.delete,onSuccess:()=>{e.invalidateQueries({queryKey:["events"]}),g(!1),b(null)}});q({mutationFn:B.tasks.create,onSuccess:()=>{e.invalidateQueries({queryKey:["tasks"]})}}),q({mutationFn:({id:o,status:m})=>B.tasks.update(o,{status:m==="completed"?"pending":"completed"}),onSuccess:()=>{e.invalidateQueries({queryKey:["tasks"]})}}),q({mutationFn:async o=>{const m=await fetch("/api/google-tasks/@default",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:o})});if(!m.ok)throw new Error("Failed to create task");return m.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["google-tasks"]})}}),q({mutationFn:async({taskId:o,completed:m})=>{const N=await fetch(`/api/google-tasks/@default/${o}/toggle`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({completed:m})});if(!N.ok)throw new Error("Failed to toggle task");return N.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["google-tasks"]})}});const re=q({mutationFn:async({eventId:o,calendarId:m})=>{const N=await fetch(`/api/google-calendar/events/${encodeURIComponent(o)}?calendarId=${encodeURIComponent(m)}`,{method:"DELETE"});if(!N.ok)throw new Error("Failed to delete event");return N.status===204?null:N.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["google-calendar"]}),Xe(),n({title:"EVENT_DELETED",description:"Event removed from Google Calendar"}),h(!1),L(null)},onError:o=>{n({title:"DELETE_FAILED",description:o.message,variant:"destructive"})}}),de=q({mutationFn:async o=>{if(!o.calendarId)throw new Error("Missing calendarId");const m={...o.extendedProperties?.private||{}};o.eventType!==void 0?m.eventType=o.eventType:delete m.eventType,o.course!==void 0?m.course=o.course:delete m.course,o.courseId!==void 0?m.courseId=String(o.courseId):delete m.courseId,o.courseCode!==void 0?m.courseCode=o.courseCode:delete m.courseCode,o.weight!==void 0?m.weight=o.weight:delete m.weight;const N=o.extendedProperties?.private?.timeZone||o.start?.timeZone;N&&(m.timeZone=N);const C=Object.keys(m).length?{private:m}:void 0,k=await fetch(`/api/google-calendar/events/${encodeURIComponent(o.id)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({calendarId:o.calendarId,summary:o.summary,description:o.description,location:o.location,start:o.start,end:o.end,recurrence:o.recurringEventId?void 0:o.recurrence,attendees:o.attendees,visibility:o.visibility,transparency:o.transparency,colorId:o.colorId,reminders:o.reminders,extendedProperties:C})});if(!k.ok)throw new Error("Failed to update google event");return k.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["google-calendar"]}),Xe(),n({title:"EVENT_UPDATED",description:"Changes synced to Google Calendar"}),h(!1)},onError:o=>{n({title:"SYNC_FAILED",description:o.message,variant:"destructive"})}}),Le=q({mutationFn:async o=>{const m=await fetch("/api/google-calendar/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!m.ok)throw new Error("Failed to create Google event");return m.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["google-calendar"]}),Xe(),c(!1),we(),n({title:"EVENT_CREATED",description:"Saved to Google Calendar"})},onError:o=>{n({title:"CREATE_FAILED",description:o.message,variant:"destructive"})}}),xe=()=>{R&&R.calendarId&&(R.recurringEventId?confirm("Delete this single occurrence?")&&re.mutate({eventId:R.id,calendarId:R.calendarId}):R.recurrence&&R.recurrence.length>0?confirm("Delete the ENTIRE series? This cannot be undone.")&&re.mutate({eventId:R.id,calendarId:R.calendarId}):confirm("Delete this event?")&&re.mutate({eventId:R.id,calendarId:R.calendarId}))},ue=()=>{R&&de.mutate(R)},we=()=>{y({title:"",date:"",endDate:"",startTime:"09:00",endTime:"10:00",allDay:!1,eventType:"study",color:"#ef4444",recurrence:"",calendarId:""})},qe=o=>{if(!o||o==="none")return null;if(o.startsWith("RRULE:"))return o;switch(o){case"daily":return"RRULE:FREQ=DAILY";case"weekly":return"RRULE:FREQ=WEEKLY";case"monthly":return"RRULE:FREQ=MONTHLY";case"yearly":return"RRULE:FREQ=YEARLY";default:return o}},G=o=>{if("summary"in o){const m=o,N=!!m.start?.date&&!m.start?.dateTime,C=m.start?.dateTime||m.start?.date||new Date().toISOString(),k=m.end?.dateTime||m.end?.date||C,F=N&&m.start?.date?kn(m.start.date):new Date(C);let _=N&&m.end?.date?kn(m.end.date):new Date(k);N&&m.start?.date&&m.end?.date&&m.end.date>m.start.date&&(_=rt(kn(m.end.date),-1));const J=!!(m.conferenceData||m.hangoutLink),tt=m.eventType||m.extendedProperties?.private?.eventType;return{id:m.id,title:m.summary||"Untitled",start:F,end:_,allDay:N,isGoogle:!0,eventType:tt||(J?"online":"synchronous"),calendarColor:m.calendarColor,calendarName:m.calendarSummary,originalEvent:o}}else{const m=o,N=new Date(m.date),C=m.endDate?new Date(m.endDate):ea(N,1);return{id:m.id,title:m.title,start:N,end:C,allDay:m.allDay||!1,isGoogle:!1,eventType:m.eventType,calendarColor:m.color||void 0,originalEvent:o}}},Re=o=>!o.calendarId||o.calendarId==="local",Ce=()=>{if(p.title&&p.date){const[o,m]=p.startTime.split(":").map(Number),[N,C]=p.endTime.split(":").map(Number),k=Ke($e(new Date(p.date),o),m);let F=null;if(p.allDay)p.endDate&&(F=new Date(p.endDate));else{const J=p.endDate||p.date;F=Ke($e(new Date(J),N),C)}const _=qe(p.recurrence);if(p.calendarId&&p.calendarId!=="local"){if(!je){n({title:"SYNC_FAILED",description:"Google is not connected.",variant:"destructive"});return}const J=p.allDay&&p.endDate?rt(new Date(p.endDate),1):F;Le.mutate({calendarId:p.calendarId,title:p.title,date:k,endDate:J,allDay:p.allDay,recurrence:_});return}mn.mutate({title:p.title,date:k,endDate:F,allDay:p.allDay,eventType:p.eventType,color:p.color,recurrence:_,calendarId:"local"})}},pe=(o,m)=>{const N=m??9;y({title:"",date:V(o,"yyyy-MM-dd"),endDate:"",startTime:`${N.toString().padStart(2,"0")}:00`,endTime:`${(N+1).toString().padStart(2,"0")}:00`,allDay:!1,eventType:"study",color:"#ef4444",recurrence:"",calendarId:"local"}),c(!0)},Je=o=>{o&&(b(o),g(!0))},et=o=>{if(!o)return;const m=o.extendedProperties?.private||{},N=m.courseId?Number.parseInt(m.courseId,10):void 0,C=Number.isFinite(N)?N:void 0;L({...o,eventType:o.eventType||m.eventType,course:o.course||m.course,courseId:o.courseId??C,courseCode:o.courseCode||m.courseCode,weight:o.weight||m.weight}),h(!0)},be=o=>{o.isGoogle?et(o.originalEvent):Je(o.originalEvent)};d.useMemo(()=>{if(!S.trim())return[];const o=S.toLowerCase(),m=[];return j&&Ne.forEach(N=>{je&&!Re(N)||N.title.toLowerCase().includes(o)&&m.push(G(N))}),Me.forEach(N=>{T.size>0&&!T.has(N.calendarId||"")||N.summary?.toLowerCase().includes(o)&&m.push(G(N))}),m.sort((N,C)=>N.start.getTime()-C.start.getTime())},[S,Ne,Me,j,T]);const Qe=(o,m)=>{const N=$e(Ke(m,0),0),C=$e(Ke(m,59),23);return o.start<=C&&o.end>=N},Ue=o=>{const m=[];return j&&Ne.forEach(N=>{if(je&&!Re(N))return;const C=G(N);Qe(C,o)&&m.push(C)}),Me.forEach(N=>{if(T.size>0&&!T.has(N.calendarId||""))return;const C=G(N);Qe(C,o)&&m.push(C)}),m.sort((N,C)=>N.allDay&&!C.allDay?-1:!N.allDay&&C.allDay?1:N.start.getTime()-C.start.getTime())},rr=o=>{s(a==="month"?o==="prev"?ur(t):On(t,1):a==="week"?o==="prev"?va(t):Pr(t,1):o==="prev"?ra(t):rt(t,1))},Es=()=>s(new Date),gn=o=>{s(o),i("day")};_t.filter(o=>o.status==="pending").length,lt.filter(o=>o.status==="needsAction").length;const Ds=()=>a==="month"?V(t,"MMMM yyyy").toUpperCase():a==="week"?`${V(ce,"MMM d")} - ${V(rt(ce,6),"MMM d, yyyy")}`.toUpperCase():V(t,"EEEE, MMMM d, yyyy").toUpperCase(),Nt=o=>{const m="backdrop-blur-sm shadow-sm transition-all duration-200 hover:scale-[1.02] hover:z-50 hover:shadow-lg";if(o.calendarColor)return`${m} text-white font-medium border-l-4`;if(o.isGoogle)return`${m} text-white font-medium border-l-4`;switch(o.eventType){case"study":return`${m} bg-red-500/30 text-white border-l-4 border-red-500`;case"lecture":return`${m} bg-cyan-500/30 text-white border-l-4 border-cyan-500`;case"exam":return`${m} bg-amber-500/30 text-white border-l-4 border-amber-500`;default:return`${m} bg-red-500/30 text-white border-l-4 border-red-500`}},wt=o=>{if(o.calendarColor){const m=o.calendarColor.replace("#",""),N=parseInt(m.substring(0,2),16),C=parseInt(m.substring(2,4),16),k=parseInt(m.substring(4,6),16);return{backgroundColor:`rgba(${N}, ${C}, ${k}, 0.35)`,borderLeftColor:o.calendarColor,boxShadow:"0 4px 6px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.1)"}}return{boxShadow:"0 4px 6px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.1)"}},sr=(o,m,N=0,C=1)=>{const k=lr(o.start,m),F=lr(o.end,o.start),_=k/60*nt,J=Math.max(F/60*nt,24),tt=C>1?`${100/C}%`:"calc(100% - 4px)",xn=C>1?`${N/C*100}%`:"0",pn={top:`${_}px`,height:`${J}px`,width:tt,left:xn};return o.calendarColor&&(pn.backgroundColor=o.calendarColor,pn.borderLeftColor=o.calendarColor),pn},ar=o=>{const m=new Map;if(o.length===0)return m;const N=[...o].sort((k,F)=>k.start.getTime()-F.start.getTime()),C=[];for(const k of N){let F=-1;for(let _=0;_<C.length;_++)if(k.start>=C[_]){F=_;break}F===-1?(F=C.length,C.push(k.end)):C[F]=k.end,m.set(k.id,{column:F,totalColumns:1})}for(const k of N){let F=1;for(const J of N)if(k.id!==J.id&&k.start<J.end&&k.end>J.start){const tt=m.get(k.id)?.column||0,xn=m.get(J.id)?.column||0;F=Math.max(F,tt+1,xn+1)}const _=m.get(k.id);_&&m.set(k.id,{..._,totalColumns:F})}return m};return r.jsxs(Fs,{children:[ye&&r.jsxs("div",{className:"fixed bottom-12 right-4 z-[70] bg-black/80 border border-primary text-primary font-terminal text-[10px] px-2 py-1 rounded-none",children:[r.jsx("div",{children:"Calendar modals"}),r.jsxs("div",{children:["Edit event: ",u?"open":"closed"]}),r.jsxs("div",{children:["Selected event: ",f?.id??"none"]}),r.jsxs("div",{children:["Google edit: ",x?"open":"closed"]}),r.jsxs("div",{children:["Google event: ",R?.id??"none"]}),r.jsxs("div",{children:["Manage calendars: ",Fe?"open":"closed"]}),r.jsxs("div",{children:["Create event: ",l?"open":"closed"]})]}),r.jsx("div",{className:"h-[calc(100vh-80px)]",children:r.jsx("div",{className:"flex flex-col h-full",children:r.jsxs(Ar,{className:"bg-black/40 border-2 border-primary rounded-none flex-1 flex flex-col overflow-hidden",children:[r.jsxs(Mr,{className:"border-b border-primary/30 p-4 flex flex-row justify-between items-center shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(Y,{size:"sm",variant:"outline",className:"rounded-none border-primary text-primary hover:bg-primary hover:text-black font-arcade text-xs",onClick:Es,"data-testid":"button-today",children:"TODAY"}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(Y,{size:"icon",variant:"ghost",className:"h-8 w-8 rounded-none hover:bg-primary/20",onClick:()=>rr("prev"),"data-testid":"button-prev",children:r.jsx(Lr,{className:"h-4 w-4"})}),r.jsx(Y,{size:"icon",variant:"ghost",className:"h-8 w-8 rounded-none hover:bg-primary/20",onClick:()=>rr("next"),"data-testid":"button-next",children:r.jsx($n,{className:"h-4 w-4"})})]}),r.jsxs("div",{className:"relative",children:[r.jsxs("button",{className:"font-arcade text-sm md:text-lg text-primary hover:text-primary/80 flex items-center gap-1 transition-colors",onClick:()=>me(!te),"data-testid":"text-header-title",children:[Ds(),r.jsx(zs,{className:$("w-4 h-4 transition-transform",te&&"rotate-180")})]}),te&&r.jsx("div",{className:"absolute top-full left-0 mt-2 z-50 bg-black border-2 border-primary p-2 shadow-lg",children:r.jsxs("div",{className:"grid grid-cols-7 gap-1 text-center min-w-[200px]",children:[["S","M","T","W","T","F","S"].map((o,m)=>r.jsx("div",{className:"font-arcade text-[8px] text-muted-foreground p-1",children:o},m)),Nn({start:bn(wn(t),{weekStartsOn:0}),end:cr(yn(t),{weekStartsOn:0})}).slice(0,42).map((o,m)=>r.jsx("button",{onClick:()=>{gn(o),me(!1)},className:$("font-terminal text-[10px] p-1 hover:bg-primary/20 transition-colors",!dr(o,t)&&"text-muted-foreground/50",st(o)&&"bg-primary text-black",Gs(o,t)&&!st(o)&&"ring-1 ring-primary"),children:V(o,"d")},m))]})})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"relative hidden md:block",children:[r.jsx(Zs,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3 h-3 text-muted-foreground"}),r.jsx(K,{className:"rounded-none bg-black/60 border-secondary pl-7 pr-2 font-terminal text-xs h-8 w-40",placeholder:"Search...",value:S,onChange:o=>A(o.target.value),"data-testid":"input-search-events"})]}),r.jsx(Ri,{onClick:()=>z(!0)}),r.jsx(Y,{size:"sm",variant:"ghost",className:"rounded-none hover:bg-primary/20",onClick:$t,disabled:ze||he,"data-testid":"button-sync",children:r.jsx(Fr,{className:$("h-4 w-4",(ze||he)&&"animate-spin")})}),r.jsx("div",{className:"flex border border-secondary rounded-none",children:["month","week","day","tasks"].map(o=>r.jsx(Y,{size:"sm",variant:a===o?"default":"ghost",className:$("rounded-none font-arcade text-xs px-3",a===o?"bg-primary text-black":""),onClick:()=>i(o),"data-testid":`button-${o}-view`,children:o.toUpperCase()},o))}),r.jsxs(Y,{size:"sm",className:"rounded-none font-arcade text-xs bg-primary text-black hover:bg-primary/90",onClick:()=>pe(t),"data-testid":"button-create-event-header",children:[r.jsx(Bt,{className:"w-4 h-4 mr-1"})," CREATE"]})]})]}),r.jsxs("div",{className:"px-4 py-1.5 border-b border-primary/20 bg-black/60 flex items-center gap-3 shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-4 overflow-x-auto flex-1 min-w-0",children:[r.jsx("span",{className:"font-arcade text-xs text-muted-foreground shrink-0",children:"CALENDARS:"}),r.jsxs("div",{className:"flex items-center gap-2 cursor-pointer hover:opacity-80 transition-opacity shrink-0",onClick:()=>M(!j),children:[r.jsx("div",{className:$("w-3 h-3 rounded-sm",j?"bg-primary":"bg-muted-foreground/30")}),r.jsx("span",{className:$("font-terminal text-sm",j?"text-primary":"text-muted-foreground"),children:"Local"})]}),un.map(o=>r.jsxs("div",{className:"flex items-center gap-1.5 cursor-pointer hover:opacity-80 transition-opacity shrink-0",onClick:()=>fn(o.id),children:[r.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:T.has(o.id)?o.color:"rgba(100,100,100,0.3)"}}),r.jsx("span",{className:$("font-terminal text-sm truncate max-w-[100px]",T.has(o.id)?"":"text-muted-foreground"),children:o.name})]},o.id)),le.length>0&&r.jsxs("span",{className:"font-terminal text-[10px] text-muted-foreground shrink-0",children:["+",le.length," hidden"]})]}),r.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[r.jsxs(Y,{size:"sm",variant:"ghost",className:"h-6 px-2 rounded-none hover:bg-primary/20 font-arcade text-[9px] flex items-center gap-1.5",onClick:()=>{localStorage.setItem("selectedCalendars",JSON.stringify(Array.from(T))),v(!1),n({title:"SAVED",description:`${T.size} calendar(s) saved`})},children:[r.jsx("div",{className:$("w-2 h-2 rounded-full",E?"bg-red-500":"bg-green-500")}),"SAVE"]}),r.jsx(Y,{size:"sm",variant:"ghost",className:"h-6 px-2 rounded-none hover:bg-primary/20 font-arcade text-[9px]",onClick:()=>{ye&&console.info("[ModalDebug][Calendar] MANAGE click"),Z(!0)},children:"MANAGE"}),_e?.connected?r.jsxs("div",{className:"flex items-center gap-1 text-green-500",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-current"}),r.jsx("span",{className:"font-terminal text-[10px]",children:"SYNCED"})]}):r.jsx(Y,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none border-yellow-500 text-yellow-500 hover:bg-yellow-500/20 font-arcade text-[9px]",onClick:()=>pt.mutate(),disabled:pt.isPending,children:pt.isPending?"CONNECTING...":"CONNECT GOOGLE"})]})]}),r.jsx(Rt,{open:Fe,onOpenChange:Z,modal:!1,children:r.jsxs(Tt,{"data-modal":"calendar-manage",className:"bg-black border-2 border-primary rounded-none max-w-md pointer-events-auto translate-y-0 data-[state=open]:animate-none data-[state=closed]:animate-none",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[r.jsx(or,{children:r.jsx(ir,{className:"font-arcade text-primary",children:"MANAGE CALENDARS"})}),r.jsxs("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:[r.jsx("p",{className:"font-terminal text-xs text-muted-foreground mb-4",children:"Drag to reorder. Click to show/hide."}),r.jsx(fs,{sensors:De,collisionDetection:Wr,modifiers:[Li],onDragEnd:o=>{const{active:m,over:N}=o;if(!N||m.id===N.id)return;const C=ne.findIndex(_=>_.id===m.id),k=ne.findIndex(_=>_.id===N.id);if(C===-1||k===-1)return;const F=Xn(ne,C,k);vt.mutate(F.map(_=>_.id))},children:r.jsx(bs,{items:ne.map(o=>o.id),strategy:gs,children:ne.map(o=>r.jsx(Fi,{cal:o,isHidden:le.includes(o.id),onToggle:()=>ge(o.id)},o.id))})})]}),r.jsx(An,{children:r.jsx(Y,{variant:"outline",className:"rounded-none border-primary font-arcade text-xs",onClick:()=>Z(!1),children:"CLOSE"})})]})}),r.jsxs(Us,{className:"p-0 flex-1 overflow-hidden flex flex-col",children:[a==="month"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"grid grid-cols-7 border-b border-zinc-800 bg-zinc-900/80 shrink-0",children:["SUN","MON","TUE","WED","THU","FRI","SAT"].map(o=>r.jsx("div",{className:"p-2 text-center font-arcade text-xs text-zinc-400 border-r border-zinc-800 last:border-r-0",children:o},o))}),r.jsx("div",{className:"grid grid-cols-7 flex-1 overflow-auto",children:Ze.map((o,m)=>{const N=Ue(o),C=dr(o,t),k=st(o);return r.jsxs("div",{onClick:()=>gn(o),className:$("min-h-[180px] border-r border-b border-zinc-800 p-1.5 cursor-pointer transition-colors hover:bg-zinc-800/50",!C&&"bg-zinc-900/60 text-zinc-600",m%7===6&&"border-r-0"),"data-testid":`day-cell-${V(o,"yyyy-MM-dd")}`,children:[r.jsx("div",{className:$("text-right font-mono text-sm w-6 h-6 flex items-center justify-center ml-auto",k&&"bg-red-500 text-white rounded-full font-bold"),children:V(o,"d")}),r.jsxs("div",{className:"space-y-0.5 mt-1",children:[N.slice(0,3).map((F,_)=>r.jsxs("div",{className:$("text-xs font-mono truncate px-1.5 py-1 rounded cursor-pointer hover:brightness-110",Nt(F)),style:wt(F),title:F.title,onClick:J=>{J.stopPropagation(),be(F)},children:[F.eventType==="online"&&r.jsx("span",{className:"inline-block w-1.5 h-1.5 rounded-full bg-blue-400 mr-1 align-middle",title:"Online"}),F.title]},`${F.id}-${_}`)),N.length>3&&r.jsxs("div",{className:"text-[10px] font-mono text-zinc-400 px-1 mt-0.5",children:["+",N.length-3," more"]})]})]},m)})})]}),a==="week"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-8 border-b border-zinc-800 bg-zinc-900/80 shrink-0",children:[r.jsx("div",{className:"p-2 w-16 border-r border-zinc-800"}),Ae.map(o=>r.jsxs("div",{className:"p-2 text-center border-r border-zinc-800 last:border-r-0 cursor-pointer hover:bg-zinc-800/50",onClick:()=>gn(o),children:[r.jsx("div",{className:"font-arcade text-xs text-zinc-400",children:V(o,"EEE").toUpperCase()}),r.jsx("div",{className:$("font-mono text-lg mt-1 w-8 h-8 flex items-center justify-center mx-auto",st(o)&&"bg-red-500 text-white rounded-full font-bold"),children:V(o,"d")})]},o.toISOString()))]}),r.jsxs("div",{className:"grid grid-cols-8 border-b border-zinc-800 bg-zinc-900/60 shrink-0",children:[r.jsx("div",{className:"p-1 w-16 border-r border-zinc-800 text-xs font-mono text-zinc-500 text-right pr-2",children:"ALL DAY"}),Ae.map(o=>{const m=Ue(o).filter(N=>N.allDay);return r.jsx("div",{className:"border-r border-zinc-800 last:border-r-0 p-0.5 min-h-[28px]",children:m.map((N,C)=>r.jsx("div",{className:$("text-[10px] font-mono truncate px-1.5 py-0.5 rounded cursor-pointer hover:brightness-110",Nt(N)),style:wt(N),onClick:k=>{k.stopPropagation(),be(N)},children:N.title},C))},`allday-${o.toISOString()}`)})]}),r.jsx(Mn,{className:"flex-1",children:r.jsxs("div",{className:"grid grid-cols-8 relative",style:{height:`${24*nt}px`},children:[r.jsx("div",{className:"w-16 border-r border-zinc-800",children:In.map(o=>r.jsx("div",{className:"border-b border-zinc-800/50 text-right pr-2 font-mono text-[11px] text-zinc-500",style:{height:`${nt}px`},children:o===0?"12 AM":o<12?`${o} AM`:o===12?"12 PM":`${o-12} PM`},o))}),Ae.map(o=>{const m=$e(Ke(o,0),0),N=Ue(o).filter(k=>!k.allDay),C=ar(N);return r.jsxs("div",{className:"relative border-r border-zinc-800/50 last:border-r-0",children:[In.map(k=>r.jsx("div",{className:"border-b border-zinc-800/30 cursor-pointer hover:bg-zinc-800/30",style:{height:`${nt}px`},onClick:()=>pe(o,k)},k)),N.map((k,F)=>{const _=C.get(k.id)||{column:0,totalColumns:1},J={...sr(k,m,_.column,_.totalColumns),...wt(k)};return r.jsxs("div",{className:$("absolute rounded p-1 cursor-pointer overflow-hidden",Nt(k)),style:J,onClick:tt=>{tt.stopPropagation(),be(k)},children:[r.jsx("div",{className:"text-xs font-mono font-medium truncate",children:k.title}),r.jsx("div",{className:"text-[10px] opacity-80 font-mono",children:V(k.start,"h:mma")})]},F)})]},o.toISOString())})]})})]}),a==="day"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"p-4 border-b border-zinc-800 bg-zinc-900/80 shrink-0 flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-arcade text-xs text-zinc-400",children:V(t,"EEEE").toUpperCase()}),r.jsx("div",{className:$("font-mono text-2xl font-bold",st(t)&&"text-red-500"),children:V(t,"d")})]}),r.jsxs(Y,{size:"sm",className:"rounded-none font-arcade text-xs bg-red-500 text-white hover:bg-red-600",onClick:()=>pe(t),"data-testid":"button-create-event",children:[r.jsx(Bt,{className:"w-4 h-4 mr-1"})," CREATE"]})]}),(()=>{const o=Ue(t).filter(m=>m.allDay);return o.length===0?null:r.jsxs("div",{className:"p-3 border-b border-secondary/50 bg-black/40 shrink-0 flex gap-2 flex-wrap items-center",children:[r.jsx("span",{className:"font-mono text-sm text-muted-foreground",children:"ALL DAY:"}),o.map((m,N)=>r.jsx("div",{className:$("text-sm font-mono px-3 py-1 rounded cursor-pointer hover:brightness-110",Nt(m)),style:wt(m),onClick:C=>{C.stopPropagation(),be(m)},children:m.title},N))]})})(),r.jsx(Mn,{className:"flex-1",children:r.jsxs("div",{className:"relative",style:{height:`${24*nt}px`},children:[In.map(o=>r.jsxs("div",{className:"flex border-b border-zinc-800/30 cursor-pointer hover:bg-zinc-800/30",style:{height:`${nt}px`},onClick:()=>pe(t,o),children:[r.jsx("div",{className:"w-20 text-right pr-2 font-mono text-xs text-zinc-500 shrink-0 pt-1",children:o===0?"12 AM":o<12?`${o} AM`:o===12?"12 PM":`${o-12} PM`}),r.jsx("div",{className:"flex-1 border-l border-zinc-800/50"})]},o)),(()=>{const o=Ue(t).filter(C=>!C.allDay),m=ar(o),N=$e(Ke(t,0),0);return r.jsx("div",{className:"absolute top-0 left-20 right-0",children:o.map((C,k)=>{const F=m.get(C.id)||{column:0,totalColumns:1},_={...sr(C,N,F.column,F.totalColumns),...wt(C)};return r.jsxs("div",{className:$("absolute rounded p-2 cursor-pointer",Nt(C)),style:_,onClick:J=>{J.stopPropagation(),be(C)},children:[r.jsx("div",{className:"font-bold text-sm font-mono truncate",children:C.title}),r.jsxs("div",{className:"text-xs font-mono opacity-80",children:[V(C.start,"h:mm a")," - ",V(C.end,"h:mm a")]})]},k)})})})()]})})]}),a==="tasks"&&r.jsx("div",{className:"flex-1 overflow-hidden bg-black/40 p-4",children:r.jsx(Oi,{tasks:lt,taskLists:Yt})})]})]})})}),r.jsx(Rt,{open:l,onOpenChange:c,children:r.jsxs(Tt,{"data-modal":"calendar-create",className:"bg-black border-2 border-primary rounded-none max-w-lg max-h-[90vh] overflow-y-auto translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[r.jsx(or,{children:r.jsx(ir,{className:"font-arcade text-primary",children:"CREATE_EVENT"})}),r.jsxs("div",{className:"space-y-4 py-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"font-arcade text-sm",children:"TITLE"}),r.jsx(K,{className:"rounded-none bg-black border-secondary focus-visible:ring-primary",placeholder:"Event title...",value:p.title,onChange:o=>y({...p,title:o.target.value}),"data-testid":"input-modal-title"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"font-arcade text-sm",children:"START DATE"}),r.jsx(K,{type:"date",className:"rounded-none bg-black border-secondary",value:p.date,onChange:o=>y({...p,date:o.target.value}),"data-testid":"input-modal-date"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"font-arcade text-sm",children:"END DATE"}),r.jsx(K,{type:"date",className:"rounded-none bg-black border-secondary",value:p.endDate,onChange:o=>y({...p,endDate:o.target.value}),placeholder:p.date,"data-testid":"input-modal-end-date"})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(It,{id:"allDay",checked:p.allDay,onCheckedChange:o=>y({...p,allDay:!!o})}),r.jsx(O,{htmlFor:"allDay",className:"font-terminal text-sm",children:"All day"})]}),!p.allDay&&r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"font-arcade text-sm",children:"START TIME"}),r.jsx(K,{type:"time",className:"rounded-none bg-black border-secondary",value:p.startTime,onChange:o=>y({...p,startTime:o.target.value}),"data-testid":"input-modal-start"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"font-arcade text-sm",children:"END TIME"}),r.jsx(K,{type:"time",className:"rounded-none bg-black border-secondary",value:p.endTime,onChange:o=>y({...p,endTime:o.target.value}),"data-testid":"input-modal-end"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"font-arcade text-sm",children:"TYPE"}),r.jsxs(se,{value:p.eventType,onValueChange:o=>y({...p,eventType:o}),children:[r.jsx(ae,{className:"rounded-none bg-black border-secondary","data-testid":"select-event-type",children:r.jsx(oe,{})}),r.jsxs(ie,{className:"rounded-none bg-black border-primary z-[100010]",children:[r.jsx(I,{value:"study",children:"STUDY"}),r.jsx(I,{value:"lecture",children:"LECTURE"}),r.jsx(I,{value:"exam",children:"EXAM"}),r.jsx(I,{value:"synchronous",children:"SYNCHRONOUS"}),r.jsx(I,{value:"online",children:"ONLINE"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"font-arcade text-sm",children:"COLOR"}),r.jsx("div",{className:"flex gap-2 flex-wrap",children:["#ef4444","#f97316","#eab308","#22c55e","#3b82f6","#8b5cf6","#ec4899","#6b7280"].map(o=>r.jsx("button",{type:"button",className:$("w-6 h-6 rounded-sm border-2",p.color===o?"border-white":"border-transparent"),style:{backgroundColor:o},onClick:()=>y({...p,color:o}),"data-testid":`color-${o}`},o))})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"font-arcade text-sm",children:"REPEAT"}),r.jsxs(se,{value:p.recurrence,onValueChange:o=>y({...p,recurrence:o}),children:[r.jsx(ae,{className:"rounded-none bg-black border-secondary","data-testid":"select-recurrence",children:r.jsx(oe,{placeholder:"No repeat"})}),r.jsxs(ie,{className:"rounded-none bg-black border-primary z-[100010]",children:[r.jsx(I,{value:"none",children:"NO REPEAT"}),r.jsx(I,{value:"daily",children:"DAILY"}),r.jsx(I,{value:"weekly",children:"WEEKLY"}),r.jsx(I,{value:"monthly",children:"MONTHLY"}),r.jsx(I,{value:"yearly",children:"YEARLY"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(O,{className:"font-arcade text-sm",children:"CALENDAR"}),r.jsxs(se,{value:p.calendarId,onValueChange:o=>y({...p,calendarId:o}),children:[r.jsx(ae,{className:"rounded-none bg-black border-secondary","data-testid":"select-calendar",children:r.jsx(oe,{placeholder:"Local"})}),r.jsxs(ie,{className:"rounded-none bg-black border-primary z-[100010]",children:[r.jsx(I,{value:"local",children:"LOCAL"}),ne.map(o=>r.jsx(I,{value:o.id,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:o.color}}),o.name]})},o.id))]})]})]})]})]}),r.jsxs(An,{children:[r.jsx(Y,{variant:"ghost",className:"rounded-none font-arcade text-xs",onClick:()=>c(!1),children:"CANCEL"}),r.jsx(Y,{className:"rounded-none font-arcade text-xs bg-primary text-black hover:bg-primary/90",onClick:Ce,disabled:!p.title||!p.date,"data-testid":"button-save-event",children:"SAVE"})]})]})}),f&&r.jsx(Mi,{open:u,onOpenChange:o=>{g(o),o||b(null)},event:f,onEventChange:b,courseOptions:yt,onSave:()=>{f&&hn.mutate({id:f.id,data:{title:f.title,date:f.date,endDate:f.endDate,allDay:f.allDay,eventType:f.eventType,courseId:f.courseId??null,course:f.course,weight:f.weight,notes:f.notes,color:f.color,recurrence:f.recurrence,location:f.location,attendees:f.attendees,visibility:f.visibility,transparency:f.transparency,reminders:f.reminders,timeZone:f.timeZone}})},onDelete:()=>{f&&X.mutate(f.id)}}),R&&r.jsx(ki,{open:x,onOpenChange:o=>{h(o),o||L(null)},event:R,onEventChange:L,courseOptions:yt,onSave:ue,onDelete:xe}),r.jsx(Ti,{isOpen:D,onClose:()=>z(!1)})]})}export{Qi as default};

import{c as Ae,r as l,j as e,b as O,R as Es,d as Ps,e as k,f as Os,P as Ve,g as Rs,u as Je,X as ie}from"./index-CuHcQHP3.js";import{h as Fs,i as Ms,j as Ls,u as M,a as B,g,L as _s,k as qs,C as de,B as b,f as zs,S as ye,l as ve,T as J,P as me,D as Fe,c as Me,d as Le,e as _e,m as qe,I as ze,n as U,o as Be}from"./layout-aFUpFhYH.js";import{C as ae,c as ne,a as xe,b as ue}from"./card-BNOFlXMO.js";import{e as Bs,B as he,S as $e,a as Ke,b as Ge,c as He,d as P}from"./select-B2B7mi8s.js";import{c as Qe,R as $s,T as Ks,C as Gs,a as Se}from"./index-Dn8vpXLD.js";import{T as Hs,A as Us,a as Ws,b as Vs,c as Js,d as Qs,e as Ys,f as Xs,g as Zs}from"./alert-dialog-BDELDAEL.js";import{F as et,a as Ue}from"./folder-Cvs5jnDc.js";import{F as st}from"./file-text-CFn8vxvC.js";import{R as We}from"./refresh-cw-CtVThOHs.js";import{i as tt,f as at}from"./format-D7m0hUtg.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],rt=Ae("database",nt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],lt=Ae("file",ot);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],it=Ae("layers",ct),Ye=l.forwardRef(({className:a,...n},t)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:t,className:O("w-full caption-bottom text-sm",a),...n})}));Ye.displayName="Table";const Xe=l.forwardRef(({className:a,...n},t)=>e.jsx("thead",{ref:t,className:O("[&_tr]:border-b",a),...n}));Xe.displayName="TableHeader";const Ze=l.forwardRef(({className:a,...n},t)=>e.jsx("tbody",{ref:t,className:O("[&_tr:last-child]:border-0",a),...n}));Ze.displayName="TableBody";const dt=l.forwardRef(({className:a,...n},t)=>e.jsx("tfoot",{ref:t,className:O("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...n}));dt.displayName="TableFooter";const Ce=l.forwardRef(({className:a,...n},t)=>e.jsx("tr",{ref:t,className:O("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...n}));Ce.displayName="TableRow";const q=l.forwardRef(({className:a,...n},t)=>e.jsx("th",{ref:t,className:O("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...n}));q.displayName="TableHead";const z=l.forwardRef(({className:a,...n},t)=>e.jsx("td",{ref:t,className:O("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...n}));z.displayName="TableCell";const mt=l.forwardRef(({className:a,...n},t)=>e.jsx("caption",{ref:t,className:O("mt-4 text-sm text-muted-foreground",a),...n}));mt.displayName="TableCaption";function xt(a,n,{checkForDefaultPrevented:t=!0}={}){return function(d){if(a?.(d),t===!1||!d.defaultPrevented)return n?.(d)}}var ut=Es[" useInsertionEffect ".trim().toString()]||Ps;function es({prop:a,defaultProp:n,onChange:t=()=>{},caller:c}){const[d,i,u]=ht({defaultProp:n,onChange:t}),x=a!==void 0,y=x?a:d;{const m=l.useRef(a!==void 0);l.useEffect(()=>{const f=m.current;f!==x&&console.warn(`${c} is changing from ${f?"controlled":"uncontrolled"} to ${x?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),m.current=x},[x,c])}const S=l.useCallback(m=>{if(x){const f=pt(m)?m(a):m;f!==a&&u.current?.(f)}else i(m)},[x,a,i,u]);return[y,S]}function ht({defaultProp:a,onChange:n}){const[t,c]=l.useState(a),d=l.useRef(t),i=l.useRef(n);return ut(()=>{i.current=n},[n]),l.useEffect(()=>{d.current!==t&&(i.current?.(t),d.current=t)},[t,d]),[t,c,i]}function pt(a){return typeof a=="function"}var R="Accordion",ft=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[De,gt,bt]=Bs(R),[fe]=Os(R,[bt,Qe]),Ie=Qe(),ss=k.forwardRef((a,n)=>{const{type:t,...c}=a,d=c,i=c;return e.jsx(De.Provider,{scope:a.__scopeAccordion,children:t==="multiple"?e.jsx(vt,{...i,ref:n}):e.jsx(yt,{...d,ref:n})})});ss.displayName=R;var[ts,jt]=fe(R),[as,Nt]=fe(R,{collapsible:!1}),yt=k.forwardRef((a,n)=>{const{value:t,defaultValue:c,onValueChange:d=()=>{},collapsible:i=!1,...u}=a,[x,y]=es({prop:t,defaultProp:c??"",onChange:d,caller:R});return e.jsx(ts,{scope:a.__scopeAccordion,value:k.useMemo(()=>x?[x]:[],[x]),onItemOpen:y,onItemClose:k.useCallback(()=>i&&y(""),[i,y]),children:e.jsx(as,{scope:a.__scopeAccordion,collapsible:i,children:e.jsx(ns,{...u,ref:n})})})}),vt=k.forwardRef((a,n)=>{const{value:t,defaultValue:c,onValueChange:d=()=>{},...i}=a,[u,x]=es({prop:t,defaultProp:c??[],onChange:d,caller:R}),y=k.useCallback(m=>x((f=[])=>[...f,m]),[x]),S=k.useCallback(m=>x((f=[])=>f.filter(D=>D!==m)),[x]);return e.jsx(ts,{scope:a.__scopeAccordion,value:u,onItemOpen:y,onItemClose:S,children:e.jsx(as,{scope:a.__scopeAccordion,collapsible:!0,children:e.jsx(ns,{...i,ref:n})})})}),[St,ge]=fe(R),ns=k.forwardRef((a,n)=>{const{__scopeAccordion:t,disabled:c,dir:d,orientation:i="vertical",...u}=a,x=k.useRef(null),y=Rs(x,n),S=gt(t),f=Ms(d)==="ltr",D=xt(a.onKeyDown,C=>{if(!ft.includes(C.key))return;const w=C.target,F=S().filter(j=>!j.ref.current?.disabled),p=F.findIndex(j=>j.ref.current===w),v=F.length;if(p===-1)return;C.preventDefault();let h=p;const L=0,A=v-1,I=()=>{h=p+1,h>A&&(h=L)},$=()=>{h=p-1,h<L&&(h=A)};switch(C.key){case"Home":h=L;break;case"End":h=A;break;case"ArrowRight":i==="horizontal"&&(f?I():$());break;case"ArrowDown":i==="vertical"&&I();break;case"ArrowLeft":i==="horizontal"&&(f?$():I());break;case"ArrowUp":i==="vertical"&&$();break}const r=h%v;F[r].ref.current?.focus()});return e.jsx(St,{scope:t,disabled:c,direction:d,orientation:i,children:e.jsx(De.Slot,{scope:t,children:e.jsx(Ve.div,{...u,"data-orientation":i,ref:y,onKeyDown:c?void 0:D})})})}),pe="AccordionItem",[Ct,Te]=fe(pe),rs=k.forwardRef((a,n)=>{const{__scopeAccordion:t,value:c,...d}=a,i=ge(pe,t),u=jt(pe,t),x=Ie(t),y=Fs(),S=c&&u.value.includes(c)||!1,m=i.disabled||a.disabled;return e.jsx(Ct,{scope:t,open:S,disabled:m,triggerId:y,children:e.jsx($s,{"data-orientation":i.orientation,"data-state":ms(S),...x,...d,ref:n,disabled:m,open:S,onOpenChange:f=>{f?u.onItemOpen(c):u.onItemClose(c)}})})});rs.displayName=pe;var os="AccordionHeader",ls=k.forwardRef((a,n)=>{const{__scopeAccordion:t,...c}=a,d=ge(R,t),i=Te(os,t);return e.jsx(Ve.h3,{"data-orientation":d.orientation,"data-state":ms(i.open),"data-disabled":i.disabled?"":void 0,...c,ref:n})});ls.displayName=os;var we="AccordionTrigger",cs=k.forwardRef((a,n)=>{const{__scopeAccordion:t,...c}=a,d=ge(R,t),i=Te(we,t),u=Nt(we,t),x=Ie(t);return e.jsx(De.ItemSlot,{scope:t,children:e.jsx(Ks,{"aria-disabled":i.open&&!u.collapsible||void 0,"data-orientation":d.orientation,id:i.triggerId,...x,...c,ref:n})})});cs.displayName=we;var is="AccordionContent",ds=k.forwardRef((a,n)=>{const{__scopeAccordion:t,...c}=a,d=ge(R,t),i=Te(is,t),u=Ie(t);return e.jsx(Gs,{role:"region","aria-labelledby":i.triggerId,"data-orientation":d.orientation,...u,...c,ref:n,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...a.style}})});ds.displayName=is;function ms(a){return a?"open":"closed"}var wt=ss,kt=rs,At=ls,xs=cs,us=ds;const ke=wt,Q=l.forwardRef(({className:a,...n},t)=>e.jsx(kt,{ref:t,className:O("border-b",a),...n}));Q.displayName="AccordionItem";const Y=l.forwardRef(({className:a,children:n,...t},c)=>e.jsx(At,{className:"flex",children:e.jsxs(xs,{ref:c,className:O("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",a),...t,children:[n,e.jsx(Ls,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})}));Y.displayName=xs.displayName;const X=l.forwardRef(({className:a,children:n,...t},c)=>e.jsx(us,{ref:c,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...t,children:e.jsx("div",{className:O("pb-4 pt-0",a),children:n})}));X.displayName=us.displayName;const Dt=`I need you to extract learning objectives from my course material.

Return ONLY a valid JSON array with NO additional text, NO markdown code blocks, NO explanation.

Structure for each item:
{
  "loCode": "string",
  "title": "string"
}

Rules:
1. loCode: Preserve original numbering if present, or create sequential "1", "2", "3"...
2. title: Keep the objective text exactly as written
3. Return ONLY the JSON array, nothing else

Here are my learning objectives:

[PASTE YOUR LOs BELOW]`,It=`I need you to convert my study session notes into WRAP format.

WRAP format has 4 sections:

Section A: Obsidian Notes
- Main concepts and insights from the session
- Key points to remember

Section B: Anki Cards
- Format: "front: [question]" on one line, "back: [answer]" on next line
- Create cards for important facts and concepts

Section C: Spaced Schedule
- R1=tomorrow
- R2=3d
- R3=1w
- R4=2w

Section D: JSON Logs
\`\`\`json
{
  "merged": {
    "topic": "[main topic]",
    "mode": "Core",
    "duration_minutes": [number],
    "understanding": [1-5],
    "retention": [1-5]
  }
}
\`\`\`

Return ONLY the WRAP formatted content, NO additional text or explanation.

Here are my study notes:

[PASTE YOUR NOTES BELOW]`;function Tt(){const a=Je(),[n,t]=l.useState(null),[c,d]=l.useState(null),[i,u]=l.useState(""),[x,y]=l.useState(""),[S,m]=l.useState(null),[f,D]=l.useState(""),[C,w]=l.useState(null),{data:F=[]}=M({queryKey:["courses"],queryFn:()=>g.courses.getActive()}),{data:p=[]}=M({queryKey:["modules",n],queryFn:()=>n?g.modules.getByCourse(n):Promise.resolve([]),enabled:!!n}),{data:v=[]}=M({queryKey:["learningObjectives",n],queryFn:()=>n?g.learningObjectives.getByCourse(n):Promise.resolve([]),enabled:!!n}),h=B({mutationFn:async r=>{if(!n)throw new Error("Select a course first");const j=JSON.parse(r);return g.scheduleEvents.createBulk(n,j)},onSuccess:()=>{a.invalidateQueries({queryKey:["scheduleEvents"]}),u(""),m(null)},onError:r=>{m(r.message||"Failed to import schedule")}}),L=B({mutationFn:async r=>{if(!n)throw new Error("Select a course first");const j=JSON.parse(r);return g.learningObjectives.createBulk(n,c,j)},onSuccess:()=>{a.invalidateQueries({queryKey:["learningObjectives"]}),y(""),m(null)},onError:r=>{m(r.message||"Failed to import LOs")}}),A=B({mutationFn:({id:r,data:j})=>g.modules.update(r,j),onSuccess:()=>{a.invalidateQueries({queryKey:["modules"]})}}),I=r=>{navigator.clipboard.writeText(r)},$=async()=>{try{w(null);const r=f,K=await g.brain.ingest(r,"pasted_wrap.md");K.sessionSaved?(w({type:"success",message:`âœ“ Session saved! ID: ${K.sessionId}, Cards: ${K.cardsCreated||0}`}),D("")):w({type:"error",message:K.errors?.join(", ")||K.message})}catch(r){w({type:"error",message:r.message||"Failed to ingest"})}};return e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"border-2 border-primary rounded-none p-4 bg-primary/5",children:[e.jsx("h2",{className:"text-xl font-arcade text-primary mb-4",children:"WRAP SESSION INGESTION"}),C&&e.jsx("div",{className:`mb-4 p-3 rounded-none font-terminal text-sm ${C.type==="success"?"bg-green-900/30 border border-green-500 text-green-400":"bg-red-900/30 border border-red-500 text-red-400"}`,children:C.message}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:()=>I(It),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Use ChatGPT to convert your notes to WRAP format, then paste or upload below:"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-2 font-terminal text-muted-foreground",children:"Paste WRAP Content"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-48 font-terminal text-sm",placeholder:"Paste your WRAP session here...",value:f,onChange:r=>{D(r.target.value),w(null)}})]}),e.jsx("button",{onClick:$,disabled:!f,className:"bg-primary hover:bg-primary/80 disabled:opacity-50 px-6 py-3 rounded-none font-arcade text-sm w-full",type:"button",children:"INGEST WRAP SESSION"})]})]}),e.jsx("h2",{className:"text-xl font-arcade text-primary",children:"MATERIAL INGESTION"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),e.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:n||"",onChange:r=>{t(r.target.value?parseInt(r.target.value):null),d(null)},children:[e.jsx("option",{value:"",children:"-- Select Course --"}),F.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),S&&e.jsx("div",{className:"bg-destructive/20 border border-destructive rounded-none p-3 text-destructive font-terminal",children:S}),n&&e.jsxs(ke,{type:"multiple",className:"border border-secondary/40 rounded-none divide-y divide-secondary/40",children:[e.jsxs(Q,{value:"schedule",className:"border-secondary/40",children:[e.jsx(Y,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"SCHEDULE IMPORT"}),e.jsxs(X,{className:"px-3",children:[e.jsx("button",{onClick:()=>I(SCHEDULE_PROMPT),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Paste the ChatGPT response (JSON array) below:"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-32 font-terminal text-sm",placeholder:'[{"type": "exam", "title": "...", "dueDate": "2026-01-20", "notes": null}]',value:i,onChange:r=>u(r.target.value)}),e.jsx("button",{onClick:()=>h.mutate(i),disabled:!i||h.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none mt-2 font-terminal text-xs",type:"button",children:h.isPending?"Importing...":"Import Schedule"})]})]}),e.jsxs(Q,{value:"modules",className:"border-secondary/40",children:[e.jsx(Y,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"MODULES"}),e.jsx(X,{className:"px-3",children:p.length===0?e.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"No modules yet. Add modules manually or import."}):e.jsxs("table",{className:"w-full text-sm font-terminal",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-secondary/50",children:[e.jsx("th",{className:"text-left p-2",children:"Module"}),e.jsx("th",{className:"text-center p-2",children:"Files"}),e.jsx("th",{className:"text-center p-2",children:"NotebookLM"}),e.jsx("th",{className:"text-center p-2",children:"Status"})]})}),e.jsx("tbody",{children:p.map(r=>e.jsxs("tr",{className:"border-b border-secondary/30",children:[e.jsx("td",{className:"p-2",children:r.name}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"checkbox",checked:r.filesDownloaded,onChange:j=>A.mutate({id:r.id,data:{filesDownloaded:j.target.checked}})})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"checkbox",checked:r.notebooklmLoaded,onChange:j=>A.mutate({id:r.id,data:{notebooklmLoaded:j.target.checked}})})}),e.jsx("td",{className:"text-center p-2",children:r.filesDownloaded&&r.notebooklmLoaded?e.jsx("span",{className:"text-green-400",children:"Ready"}):e.jsx("span",{className:"text-yellow-400",children:"Pending"})})]},r.id))})]})})]}),e.jsxs(Q,{value:"learning-objectives",className:"border-secondary/40",children:[e.jsx(Y,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"LEARNING OBJECTIVES IMPORT"}),e.jsxs(X,{className:"px-3",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-xs mb-1 font-terminal text-muted-foreground",children:"Target Module (optional)"}),e.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:c||"",onChange:r=>d(r.target.value?parseInt(r.target.value):null),children:[e.jsx("option",{value:"",children:"-- No Module (Course-level) --"}),p.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),e.jsx("button",{onClick:()=>I(Dt),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Paste the ChatGPT response (JSON array) below:"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-32 font-terminal text-sm",placeholder:'[{"loCode": "1.1", "title": "Define..."}]',value:x,onChange:r=>y(r.target.value)}),e.jsx("button",{onClick:()=>L.mutate(x),disabled:!x||L.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none mt-2 font-terminal text-xs",type:"button",children:L.isPending?"Importing...":"Import LOs"}),v.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"font-terminal text-xs mb-2",children:["Current LOs (",v.length,")"]}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:v.map(r=>e.jsxs("div",{className:"text-xs py-1 border-b border-secondary/30 font-terminal",children:[e.jsx("span",{className:"text-primary",children:r.loCode}),": ",r.title,e.jsx("span",{className:`ml-2 text-[10px] px-1 rounded ${r.status==="solid"?"bg-green-600":r.status==="in_progress"?"bg-yellow-600":r.status==="need_review"?"bg-orange-600":"bg-gray-600"}`,children:r.status})]},r.id))})]})]})]})]})]})}const Et=(a,n="MM/dd")=>{if(!a)return"-";try{const t=a instanceof Date?a:new Date(a);return tt(t)?at(t,n):"-"}catch{return"-"}},re=a=>{if(Array.isArray(a))return a.filter(n=>typeof n=="string");if(typeof a=="string"){const n=a.trim();if(!n)return[];try{const t=JSON.parse(n);if(Array.isArray(t))return t.filter(c=>typeof c=="string")}catch{}return n.split(",").map(t=>t.trim()).filter(Boolean)}return[]};function Kt(){const[a,n]=l.useState(new Set),[t,c]=l.useState(null),[d,i]=l.useState(!1),[u,x]=l.useState([]),[y,S]=l.useState(!1),[m,f]=l.useState(new Set),[D,C]=l.useState(null),[w,F]=l.useState({front:"",back:"",deckName:""}),[p,v]=l.useState({mode:"",minutes:"",cards:"",confusions:"",weakAnchors:"",concepts:"",issues:"",notes:""}),[h,L]=l.useState("School"),[A,I]=l.useState(null),[$,r]=l.useState(""),[j,K]=l.useState(!1),[Ee,oe]=l.useState(!1),hs=[{name:"EBP",path:"School/Evidence Based Practice"},{name:"ExPhys",path:"School/Exercise Physiology"},{name:"MS1",path:"School/Movement Science 1"},{name:"Neuro",path:"School/Neuroscience"},{name:"TI",path:"School/Theraputic Intervention"}],{data:T=[],isLoading:Z}=M({queryKey:["sessions"],queryFn:g.sessions.getAll}),{data:le}=M({queryKey:["brain","metrics"],queryFn:g.brain.getMetrics}),ee=Je(),be=B({mutationFn:s=>g.sessions.deleteMany(s),onSuccess:()=>{ee.invalidateQueries({queryKey:["sessions"]}),ee.invalidateQueries({queryKey:["brain","metrics"]}),n(new Set)}}),ps=B({mutationFn:({id:s,updates:o})=>g.sessions.update(s,o),onSuccess:()=>{ee.invalidateQueries({queryKey:["sessions"]}),ee.invalidateQueries({queryKey:["brain","metrics"]}),c(null)}}),fs=s=>{n(o=>{const N=new Set(o);return N.has(s)?N.delete(s):N.add(s),N})},gs=()=>{a.size===T.length?n(new Set):n(new Set(T.map(s=>s.id)))},bs=()=>{a.size!==0&&(x(Array.from(a)),i(!0))},js=s=>{x([s]),i(!0)},Ns=()=>{be.mutate(u),i(!1),x([])};l.useEffect(()=>{if(t!==null){const s=T.find(o=>o.id===t);s&&v({mode:s.mode||"",minutes:s.minutes?.toString()||"",cards:s.cards?.toString()||"",confusions:re(s.confusions).join(", "),weakAnchors:re(s.weakAnchors).join(", "),concepts:re(s.concepts).join(", "),issues:re(s.issues).join(", "),notes:s.notes||""})}},[t,T]);const W=t!==null?T.find(s=>s.id===t):null,se=typeof window<"u"&&new URLSearchParams(window.location.search).has("debugModals");l.useEffect(()=>{t!==null&&!Z&&!W&&(se&&console.warn("[ModalDebug][Brain] Missing session for edit; closing.",{editingSession:t,sessionsCount:T.length}),c(null))},[se,t,W,T.length,Z]),l.useEffect(()=>{se&&console.info("[ModalDebug][Brain] state",{editingSession:t,hasEditingSessionData:!!W,deleteDialogOpen:d,sessionsToDelete:u.length,sessionsLoading:Z})},[se,d,t,W,Z,u.length]);const ys=()=>{if(t===null)return;const s=E=>E?E.split(",").map(V=>V.trim()).filter(Boolean):[],o=E=>E.length?JSON.stringify(E):null,N={mode:p.mode||"study",minutes:parseInt(p.minutes)||0,cards:parseInt(p.cards)||0,confusions:o(s(p.confusions)),weakAnchors:o(s(p.weakAnchors)),concepts:o(s(p.concepts)),issues:o(s(p.issues)),notes:p.notes||null};ps.mutate({id:t,updates:N})},{data:G}=M({queryKey:["obsidian","status"],queryFn:g.obsidian.getStatus,refetchInterval:3e4}),{data:vs,refetch:Pt}=M({queryKey:["obsidian","files",h],queryFn:()=>g.obsidian.getFiles(h),enabled:G?.connected===!0}),Ss=async s=>{try{const o=await g.obsidian.getFile(s);o.success&&o.content!==void 0&&(I(s),r(o.content),oe(!1))}catch(o){console.error("Failed to load file:",o)}},Cs=async()=>{if(A){K(!0);try{(await g.obsidian.saveFile(A,$)).success&&oe(!1)}catch(s){console.error("Failed to save file:",s)}finally{K(!1)}}},te=s=>{L(s),I(null),r("")},ws=()=>{const s=new Date().toISOString().split("T")[0],o=h?`${h}/Session-${s}.md`:`Session-${s}.md`,N=`# Study Session - ${s}

## Summary


## Concepts Covered
- 

## Strengths
- 

## Areas to Review
- 

## Notes

`;I(o),r(N),oe(!0)},{data:_,isLoading:ks,refetch:Pe}=M({queryKey:["anki","status"],queryFn:g.anki.getStatus,refetchInterval:3e4}),{data:As}=M({queryKey:["anki","due"],queryFn:g.anki.getDue,enabled:_?.connected===!0}),{data:Ds=[],refetch:ce}=M({queryKey:["anki","drafts"],queryFn:g.anki.getDrafts}),H=Ds.filter(s=>s.status==="pending"),je=B({mutationFn:g.anki.sync,onSuccess:()=>{ee.invalidateQueries({queryKey:["anki"]}),ce()}}),Oe=B({mutationFn:s=>g.anki.approveDraft(s),onSuccess:()=>{ce()}}),Re=B({mutationFn:s=>g.anki.deleteDraft(s),onSuccess:()=>{ce()}}),Ne=B({mutationFn:({id:s,data:o})=>g.anki.updateDraft(s,o),onSuccess:()=>{ce(),C(null)}}),Is=s=>{C(s.id),F({front:s.front,back:s.back,deckName:s.deckName})},Ts=()=>{D!==null&&Ne.mutate({id:D,data:w})};return e.jsxs(_s,{children:[se&&e.jsxs("div",{className:"fixed bottom-12 right-4 z-[70] bg-black/80 border border-primary text-primary font-terminal text-[10px] px-2 py-1 rounded-none",children:[e.jsx("div",{children:"Brain modals"}),e.jsxs("div",{children:["Edit session: ",t??"none"]}),e.jsxs("div",{children:["Edit data: ",W?"yes":"no"]}),e.jsxs("div",{children:["Delete open: ",d?"yes":"no"]}),e.jsxs("div",{children:["Delete count: ",u.length]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h1",{className:"font-arcade text-xl text-primary flex items-center gap-2",children:[e.jsx(qs,{className:"w-6 h-6"}),"BRAIN ANALYTICS"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"SYSTEM STATUS"}),e.jsx(ae,{className:"brain-card rounded-none",children:e.jsx(ne,{className:"p-3",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3 font-terminal text-xs",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${G?.connected?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-muted-foreground",children:"Obsidian"}),e.jsx("span",{className:"text-primary",children:G?.connected?"Online":"Offline"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${_?.connected?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-muted-foreground",children:"Anki"}),e.jsx("span",{className:"text-primary",children:_?.connected?"Connected":"Offline"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-muted-foreground",children:[e.jsxs("span",{children:["Cards: ",e.jsx("span",{className:"text-primary",children:le?.totalCards||0})]}),e.jsxs("span",{children:["Drafts: ",e.jsx("span",{className:"text-primary",children:H.length})]})]})]})})})]}),e.jsx(ke,{type:"single",collapsible:!0,className:"border border-secondary/40 rounded-none",children:e.jsxs(Q,{value:"ingestion",className:"border-secondary/40",children:[e.jsx(Y,{className:"font-arcade text-sm text-primary px-4 hover:no-underline",children:"DATA INGESTION TOOLS"}),e.jsx(X,{className:"px-2",children:e.jsx("div",{className:"pt-2",children:e.jsx(Tt,{})})})]})}),e.jsx(ke,{type:"single",collapsible:!0,className:"border border-secondary/40 rounded-none",children:e.jsxs(Q,{value:"integrations",className:"border-secondary/40",children:[e.jsx(Y,{className:"font-arcade text-sm text-primary px-4 hover:no-underline",children:"INTEGRATIONS"}),e.jsx(X,{className:"px-2",children:e.jsxs("div",{className:"space-y-4 pt-2 min-w-0",children:[e.jsxs(ae,{className:"brain-card rounded-none",children:[e.jsxs(xe,{className:"border-b border-secondary/50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ue,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(et,{className:"w-4 h-4"}),"OBSIDIAN VAULT",G?.connected?e.jsx(de,{className:"w-3 h-3 text-green-500"}):e.jsx(ie,{className:"w-3 h-3 text-red-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(b,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:ws,disabled:!G?.connected,children:[e.jsx(st,{className:"w-3 h-3 mr-1"}),"New Note"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y,onChange:s=>S(s.target.checked),disabled:!G?.connected,className:"w-4 h-4 accent-primary"}),e.jsx("span",{className:"font-terminal text-xs",children:"Auto-Sync"})]})]})]}),e.jsx("div",{className:"flex items-center gap-1 mt-2 flex-wrap",children:hs.map(s=>e.jsx(b,{size:"sm",variant:h===s.path?"default":"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:()=>te(s.path),children:s.name},s.path))}),h&&e.jsxs("div",{className:"flex items-center gap-1 mt-2 font-terminal text-xs text-muted-foreground",children:[e.jsx("button",{onClick:()=>te(""),className:"hover:text-primary",children:"vault"}),h.split("/").map((s,o,N)=>e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(zs,{className:"w-3 h-3"}),e.jsx("button",{onClick:()=>te(N.slice(0,o+1).join("/")),className:"hover:text-primary",children:s})]},o))]})]}),e.jsx(ne,{className:"p-0",children:G?.connected?e.jsxs("div",{className:"grid md:grid-cols-2 h-[240px] md:h-[300px]",children:[e.jsx("div",{className:"border-r border-secondary/30",children:e.jsx(ye,{className:"h-[240px] md:h-[300px]",children:e.jsxs("div",{className:"p-2 space-y-1",children:[h&&e.jsxs("button",{onClick:()=>{const s=h.split("/");s.pop(),te(s.join("/"))},className:"w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs text-muted-foreground",children:[e.jsx(Ue,{className:"w-3 h-3"}),".."]}),vs?.files?.map(s=>{const o=typeof s=="string"?s:s.path,N=o.endsWith("/"),E=o.replace(/\/$/,"").split("/").pop()||o;return e.jsxs("button",{onClick:()=>{if(N){const V=E.replace(/\/$/,"");te(h?`${h}/${V}`:V)}else{const V=h?`${h}/${E}`:E;Ss(V)}},className:`w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs ${A?.endsWith(E)?"bg-primary/20 text-primary":""}`,children:[N?e.jsx(Ue,{className:"w-3 h-3 text-yellow-500"}):e.jsx(lt,{className:"w-3 h-3 text-blue-400"}),E]},o)})]})})}),e.jsx("div",{className:"flex flex-col h-[240px] md:h-[300px]",children:A?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-secondary/30",children:[e.jsxs("span",{className:"font-terminal text-xs text-primary truncate",children:[A.split("/").pop(),Ee&&e.jsx("span",{className:"text-yellow-500 ml-1",children:"*"})]}),e.jsxs(b,{size:"sm",variant:"ghost",onClick:Cs,disabled:!Ee||j,className:"h-6 px-2",children:[e.jsx(ve,{className:"w-3 h-3 mr-1"}),j?"Saving...":"Save"]})]}),e.jsx("textarea",{value:$,onChange:s=>{r(s.target.value),oe(!0)},className:"flex-1 w-full p-3 bg-black/60 font-terminal text-sm resize-none focus:outline-none focus:ring-1 focus:ring-primary",placeholder:"File content..."})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center font-terminal text-xs text-muted-foreground",children:"Select a file to edit"})})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("p",{className:"font-terminal text-xs text-red-400 mb-2",children:"Obsidian Offline"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Obsidian with Local REST API plugin enabled"})]})})]}),e.jsxs(ae,{className:"brain-card rounded-none",children:[e.jsx(xe,{className:"border-b border-secondary/50 p-3",children:e.jsxs(ue,{className:"font-arcade text-xs flex items-center gap-2 text-muted-foreground",children:[e.jsx(it,{className:"w-3 h-3"}),"ANKI INTEGRATION",_?.connected?e.jsx(de,{className:"w-3 h-3 text-green-500 ml-auto"}):e.jsx(ie,{className:"w-3 h-3 text-red-500 ml-auto"})]})}),e.jsx(ne,{className:"p-4 space-y-3",children:ks?e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Checking Anki..."}):_?.connected?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Status:"}),e.jsx(he,{variant:"outline",className:"bg-green-500/20 text-green-400 border-green-500",children:"Connected"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Cards Created:"}),e.jsx("span",{className:"font-arcade text-xs text-primary",children:le?.totalCards||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Due Today:"}),e.jsx("span",{className:"font-arcade text-xs text-secondary",children:As?.dueCount||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Reviewed Today:"}),e.jsx("span",{className:"font-arcade text-xs text-muted-foreground",children:_.reviewedToday||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Decks:"}),e.jsx("span",{className:"font-arcade text-xs text-muted-foreground",children:_.decks?.length||0})]}),e.jsxs("div",{className:"pt-2 flex gap-2",children:[e.jsxs(b,{size:"sm",variant:"outline",className:"flex-1 font-terminal text-xs",onClick:()=>Pe(),children:[e.jsx(We,{className:"w-3 h-3 mr-1"}),"Refresh"]}),e.jsx(b,{size:"sm",className:"flex-1 font-terminal text-xs bg-secondary hover:bg-secondary/80",onClick:()=>je.mutate(),disabled:je.isPending,children:je.isPending?"Syncing...":"Sync Cards"})]}),H.length>0&&e.jsxs("div",{className:"pt-3 border-t border-secondary/30",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-arcade text-[10px] text-yellow-400",children:["PENDING CARDS (",H.length,")"]}),e.jsx("div",{className:"flex gap-1",children:e.jsx(b,{size:"sm",variant:"outline",className:"h-5 px-2 text-[10px] font-terminal",onClick:()=>{m.size===H.length?f(new Set):f(new Set(H.map(s=>s.id)))},children:m.size===H.length?"None":"All"})})]}),m.size>0&&e.jsxs("div",{className:"flex gap-1 mb-2",children:[e.jsxs(b,{size:"sm",className:"h-6 px-2 text-[10px] font-terminal bg-green-600 hover:bg-green-700",onClick:()=>{m.forEach(s=>Oe.mutate(s)),f(new Set)},children:[e.jsx(de,{className:"w-3 h-3 mr-1"}),"Approve (",m.size,")"]}),e.jsxs(b,{size:"sm",variant:"destructive",className:"h-6 px-2 text-[10px] font-terminal",onClick:()=>{m.forEach(s=>Re.mutate(s)),f(new Set)},children:[e.jsx(J,{className:"w-3 h-3 mr-1"}),"Delete (",m.size,")"]})]}),e.jsx(ye,{className:"h-[200px]",children:e.jsx("div",{className:"space-y-2",children:H.map(s=>e.jsx("div",{className:`p-2 bg-black/40 border text-xs ${m.has(s.id)?"border-primary":"border-secondary/30"}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Se,{checked:m.has(s.id),onCheckedChange:o=>{const N=new Set(m);o?N.add(s.id):N.delete(s.id),f(N)},className:"mt-1 border-secondary data-[state=checked]:bg-primary"}),e.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[e.jsx("div",{className:"font-terminal text-primary truncate",children:s.front}),e.jsx("div",{className:"font-terminal text-muted-foreground mt-1 truncate",children:s.back}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(he,{variant:"outline",className:"text-[9px] border-blue-500/50 text-blue-400 shrink-0",children:s.deckName}),e.jsx(b,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-yellow-500/50 text-yellow-400 hover:bg-yellow-500/20",onClick:()=>Is(s),title:"Edit card",children:e.jsx(me,{className:"w-3 h-3"})}),e.jsx(b,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-green-500/50 text-green-400 hover:bg-green-500/20",onClick:()=>Oe.mutate(s.id),title:"Approve card",children:e.jsx(de,{className:"w-3 h-3"})}),e.jsx(b,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-red-500/50 text-red-400 hover:bg-red-500/20",onClick:()=>Re.mutate(s.id),title:"Delete card",children:e.jsx(J,{className:"w-3 h-3"})})]})]})]})},s.id))})})]})]}):e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"font-terminal text-xs text-red-400",children:_?.error||"Anki not connected"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Anki with AnkiConnect plugin"}),e.jsxs(b,{size:"sm",variant:"outline",className:"font-terminal text-xs",onClick:()=>Pe(),children:[e.jsx(We,{className:"w-3 h-3 mr-1"}),"Retry"]})]})})]})]})})]})}),e.jsxs("div",{className:"mb-6 min-w-0",children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"SESSION EVIDENCE"}),e.jsxs(ae,{className:"brain-card rounded-none",children:[e.jsx(xe,{className:"border-b border-secondary/60 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(ue,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(rt,{className:"w-4 h-4"}),"SESSION EVIDENCE TABLE"]}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mt-1",children:"Raw WRAP data. All metrics derive from these fields."})]}),a.size>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-terminal text-xs text-muted-foreground",children:[a.size," selected"]}),e.jsxs(b,{size:"sm",variant:"destructive",className:"font-terminal text-xs rounded-none",onClick:bs,disabled:be.isPending,children:[e.jsx(J,{className:"w-3 h-3 mr-1"}),be.isPending?"Deleting...":"Delete"]})]})]})}),e.jsx(ne,{className:"p-0",children:Z?e.jsx("div",{className:"p-8 text-center font-terminal text-muted-foreground",children:"LOADING..."}):T.length===0?e.jsx("div",{className:"p-8 text-center font-terminal text-muted-foreground",children:"NO SESSIONS YET"}):e.jsx(ye,{className:"h-[360px] xl:h-[420px]",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ye,{className:"min-w-[620px]",children:[e.jsx(Xe,{children:e.jsxs(Ce,{className:"border-secondary/60 hover:bg-transparent",children:[e.jsx(q,{className:"w-10 px-2 py-2",children:e.jsx(Se,{checked:a.size===T.length&&T.length>0,onCheckedChange:gs,className:"border-primary data-[state=checked]:bg-primary"})}),e.jsx(q,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"DATE"}),e.jsx(q,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"COURSE"}),e.jsx(q,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"MODE"}),e.jsx(q,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"MIN"}),e.jsx(q,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"CARDS"}),e.jsx(q,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"CONFUSIONS"}),e.jsx(q,{className:"font-arcade text-[10px] text-primary w-10 px-2 py-2",children:"ACTIONS"})]})}),e.jsx(Ze,{children:T.map(s=>e.jsxs(Ce,{className:"border-secondary/50 hover:bg-primary/10 font-terminal text-xs","data-testid":`row-session-${s.id}`,children:[e.jsx(z,{className:"px-2 py-2",children:e.jsx(Se,{checked:a.has(s.id),onCheckedChange:()=>fs(s.id),className:"border-secondary data-[state=checked]:bg-primary"})}),e.jsx(z,{className:"text-muted-foreground px-2 py-2",children:Et(s.date)}),e.jsx(z,{className:"font-bold px-2 py-2",children:s.topic||"-"}),e.jsx(z,{className:"px-2 py-2",children:e.jsx(he,{variant:"outline",className:"rounded-none border-secondary font-normal text-[10px]",children:s.mode})}),e.jsx(z,{className:"px-2 py-2",children:s.minutes||0}),e.jsx(z,{className:"px-2 py-2",children:s.cards||0}),e.jsx(z,{className:"max-w-[150px] truncate text-[10px] text-muted-foreground px-2 py-2",children:re(s.confusions).join(", ")||"-"}),e.jsx(z,{className:"px-2 py-2",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(b,{size:"icon",variant:"ghost",className:"h-6 w-6 rounded-none hover:bg-primary/20",onClick:()=>c(s.id),title:"Edit session",children:e.jsx(me,{className:"w-3 h-3"})}),e.jsx(b,{size:"icon",variant:"ghost",className:"h-6 w-6 rounded-none hover:bg-destructive/20 text-destructive",onClick:()=>js(s.id),title:"Delete session",children:e.jsx(J,{className:"w-3 h-3"})})]})})]},s.id))})]})})})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"ISSUES LOG"}),e.jsxs(ae,{className:"brain-card rounded-none",children:[e.jsxs(xe,{className:"border-b border-secondary p-4",children:[e.jsxs(ue,{className:"font-arcade text-sm flex items-center gap-2 text-red-400",children:[e.jsx(Hs,{className:"w-4 h-4"}),"ISSUES AND FAILURES LOG"]}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mt-1",children:"Aggregated session issues: interruptions, source-lock failures, workflow problems"})]}),e.jsx(ne,{className:"p-4",children:(le?.issuesLog||[]).length===0?e.jsx("div",{className:"text-center font-terminal text-muted-foreground py-8",children:"NO ISSUES LOGGED"}):e.jsx("div",{className:"space-y-2",children:le?.issuesLog.map((s,o)=>e.jsxs("div",{className:"flex items-center justify-between p-2 border border-red-500/30 bg-red-500/5 font-terminal text-sm",children:[e.jsx("span",{className:"text-red-300",children:s.issue}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:s.course}),e.jsxs(he,{variant:"outline",className:"rounded-none border-red-500/50 text-red-400",children:["x",s.count]})]})]},o))})})]})]})]})]}),e.jsx(Fe,{open:!!W,onOpenChange:s=>{s||c(null)},children:e.jsxs(Me,{className:"bg-black border-2 border-primary rounded-none max-w-2xl",children:[e.jsxs(Le,{children:[e.jsxs(_e,{className:"font-arcade text-primary flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5"}),"EDIT SESSION #",t]}),e.jsx(qe,{className:"font-terminal text-muted-foreground",children:"Update WRAP methodology fields for this study session"})]}),e.jsxs("div",{className:"space-y-4 font-terminal",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Mode"}),e.jsxs($e,{value:p.mode,onValueChange:s=>v(o=>({...o,mode:s})),children:[e.jsx(Ke,{className:"rounded-none border-secondary",children:e.jsx(Ge,{placeholder:"Select mode"})}),e.jsxs(He,{className:"rounded-none border-secondary bg-black",children:[e.jsx(P,{value:"Core",children:"Core"}),e.jsx(P,{value:"Sprint",children:"Sprint"}),e.jsx(P,{value:"Drill",children:"Drill"}),e.jsx(P,{value:"study",children:"Study"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Minutes"}),e.jsx(ze,{type:"number",value:p.minutes,onChange:s=>v(o=>({...o,minutes:s.target.value})),className:"rounded-none border-secondary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Cards"}),e.jsx(ze,{type:"number",value:p.cards,onChange:s=>v(o=>({...o,cards:s.target.value})),className:"rounded-none border-secondary"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Confusions (comma-separated)"}),e.jsx(U,{value:p.confusions,onChange:s=>v(o=>({...o,confusions:s.target.value})),placeholder:"e.g., muscle insertion points, nerve pathways",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Weak Anchors (comma-separated)"}),e.jsx(U,{value:p.weakAnchors,onChange:s=>v(o=>({...o,weakAnchors:s.target.value})),placeholder:"e.g., brachial plexus diagram, ROM measurements",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Concepts (comma-separated)"}),e.jsx(U,{value:p.concepts,onChange:s=>v(o=>({...o,concepts:s.target.value})),placeholder:"e.g., upper extremity anatomy, peripheral nerves",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Issues (comma-separated)"}),e.jsx(U,{value:p.issues,onChange:s=>v(o=>({...o,issues:s.target.value})),placeholder:"e.g., interrupted by phone, lost focus after 30 min",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Notes"}),e.jsx(U,{value:p.notes,onChange:s=>v(o=>({...o,notes:s.target.value})),placeholder:"Free-form observations about the session",className:"rounded-none border-secondary min-h-[80px]"})]})]}),e.jsxs(Be,{className:"gap-2",children:[e.jsxs(b,{variant:"outline",onClick:()=>c(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(b,{onClick:ys,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})}),e.jsx(Us,{open:d&&u.length>0,onOpenChange:i,children:e.jsxs(Ws,{className:"bg-black border-2 border-destructive rounded-none",children:[e.jsxs(Vs,{children:[e.jsxs(Js,{className:"font-arcade text-destructive flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5"}),"CONFIRM DELETE"]}),e.jsxs(Qs,{className:"font-terminal text-muted-foreground",children:["Are you sure you want to delete ",u.length," session",u.length!==1?"s":"","? This action cannot be undone."]})]}),e.jsxs(Ys,{className:"gap-2",children:[e.jsx(Xs,{className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:"Cancel"}),e.jsxs(Zs,{onClick:Ns,className:"font-terminal rounded-none bg-destructive hover:bg-destructive/80 text-destructive-foreground",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})}),e.jsx(Fe,{open:D!==null,onOpenChange:s=>{s||C(null)},children:e.jsxs(Me,{className:"bg-black border-2 border-primary rounded-none max-w-lg",style:{top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:[e.jsxs(Le,{children:[e.jsxs(_e,{className:"font-arcade text-primary flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5"}),"EDIT CARD"]}),e.jsx(qe,{className:"font-terminal text-muted-foreground",children:"Edit card content and select target deck"})]}),e.jsxs("div",{className:"space-y-4 font-terminal",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Front (Question)"}),e.jsx(U,{value:w.front,onChange:s=>F(o=>({...o,front:s.target.value})),placeholder:"Card front...",className:"rounded-none border-secondary min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Back (Answer)"}),e.jsx(U,{value:w.back,onChange:s=>F(o=>({...o,back:s.target.value})),placeholder:"Card back...",className:"rounded-none border-secondary min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Target Deck"}),e.jsxs($e,{value:w.deckName,onValueChange:s=>F(o=>({...o,deckName:s})),children:[e.jsx(Ke,{className:"rounded-none border-secondary",children:e.jsx(Ge,{placeholder:"Select deck"})}),e.jsxs(He,{className:"rounded-none border-secondary bg-black max-h-[200px]",children:[e.jsx(P,{value:"PT::EBP",children:"PT::EBP (Evidence Based Practice)"}),e.jsx(P,{value:"PT::ExPhys",children:"PT::ExPhys (Exercise Physiology)"}),e.jsx(P,{value:"PT::MS1",children:"PT::MS1 (Movement Science 1)"}),e.jsx(P,{value:"PT::Neuro",children:"PT::Neuro (Neuroscience)"}),e.jsx(P,{value:"PT::TI",children:"PT::TI (Therapeutic Intervention)"}),e.jsx(P,{value:"PT::General",children:"PT::General"}),_?.decks?.filter(s=>!s.startsWith("PT::")).map(s=>e.jsx(P,{value:s,children:s},s))]})]}),e.jsxs("p",{className:"text-[10px] text-muted-foreground mt-1",children:["Current: ",e.jsx("span",{className:"text-blue-400",children:w.deckName})]})]})]}),e.jsxs(Be,{className:"gap-2",children:[e.jsxs(b,{variant:"outline",onClick:()=>C(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(b,{onClick:Ts,disabled:Ne.isPending,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),Ne.isPending?"Saving...":"Save"]})]})]})})]})}export{Kt as default};

import{c as Ke,r as l,j as e,b as B,R as Os,d as Ps,e as M,f as Rs,P as cs,g as Ms,u as is,X as ye}from"./index-izvMmS1T.js";import{h as Fs,i as Ls,j as qs,u as _,a as O,g as b,L as zs,k as _s,C as ve,B as S,f as Bs,S as Le,l as qe,T as le,P as Se,D as Ve,c as Je,d as Qe,e as Xe,m as Ze,I as es,n as se,o as ss}from"./layout-BJj8Citw.js";import{C as me,c as xe,a as Ce,b as we}from"./card-D_aVfyD-.js";import{e as $s,B as ke,S as ts,a as ns,b as as,c as rs,d as z}from"./select-kMy8xPnp.js";import{c as ds,R as Ks,T as Ys,C as Us,a as ze}from"./index-DX7bt5yf.js";import{T as Hs,A as Ws,a as Gs,b as Vs,c as Js,d as Qs,e as Xs,f as Zs,g as et}from"./alert-dialog-DcUrWyY1.js";import{F as st,a as os}from"./folder-DWgA0yi9.js";import{F as tt}from"./file-text-Cb2FSBup.js";import{R as ls}from"./refresh-cw-BJWDVixb.js";import{i as nt,f as at}from"./format-D7m0hUtg.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],ot=Ke("database",rt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],ct=Ke("file",lt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],dt=Ke("layers",it),ms=l.forwardRef(({className:n,...r},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:B("w-full caption-bottom text-sm",n),...r})}));ms.displayName="Table";const xs=l.forwardRef(({className:n,...r},a)=>e.jsx("thead",{ref:a,className:B("[&_tr]:border-b",n),...r}));xs.displayName="TableHeader";const us=l.forwardRef(({className:n,...r},a)=>e.jsx("tbody",{ref:a,className:B("[&_tr:last-child]:border-0",n),...r}));us.displayName="TableBody";const mt=l.forwardRef(({className:n,...r},a)=>e.jsx("tfoot",{ref:a,className:B("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",n),...r}));mt.displayName="TableFooter";const _e=l.forwardRef(({className:n,...r},a)=>e.jsx("tr",{ref:a,className:B("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",n),...r}));_e.displayName="TableRow";const G=l.forwardRef(({className:n,...r},a)=>e.jsx("th",{ref:a,className:B("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",n),...r}));G.displayName="TableHead";const V=l.forwardRef(({className:n,...r},a)=>e.jsx("td",{ref:a,className:B("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",n),...r}));V.displayName="TableCell";const xt=l.forwardRef(({className:n,...r},a)=>e.jsx("caption",{ref:a,className:B("mt-4 text-sm text-muted-foreground",n),...r}));xt.displayName="TableCaption";function ut(n,r,{checkForDefaultPrevented:a=!0}={}){return function(m){if(n?.(m),a===!1||!m.defaultPrevented)return r?.(m)}}var ht=Os[" useInsertionEffect ".trim().toString()]||Ps;function hs({prop:n,defaultProp:r,onChange:a=()=>{},caller:i}){const[m,d,g]=pt({defaultProp:r,onChange:a}),h=n!==void 0,A=h?n:m;{const u=l.useRef(n!==void 0);l.useEffect(()=>{const j=u.current;j!==h&&console.warn(`${i} is changing from ${j?"controlled":"uncontrolled"} to ${h?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=h},[h,i])}const T=l.useCallback(u=>{if(h){const j=ft(u)?u(n):u;j!==n&&g.current?.(j)}else d(u)},[h,n,d,g]);return[A,T]}function pt({defaultProp:n,onChange:r}){const[a,i]=l.useState(n),m=l.useRef(a),d=l.useRef(r);return ht(()=>{d.current=r},[r]),l.useEffect(()=>{m.current!==a&&(d.current?.(a),m.current=a)},[a,m]),[a,i,d]}function ft(n){return typeof n=="function"}var $="Accordion",bt=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Ye,gt,Nt]=$s($),[De]=Rs($,[Nt,ds]),Ue=ds(),ps=M.forwardRef((n,r)=>{const{type:a,...i}=n,m=i,d=i;return e.jsx(Ye.Provider,{scope:n.__scopeAccordion,children:a==="multiple"?e.jsx(St,{...d,ref:r}):e.jsx(vt,{...m,ref:r})})});ps.displayName=$;var[fs,jt]=De($),[bs,yt]=De($,{collapsible:!1}),vt=M.forwardRef((n,r)=>{const{value:a,defaultValue:i,onValueChange:m=()=>{},collapsible:d=!1,...g}=n,[h,A]=hs({prop:a,defaultProp:i??"",onChange:m,caller:$});return e.jsx(fs,{scope:n.__scopeAccordion,value:M.useMemo(()=>h?[h]:[],[h]),onItemOpen:A,onItemClose:M.useCallback(()=>d&&A(""),[d,A]),children:e.jsx(bs,{scope:n.__scopeAccordion,collapsible:d,children:e.jsx(gs,{...g,ref:r})})})}),St=M.forwardRef((n,r)=>{const{value:a,defaultValue:i,onValueChange:m=()=>{},...d}=n,[g,h]=hs({prop:a,defaultProp:i??[],onChange:m,caller:$}),A=M.useCallback(u=>h((j=[])=>[...j,u]),[h]),T=M.useCallback(u=>h((j=[])=>j.filter(L=>L!==u)),[h]);return e.jsx(fs,{scope:n.__scopeAccordion,value:g,onItemOpen:A,onItemClose:T,children:e.jsx(bs,{scope:n.__scopeAccordion,collapsible:!0,children:e.jsx(gs,{...d,ref:r})})})}),[Ct,Te]=De($),gs=M.forwardRef((n,r)=>{const{__scopeAccordion:a,disabled:i,dir:m,orientation:d="vertical",...g}=n,h=M.useRef(null),A=Ms(h,r),T=gt(a),j=Ls(m)==="ltr",L=ut(n.onKeyDown,E=>{if(!bt.includes(E.key))return;const P=E.target,F=T().filter(Y=>!Y.ref.current?.disabled),N=F.findIndex(Y=>Y.ref.current===P),C=F.length;if(N===-1)return;E.preventDefault();let f=N;const J=0,v=C-1,I=()=>{f=N+1,f>v&&(f=J)},K=()=>{f=N-1,f<J&&(f=v)};switch(E.key){case"Home":f=J;break;case"End":f=v;break;case"ArrowRight":d==="horizontal"&&(j?I():K());break;case"ArrowDown":d==="vertical"&&I();break;case"ArrowLeft":d==="horizontal"&&(j?K():I());break;case"ArrowUp":d==="vertical"&&K();break}const R=f%C;F[R].ref.current?.focus()});return e.jsx(Ct,{scope:a,disabled:i,direction:m,orientation:d,children:e.jsx(Ye.Slot,{scope:a,children:e.jsx(cs.div,{...g,"data-orientation":d,ref:A,onKeyDown:i?void 0:L})})})}),Ae="AccordionItem",[wt,He]=De(Ae),Ns=M.forwardRef((n,r)=>{const{__scopeAccordion:a,value:i,...m}=n,d=Te(Ae,a),g=jt(Ae,a),h=Ue(a),A=Fs(),T=i&&g.value.includes(i)||!1,u=d.disabled||n.disabled;return e.jsx(wt,{scope:a,open:T,disabled:u,triggerId:A,children:e.jsx(Ks,{"data-orientation":d.orientation,"data-state":ws(T),...h,...m,ref:r,disabled:u,open:T,onOpenChange:j=>{j?g.onItemOpen(i):g.onItemClose(i)}})})});Ns.displayName=Ae;var js="AccordionHeader",ys=M.forwardRef((n,r)=>{const{__scopeAccordion:a,...i}=n,m=Te($,a),d=He(js,a);return e.jsx(cs.h3,{"data-orientation":m.orientation,"data-state":ws(d.open),"data-disabled":d.disabled?"":void 0,...i,ref:r})});ys.displayName=js;var Be="AccordionTrigger",vs=M.forwardRef((n,r)=>{const{__scopeAccordion:a,...i}=n,m=Te($,a),d=He(Be,a),g=yt(Be,a),h=Ue(a);return e.jsx(Ye.ItemSlot,{scope:a,children:e.jsx(Ys,{"aria-disabled":d.open&&!g.collapsible||void 0,"data-orientation":m.orientation,id:d.triggerId,...h,...i,ref:r})})});vs.displayName=Be;var Ss="AccordionContent",Cs=M.forwardRef((n,r)=>{const{__scopeAccordion:a,...i}=n,m=Te($,a),d=He(Ss,a),g=Ue(a);return e.jsx(Us,{role:"region","aria-labelledby":d.triggerId,"data-orientation":m.orientation,...g,...i,ref:r,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...n.style}})});Cs.displayName=Ss;function ws(n){return n?"open":"closed"}var kt=ps,At=Ns,Dt=ys,ks=vs,As=Cs;const $e=kt,te=l.forwardRef(({className:n,...r},a)=>e.jsx(At,{ref:a,className:B("border-b",n),...r}));te.displayName="AccordionItem";const ne=l.forwardRef(({className:n,children:r,...a},i)=>e.jsx(Dt,{className:"flex",children:e.jsxs(ks,{ref:i,className:B("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",n),...a,children:[r,e.jsx(qs,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})}));ne.displayName=ks.displayName;const ae=l.forwardRef(({className:n,children:r,...a},i)=>e.jsx(As,{ref:i,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...a,children:e.jsx("div",{className:B("pb-4 pt-0",n),children:r})}));ae.displayName=As.displayName;const Tt=`You are extracting a full course syllabus for ingestion.

Return ONLY a valid JSON object with NO additional text, NO markdown code blocks, NO explanation.

Top-level structure:
{
  "term": {
    "startDate": "YYYY-MM-DD",
    "endDate": "YYYY-MM-DD",
    "timezone": "America/Chicago"
  },
  "modules": [
    {
      "name": "Module 1: ...",
      "orderIndex": 1,
      "topics": ["..."],
      "readings": ["..."],
      "assessments": ["..."]
    }
  ],
  "events": [
    {
      "type": "class" | "lecture" | "reading" | "topic" | "assignment" | "quiz" | "exam" | "assessment",
      "title": "string",
      "date": "YYYY-MM-DD",
      "dueDate": "YYYY-MM-DD | null",
      "startTime": "HH:MM | null",
      "endTime": "HH:MM | null",
      "daysOfWeek": ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
      "delivery": "in_person" | "virtual_sync" | "virtual_async" | "hybrid",
      "assessmentType": "EA | null",
      "moduleName": "Module 1: ... | null",
      "notes": "string | null"
    }
  ]
}

Rules:
1. Include ALL items: class meetings, assignments, quizzes, exams, topics, readings, virtual synchronous/asynchronous activities, and learning assessments (EA).
2. For repeating class meetings, set daysOfWeek + startTime/endTime, and include term start/end.
3. For one-off items, set date or dueDate.
4. Keep moduleName when items belong to a module.
5. Return ONLY the JSON object, nothing else.

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,Et=`I need you to extract learning objectives from my course material.

Return ONLY a valid JSON array with NO additional text, NO markdown code blocks, NO explanation.

Structure for each item:
{
  "loCode": "string",
  "title": "string"
}

Rules:
1. loCode: Preserve original numbering if present, or create sequential "1", "2", "3"...
2. title: Keep the objective text exactly as written
3. Return ONLY the JSON array, nothing else

Here are my learning objectives:

[PASTE YOUR LOs BELOW]`,It=`I need you to convert my study session notes into WRAP format.

WRAP format has 4 sections:

Section A: Obsidian Notes
- Main concepts and insights from the session
- Key points to remember

Section B: Anki Cards
- Format: "front: [question]" on one line, "back: [answer]" on next line
- Create cards for important facts and concepts

Section C: Spaced Schedule
- R1=tomorrow
- R2=3d
- R3=1w
- R4=2w

Section D: JSON Logs
\`\`\`json
{
  "merged": {
    "topic": "[main topic]",
    "mode": "Core",
    "duration_minutes": [number],
    "understanding": [1-5],
    "retention": [1-5]
  }
}
\`\`\`

Return ONLY the WRAP formatted content, NO additional text or explanation.

Here are my study notes:

[PASTE YOUR NOTES BELOW]`;function Ot(){const n=is(),[r,a]=l.useState(null),[i,m]=l.useState(null),[d,g]=l.useState(""),[h,A]=l.useState(""),[T,u]=l.useState(null),[j,L]=l.useState(""),[E,P]=l.useState(null),[F,N]=l.useState(null),[C,f]=l.useState({}),[J,v]=l.useState({}),[I,K]=l.useState(new Set),[R,Y]=l.useState(new Set),{data:he=[]}=_({queryKey:["courses"],queryFn:()=>b.courses.getActive()}),{data:H=[]}=_({queryKey:["modules",r],queryFn:()=>r?b.modules.getByCourse(r):Promise.resolve([]),enabled:!!r}),{data:U=[]}=_({queryKey:["scheduleEvents",r],queryFn:()=>r?b.scheduleEvents.getByCourse(r):Promise.resolve([]),enabled:!!r}),{data:ce=[]}=_({queryKey:["learningObjectives",r],queryFn:()=>r?b.learningObjectives.getByCourse(r):Promise.resolve([]),enabled:!!r}),D=O({mutationFn:async t=>{if(!r)throw new Error("Select a course first");const c=JSON.parse(t);return b.syllabus.importBulk(r,c)},onSuccess:t=>{n.invalidateQueries({queryKey:["scheduleEvents"]}),n.invalidateQueries({queryKey:["modules"]}),g(""),N({type:"success",message:`Imported: ${t.modulesCreated} modules, ${t.eventsCreated} events (${t.classMeetingsExpanded} class meetings expanded)`}),u(null)},onError:t=>{N({type:"error",message:t.message||"Failed to import syllabus"}),u(t.message||"Failed to import syllabus")}}),W=O({mutationFn:async t=>{if(!r)throw new Error("Select a course first");const c=JSON.parse(t);return b.learningObjectives.createBulk(r,i,c)},onSuccess:()=>{n.invalidateQueries({queryKey:["learningObjectives"]}),A(""),u(null)},onError:t=>{u(t.message||"Failed to import LOs")}}),Q=O({mutationFn:({id:t,data:c})=>b.modules.update(t,c),onSuccess:()=>{n.invalidateQueries({queryKey:["modules"]})}}),Z=O({mutationFn:t=>b.modules.delete(t),onSuccess:()=>{n.invalidateQueries({queryKey:["modules"]})}}),ie=O({mutationFn:t=>b.modules.deleteMany(t),onSuccess:()=>{n.invalidateQueries({queryKey:["modules"]}),K(new Set)}}),Ee=O({mutationFn:({id:t,data:c})=>b.scheduleEvents.update(t,c),onSuccess:()=>{n.invalidateQueries({queryKey:["scheduleEvents"]})}}),Ie=O({mutationFn:t=>b.scheduleEvents.delete(t),onSuccess:()=>{n.invalidateQueries({queryKey:["scheduleEvents"]})}}),Oe=O({mutationFn:t=>b.scheduleEvents.deleteMany(t),onSuccess:()=>{n.invalidateQueries({queryKey:["scheduleEvents"]}),Y(new Set)}}),de=t=>{navigator.clipboard.writeText(t)},pe=(t,c)=>c===0?!1:window.confirm(`Delete ${c} ${t}? This cannot be undone.`),Pe=async()=>{try{P(null);const t=j,y=await b.brain.ingest(t,"pasted_wrap.md");y.sessionSaved?(P({type:"success",message:`âœ“ Session saved! ID: ${y.sessionId}, Cards: ${y.cardsCreated||0}`}),L("")):P({type:"error",message:y.errors?.join(", ")||y.message})}catch(t){P({type:"error",message:t.message||"Failed to ingest"})}};return e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"border-2 border-primary rounded-none p-4 bg-primary/5",children:[e.jsx("h2",{className:"text-xl font-arcade text-primary mb-4",children:"WRAP SESSION INGESTION"}),E&&e.jsx("div",{className:`mb-4 p-3 rounded-none font-terminal text-sm ${E.type==="success"?"bg-green-900/30 border border-green-500 text-green-400":"bg-red-900/30 border border-red-500 text-red-400"}`,children:E.message}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:()=>de(It),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Use ChatGPT to convert your notes to WRAP format, then paste or upload below:"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-2 font-terminal text-muted-foreground",children:"Paste WRAP Content"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-48 font-terminal text-sm",placeholder:"Paste your WRAP session here...",value:j,onChange:t=>{L(t.target.value),P(null)}})]}),e.jsx("button",{onClick:Pe,disabled:!j,className:"bg-primary hover:bg-primary/80 disabled:opacity-50 px-6 py-3 rounded-none font-arcade text-sm w-full",type:"button",children:"INGEST WRAP SESSION"})]})]}),e.jsx("h2",{className:"text-xl font-arcade text-primary",children:"MATERIAL INGESTION"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),e.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:r||"",onChange:t=>{a(t.target.value?parseInt(t.target.value):null),m(null)},children:[e.jsx("option",{value:"",children:"-- Select Course --"}),he.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),T&&e.jsx("div",{className:"bg-destructive/20 border border-destructive rounded-none p-3 text-destructive font-terminal",children:T}),r&&e.jsxs($e,{type:"multiple",className:"border border-secondary/40 rounded-none divide-y divide-secondary/40",children:[e.jsxs(te,{value:"syllabus-import",className:"border-secondary/40",children:[e.jsx(ne,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"SYLLABUS IMPORT (MODULES + SCHEDULE)"}),e.jsxs(ae,{className:"px-3",children:[e.jsx("button",{onClick:()=>de(Tt),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Paste the ChatGPT response (combined JSON object) below:"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-40 font-terminal text-sm",placeholder:'{"term":{"startDate":"2026-01-15","endDate":"2026-05-01","timezone":"America/Chicago"},"modules":[...],"events":[...]}',value:d,onChange:t=>{g(t.target.value),N(null)}}),e.jsx("button",{onClick:()=>D.mutate(d),disabled:!d||D.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none mt-2 font-terminal text-xs",type:"button",children:D.isPending?"Importing...":"Import Syllabus"}),F&&e.jsx("div",{className:`mt-2 p-2 border font-terminal text-xs ${F.type==="success"?"border-green-500 text-green-400":"border-red-500 text-red-400"}`,children:F.message})]})]}),e.jsxs(te,{value:"modules",className:"border-secondary/40",children:[e.jsx(ne,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"MODULES"}),e.jsx(ae,{className:"px-3",children:H.length===0?e.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"No modules yet. Add modules manually or import."}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>{const t=new Set;I.size!==H.length&&H.forEach(c=>t.add(c.id)),K(t)},children:I.size===H.length?"Uncheck All":"Check All"}),e.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:I.size===0,onClick:()=>{pe("module(s)",I.size)&&ie.mutate(Array.from(I))},children:"Delete Selected"})]}),e.jsxs("table",{className:"w-full text-sm font-terminal",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-secondary/50",children:[e.jsx("th",{className:"text-center p-2 w-8",children:"Select"}),e.jsx("th",{className:"text-left p-2",children:"Module"}),e.jsx("th",{className:"text-center p-2",children:"Order"}),e.jsx("th",{className:"text-center p-2",children:"Files"}),e.jsx("th",{className:"text-center p-2",children:"NotebookLM"}),e.jsx("th",{className:"text-center p-2",children:"Status"}),e.jsx("th",{className:"text-center p-2",children:"Actions"})]})}),e.jsx("tbody",{children:H.map(t=>e.jsxs("tr",{className:"border-b border-secondary/30",children:[e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"checkbox",checked:I.has(t.id),onChange:c=>K(y=>{const w=new Set(y);return c.target.checked?w.add(t.id):w.delete(t.id),w})})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:C[t.id]?.name??t.name,onChange:c=>f(y=>({...y,[t.id]:{...y[t.id],name:c.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"number",className:"w-16 bg-black border border-secondary rounded-none p-1 text-xs font-terminal text-center",value:C[t.id]?.orderIndex??t.orderIndex??0,onChange:c=>f(y=>({...y,[t.id]:{...y[t.id],orderIndex:parseInt(c.target.value||"0",10)}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"checkbox",checked:t.filesDownloaded,onChange:c=>Q.mutate({id:t.id,data:{filesDownloaded:c.target.checked}})})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"checkbox",checked:t.notebooklmLoaded,onChange:c=>Q.mutate({id:t.id,data:{notebooklmLoaded:c.target.checked}})})}),e.jsx("td",{className:"text-center p-2",children:t.filesDownloaded&&t.notebooklmLoaded?e.jsx("span",{className:"text-green-400",children:"Ready"}):e.jsx("span",{className:"text-yellow-400",children:"Pending"})}),e.jsxs("td",{className:"text-center p-2 space-x-2",children:[e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:!C[t.id],onClick:()=>{const c=C[t.id];c&&(Q.mutate({id:t.id,data:c}),f(y=>{const w={...y};return delete w[t.id],w}))},children:"Save"}),e.jsx("button",{className:"bg-muted hover:bg-muted/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:!C[t.id],onClick:()=>f(c=>{const y={...c};return delete y[t.id],y}),children:"Cancel"}),e.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>Z.mutate(t.id),children:"Delete"})]})]},t.id))})]})]})})]}),e.jsxs(te,{value:"schedule-items",className:"border-secondary/40",children:[e.jsx(ne,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"SCHEDULE ITEMS"}),e.jsx(ae,{className:"px-3",children:U.length===0?e.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"No schedule items yet. Import the syllabus or add events manually."}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>{const t=new Set;R.size!==U.length&&U.forEach(c=>t.add(c.id)),Y(t)},children:R.size===U.length?"Uncheck All":"Check All"}),e.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:R.size===0,onClick:()=>{pe("schedule item(s)",R.size)&&Oe.mutate(Array.from(R))},children:"Delete Selected"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs font-terminal",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-secondary/50",children:[e.jsx("th",{className:"text-center p-2 w-8",children:"Select"}),e.jsx("th",{className:"text-left p-2",children:"Type"}),e.jsx("th",{className:"text-left p-2",children:"Title"}),e.jsx("th",{className:"text-center p-2",children:"Date"}),e.jsx("th",{className:"text-center p-2",children:"Start"}),e.jsx("th",{className:"text-center p-2",children:"End"}),e.jsx("th",{className:"text-center p-2",children:"Due"}),e.jsx("th",{className:"text-left p-2",children:"Notes"}),e.jsx("th",{className:"text-center p-2",children:"Actions"})]})}),e.jsx("tbody",{children:U.map(t=>{const c=J[t.id]||{},y=c.type??t.type??"",w=c.title??t.title??"",fe=c.date??t.date??"",Re=c.startTime??t.startTime??"",be=c.endTime??t.endTime??"",ge=c.dueDate??t.dueDate??"",X=c.notes??t.notes??"",Ne=!!J[t.id];return e.jsxs("tr",{className:"border-b border-secondary/30 align-top",children:[e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"checkbox",checked:R.has(t.id),onChange:x=>Y(p=>{const re=new Set(p);return x.target.checked?re.add(t.id):re.delete(t.id),re})})}),e.jsx("td",{className:"p-2",children:e.jsx("select",{className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:y,onChange:x=>v(p=>({...p,[t.id]:{...p[t.id],type:x.target.value}})),children:["class","lecture","reading","topic","assignment","quiz","exam","assessment","other"].map(x=>e.jsx("option",{value:x,children:x},x))})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:w,onChange:x=>v(p=>({...p,[t.id]:{...p[t.id],title:x.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"date",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:fe||"",onChange:x=>v(p=>({...p,[t.id]:{...p[t.id],date:x.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"time",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:Re||"",onChange:x=>v(p=>({...p,[t.id]:{...p[t.id],startTime:x.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"time",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:be||"",onChange:x=>v(p=>({...p,[t.id]:{...p[t.id],endTime:x.target.value}}))})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"date",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:ge||"",onChange:x=>v(p=>({...p,[t.id]:{...p[t.id],dueDate:x.target.value}}))})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:X||"",onChange:x=>v(p=>({...p,[t.id]:{...p[t.id],notes:x.target.value}}))})}),e.jsxs("td",{className:"text-center p-2 space-x-2",children:[e.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:!Ne,onClick:()=>{Ee.mutate({id:t.id,data:{type:y,title:w,date:fe,startTime:Re,endTime:be,dueDate:ge,notes:X}}),v(x=>{const p={...x};return delete p[t.id],p})},children:"Save"}),e.jsx("button",{className:"bg-muted hover:bg-muted/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:!Ne,onClick:()=>v(x=>{const p={...x};return delete p[t.id],p}),children:"Cancel"}),e.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>Ie.mutate(t.id),children:"Delete"})]})]},t.id)})})]})})]})})]}),e.jsxs(te,{value:"learning-objectives",className:"border-secondary/40",children:[e.jsx(ne,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"LEARNING OBJECTIVES IMPORT"}),e.jsxs(ae,{className:"px-3",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-xs mb-1 font-terminal text-muted-foreground",children:"Target Module (optional)"}),e.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:i||"",onChange:t=>m(t.target.value?parseInt(t.target.value):null),children:[e.jsx("option",{value:"",children:"-- No Module (Course-level) --"}),H.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsx("button",{onClick:()=>de(Et),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Paste the ChatGPT response (JSON array) below:"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-32 font-terminal text-sm",placeholder:'[{"loCode": "1.1", "title": "Define..."}]',value:h,onChange:t=>A(t.target.value)}),e.jsx("button",{onClick:()=>W.mutate(h),disabled:!h||W.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none mt-2 font-terminal text-xs",type:"button",children:W.isPending?"Importing...":"Import LOs"}),ce.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"font-terminal text-xs mb-2",children:["Current LOs (",ce.length,")"]}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:ce.map(t=>e.jsxs("div",{className:"text-xs py-1 border-b border-secondary/30 font-terminal",children:[e.jsx("span",{className:"text-primary",children:t.loCode}),": ",t.title,e.jsx("span",{className:`ml-2 text-[10px] px-1 rounded ${t.status==="solid"?"bg-green-600":t.status==="in_progress"?"bg-yellow-600":t.status==="need_review"?"bg-orange-600":"bg-gray-600"}`,children:t.status})]},t.id))})]})]})]})]})]})}const Pt=(n,r="MM/dd")=>{if(!n)return"-";try{const a=n instanceof Date?n:new Date(n);return nt(a)?at(a,r):"-"}catch{return"-"}},ue=n=>{if(Array.isArray(n))return n.filter(r=>typeof r=="string");if(typeof n=="string"){const r=n.trim();if(!r)return[];try{const a=JSON.parse(r);if(Array.isArray(a))return a.filter(i=>typeof i=="string")}catch{}return r.split(",").map(a=>a.trim()).filter(Boolean)}return[]};function Yt(){const[n,r]=l.useState(new Set),[a,i]=l.useState(null),[m,d]=l.useState(!1),[g,h]=l.useState([]),[A,T]=l.useState(!1),[u,j]=l.useState(new Set),[L,E]=l.useState(null),[P,F]=l.useState({front:"",back:"",deckName:""}),[N,C]=l.useState({mode:"",minutes:"",cards:"",confusions:"",weakAnchors:"",concepts:"",issues:"",notes:""}),[f,J]=l.useState("School"),[v,I]=l.useState(null),[K,R]=l.useState(""),[Y,he]=l.useState(!1),[H,U]=l.useState(!1),ce=[{name:"EBP",path:"School/Evidence Based Practice"},{name:"ExPhys",path:"School/Exercise Physiology"},{name:"MS1",path:"School/Movement Science 1"},{name:"Neuro",path:"School/Neuroscience"},{name:"TI",path:"School/Theraputic Intervention"}],{data:D=[],isLoading:W}=_({queryKey:["sessions"],queryFn:b.sessions.getAll}),{data:Q}=_({queryKey:["brain","metrics"],queryFn:b.brain.getMetrics}),Z=is(),ie=O({mutationFn:s=>b.sessions.deleteMany(s),onSuccess:()=>{Z.invalidateQueries({queryKey:["sessions"]}),Z.invalidateQueries({queryKey:["brain","metrics"]}),r(new Set)}}),Ee=O({mutationFn:({id:s,updates:o})=>b.sessions.update(s,o),onSuccess:()=>{Z.invalidateQueries({queryKey:["sessions"]}),Z.invalidateQueries({queryKey:["brain","metrics"]}),i(null)}}),Ie=s=>{r(o=>{const k=new Set(o);return k.has(s)?k.delete(s):k.add(s),k})},Oe=()=>{n.size===D.length?r(new Set):r(new Set(D.map(s=>s.id)))},de=()=>{n.size!==0&&(h(Array.from(n)),d(!0))},pe=s=>{h([s]),d(!0)},Pe=()=>{ie.mutate(g),d(!1),h([])};l.useEffect(()=>{if(a!==null){const s=D.find(o=>o.id===a);s&&C({mode:s.mode||"",minutes:s.minutes?.toString()||"",cards:s.cards?.toString()||"",confusions:ue(s.confusions).join(", "),weakAnchors:ue(s.weakAnchors).join(", "),concepts:ue(s.concepts).join(", "),issues:ue(s.issues).join(", "),notes:s.notes||""})}},[a,D]);const t=a!==null?D.find(s=>s.id===a):null,c=typeof window<"u"&&new URLSearchParams(window.location.search).has("debugModals");l.useEffect(()=>{a!==null&&!W&&!t&&(c&&console.warn("[ModalDebug][Brain] Missing session for edit; closing.",{editingSession:a,sessionsCount:D.length}),i(null))},[c,a,t,D.length,W]),l.useEffect(()=>{c&&console.info("[ModalDebug][Brain] state",{editingSession:a,hasEditingSessionData:!!t,deleteDialogOpen:m,sessionsToDelete:g.length,sessionsLoading:W})},[c,m,a,t,W,g.length]);const y=()=>{if(a===null)return;const s=q=>q?q.split(",").map(oe=>oe.trim()).filter(Boolean):[],o=q=>q.length?JSON.stringify(q):null,k={mode:N.mode||"study",minutes:parseInt(N.minutes)||0,cards:parseInt(N.cards)||0,confusions:o(s(N.confusions)),weakAnchors:o(s(N.weakAnchors)),concepts:o(s(N.concepts)),issues:o(s(N.issues)),notes:N.notes||null};Ee.mutate({id:a,updates:k})},{data:w}=_({queryKey:["obsidian","status"],queryFn:b.obsidian.getStatus,refetchInterval:3e4}),{data:fe,refetch:Re}=_({queryKey:["obsidian","files",f],queryFn:()=>b.obsidian.getFiles(f),enabled:w?.connected===!0}),be=async s=>{try{const o=await b.obsidian.getFile(s);o.success&&o.content!==void 0&&(I(s),R(o.content),U(!1))}catch(o){console.error("Failed to load file:",o)}},ge=async()=>{if(v){he(!0);try{(await b.obsidian.saveFile(v,K)).success&&U(!1)}catch(s){console.error("Failed to save file:",s)}finally{he(!1)}}},X=s=>{J(s),I(null),R("")},Ne=()=>{const s=new Date().toISOString().split("T")[0],o=f?`${f}/Session-${s}.md`:`Session-${s}.md`,k=`# Study Session - ${s}

## Summary


## Concepts Covered
- 

## Strengths
- 

## Areas to Review
- 

## Notes

`;I(o),R(k),U(!0)},{data:x,isLoading:p,refetch:re}=_({queryKey:["anki","status"],queryFn:b.anki.getStatus,refetchInterval:3e4}),{data:Ds}=_({queryKey:["anki","due"],queryFn:b.anki.getDue,enabled:x?.connected===!0}),{data:Ts=[],refetch:je}=_({queryKey:["anki","drafts"],queryFn:b.anki.getDrafts}),ee=Ts.filter(s=>s.status==="pending"),Me=O({mutationFn:b.anki.sync,onSuccess:()=>{Z.invalidateQueries({queryKey:["anki"]}),je()}}),We=O({mutationFn:s=>b.anki.approveDraft(s),onSuccess:()=>{je()}}),Ge=O({mutationFn:s=>b.anki.deleteDraft(s),onSuccess:()=>{je()}}),Fe=O({mutationFn:({id:s,data:o})=>b.anki.updateDraft(s,o),onSuccess:()=>{je(),E(null)}}),Es=s=>{E(s.id),F({front:s.front,back:s.back,deckName:s.deckName})},Is=()=>{L!==null&&Fe.mutate({id:L,data:P})};return e.jsxs(zs,{children:[c&&e.jsxs("div",{className:"fixed bottom-12 right-4 z-[70] bg-black/80 border border-primary text-primary font-terminal text-[10px] px-2 py-1 rounded-none",children:[e.jsx("div",{children:"Brain modals"}),e.jsxs("div",{children:["Edit session: ",a??"none"]}),e.jsxs("div",{children:["Edit data: ",t?"yes":"no"]}),e.jsxs("div",{children:["Delete open: ",m?"yes":"no"]}),e.jsxs("div",{children:["Delete count: ",g.length]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h1",{className:"font-arcade text-xl text-primary flex items-center gap-2",children:[e.jsx(_s,{className:"w-6 h-6"}),"BRAIN ANALYTICS"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"SYSTEM STATUS"}),e.jsx(me,{className:"brain-card rounded-none",children:e.jsx(xe,{className:"p-3",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3 font-terminal text-xs",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${w?.connected?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-muted-foreground",children:"Obsidian"}),e.jsx("span",{className:"text-primary",children:w?.connected?"Online":"Offline"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${x?.connected?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-muted-foreground",children:"Anki"}),e.jsx("span",{className:"text-primary",children:x?.connected?"Connected":"Offline"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-muted-foreground",children:[e.jsxs("span",{children:["Cards: ",e.jsx("span",{className:"text-primary",children:Q?.totalCards||0})]}),e.jsxs("span",{children:["Drafts: ",e.jsx("span",{className:"text-primary",children:ee.length})]})]})]})})})]}),e.jsx($e,{type:"single",collapsible:!0,className:"border border-secondary/40 rounded-none",children:e.jsxs(te,{value:"ingestion",className:"border-secondary/40",children:[e.jsx(ne,{className:"font-arcade text-sm text-primary px-4 hover:no-underline",children:"DATA INGESTION TOOLS"}),e.jsx(ae,{className:"px-2",children:e.jsx("div",{className:"pt-2",children:e.jsx(Ot,{})})})]})}),e.jsx($e,{type:"single",collapsible:!0,className:"border border-secondary/40 rounded-none",children:e.jsxs(te,{value:"integrations",className:"border-secondary/40",children:[e.jsx(ne,{className:"font-arcade text-sm text-primary px-4 hover:no-underline",children:"INTEGRATIONS"}),e.jsx(ae,{className:"px-2",children:e.jsxs("div",{className:"space-y-4 pt-2 min-w-0",children:[e.jsxs(me,{className:"brain-card rounded-none",children:[e.jsxs(Ce,{className:"border-b border-secondary/50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(we,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(st,{className:"w-4 h-4"}),"OBSIDIAN VAULT",w?.connected?e.jsx(ve,{className:"w-3 h-3 text-green-500"}):e.jsx(ye,{className:"w-3 h-3 text-red-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(S,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:Ne,disabled:!w?.connected,children:[e.jsx(tt,{className:"w-3 h-3 mr-1"}),"New Note"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:A,onChange:s=>T(s.target.checked),disabled:!w?.connected,className:"w-4 h-4 accent-primary"}),e.jsx("span",{className:"font-terminal text-xs",children:"Auto-Sync"})]})]})]}),e.jsx("div",{className:"flex items-center gap-1 mt-2 flex-wrap",children:ce.map(s=>e.jsx(S,{size:"sm",variant:f===s.path?"default":"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:()=>X(s.path),children:s.name},s.path))}),f&&e.jsxs("div",{className:"flex items-center gap-1 mt-2 font-terminal text-xs text-muted-foreground",children:[e.jsx("button",{onClick:()=>X(""),className:"hover:text-primary",children:"vault"}),f.split("/").map((s,o,k)=>e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Bs,{className:"w-3 h-3"}),e.jsx("button",{onClick:()=>X(k.slice(0,o+1).join("/")),className:"hover:text-primary",children:s})]},o))]})]}),e.jsx(xe,{className:"p-0",children:w?.connected?e.jsxs("div",{className:"grid md:grid-cols-2 h-[240px] md:h-[300px]",children:[e.jsx("div",{className:"border-r border-secondary/30",children:e.jsx(Le,{className:"h-[240px] md:h-[300px]",children:e.jsxs("div",{className:"p-2 space-y-1",children:[f&&e.jsxs("button",{onClick:()=>{const s=f.split("/");s.pop(),X(s.join("/"))},className:"w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs text-muted-foreground",children:[e.jsx(os,{className:"w-3 h-3"}),".."]}),fe?.files?.map(s=>{const o=typeof s=="string"?s:s.path,k=o.endsWith("/"),q=o.replace(/\/$/,"").split("/").pop()||o;return e.jsxs("button",{onClick:()=>{if(k){const oe=q.replace(/\/$/,"");X(f?`${f}/${oe}`:oe)}else{const oe=f?`${f}/${q}`:q;be(oe)}},className:`w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs ${v?.endsWith(q)?"bg-primary/20 text-primary":""}`,children:[k?e.jsx(os,{className:"w-3 h-3 text-yellow-500"}):e.jsx(ct,{className:"w-3 h-3 text-blue-400"}),q]},o)})]})})}),e.jsx("div",{className:"flex flex-col h-[240px] md:h-[300px]",children:v?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-secondary/30",children:[e.jsxs("span",{className:"font-terminal text-xs text-primary truncate",children:[v.split("/").pop(),H&&e.jsx("span",{className:"text-yellow-500 ml-1",children:"*"})]}),e.jsxs(S,{size:"sm",variant:"ghost",onClick:ge,disabled:!H||Y,className:"h-6 px-2",children:[e.jsx(qe,{className:"w-3 h-3 mr-1"}),Y?"Saving...":"Save"]})]}),e.jsx("textarea",{value:K,onChange:s=>{R(s.target.value),U(!0)},className:"flex-1 w-full p-3 bg-black/60 font-terminal text-sm resize-none focus:outline-none focus:ring-1 focus:ring-primary",placeholder:"File content..."})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center font-terminal text-xs text-muted-foreground",children:"Select a file to edit"})})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("p",{className:"font-terminal text-xs text-red-400 mb-2",children:"Obsidian Offline"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Obsidian with Local REST API plugin enabled"})]})})]}),e.jsxs(me,{className:"brain-card rounded-none",children:[e.jsx(Ce,{className:"border-b border-secondary/50 p-3",children:e.jsxs(we,{className:"font-arcade text-xs flex items-center gap-2 text-muted-foreground",children:[e.jsx(dt,{className:"w-3 h-3"}),"ANKI INTEGRATION",x?.connected?e.jsx(ve,{className:"w-3 h-3 text-green-500 ml-auto"}):e.jsx(ye,{className:"w-3 h-3 text-red-500 ml-auto"})]})}),e.jsx(xe,{className:"p-4 space-y-3",children:p?e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Checking Anki..."}):x?.connected?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Status:"}),e.jsx(ke,{variant:"outline",className:"bg-green-500/20 text-green-400 border-green-500",children:"Connected"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Cards Created:"}),e.jsx("span",{className:"font-arcade text-xs text-primary",children:Q?.totalCards||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Due Today:"}),e.jsx("span",{className:"font-arcade text-xs text-secondary",children:Ds?.dueCount||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Reviewed Today:"}),e.jsx("span",{className:"font-arcade text-xs text-muted-foreground",children:x.reviewedToday||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Decks:"}),e.jsx("span",{className:"font-arcade text-xs text-muted-foreground",children:x.decks?.length||0})]}),e.jsxs("div",{className:"pt-2 flex gap-2",children:[e.jsxs(S,{size:"sm",variant:"outline",className:"flex-1 font-terminal text-xs",onClick:()=>re(),children:[e.jsx(ls,{className:"w-3 h-3 mr-1"}),"Refresh"]}),e.jsx(S,{size:"sm",className:"flex-1 font-terminal text-xs bg-secondary hover:bg-secondary/80",onClick:()=>Me.mutate(),disabled:Me.isPending,children:Me.isPending?"Syncing...":"Sync Cards"})]}),ee.length>0&&e.jsxs("div",{className:"pt-3 border-t border-secondary/30",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-arcade text-[10px] text-yellow-400",children:["PENDING CARDS (",ee.length,")"]}),e.jsx("div",{className:"flex gap-1",children:e.jsx(S,{size:"sm",variant:"outline",className:"h-5 px-2 text-[10px] font-terminal",onClick:()=>{u.size===ee.length?j(new Set):j(new Set(ee.map(s=>s.id)))},children:u.size===ee.length?"None":"All"})})]}),u.size>0&&e.jsxs("div",{className:"flex gap-1 mb-2",children:[e.jsxs(S,{size:"sm",className:"h-6 px-2 text-[10px] font-terminal bg-green-600 hover:bg-green-700",onClick:()=>{u.forEach(s=>We.mutate(s)),j(new Set)},children:[e.jsx(ve,{className:"w-3 h-3 mr-1"}),"Approve (",u.size,")"]}),e.jsxs(S,{size:"sm",variant:"destructive",className:"h-6 px-2 text-[10px] font-terminal",onClick:()=>{u.forEach(s=>Ge.mutate(s)),j(new Set)},children:[e.jsx(le,{className:"w-3 h-3 mr-1"}),"Delete (",u.size,")"]})]}),e.jsx(Le,{className:"h-[200px]",children:e.jsx("div",{className:"space-y-2",children:ee.map(s=>e.jsx("div",{className:`p-2 bg-black/40 border text-xs ${u.has(s.id)?"border-primary":"border-secondary/30"}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ze,{checked:u.has(s.id),onCheckedChange:o=>{const k=new Set(u);o?k.add(s.id):k.delete(s.id),j(k)},className:"mt-1 border-secondary data-[state=checked]:bg-primary"}),e.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[e.jsx("div",{className:"font-terminal text-primary truncate",children:s.front}),e.jsx("div",{className:"font-terminal text-muted-foreground mt-1 truncate",children:s.back}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(ke,{variant:"outline",className:"text-[9px] border-blue-500/50 text-blue-400 shrink-0",children:s.deckName}),e.jsx(S,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-yellow-500/50 text-yellow-400 hover:bg-yellow-500/20",onClick:()=>Es(s),title:"Edit card",children:e.jsx(Se,{className:"w-3 h-3"})}),e.jsx(S,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-green-500/50 text-green-400 hover:bg-green-500/20",onClick:()=>We.mutate(s.id),title:"Approve card",children:e.jsx(ve,{className:"w-3 h-3"})}),e.jsx(S,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-red-500/50 text-red-400 hover:bg-red-500/20",onClick:()=>Ge.mutate(s.id),title:"Delete card",children:e.jsx(le,{className:"w-3 h-3"})})]})]})]})},s.id))})})]})]}):e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"font-terminal text-xs text-red-400",children:x?.error||"Anki not connected"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Anki with AnkiConnect plugin"}),e.jsxs(S,{size:"sm",variant:"outline",className:"font-terminal text-xs",onClick:()=>re(),children:[e.jsx(ls,{className:"w-3 h-3 mr-1"}),"Retry"]})]})})]})]})})]})}),e.jsxs("div",{className:"mb-6 min-w-0",children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"SESSION EVIDENCE"}),e.jsxs(me,{className:"brain-card rounded-none",children:[e.jsx(Ce,{className:"border-b border-secondary/60 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(we,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(ot,{className:"w-4 h-4"}),"SESSION EVIDENCE TABLE"]}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mt-1",children:"Raw WRAP data. All metrics derive from these fields."})]}),n.size>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-terminal text-xs text-muted-foreground",children:[n.size," selected"]}),e.jsxs(S,{size:"sm",variant:"destructive",className:"font-terminal text-xs rounded-none",onClick:de,disabled:ie.isPending,children:[e.jsx(le,{className:"w-3 h-3 mr-1"}),ie.isPending?"Deleting...":"Delete"]})]})]})}),e.jsx(xe,{className:"p-0",children:W?e.jsx("div",{className:"p-8 text-center font-terminal text-muted-foreground",children:"LOADING..."}):D.length===0?e.jsx("div",{className:"p-8 text-center font-terminal text-muted-foreground",children:"NO SESSIONS YET"}):e.jsx(Le,{className:"h-[360px] xl:h-[420px]",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ms,{className:"min-w-[620px]",children:[e.jsx(xs,{children:e.jsxs(_e,{className:"border-secondary/60 hover:bg-transparent",children:[e.jsx(G,{className:"w-10 px-2 py-2",children:e.jsx(ze,{checked:n.size===D.length&&D.length>0,onCheckedChange:Oe,className:"border-primary data-[state=checked]:bg-primary"})}),e.jsx(G,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"DATE"}),e.jsx(G,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"COURSE"}),e.jsx(G,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"MODE"}),e.jsx(G,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"MIN"}),e.jsx(G,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"CARDS"}),e.jsx(G,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"CONFUSIONS"}),e.jsx(G,{className:"font-arcade text-[10px] text-primary w-10 px-2 py-2",children:"ACTIONS"})]})}),e.jsx(us,{children:D.map(s=>e.jsxs(_e,{className:"border-secondary/50 hover:bg-primary/10 font-terminal text-xs","data-testid":`row-session-${s.id}`,children:[e.jsx(V,{className:"px-2 py-2",children:e.jsx(ze,{checked:n.has(s.id),onCheckedChange:()=>Ie(s.id),className:"border-secondary data-[state=checked]:bg-primary"})}),e.jsx(V,{className:"text-muted-foreground px-2 py-2",children:Pt(s.date)}),e.jsx(V,{className:"font-bold px-2 py-2",children:s.topic||"-"}),e.jsx(V,{className:"px-2 py-2",children:e.jsx(ke,{variant:"outline",className:"rounded-none border-secondary font-normal text-[10px]",children:s.mode})}),e.jsx(V,{className:"px-2 py-2",children:s.minutes||0}),e.jsx(V,{className:"px-2 py-2",children:s.cards||0}),e.jsx(V,{className:"max-w-[150px] truncate text-[10px] text-muted-foreground px-2 py-2",children:ue(s.confusions).join(", ")||"-"}),e.jsx(V,{className:"px-2 py-2",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(S,{size:"icon",variant:"ghost",className:"h-6 w-6 rounded-none hover:bg-primary/20",onClick:()=>i(s.id),title:"Edit session",children:e.jsx(Se,{className:"w-3 h-3"})}),e.jsx(S,{size:"icon",variant:"ghost",className:"h-6 w-6 rounded-none hover:bg-destructive/20 text-destructive",onClick:()=>pe(s.id),title:"Delete session",children:e.jsx(le,{className:"w-3 h-3"})})]})})]},s.id))})]})})})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"ISSUES LOG"}),e.jsxs(me,{className:"brain-card rounded-none",children:[e.jsxs(Ce,{className:"border-b border-secondary p-4",children:[e.jsxs(we,{className:"font-arcade text-sm flex items-center gap-2 text-red-400",children:[e.jsx(Hs,{className:"w-4 h-4"}),"ISSUES AND FAILURES LOG"]}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mt-1",children:"Aggregated session issues: interruptions, source-lock failures, workflow problems"})]}),e.jsx(xe,{className:"p-4",children:(Q?.issuesLog||[]).length===0?e.jsx("div",{className:"text-center font-terminal text-muted-foreground py-8",children:"NO ISSUES LOGGED"}):e.jsx("div",{className:"space-y-2",children:Q?.issuesLog.map((s,o)=>e.jsxs("div",{className:"flex items-center justify-between p-2 border border-red-500/30 bg-red-500/5 font-terminal text-sm",children:[e.jsx("span",{className:"text-red-300",children:s.issue}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:s.course}),e.jsxs(ke,{variant:"outline",className:"rounded-none border-red-500/50 text-red-400",children:["x",s.count]})]})]},o))})})]})]})]})]}),e.jsx(Ve,{open:!!t,onOpenChange:s=>{s||i(null)},children:e.jsxs(Je,{"data-modal":"brain-edit-session",className:"bg-black border-2 border-primary rounded-none max-w-2xl",children:[e.jsxs(Qe,{children:[e.jsxs(Xe,{className:"font-arcade text-primary flex items-center gap-2",children:[e.jsx(Se,{className:"w-5 h-5"}),"EDIT SESSION #",a]}),e.jsx(Ze,{className:"font-terminal text-muted-foreground",children:"Update WRAP methodology fields for this study session"})]}),e.jsxs("div",{className:"space-y-4 font-terminal",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Mode"}),e.jsxs(ts,{value:N.mode,onValueChange:s=>C(o=>({...o,mode:s})),children:[e.jsx(ns,{className:"rounded-none border-secondary",children:e.jsx(as,{placeholder:"Select mode"})}),e.jsxs(rs,{className:"rounded-none border-secondary bg-black",children:[e.jsx(z,{value:"Core",children:"Core"}),e.jsx(z,{value:"Sprint",children:"Sprint"}),e.jsx(z,{value:"Drill",children:"Drill"}),e.jsx(z,{value:"study",children:"Study"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Minutes"}),e.jsx(es,{type:"number",value:N.minutes,onChange:s=>C(o=>({...o,minutes:s.target.value})),className:"rounded-none border-secondary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Cards"}),e.jsx(es,{type:"number",value:N.cards,onChange:s=>C(o=>({...o,cards:s.target.value})),className:"rounded-none border-secondary"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Confusions (comma-separated)"}),e.jsx(se,{value:N.confusions,onChange:s=>C(o=>({...o,confusions:s.target.value})),placeholder:"e.g., muscle insertion points, nerve pathways",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Weak Anchors (comma-separated)"}),e.jsx(se,{value:N.weakAnchors,onChange:s=>C(o=>({...o,weakAnchors:s.target.value})),placeholder:"e.g., brachial plexus diagram, ROM measurements",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Concepts (comma-separated)"}),e.jsx(se,{value:N.concepts,onChange:s=>C(o=>({...o,concepts:s.target.value})),placeholder:"e.g., upper extremity anatomy, peripheral nerves",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Issues (comma-separated)"}),e.jsx(se,{value:N.issues,onChange:s=>C(o=>({...o,issues:s.target.value})),placeholder:"e.g., interrupted by phone, lost focus after 30 min",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Notes"}),e.jsx(se,{value:N.notes,onChange:s=>C(o=>({...o,notes:s.target.value})),placeholder:"Free-form observations about the session",className:"rounded-none border-secondary min-h-[80px]"})]})]}),e.jsxs(ss,{className:"gap-2",children:[e.jsxs(S,{variant:"outline",onClick:()=>i(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(S,{onClick:y,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})}),e.jsx(Ws,{open:m&&g.length>0,onOpenChange:d,children:e.jsxs(Gs,{"data-modal":"brain-delete-session",className:"bg-black border-2 border-destructive rounded-none",children:[e.jsxs(Vs,{children:[e.jsxs(Js,{className:"font-arcade text-destructive flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5"}),"CONFIRM DELETE"]}),e.jsxs(Qs,{className:"font-terminal text-muted-foreground",children:["Are you sure you want to delete ",g.length," session",g.length!==1?"s":"","? This action cannot be undone."]})]}),e.jsxs(Xs,{className:"gap-2",children:[e.jsx(Zs,{className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:"Cancel"}),e.jsxs(et,{onClick:Pe,className:"font-terminal rounded-none bg-destructive hover:bg-destructive/80 text-destructive-foreground",children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})}),e.jsx(Ve,{open:L!==null,onOpenChange:s=>{s||E(null)},children:e.jsxs(Je,{"data-modal":"brain-edit-draft",className:"bg-black border-2 border-primary rounded-none max-w-lg",style:{top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:[e.jsxs(Qe,{children:[e.jsxs(Xe,{className:"font-arcade text-primary flex items-center gap-2",children:[e.jsx(Se,{className:"w-5 h-5"}),"EDIT CARD"]}),e.jsx(Ze,{className:"font-terminal text-muted-foreground",children:"Edit card content and select target deck"})]}),e.jsxs("div",{className:"space-y-4 font-terminal",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Front (Question)"}),e.jsx(se,{value:P.front,onChange:s=>F(o=>({...o,front:s.target.value})),placeholder:"Card front...",className:"rounded-none border-secondary min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Back (Answer)"}),e.jsx(se,{value:P.back,onChange:s=>F(o=>({...o,back:s.target.value})),placeholder:"Card back...",className:"rounded-none border-secondary min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Target Deck"}),e.jsxs(ts,{value:P.deckName,onValueChange:s=>F(o=>({...o,deckName:s})),children:[e.jsx(ns,{className:"rounded-none border-secondary",children:e.jsx(as,{placeholder:"Select deck"})}),e.jsxs(rs,{className:"rounded-none border-secondary bg-black max-h-[200px]",children:[e.jsx(z,{value:"PT::EBP",children:"PT::EBP (Evidence Based Practice)"}),e.jsx(z,{value:"PT::ExPhys",children:"PT::ExPhys (Exercise Physiology)"}),e.jsx(z,{value:"PT::MS1",children:"PT::MS1 (Movement Science 1)"}),e.jsx(z,{value:"PT::Neuro",children:"PT::Neuro (Neuroscience)"}),e.jsx(z,{value:"PT::TI",children:"PT::TI (Therapeutic Intervention)"}),e.jsx(z,{value:"PT::General",children:"PT::General"}),x?.decks?.filter(s=>!s.startsWith("PT::")).map(s=>e.jsx(z,{value:s,children:s},s))]})]}),e.jsxs("p",{className:"text-[10px] text-muted-foreground mt-1",children:["Current: ",e.jsx("span",{className:"text-blue-400",children:P.deckName})]})]})]}),e.jsxs(ss,{className:"gap-2",children:[e.jsxs(S,{variant:"outline",onClick:()=>E(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(S,{onClick:Is,disabled:Fe.isPending,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),Fe.isPending?"Saving...":"Save"]})]})]})})]})}export{Yt as default};

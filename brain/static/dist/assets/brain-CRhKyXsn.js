import{c as ft,r as D,u as ht,a as Zi,j as l,X as It,R as Ts,g as Os,b as Je}from"./index-CCotL82y.js";import{u as X,a as de,h as V,S as Ye,i as Ms,B as ne,C as nn,g as Es,j as gr,T as st,P as cn,D as ea,c as ta,d as na,e as ra,f as ia,k as Qe,l as aa,I as Wt,L as Ps}from"./layout-B966LvX-.js";import{C as ee,a as ae,b as oe,c as te}from"./card-Dvno1_1I.js";import{B as un,S as Is,R as Rr}from"./badge-WjmBC6z3.js";import{L as Rt,M as Rs,T as Ds,a as zs,b as En,c as Pn}from"./tabs-BF6nM8ji.js";import{B as Wn,C as $s}from"./circle-check-Dn4RiOjU.js";import{C as ye,E as Fs}from"./checkbox-BCFES2vO.js";import{A as sa,a as oa,b as la,c as ca,d as ua,e as da,f as fa,g as ha,C as Ls,N as Dr}from"./alert-dialog-Bxj5hiGB.js";import{S as Ct,a as At,b as Tt,c as Ot,d as le,C as qs}from"./select-116zblGl.js";import{L as Us}from"./loader-circle-DuX5SQgK.js";import{M as Hs,r as Bs,F as Vs,a as zr}from"./index-BNWVZRso.js";import{F as Gs}from"./file-text-S4Cj_NYp.js";import{i as Ws,f as Ks}from"./format-D7m0hUtg.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Js=ft("arrow-right",Ys);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],Qs=ft("brain-circuit",Xs);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],$r=ft("calendar-days",Zs);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],xr=ft("database",eo);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],no=ft("file",to);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],io=ft("image",ro);function ao(){const[e,n]=D.useState(""),[r,i]=D.useState(null),[a,s]=D.useState("auto"),[o,c]=D.useState([]),u=ht(),{toast:d}=Zi(),{data:h=[]}=X({queryKey:["sessions"],queryFn:V.sessions.getAll}),f=h.slice().sort((g,v)=>{const b=g.date||g.createdAt||"";return(v.date||v.createdAt||"").localeCompare(b)}).slice(0,20),p=de({mutationFn:async()=>{if(!r)throw new Error("Select a session first");let g;try{g=JSON.parse(e)}catch{throw new Error("Invalid JSON — check syntax")}let v=a;if(v==="auto"){const j=Object.keys(g),C=["source_lock","plan_of_attack","frameworks_used","buckets","confusables_interleaved","anki_cards","glossary","exit_ticket_blurt","exit_ticket_muddiest","exit_ticket_next_action","retrospective_status","spaced_reviews","next_session","errors_by_type","errors_by_severity","error_patterns","spacing_algorithm","rsr_adaptive_adjustment","adaptive_multipliers"];v=j.some(w=>C.includes(w))?"enhanced":"tracker"}const b=v==="tracker"?g:void 0,x=v==="enhanced"?g:void 0;return V.brain.ingestSessionJson(r,b,x)},onSuccess:g=>{d({title:"JSON ingested",description:`${g.fields_updated} fields updated on session #${g.session_id}`}),u.invalidateQueries({queryKey:["sessions"]}),u.invalidateQueries({queryKey:["brain","metrics"]}),n(""),c([])},onError:g=>{d({title:"Ingestion failed",description:g.message,variant:"destructive"})}});function m(){const g=[];if(r||g.push("Select a session"),!e.trim())g.push("Paste JSON first");else try{const v=JSON.parse(e);(typeof v!="object"||Array.isArray(v))&&g.push("JSON must be an object, not array"),v.schema_version&&v.schema_version!=="9.4"&&g.push(`Expected schema_version 9.4, got ${v.schema_version}`)}catch{g.push("Invalid JSON syntax")}return c(g),g.length===0}return l.jsxs(ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ae,{className:"border-b border-primary/50 p-4",children:l.jsxs(oe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 bg-primary inline-block"}),"SESSION_JSON_INGEST"]})}),l.jsxs(te,{className:"p-4 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"TARGET SESSION"}),l.jsxs("select",{value:r??"",onChange:g=>i(g.target.value?Number(g.target.value):null),className:"w-full bg-black border border-primary/50 text-white font-terminal text-xs p-2 rounded-none focus:border-primary outline-none",children:[l.jsx("option",{value:"",children:"-- select session --"}),f.map(g=>l.jsxs("option",{value:g.id,children:["#",g.id," | ",g.date?.slice(0,10)||"?"," | ",g.topic||g.mainTopic||"Untitled"," | ",g.mode||"?"]},g.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"JSON TYPE"}),l.jsx("div",{className:"flex gap-2",children:["auto","tracker","enhanced"].map(g=>l.jsx("button",{onClick:()=>s(g),className:`px-3 py-1 font-arcade text-xs rounded-none border ${a===g?"bg-primary text-black border-primary":"border-primary/30 text-muted-foreground hover:text-white"}`,children:g.toUpperCase()},g))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"PASTE TRACKER OR ENHANCED JSON"}),l.jsx("textarea",{value:e,onChange:g=>n(g.target.value),placeholder:'{"schema_version": "9.4", "topic": "...", "mode": "Core", ...}',rows:10,className:"w-full bg-black border border-primary/50 text-green-400 font-terminal text-xs p-2 rounded-none focus:border-primary outline-none resize-y"})]}),o.length>0&&l.jsx("div",{className:"border border-red-500/50 bg-red-500/10 p-2 font-terminal text-xs text-red-400 space-y-1",children:o.map((g,v)=>l.jsxs("div",{children:["- ",g]},v))}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>{m()&&p.mutate()},disabled:p.isPending,className:"px-4 py-2 bg-primary text-black font-arcade text-xs rounded-none hover:bg-primary/80 disabled:opacity-50",children:p.isPending?"INGESTING...":"INGEST"}),l.jsx("button",{onClick:m,className:"px-4 py-2 border border-primary/50 text-primary font-arcade text-xs rounded-none hover:bg-primary/10",children:"VALIDATE"}),l.jsx("button",{onClick:()=>{n(""),c([])},className:"px-4 py-2 border border-primary/30 text-muted-foreground font-arcade text-xs rounded-none hover:text-white",children:"CLEAR"})]})]})]})}const so=`You are extracting a course schedule for ingestion.

Return ONLY a valid JSON object with NO additional text, NO markdown code blocks, NO explanation.

Structure:
{
  "name": "Course Name (e.g. Anatomy & Physiology II)",
  "term": {
    "startDate": "2026-01-05",
    "endDate": "2026-04-24",
    "timezone": "America/Chicago"
  },
  "events": [
    {
      "type": "class" | "lecture" | "reading" | "topic" | "assignment" | "quiz" | "exam" | "assessment",
      "title": "string",
      "date": "YYYY-MM-DD",
      "dueDate": "YYYY-MM-DD | null",
      "startTime": "HH:MM | null",
      "endTime": "HH:MM | null",
      "daysOfWeek": ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
      "delivery": "in_person" | "virtual_sync" | "virtual_async" | "hybrid",
      "assessmentType": "EA | null",
      "moduleName": "Module 1: ... | null",
      "notes": "string | null"
    }
  ]
}

Rules:
1. Include ALL schedule items: class meetings, assignments, quizzes, exams, readings, virtual activities, and learning assessments (EA).
2. For repeating class meetings, set daysOfWeek + startTime/endTime, and include term start/end.
3. For one-off items, set date or dueDate.
4. Do NOT include a "modules" array — schedule only.
5. Return ONLY the JSON object, nothing else.

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,oo=`You are extracting course module structure for ingestion.

Return ONLY a valid JSON object with NO additional text, NO markdown code blocks, NO explanation.

Structure:
{
  "modules": [
    {
      "name": "Module 1: Topic Name",
      "orderIndex": 1,
      "topics": ["Topic A", "Topic B"],
      "readings": ["Chapter 1", "Article X"],
      "assessments": ["Quiz 1", "Exam 1"]
    }
  ]
}

Rules:
1. Include ALL modules/units with their topics, readings, and assessments.
2. orderIndex should be sequential starting at 1.
3. Do NOT include dates or events — structure only.
4. Return ONLY the JSON object, nothing else.

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,lo=`I need you to extract learning objectives from my course material.

Return ONLY a valid JSON array with NO additional text, NO markdown code blocks, NO explanation.

Structure for each item:
{
  "loCode": "string",
  "title": "string"
}

Rules:
1. loCode: Preserve original numbering if present, or create sequential "1", "2", "3"...
2. title: Keep the objective text exactly as written
3. Return ONLY the JSON array, nothing else

Here are my learning objectives:

[PASTE YOUR LOs BELOW]`,co=`I need you to convert my study session notes into WRAP format.

WRAP format has 4 sections:

Section A: Obsidian Notes
- Main concepts and insights from the session
- Key points to remember

Section B: Anki Cards
- Format: "front: [question]" on one line, "back: [answer]" on next line
- Create cards for important facts and concepts

Section C: Spaced Schedule
- R1=tomorrow
- R2=3d
- R3=1w
- R4=2w

Section D: JSON Logs
\`\`\`json
{
  "merged": {
    "topic": "[main topic]",
    "mode": "Core",
    "duration_minutes": [number],
    "understanding": [1-5],
    "retention": [1-5]
  }
}
\`\`\`

Return ONLY the WRAP formatted content, NO additional text or explanation.

Here are my study notes:

[PASTE YOUR NOTES BELOW]`;function uo(){const e=ht(),[n,r]=D.useState(null),[i,a]=D.useState(null),[s,o]=D.useState("schedule"),[c,u]=D.useState(""),[d,h]=D.useState(""),[f,p]=D.useState(""),[m,g]=D.useState(""),[v,b]=D.useState(null),[x,j]=D.useState(null),[C,w]=D.useState(null),[_,M]=D.useState(null),[E,y]=D.useState(null),[T,k]=D.useState(null),{data:O=[]}=X({queryKey:["courses"],queryFn:()=>V.courses.getActive()}),{data:P=[]}=X({queryKey:["modules",n],queryFn:()=>n?V.modules.getByCourse(n):Promise.resolve([]),enabled:!!n}),{data:z=[]}=X({queryKey:["learningObjectives",n],queryFn:()=>n?V.learningObjectives.getByCourse(n):Promise.resolve([]),enabled:!!n}),S=F=>{const U=F.trim();if(!U)return"";const K=U.match(/```json\s*([\s\S]*?)```/i)||U.match(/```\s*([\s\S]*?)```/i),Y=K?K[1].trim():U,se=Y.indexOf("["),ge=Y.lastIndexOf("]"),Ie=Y.indexOf("{"),Mn=Y.lastIndexOf("}");return se!==-1&&ge!==-1&&ge>se&&(Ie===-1||se<Ie)?Y.slice(se,ge+1).trim():Ie!==-1&&Mn!==-1&&Mn>Ie?Y.slice(Ie,Mn+1).trim():Y},R=F=>{navigator.clipboard.writeText(F)},N=de({mutationFn:async F=>{if(!n)throw new Error("Select a course first");const K={...JSON.parse(S(F)),modules:[]};return V.syllabus.importBulk(n,K)},onSuccess:F=>{e.invalidateQueries({queryKey:["scheduleEvents"]}),u(""),y(null),w({type:"success",message:`Imported: ${F.eventsCreated} events (${F.classMeetingsExpanded} class meetings expanded)`}),b(null)},onError:F=>{w({type:"error",message:F.message||"Failed to import schedule"})}}),I=de({mutationFn:async F=>{if(!n)throw new Error("Select a course first");const U=JSON.parse(S(F)),K=U.modules||U;return V.modules.createBulk(n,K)},onSuccess:()=>{e.invalidateQueries({queryKey:["modules"]}),h(""),k(null),M({type:"success",message:"Modules imported successfully"}),b(null)},onError:F=>{M({type:"error",message:F.message||"Failed to import modules"})}}),$=de({mutationFn:async F=>{if(!n)throw new Error("Select a course first");const U=JSON.parse(S(F));return V.learningObjectives.createBulk(n,i,U)},onSuccess:()=>{e.invalidateQueries({queryKey:["learningObjectives"]}),p(""),b(null)},onError:F=>{b(F.message||"Failed to import LOs")}}),L=F=>{const U=[];try{const K=S(F);if(!K){y({isValid:!1,errors:["No JSON found"]});return}const Y=JSON.parse(K);(!Y||typeof Y!="object")&&U.push("JSON must be an object"),(!Y.name||typeof Y.name!="string")&&U.push("Missing 'name' field"),!Y.term||typeof Y.term!="object"?U.push("Missing 'term' object"):(Y.term.startDate||U.push("term.startDate is required"),Y.term.endDate||U.push("term.endDate is required")),Array.isArray(Y.events)||U.push("Missing 'events' array"),U.length===0?y({isValid:!0,errors:[],preview:{courseName:Y.name,eventCount:Y.events.length,startDate:Y.term?.startDate,endDate:Y.term?.endDate}}):y({isValid:!1,errors:U})}catch(K){y({isValid:!1,errors:[`Invalid JSON: ${K.message}`]})}},B=F=>{const U=[];try{const K=S(F);if(!K){k({isValid:!1,errors:["No JSON found"]});return}const Y=JSON.parse(K),se=Y.modules||(Array.isArray(Y)?Y:null);Array.isArray(se)?se.length===0&&U.push("modules array is empty"):U.push("Missing 'modules' array"),U.length===0?k({isValid:!0,errors:[],preview:{moduleCount:se.length}}):k({isValid:!1,errors:U})}catch(K){k({isValid:!1,errors:[`Invalid JSON: ${K.message}`]})}},G=async()=>{try{j(null);const F=await V.brain.ingest(m,"pasted_wrap.md");F.sessionSaved?(j({type:"success",message:`Session saved! ID: ${F.sessionId}, Cards: ${F.cardsCreated||0}`}),g("")):j({type:"error",message:F.errors?.join(", ")||F.message})}catch(F){j({type:"error",message:F.message||"Failed to ingest"})}},W=[{key:"schedule",label:"SCHEDULE",icon:l.jsx($r,{className:"w-3.5 h-3.5"})},{key:"modules",label:"MODULES",icon:l.jsx(Rt,{className:"w-3.5 h-3.5"})},{key:"objectives",label:"OBJECTIVES",icon:l.jsx(Wn,{className:"w-3.5 h-3.5"})}];return l.jsxs("div",{className:"space-y-6 p-4",children:[l.jsx(ao,{}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),l.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:n||"",onChange:F=>{r(F.target.value?parseInt(F.target.value):null),a(null)},children:[l.jsx("option",{value:"",children:"-- Select Course --"}),O.map(F=>l.jsx("option",{value:F.id,children:F.name},F.id))]})]}),!n&&l.jsx("p",{className:"text-center text-muted-foreground font-terminal text-sm py-8",children:"Select a course above to begin ingestion."}),n&&l.jsxs(ee,{className:"bg-black/40 border-2 border-primary rounded-none mb-6",children:[l.jsx(ae,{className:"border-b border-primary/50 p-4",children:l.jsxs(oe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx(xr,{className:"w-4 h-4"}),"WRAP SESSION INGESTION"]})}),l.jsxs(te,{className:"p-4",children:[x&&l.jsx("div",{className:`mb-4 p-3 rounded-none font-terminal text-sm ${x.type==="success"?"bg-green-900/30 border border-green-500 text-green-400":"bg-red-900/30 border border-red-500 text-red-400"}`,children:x.message}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("button",{onClick:()=>R(co),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),l.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Use ChatGPT to convert your notes to WRAP format, then paste or upload below:"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm mb-2 font-terminal text-muted-foreground",children:"Paste WRAP Content"}),l.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-48 font-terminal text-sm",placeholder:"Paste your WRAP session here...",value:m,onChange:F=>{g(F.target.value),j(null)}})]}),l.jsx("button",{onClick:G,disabled:!m,className:"bg-primary hover:bg-primary/80 disabled:opacity-50 px-6 py-3 rounded-none font-arcade text-sm w-full",type:"button",children:"INGEST WRAP SESSION"})]})]})]}),n&&v&&l.jsx("div",{className:"bg-destructive/20 border border-destructive rounded-none p-3 text-destructive font-terminal",children:v}),n&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex border-b border-primary/50",children:W.map(F=>l.jsxs("button",{onClick:()=>o(F.key),className:`flex items-center gap-1.5 px-4 py-2 font-arcade text-xs border-b-2 transition-colors ${s===F.key?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-primary/70"}`,type:"button",children:[F.icon,F.label]},F.key))}),s==="schedule"&&l.jsxs(ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ae,{className:"border-b border-primary/50 p-4",children:l.jsxs(oe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx($r,{className:"w-4 h-4"}),"SCHEDULE IMPORT"]})}),l.jsxs(te,{className:"p-4 space-y-4",children:[l.jsx("button",{onClick:()=>R(so),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),l.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (schedule JSON) below:"}),l.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-40 font-terminal text-sm",placeholder:'{"name":"...","term":{...},"events":[...]}',value:c,onChange:F=>{u(F.target.value),w(null),F.target.value.trim()?L(F.target.value):y(null)}}),E&&!E.isValid&&l.jsxs("div",{className:"p-2 border border-red-500 bg-red-900/30 rounded-none font-terminal text-xs text-red-400",children:[l.jsx("div",{className:"font-bold mb-1",children:"Validation Errors:"}),E.errors.map((F,U)=>l.jsxs("div",{children:["• ",F]},U))]}),E?.isValid&&E.preview&&l.jsxs("div",{className:"p-3 border border-primary bg-primary/10 rounded-none font-terminal text-xs text-primary",children:[l.jsx("div",{className:"font-bold mb-2",children:"Valid JSON Preview:"}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Course:"})," ",E.preview.courseName]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Events:"})," ",E.preview.eventCount]}),E.preview.startDate&&l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Start:"})," ",E.preview.startDate]}),E.preview.endDate&&l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"End:"})," ",E.preview.endDate]})]})]}),l.jsx("button",{onClick:()=>N.mutate(c),disabled:!E?.isValid||N.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:N.isPending?"Importing...":"Import Schedule"}),C&&l.jsx("div",{className:`p-2 border font-terminal text-xs ${C.type==="success"?"border-green-500 text-green-400":"border-red-500 text-red-400"}`,children:C.message})]})]}),s==="modules"&&l.jsxs(ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ae,{className:"border-b border-primary/50 p-4",children:l.jsxs(oe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx(Rt,{className:"w-4 h-4"}),"MODULES IMPORT"]})}),l.jsxs(te,{className:"p-4 space-y-4",children:[l.jsx("button",{onClick:()=>R(oo),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),l.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (modules JSON) below:"}),l.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-40 font-terminal text-sm",placeholder:'{"modules":[{"name":"Module 1: ...","orderIndex":1,"topics":[...],"readings":[...],"assessments":[...]}]}',value:d,onChange:F=>{h(F.target.value),M(null),F.target.value.trim()?B(F.target.value):k(null)}}),T&&!T.isValid&&l.jsxs("div",{className:"p-2 border border-red-500 bg-red-900/30 rounded-none font-terminal text-xs text-red-400",children:[l.jsx("div",{className:"font-bold mb-1",children:"Validation Errors:"}),T.errors.map((F,U)=>l.jsxs("div",{children:["• ",F]},U))]}),T?.isValid&&T.preview&&l.jsxs("div",{className:"p-3 border border-primary bg-primary/10 rounded-none font-terminal text-xs text-primary",children:[l.jsx("div",{className:"font-bold mb-2",children:"Valid JSON Preview:"}),l.jsxs("div",{children:[l.jsx("span",{className:"text-muted-foreground",children:"Modules:"})," ",T.preview.moduleCount]})]}),l.jsx("button",{onClick:()=>I.mutate(d),disabled:!T?.isValid||I.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:I.isPending?"Importing...":"Import Modules"}),_&&l.jsx("div",{className:`p-2 border font-terminal text-xs ${_.type==="success"?"border-green-500 text-green-400":"border-red-500 text-red-400"}`,children:_.message})]})]}),s==="objectives"&&l.jsxs(ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ae,{className:"border-b border-primary/50 p-4",children:l.jsxs(oe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx(Wn,{className:"w-4 h-4"}),"LEARNING OBJECTIVES IMPORT"]})}),l.jsxs(te,{className:"p-4 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs mb-1 font-terminal text-muted-foreground",children:"Target Module (optional)"}),l.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:i||"",onChange:F=>a(F.target.value?parseInt(F.target.value):null),children:[l.jsx("option",{value:"",children:"-- No Module (Course-level) --"}),P.map(F=>l.jsx("option",{value:F.id,children:F.name},F.id))]})]}),l.jsx("button",{onClick:()=>R(lo),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),l.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (JSON array) below:"}),l.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-32 font-terminal text-sm",placeholder:'[{"loCode": "1.1", "title": "Define..."}]',value:f,onChange:F=>p(F.target.value)}),l.jsx("button",{onClick:()=>$.mutate(f),disabled:!f||$.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:$.isPending?"Importing...":"Import LOs"}),z.length>0&&l.jsxs("div",{children:[l.jsxs("h4",{className:"font-terminal text-xs mb-2",children:["Current LOs (",z.length,")"]}),l.jsx("div",{className:"max-h-48 overflow-y-auto",children:z.map(F=>l.jsxs("div",{className:"text-xs py-1 border-b border-secondary/30 font-terminal",children:[l.jsx("span",{className:"text-primary",children:F.loCode}),": ",F.title,l.jsx("span",{className:`ml-2 text-[10px] px-1 rounded ${F.status==="solid"?"bg-green-600":F.status==="in_progress"?"bg-yellow-600":F.status==="need_review"?"bg-orange-600":"bg-gray-600"}`,children:F.status})]},F.id))})]})]})]})]})]})}function fo(){const e=ht(),[n,r]=D.useState(null),[i,a]=D.useState({}),[s,o]=D.useState({}),[c,u]=D.useState(new Set),[d,h]=D.useState(new Set),[f,p]=D.useState(null),m=D.useRef(null),{data:g=[]}=X({queryKey:["courses"],queryFn:()=>V.courses.getActive()}),{data:v=[]}=X({queryKey:["modules",n],queryFn:()=>n?V.modules.getByCourse(n):Promise.resolve([]),enabled:!!n}),{data:b=[]}=X({queryKey:["scheduleEvents",n],queryFn:()=>n?V.scheduleEvents.getByCourse(n):Promise.resolve([]),enabled:!!n}),x=de({mutationFn:({id:y,data:T})=>V.modules.update(y,T),onSuccess:()=>{e.invalidateQueries({queryKey:["modules"]})}}),j=de({mutationFn:y=>V.modules.delete(y),onSuccess:()=>{e.invalidateQueries({queryKey:["modules"]})}}),C=de({mutationFn:y=>V.modules.deleteMany(y),onSuccess:()=>{e.invalidateQueries({queryKey:["modules"]}),u(new Set)}}),w=de({mutationFn:({id:y,data:T})=>V.scheduleEvents.update(y,T),onSuccess:()=>{e.invalidateQueries({queryKey:["scheduleEvents"]})}}),_=de({mutationFn:y=>V.scheduleEvents.delete(y),onSuccess:()=>{e.invalidateQueries({queryKey:["scheduleEvents"]})}}),M=de({mutationFn:y=>V.scheduleEvents.deleteMany(y),onSuccess:()=>{e.invalidateQueries({queryKey:["scheduleEvents"]}),h(new Set)}}),E=(y,T,k)=>{if(!T.length)return;const O={type:y,ids:T,label:k};m.current=O,p(O)};return l.jsxs("div",{className:"space-y-6 p-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),l.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:n||"",onChange:y=>{r(y.target.value?parseInt(y.target.value):null)},children:[l.jsx("option",{value:"",children:"-- Select Course --"}),g.map(y=>l.jsx("option",{value:y.id,children:y.name},y.id))]})]}),n&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs(ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ae,{className:"border-b border-primary/50 p-3",children:l.jsxs(oe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx(xr,{className:"w-4 h-4"}),"MODULES (",v.length,")"]})}),l.jsx(te,{className:"p-0",children:v.length===0?l.jsx("p",{className:"text-xs text-muted-foreground font-terminal p-4",children:"No modules yet. Import a syllabus to add modules."}):l.jsxs("div",{className:"p-3 space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>{const y=new Set;c.size!==v.length&&v.forEach(T=>y.add(T.id)),u(y)},children:c.size===v.length?"Uncheck All":"Check All"}),l.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:c.size===0,onClick:()=>{E("modules",Array.from(c),`Delete ${c.size} module(s)? This cannot be undone.`)},children:"Delete"}),l.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:c.size===0,onClick:()=>{c.forEach(y=>{const T=i[y];T&&x.mutate({id:y,data:T})}),a(y=>{const T={...y};return c.forEach(k=>{delete T[k]}),T})},children:"Save"})]}),l.jsx(Ye,{className:"h-[280px]",children:l.jsxs("table",{className:"w-full text-sm font-terminal",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-secondary/50",children:[l.jsx("th",{className:"text-center p-2 w-8",children:"Select"}),l.jsx("th",{className:"text-left p-2",children:"Module"}),l.jsx("th",{className:"text-center p-2",children:"Order"}),l.jsx("th",{className:"text-center p-2",children:"Files"}),l.jsx("th",{className:"text-center p-2",children:"NotebookLM"}),l.jsx("th",{className:"text-center p-2",children:"Status"}),l.jsx("th",{className:"text-center p-2",children:"Actions"})]})}),l.jsx("tbody",{children:v.map(y=>l.jsxs("tr",{className:"border-b border-secondary/30",children:[l.jsx("td",{className:"text-center p-2",children:l.jsx(ye,{checked:c.has(y.id),onCheckedChange:T=>u(k=>{const O=new Set(k);return T?O.add(y.id):O.delete(y.id),O}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),l.jsx("td",{className:"p-2",children:l.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:i[y.id]?.name??y.name,onChange:T=>a(k=>({...k,[y.id]:{...k[y.id],name:T.target.value}}))})}),l.jsx("td",{className:"text-center p-2",children:l.jsx("input",{type:"number",className:"w-16 bg-black border border-secondary rounded-none p-1 text-xs font-terminal text-center",value:i[y.id]?.orderIndex??y.orderIndex??0,onChange:T=>a(k=>({...k,[y.id]:{...k[y.id],orderIndex:parseInt(T.target.value||"0",10)}}))})}),l.jsx("td",{className:"text-center p-2",children:l.jsx(ye,{checked:y.filesDownloaded,onCheckedChange:T=>x.mutate({id:y.id,data:{filesDownloaded:!!T}}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),l.jsx("td",{className:"text-center p-2",children:l.jsx(ye,{checked:y.notebooklmLoaded,onCheckedChange:T=>x.mutate({id:y.id,data:{notebooklmLoaded:!!T}}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),l.jsx("td",{className:"text-center p-2",children:y.filesDownloaded&&y.notebooklmLoaded?l.jsx("span",{className:"text-green-400",children:"Ready"}):l.jsx("span",{className:"text-yellow-400",children:"Pending"})}),l.jsxs("td",{className:"text-center p-2 space-x-2",children:[l.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:!i[y.id],onClick:()=>{const T=i[y.id];T&&(x.mutate({id:y.id,data:T}),a(k=>{const O={...k};return delete O[y.id],O}))},children:"Save"}),l.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>j.mutate(y.id),children:"Delete"})]})]},y.id))})]})})]})})]}),l.jsxs(ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ae,{className:"border-b border-primary/50 p-3",children:l.jsxs(oe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx(Rt,{className:"w-4 h-4"}),"SCHEDULE ITEMS (",b.length,")"]})}),l.jsx(te,{className:"p-0",children:b.length===0?l.jsx("p",{className:"text-xs text-muted-foreground font-terminal p-4",children:"No schedule items yet. Import a syllabus to add events."}):l.jsxs("div",{className:"p-3 space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>{const y=new Set;d.size!==b.length&&b.forEach(T=>y.add(T.id)),h(y)},children:d.size===b.length?"Uncheck All":"Check All"}),l.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:d.size===0,onClick:()=>{E("schedule",Array.from(d),`Delete ${d.size} schedule item(s)? This cannot be undone.`)},children:"Delete"}),l.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:d.size===0,onClick:()=>{d.forEach(y=>{const T=s[y];T&&w.mutate({id:y,data:T})}),o(y=>{const T={...y};return d.forEach(k=>{delete T[k]}),T})},children:"Save"})]}),l.jsx(Ye,{className:"h-[280px]",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-xs font-terminal",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-secondary/50",children:[l.jsx("th",{className:"text-center p-2 w-8",children:"Select"}),l.jsx("th",{className:"text-left p-2",children:"Type"}),l.jsx("th",{className:"text-left p-2",children:"Title"}),l.jsx("th",{className:"text-center p-2",children:"Date"}),l.jsx("th",{className:"text-center p-2",children:"Start"}),l.jsx("th",{className:"text-center p-2",children:"End"}),l.jsx("th",{className:"text-center p-2",children:"Due"}),l.jsx("th",{className:"text-left p-2",children:"Notes"}),l.jsx("th",{className:"text-center p-2",children:"Actions"})]})}),l.jsx("tbody",{children:b.map(y=>{const T=s[y.id]||{},k=T.type??y.type??"",O=T.title??y.title??"",P=T.date??y.date??"",z=T.startTime??y.startTime??"",S=T.endTime??y.endTime??"",R=T.dueDate??y.dueDate??"",N=T.notes??y.notes??"",I=!!s[y.id];return l.jsxs("tr",{className:"border-b border-secondary/30 align-top",children:[l.jsx("td",{className:"text-center p-2",children:l.jsx(ye,{checked:d.has(y.id),onCheckedChange:$=>h(L=>{const B=new Set(L);return $?B.add(y.id):B.delete(y.id),B}),className:"rounded-none border-secondary data-[state=checked]:bg-secondary w-4 h-4"})}),l.jsx("td",{className:"p-2",children:l.jsx("select",{className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:k,onChange:$=>o(L=>({...L,[y.id]:{...L[y.id],type:$.target.value}})),children:["class","lecture","reading","topic","assignment","quiz","exam","assessment","other"].map($=>l.jsx("option",{value:$,children:$},$))})}),l.jsx("td",{className:"p-2",children:l.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:O,onChange:$=>o(L=>({...L,[y.id]:{...L[y.id],title:$.target.value}}))})}),l.jsx("td",{className:"text-center p-2",children:l.jsx("input",{type:"date",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:P||"",onChange:$=>o(L=>({...L,[y.id]:{...L[y.id],date:$.target.value}}))})}),l.jsx("td",{className:"text-center p-2",children:l.jsx("input",{type:"time",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:z||"",onChange:$=>o(L=>({...L,[y.id]:{...L[y.id],startTime:$.target.value}}))})}),l.jsx("td",{className:"text-center p-2",children:l.jsx("input",{type:"time",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:S||"",onChange:$=>o(L=>({...L,[y.id]:{...L[y.id],endTime:$.target.value}}))})}),l.jsx("td",{className:"text-center p-2",children:l.jsx("input",{type:"date",className:"bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:R||"",onChange:$=>o(L=>({...L,[y.id]:{...L[y.id],dueDate:$.target.value}}))})}),l.jsx("td",{className:"p-2",children:l.jsx("input",{className:"w-full bg-black border border-secondary rounded-none p-1 text-xs font-terminal",value:N||"",onChange:$=>o(L=>({...L,[y.id]:{...L[y.id],notes:$.target.value}}))})}),l.jsxs("td",{className:"text-center p-2 space-x-2",children:[l.jsx("button",{className:"bg-secondary hover:bg-secondary/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",disabled:!I,onClick:()=>{w.mutate({id:y.id,data:{type:k,title:O,date:P,startTime:z,endTime:S,dueDate:R,notes:N}}),o($=>{const L={...$};return delete L[y.id],L})},children:"Save"}),l.jsx("button",{className:"bg-destructive hover:bg-destructive/80 px-2 py-1 rounded-none text-[10px] font-terminal",type:"button",onClick:()=>_.mutate(y.id),children:"Delete"})]})]},y.id)})})]})})})]})})]})]}),l.jsx(sa,{open:!!f,onOpenChange:y=>!y&&p(null),children:l.jsxs(oa,{className:"bg-black border-2 border-primary rounded-none font-terminal text-primary shadow-none max-w-md translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[l.jsxs(la,{className:"text-left",children:[l.jsx(ca,{className:"font-arcade text-destructive",children:"CONFIRM_DELETE"}),l.jsx(ua,{className:"font-terminal text-muted-foreground",children:f?.label})]}),l.jsxs(da,{className:"gap-2 sm:justify-end",children:[l.jsx(fa,{className:"rounded-none border-secondary font-terminal text-xs hover:bg-secondary/20",onClick:()=>{m.current=null,p(null)},children:"CANCEL"}),l.jsx(ha,{className:"rounded-none bg-destructive text-destructive-foreground font-arcade text-xs hover:bg-destructive/80",type:"button",onClick:()=>{const y=m.current;y&&(y.type==="modules"?C.mutate(y.ids):M.mutate(y.ids),m.current=null,p(null))},children:"DELETE"})]})]})})]})}function ho(){const[e,n]=D.useState(null),{data:r=[]}=X({queryKey:["courses"],queryFn:async()=>{const f=await fetch("/api/courses");if(!f.ok)throw new Error("Failed to fetch courses");return f.json()}}),{data:i=[],isLoading:a}=X({queryKey:["modules",e],queryFn:()=>e?V.modules.getByCourse(e):Promise.resolve([]),enabled:!!e}),{data:s=[]}=X({queryKey:["learningObjectives",e],queryFn:()=>e?V.learningObjectives.getByCourse(e):Promise.resolve([]),enabled:!!e}),{data:o=[]}=X({queryKey:["scheduleEvents",e],queryFn:()=>e?V.scheduleEvents.getByCourse(e):Promise.resolve([]),enabled:!!e}),c=i.reduce((f,p)=>{const m=p.orderIndex||0;return f[m]||(f[m]=[]),f[m].push(p),f},{}),u=s.reduce((f,p)=>{const m=p.moduleId||0;return f[m]||(f[m]=[]),f[m].push(p),f},{}),d=o.reduce((f,p)=>{const m=p.linkedModuleId||0;return f[m]||(f[m]=[]),f[m].push(p),f},{}),h=i.length>0||s.length>0||o.length>0;return l.jsxs("div",{className:"space-y-4 p-4",children:[l.jsxs(ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ae,{className:"border-b border-primary/50 p-3",children:l.jsx(oe,{className:"font-arcade text-sm",children:"SELECT COURSE"})}),l.jsx(te,{className:"p-3",children:l.jsxs(Ct,{value:e?.toString()||"",onValueChange:f=>n(f?parseInt(f):null),children:[l.jsx(At,{className:"rounded-none border-primary",children:l.jsx(Tt,{placeholder:"Choose a course..."})}),l.jsx(Ot,{children:r.map(f=>l.jsx(le,{value:f.id.toString(),children:f.name},f.id))})]})})]}),e?a?l.jsx(ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:l.jsx(te,{className:"p-8 text-center",children:l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Loading syllabus..."})})}):h?l.jsx(Ye,{className:"h-[600px]",children:l.jsx("div",{className:"space-y-4 pr-4",children:Object.entries(c).sort(([f],[p])=>parseInt(f)-parseInt(p)).map(([f,p])=>l.jsxs(ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ae,{className:"border-b border-primary/50 p-3",children:l.jsxs(oe,{className:"font-arcade text-sm",children:["WEEK ",f]})}),l.jsx(te,{className:"p-3 space-y-3",children:p.map(m=>l.jsxs("div",{className:"space-y-2 border-l-2 border-secondary/40 pl-3",children:[l.jsx("div",{className:"font-arcade text-xs text-primary",children:m.name}),u[m.id]&&u[m.id].length>0&&l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground uppercase",children:"Objectives"}),l.jsx("div",{className:"space-y-1",children:u[m.id].map(g=>l.jsxs("div",{className:"font-terminal text-xs text-secondary",children:["• ",g.loCode,": ",g.title]},g.id))})]}),d[m.id]&&d[m.id].length>0&&l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground uppercase",children:"Events"}),l.jsx("div",{className:"space-y-1",children:d[m.id].map(g=>l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(un,{variant:"outline",className:`text-[10px] font-terminal ${g.type==="quiz"?"border-yellow-500/50 text-yellow-400":g.type==="exam"?"border-red-500/50 text-red-400":"border-blue-500/50 text-blue-400"}`,children:g.type?.toUpperCase()}),l.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:g.title}),g.dueDate&&l.jsx("span",{className:"font-terminal text-[10px] text-secondary ml-auto",children:new Date(g.dueDate).toLocaleDateString()})]},g.id))})]})]},m.id))})]},f))})}):l.jsx(ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:l.jsx(te,{className:"p-8 text-center",children:l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"No syllabus imported"})})}):l.jsx(ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:l.jsx(te,{className:"p-8 text-center",children:l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Select a course to view syllabus"})})})]})}function Fr(e,n){if(n.length===0)return e;const r=[];for(const i of n)r.push({type:"image_url",image_url:{url:i}});return e.trim()&&r.push({type:"text",text:e}),r}const po=`Generate Anki flashcards from the following study material. Output ONLY a numbered list in this exact format:

1. Front: [question]
Back: [answer]
Tags: [comma-separated tags like: Module1, Obj2, TopicName]

Rules:
- Front = the question only (no module/objective prefixes)
- Back = concise answer
- Tags = include Module#, Obj#, and topic keywords
- One card per concept
- No extra text before or after the list

Study material:
[PASTE YOUR NOTES HERE]`;function mo(){const[e,n]=D.useState(!1),[r,i]=D.useState("chat"),[a,s]=D.useState([]),[o,c]=D.useState(""),[u,d]=D.useState([]),[h,f]=D.useState(!1),[p,m]=D.useState("anki"),[g,v]=D.useState(!1),b=D.useRef(null),x=D.useRef(null),j=ht(),C=D.useCallback(()=>{b.current&&(b.current.scrollTop=b.current.scrollHeight)},[]);D.useEffect(()=>{C()},[a,C]);const w=O=>{const P=new FileReader;P.onload=()=>{typeof P.result=="string"&&d(z=>[...z,P.result])},P.readAsDataURL(O)},_=O=>{const P=O.clipboardData?.items;if(P){for(const z of Array.from(P))if(z.type.startsWith("image/")){O.preventDefault();const S=z.getAsFile();S&&w(S)}}},M=O=>{const P=O.target.files;if(P){for(const z of Array.from(P))z.type.startsWith("image/")&&w(z);O.target.value=""}},E=async(O,P)=>{s($=>[...$,{role:"assistant",content:""}]);const z=a.map($=>({role:$.role,content:$.images?.length?Fr($.content,$.images):$.content})).concat([{role:"user",content:Fr(O,P)}]),R=(await fetch("/api/brain/quick-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:z})})).body?.getReader(),N=new TextDecoder;if(!R)throw new Error("No response body");let I="";for(;;){const{done:$,value:L}=await R.read();if($)break;I+=N.decode(L,{stream:!0});const B=I.split(`
`);I=B.pop()??"";for(const G of B){if(!G.startsWith("data: "))continue;const W=G.slice(6);if(W==="[DONE]")break;try{const F=JSON.parse(W);if(F.error){s(U=>{const K=[...U];return K[K.length-1]={role:"assistant",content:`Error: ${F.error}`},K});return}F.content&&s(U=>{const K=[...U],Y=K[K.length-1];return K[K.length-1]={...Y,content:Y.content+F.content},K})}catch{}}}},y=async O=>{try{const P=p==="both"?"all":p,z=p==="obsidian"||p==="both",S=await V.brain.chat(O,z,P);let R=S.response;const N={cardsCreated:S.cardsCreated,sessionSaved:S.sessionSaved,sessionId:S.sessionId},I=[];S.sessionSaved&&I.push(`Session saved (ID: ${S.sessionId})`),S.cardsCreated&&I.push(`${S.cardsCreated} Anki cards created`),S.obsidianSynced&&I.push("Synced to Obsidian"),S.obsidianError&&I.push(`Obsidian error: ${S.obsidianError}`),I.length>0&&(R=`${I.join(" | ")}

${R}`),s($=>[...$,{role:"assistant",content:R,meta:N}]),j.invalidateQueries({queryKey:["anki","drafts"]}),j.invalidateQueries({queryKey:["brain","metrics"]}),j.invalidateQueries({queryKey:["sessions"]})}catch(P){s(z=>[...z,{role:"assistant",content:`Error: ${P}`}])}},T=async()=>{const O=o.trim();if(!O&&u.length===0)return;const P={role:"user",content:O,images:[...u]};s(z=>[...z,P]),c(""),d([]),f(!0);try{r==="chat"?await E(O,P.images??[]):await y(O)}catch(z){s(S=>{const R=S[S.length-1];if(R?.role==="assistant"&&!R.content){const N=[...S];return N[N.length-1]={role:"assistant",content:`Error: ${z}`},N}return[...S,{role:"assistant",content:`Error: ${z}`}]})}finally{f(!1)}},k=O=>{O.key==="Enter"&&!O.shiftKey&&(O.preventDefault(),T())};return e?l.jsxs(ee,{className:"bg-black/40 border-2 border-primary rounded-none mb-4",children:[l.jsxs(ae,{className:"py-2 px-4 flex flex-row items-center justify-between",children:[l.jsx(oe,{className:"text-xs",children:"BRAIN CHAT"}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsxs("div",{className:"flex bg-secondary/40 border border-secondary/60 rounded overflow-hidden mr-2",children:[l.jsxs("button",{onClick:()=>i("chat"),className:`flex items-center gap-1 px-2 py-0.5 text-[10px] transition-colors ${r==="chat"?"bg-primary/30 text-primary":"text-muted-foreground hover:text-foreground"}`,children:[l.jsx(Rs,{className:"w-3 h-3"})," CHAT"]}),l.jsxs("button",{onClick:()=>i("ingest"),className:`flex items-center gap-1 px-2 py-0.5 text-[10px] transition-colors ${r==="ingest"?"bg-primary/30 text-primary":"text-muted-foreground hover:text-foreground"}`,children:[l.jsx(Qs,{className:"w-3 h-3"})," INGEST"]})]}),r==="ingest"&&l.jsx("button",{type:"button",className:"bg-primary hover:bg-primary/80 px-2 py-0.5 rounded-none text-[10px] font-terminal",onClick:()=>{navigator.clipboard.writeText(po),v(!0),setTimeout(()=>v(!1),2e3)},children:g?"Copied!":"Copy Prompt for ChatGPT"}),l.jsx(ne,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>n(!1),children:l.jsx(qs,{className:"w-4 h-4"})})]})]}),l.jsxs(te,{className:"p-0",children:[l.jsxs("div",{className:"px-4 py-1 border-b border-border flex items-center justify-between",children:[l.jsx("p",{className:"text-[10px] text-muted-foreground",children:r==="chat"?"General chat with Gemini Flash — ask anything, paste screenshots":"Study ingestion — paste notes to create Anki cards & save sessions"}),r==="ingest"&&l.jsx("div",{className:"flex bg-secondary/40 border border-secondary/60 rounded overflow-hidden",children:["anki","obsidian","both"].map(O=>l.jsxs("button",{onClick:()=>m(O),className:`flex items-center gap-1 px-2 py-0.5 text-[10px] transition-colors ${p===O?"bg-primary/30 text-primary":"text-muted-foreground hover:text-foreground"}`,children:[O==="anki"&&l.jsxs(l.Fragment,{children:[l.jsx(Rt,{className:"w-3 h-3"})," ANKI"]}),O==="obsidian"&&l.jsxs(l.Fragment,{children:[l.jsx(Wn,{className:"w-3 h-3"})," OBSIDIAN"]}),O==="both"&&l.jsx(l.Fragment,{children:"BOTH"})]},O))})]}),l.jsxs("div",{ref:b,className:"h-80 overflow-y-auto px-4 py-2 space-y-3",children:[a.length===0&&l.jsx("p",{className:"text-muted-foreground text-xs text-center py-8",children:r==="chat"?"Ask anything. Paste screenshots with Ctrl+V.":"Paste your study notes to ingest into Brain."}),a.map((O,P)=>l.jsx("div",{className:`flex ${O.role==="user"?"justify-end":"justify-start"}`,children:l.jsxs("div",{className:`max-w-[80%] rounded px-3 py-2 text-base whitespace-pre-wrap ${O.role==="user"?"bg-primary/20 text-foreground border border-primary/30":"bg-secondary/40 text-foreground border border-secondary/60"}`,children:[O.images?.map((z,S)=>l.jsx("img",{src:z,alt:"attached",className:"max-h-32 rounded mb-1"},S)),O.content]})},P)),h&&l.jsx("div",{className:"flex justify-start",children:l.jsx("div",{className:"bg-secondary/40 border border-secondary/60 rounded px-3 py-2",children:l.jsx(Us,{className:"w-4 h-4 animate-spin text-primary"})})})]}),u.length>0&&l.jsx("div",{className:"px-4 py-1 flex gap-2 flex-wrap",children:u.map((O,P)=>l.jsxs("div",{className:"relative",children:[l.jsx("img",{src:O,alt:"pending",className:"h-12 rounded border border-primary/30"}),l.jsx("button",{onClick:()=>d(z=>z.filter((S,R)=>R!==P)),className:"absolute -top-1 -right-1 bg-destructive rounded-full p-0.5",children:l.jsx(It,{className:"w-3 h-3"})})]},P))}),l.jsxs("div",{className:"flex items-end gap-2 px-4 py-2 border-t border-border",children:[l.jsx("input",{ref:x,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:M}),r==="chat"&&l.jsx(ne,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 shrink-0",onClick:()=>x.current?.click(),children:l.jsx(io,{className:"w-4 h-4 text-primary"})}),l.jsx("textarea",{value:o,onChange:O=>c(O.target.value),onKeyDown:k,onPaste:_,placeholder:r==="chat"?"Ask anything... (Ctrl+V to paste images)":"Paste study notes to ingest...",rows:r==="ingest"?3:1,className:"flex-1 bg-transparent border border-input rounded px-3 py-1.5 text-base resize-none focus:outline-none focus:ring-1 focus:ring-ring"}),l.jsx(ne,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 shrink-0",onClick:T,disabled:h,children:l.jsx(Is,{className:"w-4 h-4 text-primary"})})]})]})]}):l.jsxs("button",{onClick:()=>n(!0),className:"w-full flex items-center justify-between bg-black/40 border-2 border-primary rounded-none px-4 py-2 mb-4 text-sm text-primary hover:bg-primary/10 transition-colors",children:[l.jsxs("span",{className:"font-arcade text-xs tracking-widest uppercase flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-2 bg-primary inline-block"}),"BRAIN CHAT"]}),l.jsx(Ms,{className:"w-4 h-4"})]})}function go(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,s,o,c=[],u=!0,d=!1;try{if(s=(r=r.call(e)).next,n===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(i=s.call(r)).done)&&(c.push(i.value),c.length!==n);u=!0);}catch(h){d=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return c}}function xo(e,n,r){return n=ko(n),n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function Lr(e,n){return vo(e)||go(e,n)||pa(e,n)||No()}function yo(e){return bo(e)||_o(e)||pa(e)||wo()}function bo(e){if(Array.isArray(e))return Kn(e)}function vo(e){if(Array.isArray(e))return e}function _o(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pa(e,n){if(e){if(typeof e=="string")return Kn(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kn(e,n)}}function Kn(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,i=new Array(n);r<n;r++)i[r]=e[r];return i}function wo(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function No(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jo(e,n){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function ko(e){var n=jo(e,"string");return typeof n=="symbol"?n:String(n)}var So=function(n,r){var i=new Set(r);return Object.assign.apply(Object,[{}].concat(yo(Object.entries(n).filter(function(a){var s=Lr(a,1),o=s[0];return!i.has(o)}).map(function(a){var s=Lr(a,2),o=s[0],c=s[1];return xo({},o,c)}))))};function Yn(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,i=Array(n);r<n;r++)i[r]=e[r];return i}function Co(e){if(Array.isArray(e))return e}function Ao(e){if(Array.isArray(e))return Yn(e)}function To(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Oo(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,s,o,c=[],u=!0,d=!1;try{if(s=(r=r.call(e)).next,n!==0)for(;!(u=(i=s.call(r)).done)&&(c.push(i.value),c.length!==n);u=!0);}catch(h){d=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return c}}function Mo(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eo(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Po(e,n){return Co(e)||Oo(e,n)||ma(e,n)||Mo()}function qr(e){return Ao(e)||To(e)||ma(e)||Eo()}function ma(e,n){if(e){if(typeof e=="string")return Yn(e,n);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Yn(e,n):void 0}}function Io(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.wrapperElementType,i=r===void 0?"div":r,a=n.nodeMapper,s=a===void 0?function(h){return h}:a,o=n.methodNames,c=o===void 0?[]:o,u=n.initPropNames,d=u===void 0?[]:u;return D.forwardRef(function(h,f){var p=D.useRef(),m=D.useMemo(function(){var b=Object.fromEntries(d.filter(function(x){return h.hasOwnProperty(x)}).map(function(x){return[x,h[x]]}));return e(b)},[]);Ur(function(){m(s(p.current))},D.useLayoutEffect),Ur(function(){return m._destructor instanceof Function?m._destructor:void 0});var g=D.useCallback(function(b){for(var x=arguments.length,j=new Array(x>1?x-1:0),C=1;C<x;C++)j[C-1]=arguments[C];return m[b]instanceof Function?m[b].apply(m,j):void 0},[m]),v=D.useRef({});return Object.keys(So(h,[].concat(qr(c),qr(d)))).filter(function(b){return v.current[b]!==h[b]}).forEach(function(b){return g(b,h[b])}),v.current=h,D.useImperativeHandle(f,function(){return Object.fromEntries(c.map(function(b){return[b,function(){for(var x=arguments.length,j=new Array(x),C=0;C<x;C++)j[C]=arguments[C];return g.apply(void 0,[b].concat(j))}]}))},[g]),Ts.createElement(i,{ref:p})})}function Ur(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:D.useEffect,r=D.useRef(),i=D.useRef(!1),a=D.useRef(!1),s=D.useState(0),o=Po(s,2);o[0];var c=o[1];i.current&&(a.current=!0),n(function(){return i.current||(r.current=e(),i.current=!0),c(function(u){return u+1}),function(){a.current&&r.current&&r.current()}},[])}var Jn="http://www.w3.org/1999/xhtml";const Hr={svg:"http://www.w3.org/2000/svg",xhtml:Jn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Nn(e){var n=e+="",r=n.indexOf(":");return r>=0&&(n=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),Hr.hasOwnProperty(n)?{space:Hr[n],local:e}:e}function Ro(e){return function(){var n=this.ownerDocument,r=this.namespaceURI;return r===Jn&&n.documentElement.namespaceURI===Jn?n.createElement(e):n.createElementNS(r,e)}}function Do(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ga(e){var n=Nn(e);return(n.local?Do:Ro)(n)}function zo(){}function yr(e){return e==null?zo:function(){return this.querySelector(e)}}function $o(e){typeof e!="function"&&(e=yr(e));for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a)for(var s=n[a],o=s.length,c=i[a]=new Array(o),u,d,h=0;h<o;++h)(u=s[h])&&(d=e.call(u,u.__data__,h,s))&&("__data__"in u&&(d.__data__=u.__data__),c[h]=d);return new be(i,this._parents)}function Fo(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Lo(){return[]}function xa(e){return e==null?Lo:function(){return this.querySelectorAll(e)}}function qo(e){return function(){return Fo(e.apply(this,arguments))}}function Uo(e){typeof e=="function"?e=qo(e):e=xa(e);for(var n=this._groups,r=n.length,i=[],a=[],s=0;s<r;++s)for(var o=n[s],c=o.length,u,d=0;d<c;++d)(u=o[d])&&(i.push(e.call(u,u.__data__,d,o)),a.push(u));return new be(i,a)}function ya(e){return function(){return this.matches(e)}}function ba(e){return function(n){return n.matches(e)}}var Ho=Array.prototype.find;function Bo(e){return function(){return Ho.call(this.children,e)}}function Vo(){return this.firstElementChild}function Go(e){return this.select(e==null?Vo:Bo(typeof e=="function"?e:ba(e)))}var Wo=Array.prototype.filter;function Ko(){return Array.from(this.children)}function Yo(e){return function(){return Wo.call(this.children,e)}}function Jo(e){return this.selectAll(e==null?Ko:Yo(typeof e=="function"?e:ba(e)))}function Xo(e){typeof e!="function"&&(e=ya(e));for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a)for(var s=n[a],o=s.length,c=i[a]=[],u,d=0;d<o;++d)(u=s[d])&&e.call(u,u.__data__,d,s)&&c.push(u);return new be(i,this._parents)}function va(e){return new Array(e.length)}function Qo(){return new be(this._enter||this._groups.map(va),this._parents)}function dn(e,n){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=n}dn.prototype={constructor:dn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,n){return this._parent.insertBefore(e,n)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Zo(e){return function(){return e}}function el(e,n,r,i,a,s){for(var o=0,c,u=n.length,d=s.length;o<d;++o)(c=n[o])?(c.__data__=s[o],i[o]=c):r[o]=new dn(e,s[o]);for(;o<u;++o)(c=n[o])&&(a[o]=c)}function tl(e,n,r,i,a,s,o){var c,u,d=new Map,h=n.length,f=s.length,p=new Array(h),m;for(c=0;c<h;++c)(u=n[c])&&(p[c]=m=o.call(u,u.__data__,c,n)+"",d.has(m)?a[c]=u:d.set(m,u));for(c=0;c<f;++c)m=o.call(e,s[c],c,s)+"",(u=d.get(m))?(i[c]=u,u.__data__=s[c],d.delete(m)):r[c]=new dn(e,s[c]);for(c=0;c<h;++c)(u=n[c])&&d.get(p[c])===u&&(a[c]=u)}function nl(e){return e.__data__}function rl(e,n){if(!arguments.length)return Array.from(this,nl);var r=n?tl:el,i=this._parents,a=this._groups;typeof e!="function"&&(e=Zo(e));for(var s=a.length,o=new Array(s),c=new Array(s),u=new Array(s),d=0;d<s;++d){var h=i[d],f=a[d],p=f.length,m=il(e.call(h,h&&h.__data__,d,i)),g=m.length,v=c[d]=new Array(g),b=o[d]=new Array(g),x=u[d]=new Array(p);r(h,f,v,b,x,m,n);for(var j=0,C=0,w,_;j<g;++j)if(w=v[j]){for(j>=C&&(C=j+1);!(_=b[C])&&++C<g;);w._next=_||null}}return o=new be(o,i),o._enter=c,o._exit=u,o}function il(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function al(){return new be(this._exit||this._groups.map(va),this._parents)}function sl(e,n,r){var i=this.enter(),a=this,s=this.exit();return typeof e=="function"?(i=e(i),i&&(i=i.selection())):i=i.append(e+""),n!=null&&(a=n(a),a&&(a=a.selection())),r==null?s.remove():r(s),i&&a?i.merge(a).order():a}function ol(e){for(var n=e.selection?e.selection():e,r=this._groups,i=n._groups,a=r.length,s=i.length,o=Math.min(a,s),c=new Array(a),u=0;u<o;++u)for(var d=r[u],h=i[u],f=d.length,p=c[u]=new Array(f),m,g=0;g<f;++g)(m=d[g]||h[g])&&(p[g]=m);for(;u<a;++u)c[u]=r[u];return new be(c,this._parents)}function ll(){for(var e=this._groups,n=-1,r=e.length;++n<r;)for(var i=e[n],a=i.length-1,s=i[a],o;--a>=0;)(o=i[a])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function cl(e){e||(e=ul);function n(f,p){return f&&p?e(f.__data__,p.__data__):!f-!p}for(var r=this._groups,i=r.length,a=new Array(i),s=0;s<i;++s){for(var o=r[s],c=o.length,u=a[s]=new Array(c),d,h=0;h<c;++h)(d=o[h])&&(u[h]=d);u.sort(n)}return new be(a,this._parents).order()}function ul(e,n){return e<n?-1:e>n?1:e>=n?0:NaN}function dl(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function fl(){return Array.from(this)}function hl(){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],a=0,s=i.length;a<s;++a){var o=i[a];if(o)return o}return null}function pl(){let e=0;for(const n of this)++e;return e}function ml(){return!this.node()}function gl(e){for(var n=this._groups,r=0,i=n.length;r<i;++r)for(var a=n[r],s=0,o=a.length,c;s<o;++s)(c=a[s])&&e.call(c,c.__data__,s,a);return this}function xl(e){return function(){this.removeAttribute(e)}}function yl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function bl(e,n){return function(){this.setAttribute(e,n)}}function vl(e,n){return function(){this.setAttributeNS(e.space,e.local,n)}}function _l(e,n){return function(){var r=n.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function wl(e,n){return function(){var r=n.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function Nl(e,n){var r=Nn(e);if(arguments.length<2){var i=this.node();return r.local?i.getAttributeNS(r.space,r.local):i.getAttribute(r)}return this.each((n==null?r.local?yl:xl:typeof n=="function"?r.local?wl:_l:r.local?vl:bl)(r,n))}function _a(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function jl(e){return function(){this.style.removeProperty(e)}}function kl(e,n,r){return function(){this.style.setProperty(e,n,r)}}function Sl(e,n,r){return function(){var i=n.apply(this,arguments);i==null?this.style.removeProperty(e):this.style.setProperty(e,i,r)}}function Cl(e,n,r){return arguments.length>1?this.each((n==null?jl:typeof n=="function"?Sl:kl)(e,n,r??"")):ct(this.node(),e)}function ct(e,n){return e.style.getPropertyValue(n)||_a(e).getComputedStyle(e,null).getPropertyValue(n)}function Al(e){return function(){delete this[e]}}function Tl(e,n){return function(){this[e]=n}}function Ol(e,n){return function(){var r=n.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function Ml(e,n){return arguments.length>1?this.each((n==null?Al:typeof n=="function"?Ol:Tl)(e,n)):this.node()[e]}function wa(e){return e.trim().split(/^|\s+/)}function br(e){return e.classList||new Na(e)}function Na(e){this._node=e,this._names=wa(e.getAttribute("class")||"")}Na.prototype={add:function(e){var n=this._names.indexOf(e);n<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var n=this._names.indexOf(e);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function ja(e,n){for(var r=br(e),i=-1,a=n.length;++i<a;)r.add(n[i])}function ka(e,n){for(var r=br(e),i=-1,a=n.length;++i<a;)r.remove(n[i])}function El(e){return function(){ja(this,e)}}function Pl(e){return function(){ka(this,e)}}function Il(e,n){return function(){(n.apply(this,arguments)?ja:ka)(this,e)}}function Rl(e,n){var r=wa(e+"");if(arguments.length<2){for(var i=br(this.node()),a=-1,s=r.length;++a<s;)if(!i.contains(r[a]))return!1;return!0}return this.each((typeof n=="function"?Il:n?El:Pl)(r,n))}function Dl(){this.textContent=""}function zl(e){return function(){this.textContent=e}}function $l(e){return function(){var n=e.apply(this,arguments);this.textContent=n??""}}function Fl(e){return arguments.length?this.each(e==null?Dl:(typeof e=="function"?$l:zl)(e)):this.node().textContent}function Ll(){this.innerHTML=""}function ql(e){return function(){this.innerHTML=e}}function Ul(e){return function(){var n=e.apply(this,arguments);this.innerHTML=n??""}}function Hl(e){return arguments.length?this.each(e==null?Ll:(typeof e=="function"?Ul:ql)(e)):this.node().innerHTML}function Bl(){this.nextSibling&&this.parentNode.appendChild(this)}function Vl(){return this.each(Bl)}function Gl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Wl(){return this.each(Gl)}function Kl(e){var n=typeof e=="function"?e:ga(e);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function Yl(){return null}function Jl(e,n){var r=typeof e=="function"?e:ga(e),i=n==null?Yl:typeof n=="function"?n:yr(n);return this.select(function(){return this.insertBefore(r.apply(this,arguments),i.apply(this,arguments)||null)})}function Xl(){var e=this.parentNode;e&&e.removeChild(this)}function Ql(){return this.each(Xl)}function Zl(){var e=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function ec(){var e=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function tc(e){return this.select(e?ec:Zl)}function nc(e){return arguments.length?this.property("__data__",e):this.node().__data__}function rc(e){return function(n){e.call(this,n,this.__data__)}}function ic(e){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");return i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),{type:n,name:r}})}function ac(e){return function(){var n=this.__on;if(n){for(var r=0,i=-1,a=n.length,s;r<a;++r)s=n[r],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):n[++i]=s;++i?n.length=i:delete this.__on}}}function sc(e,n,r){return function(){var i=this.__on,a,s=rc(n);if(i){for(var o=0,c=i.length;o<c;++o)if((a=i[o]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=s,a.options=r),a.value=n;return}}this.addEventListener(e.type,s,r),a={type:e.type,name:e.name,value:n,listener:s,options:r},i?i.push(a):this.__on=[a]}}function oc(e,n,r){var i=ic(e+""),a,s=i.length,o;if(arguments.length<2){var c=this.node().__on;if(c){for(var u=0,d=c.length,h;u<d;++u)for(a=0,h=c[u];a<s;++a)if((o=i[a]).type===h.type&&o.name===h.name)return h.value}return}for(c=n?sc:ac,a=0;a<s;++a)this.each(c(i[a],n,r));return this}function Sa(e,n,r){var i=_a(e),a=i.CustomEvent;typeof a=="function"?a=new a(n,r):(a=i.document.createEvent("Event"),r?(a.initEvent(n,r.bubbles,r.cancelable),a.detail=r.detail):a.initEvent(n,!1,!1)),e.dispatchEvent(a)}function lc(e,n){return function(){return Sa(this,e,n)}}function cc(e,n){return function(){return Sa(this,e,n.apply(this,arguments))}}function uc(e,n){return this.each((typeof n=="function"?cc:lc)(e,n))}function*dc(){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],a=0,s=i.length,o;a<s;++a)(o=i[a])&&(yield o)}var Ca=[null];function be(e,n){this._groups=e,this._parents=n}function Ht(){return new be([[document.documentElement]],Ca)}function fc(){return this}be.prototype=Ht.prototype={constructor:be,select:$o,selectAll:Uo,selectChild:Go,selectChildren:Jo,filter:Xo,data:rl,enter:Qo,exit:al,join:sl,merge:ol,selection:fc,order:ll,sort:cl,call:dl,nodes:fl,node:hl,size:pl,empty:ml,each:gl,attr:Nl,style:Cl,property:Ml,classed:Rl,text:Fl,html:Hl,raise:Vl,lower:Wl,append:Kl,insert:Jl,remove:Ql,clone:tc,datum:nc,on:oc,dispatch:uc,[Symbol.iterator]:dc};function we(e){return typeof e=="string"?new be([[document.querySelector(e)]],[document.documentElement]):new be([[e]],Ca)}function hc(e){let n;for(;n=e.sourceEvent;)e=n;return e}function Te(e,n){if(e=hc(e),n===void 0&&(n=e.currentTarget),n){var r=n.ownerSVGElement||n;if(r.createSVGPoint){var i=r.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,i=i.matrixTransform(n.getScreenCTM().inverse()),[i.x,i.y]}if(n.getBoundingClientRect){var a=n.getBoundingClientRect();return[e.clientX-a.left-n.clientLeft,e.clientY-a.top-n.clientTop]}}return[e.pageX,e.pageY]}var pc={value:()=>{}};function Bt(){for(var e=0,n=arguments.length,r={},i;e<n;++e){if(!(i=arguments[e]+"")||i in r||/[\s.]/.test(i))throw new Error("illegal type: "+i);r[i]=[]}return new rn(r)}function rn(e){this._=e}function mc(e,n){return e.trim().split(/^|\s+/).map(function(r){var i="",a=r.indexOf(".");if(a>=0&&(i=r.slice(a+1),r=r.slice(0,a)),r&&!n.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:i}})}rn.prototype=Bt.prototype={constructor:rn,on:function(e,n){var r=this._,i=mc(e+"",r),a,s=-1,o=i.length;if(arguments.length<2){for(;++s<o;)if((a=(e=i[s]).type)&&(a=gc(r[a],e.name)))return a;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++s<o;)if(a=(e=i[s]).type)r[a]=Br(r[a],e.name,n);else if(n==null)for(a in r)r[a]=Br(r[a],e.name,null);return this},copy:function(){var e={},n=this._;for(var r in n)e[r]=n[r].slice();return new rn(e)},call:function(e,n){if((a=arguments.length-2)>0)for(var r=new Array(a),i=0,a,s;i<a;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],i=0,a=s.length;i<a;++i)s[i].value.apply(n,r)},apply:function(e,n,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],a=0,s=i.length;a<s;++a)i[a].value.apply(n,r)}};function gc(e,n){for(var r=0,i=e.length,a;r<i;++r)if((a=e[r]).name===n)return a.value}function Br(e,n,r){for(var i=0,a=e.length;i<a;++i)if(e[i].name===n){e[i]=pc,e=e.slice(0,i).concat(e.slice(i+1));break}return r!=null&&e.push({name:n,value:r}),e}const xc={passive:!1},Dt={capture:!0,passive:!1};function In(e){e.stopImmediatePropagation()}function ot(e){e.preventDefault(),e.stopImmediatePropagation()}function Aa(e){var n=e.document.documentElement,r=we(e).on("dragstart.drag",ot,Dt);"onselectstart"in n?r.on("selectstart.drag",ot,Dt):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function Ta(e,n){var r=e.document.documentElement,i=we(e).on("dragstart.drag",null);n&&(i.on("click.drag",ot,Dt),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in r?i.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const Kt=e=>()=>e;function Xn(e,{sourceEvent:n,subject:r,target:i,identifier:a,active:s,x:o,y:c,dx:u,dy:d,dispatch:h}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:c,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:h}})}Xn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function yc(e){return!e.ctrlKey&&!e.button}function bc(){return this.parentNode}function vc(e,n){return n??{x:e.x,y:e.y}}function _c(){return navigator.maxTouchPoints||"ontouchstart"in this}function wc(){var e=yc,n=bc,r=vc,i=_c,a={},s=Bt("start","drag","end"),o=0,c,u,d,h,f=0;function p(w){w.on("mousedown.drag",m).filter(i).on("touchstart.drag",b).on("touchmove.drag",x,xc).on("touchend.drag touchcancel.drag",j).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(w,_){if(!(h||!e.call(this,w,_))){var M=C(this,n.call(this,w,_),w,_,"mouse");M&&(we(w.view).on("mousemove.drag",g,Dt).on("mouseup.drag",v,Dt),Aa(w.view),In(w),d=!1,c=w.clientX,u=w.clientY,M("start",w))}}function g(w){if(ot(w),!d){var _=w.clientX-c,M=w.clientY-u;d=_*_+M*M>f}a.mouse("drag",w)}function v(w){we(w.view).on("mousemove.drag mouseup.drag",null),Ta(w.view,d),ot(w),a.mouse("end",w)}function b(w,_){if(e.call(this,w,_)){var M=w.changedTouches,E=n.call(this,w,_),y=M.length,T,k;for(T=0;T<y;++T)(k=C(this,E,w,_,M[T].identifier,M[T]))&&(In(w),k("start",w,M[T]))}}function x(w){var _=w.changedTouches,M=_.length,E,y;for(E=0;E<M;++E)(y=a[_[E].identifier])&&(ot(w),y("drag",w,_[E]))}function j(w){var _=w.changedTouches,M=_.length,E,y;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),E=0;E<M;++E)(y=a[_[E].identifier])&&(In(w),y("end",w,_[E]))}function C(w,_,M,E,y,T){var k=s.copy(),O=Te(T||M,_),P,z,S;if((S=r.call(w,new Xn("beforestart",{sourceEvent:M,target:p,identifier:y,active:o,x:O[0],y:O[1],dx:0,dy:0,dispatch:k}),E))!=null)return P=S.x-O[0]||0,z=S.y-O[1]||0,function R(N,I,$){var L=O,B;switch(N){case"start":a[y]=R,B=o++;break;case"end":delete a[y],--o;case"drag":O=Te($||I,_),B=o;break}k.call(N,w,new Xn(N,{sourceEvent:I,subject:S,target:p,identifier:y,active:B,x:O[0]+P,y:O[1]+z,dx:O[0]-L[0],dy:O[1]-L[1],dispatch:k}),E)}}return p.filter=function(w){return arguments.length?(e=typeof w=="function"?w:Kt(!!w),p):e},p.container=function(w){return arguments.length?(n=typeof w=="function"?w:Kt(w),p):n},p.subject=function(w){return arguments.length?(r=typeof w=="function"?w:Kt(w),p):r},p.touchable=function(w){return arguments.length?(i=typeof w=="function"?w:Kt(!!w),p):i},p.on=function(){var w=s.on.apply(s,arguments);return w===s?p:w},p.clickDistance=function(w){return arguments.length?(f=(w=+w)*w,p):Math.sqrt(f)},p}function vr(e,n,r){e.prototype=n.prototype=r,r.constructor=e}function Oa(e,n){var r=Object.create(e.prototype);for(var i in n)r[i]=n[i];return r}function Vt(){}var zt=.7,fn=1/zt,lt="\\s*([+-]?\\d+)\\s*",$t="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Me="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Nc=/^#([0-9a-f]{3,8})$/,jc=new RegExp(`^rgb\\(${lt},${lt},${lt}\\)$`),kc=new RegExp(`^rgb\\(${Me},${Me},${Me}\\)$`),Sc=new RegExp(`^rgba\\(${lt},${lt},${lt},${$t}\\)$`),Cc=new RegExp(`^rgba\\(${Me},${Me},${Me},${$t}\\)$`),Ac=new RegExp(`^hsl\\(${$t},${Me},${Me}\\)$`),Tc=new RegExp(`^hsla\\(${$t},${Me},${Me},${$t}\\)$`),Vr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};vr(Vt,Ft,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Gr,formatHex:Gr,formatHex8:Oc,formatHsl:Mc,formatRgb:Wr,toString:Wr});function Gr(){return this.rgb().formatHex()}function Oc(){return this.rgb().formatHex8()}function Mc(){return Ma(this).formatHsl()}function Wr(){return this.rgb().formatRgb()}function Ft(e){var n,r;return e=(e+"").trim().toLowerCase(),(n=Nc.exec(e))?(r=n[1].length,n=parseInt(n[1],16),r===6?Kr(n):r===3?new pe(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):r===8?Yt(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):r===4?Yt(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=jc.exec(e))?new pe(n[1],n[2],n[3],1):(n=kc.exec(e))?new pe(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=Sc.exec(e))?Yt(n[1],n[2],n[3],n[4]):(n=Cc.exec(e))?Yt(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=Ac.exec(e))?Xr(n[1],n[2]/100,n[3]/100,1):(n=Tc.exec(e))?Xr(n[1],n[2]/100,n[3]/100,n[4]):Vr.hasOwnProperty(e)?Kr(Vr[e]):e==="transparent"?new pe(NaN,NaN,NaN,0):null}function Kr(e){return new pe(e>>16&255,e>>8&255,e&255,1)}function Yt(e,n,r,i){return i<=0&&(e=n=r=NaN),new pe(e,n,r,i)}function Ec(e){return e instanceof Vt||(e=Ft(e)),e?(e=e.rgb(),new pe(e.r,e.g,e.b,e.opacity)):new pe}function Qn(e,n,r,i){return arguments.length===1?Ec(e):new pe(e,n,r,i??1)}function pe(e,n,r,i){this.r=+e,this.g=+n,this.b=+r,this.opacity=+i}vr(pe,Qn,Oa(Vt,{brighter(e){return e=e==null?fn:Math.pow(fn,e),new pe(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?zt:Math.pow(zt,e),new pe(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new pe(tt(this.r),tt(this.g),tt(this.b),hn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Yr,formatHex:Yr,formatHex8:Pc,formatRgb:Jr,toString:Jr}));function Yr(){return`#${et(this.r)}${et(this.g)}${et(this.b)}`}function Pc(){return`#${et(this.r)}${et(this.g)}${et(this.b)}${et((isNaN(this.opacity)?1:this.opacity)*255)}`}function Jr(){const e=hn(this.opacity);return`${e===1?"rgb(":"rgba("}${tt(this.r)}, ${tt(this.g)}, ${tt(this.b)}${e===1?")":`, ${e})`}`}function hn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function tt(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function et(e){return e=tt(e),(e<16?"0":"")+e.toString(16)}function Xr(e,n,r,i){return i<=0?e=n=r=NaN:r<=0||r>=1?e=n=NaN:n<=0&&(e=NaN),new ke(e,n,r,i)}function Ma(e){if(e instanceof ke)return new ke(e.h,e.s,e.l,e.opacity);if(e instanceof Vt||(e=Ft(e)),!e)return new ke;if(e instanceof ke)return e;e=e.rgb();var n=e.r/255,r=e.g/255,i=e.b/255,a=Math.min(n,r,i),s=Math.max(n,r,i),o=NaN,c=s-a,u=(s+a)/2;return c?(n===s?o=(r-i)/c+(r<i)*6:r===s?o=(i-n)/c+2:o=(n-r)/c+4,c/=u<.5?s+a:2-s-a,o*=60):c=u>0&&u<1?0:o,new ke(o,c,u,e.opacity)}function Ic(e,n,r,i){return arguments.length===1?Ma(e):new ke(e,n,r,i??1)}function ke(e,n,r,i){this.h=+e,this.s=+n,this.l=+r,this.opacity=+i}vr(ke,Ic,Oa(Vt,{brighter(e){return e=e==null?fn:Math.pow(fn,e),new ke(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?zt:Math.pow(zt,e),new ke(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,i=r+(r<.5?r:1-r)*n,a=2*r-i;return new pe(Rn(e>=240?e-240:e+120,a,i),Rn(e,a,i),Rn(e<120?e+240:e-120,a,i),this.opacity)},clamp(){return new ke(Qr(this.h),Jt(this.s),Jt(this.l),hn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=hn(this.opacity);return`${e===1?"hsl(":"hsla("}${Qr(this.h)}, ${Jt(this.s)*100}%, ${Jt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Qr(e){return e=(e||0)%360,e<0?e+360:e}function Jt(e){return Math.max(0,Math.min(1,e||0))}function Rn(e,n,r){return(e<60?n+(r-n)*e/60:e<180?r:e<240?n+(r-n)*(240-e)/60:n)*255}const Ea=e=>()=>e;function Rc(e,n){return function(r){return e+r*n}}function Dc(e,n,r){return e=Math.pow(e,r),n=Math.pow(n,r)-e,r=1/r,function(i){return Math.pow(e+i*n,r)}}function zc(e){return(e=+e)==1?Pa:function(n,r){return r-n?Dc(n,r,e):Ea(isNaN(n)?r:n)}}function Pa(e,n){var r=n-e;return r?Rc(e,r):Ea(isNaN(e)?n:e)}const Zr=(function e(n){var r=zc(n);function i(a,s){var o=r((a=Qn(a)).r,(s=Qn(s)).r),c=r(a.g,s.g),u=r(a.b,s.b),d=Pa(a.opacity,s.opacity);return function(h){return a.r=o(h),a.g=c(h),a.b=u(h),a.opacity=d(h),a+""}}return i.gamma=e,i})(1);function Ke(e,n){return e=+e,n=+n,function(r){return e*(1-r)+n*r}}var Zn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Dn=new RegExp(Zn.source,"g");function $c(e){return function(){return e}}function Fc(e){return function(n){return e(n)+""}}function Lc(e,n){var r=Zn.lastIndex=Dn.lastIndex=0,i,a,s,o=-1,c=[],u=[];for(e=e+"",n=n+"";(i=Zn.exec(e))&&(a=Dn.exec(n));)(s=a.index)>r&&(s=n.slice(r,s),c[o]?c[o]+=s:c[++o]=s),(i=i[0])===(a=a[0])?c[o]?c[o]+=a:c[++o]=a:(c[++o]=null,u.push({i:o,x:Ke(i,a)})),r=Dn.lastIndex;return r<n.length&&(s=n.slice(r),c[o]?c[o]+=s:c[++o]=s),c.length<2?u[0]?Fc(u[0].x):$c(n):(n=u.length,function(d){for(var h=0,f;h<n;++h)c[(f=u[h]).i]=f.x(d);return c.join("")})}var ei=180/Math.PI,er={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ia(e,n,r,i,a,s){var o,c,u;return(o=Math.sqrt(e*e+n*n))&&(e/=o,n/=o),(u=e*r+n*i)&&(r-=e*u,i-=n*u),(c=Math.sqrt(r*r+i*i))&&(r/=c,i/=c,u/=c),e*i<n*r&&(e=-e,n=-n,u=-u,o=-o),{translateX:a,translateY:s,rotate:Math.atan2(n,e)*ei,skewX:Math.atan(u)*ei,scaleX:o,scaleY:c}}var Xt;function qc(e){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return n.isIdentity?er:Ia(n.a,n.b,n.c,n.d,n.e,n.f)}function Uc(e){return e==null||(Xt||(Xt=document.createElementNS("http://www.w3.org/2000/svg","g")),Xt.setAttribute("transform",e),!(e=Xt.transform.baseVal.consolidate()))?er:(e=e.matrix,Ia(e.a,e.b,e.c,e.d,e.e,e.f))}function Ra(e,n,r,i){function a(d){return d.length?d.pop()+" ":""}function s(d,h,f,p,m,g){if(d!==f||h!==p){var v=m.push("translate(",null,n,null,r);g.push({i:v-4,x:Ke(d,f)},{i:v-2,x:Ke(h,p)})}else(f||p)&&m.push("translate("+f+n+p+r)}function o(d,h,f,p){d!==h?(d-h>180?h+=360:h-d>180&&(d+=360),p.push({i:f.push(a(f)+"rotate(",null,i)-2,x:Ke(d,h)})):h&&f.push(a(f)+"rotate("+h+i)}function c(d,h,f,p){d!==h?p.push({i:f.push(a(f)+"skewX(",null,i)-2,x:Ke(d,h)}):h&&f.push(a(f)+"skewX("+h+i)}function u(d,h,f,p,m,g){if(d!==f||h!==p){var v=m.push(a(m)+"scale(",null,",",null,")");g.push({i:v-4,x:Ke(d,f)},{i:v-2,x:Ke(h,p)})}else(f!==1||p!==1)&&m.push(a(m)+"scale("+f+","+p+")")}return function(d,h){var f=[],p=[];return d=e(d),h=e(h),s(d.translateX,d.translateY,h.translateX,h.translateY,f,p),o(d.rotate,h.rotate,f,p),c(d.skewX,h.skewX,f,p),u(d.scaleX,d.scaleY,h.scaleX,h.scaleY,f,p),d=h=null,function(m){for(var g=-1,v=p.length,b;++g<v;)f[(b=p[g]).i]=b.x(m);return f.join("")}}}var Hc=Ra(qc,"px, ","px)","deg)"),Bc=Ra(Uc,", ",")",")"),Vc=1e-12;function ti(e){return((e=Math.exp(e))+1/e)/2}function Gc(e){return((e=Math.exp(e))-1/e)/2}function Wc(e){return((e=Math.exp(2*e))-1)/(e+1)}const Kc=(function e(n,r,i){function a(s,o){var c=s[0],u=s[1],d=s[2],h=o[0],f=o[1],p=o[2],m=h-c,g=f-u,v=m*m+g*g,b,x;if(v<Vc)x=Math.log(p/d)/n,b=function(E){return[c+E*m,u+E*g,d*Math.exp(n*E*x)]};else{var j=Math.sqrt(v),C=(p*p-d*d+i*v)/(2*d*r*j),w=(p*p-d*d-i*v)/(2*p*r*j),_=Math.log(Math.sqrt(C*C+1)-C),M=Math.log(Math.sqrt(w*w+1)-w);x=(M-_)/n,b=function(E){var y=E*x,T=ti(_),k=d/(r*j)*(T*Wc(n*y+_)-Gc(_));return[c+k*m,u+k*g,d*T/ti(n*y+_)]}}return b.duration=x*1e3*n/Math.SQRT2,b}return a.rho=function(s){var o=Math.max(.001,+s),c=o*o,u=c*c;return e(o,c,u)},a})(Math.SQRT2,2,4);var ut=0,wt=0,pt=0,Da=1e3,pn,Nt,mn=0,rt=0,jn=0,Lt=typeof performance=="object"&&performance.now?performance:Date,za=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function _r(){return rt||(za(Yc),rt=Lt.now()+jn)}function Yc(){rt=0}function gn(){this._call=this._time=this._next=null}gn.prototype=wr.prototype={constructor:gn,restart:function(e,n,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?_r():+r)+(n==null?0:+n),!this._next&&Nt!==this&&(Nt?Nt._next=this:pn=this,Nt=this),this._call=e,this._time=r,tr()},stop:function(){this._call&&(this._call=null,this._time=1/0,tr())}};function wr(e,n,r){var i=new gn;return i.restart(e,n,r),i}function Jc(){_r(),++ut;for(var e=pn,n;e;)(n=rt-e._time)>=0&&e._call.call(void 0,n),e=e._next;--ut}function ni(){rt=(mn=Lt.now())+jn,ut=wt=0;try{Jc()}finally{ut=0,Qc(),rt=0}}function Xc(){var e=Lt.now(),n=e-mn;n>Da&&(jn-=n,mn=e)}function Qc(){for(var e,n=pn,r,i=1/0;n;)n._call?(i>n._time&&(i=n._time),e=n,n=n._next):(r=n._next,n._next=null,n=e?e._next=r:pn=r);Nt=e,tr(i)}function tr(e){if(!ut){wt&&(wt=clearTimeout(wt));var n=e-rt;n>24?(e<1/0&&(wt=setTimeout(ni,e-Lt.now()-jn)),pt&&(pt=clearInterval(pt))):(pt||(mn=Lt.now(),pt=setInterval(Xc,Da)),ut=1,za(ni))}}function ri(e,n,r){var i=new gn;return n=n==null?0:+n,i.restart(a=>{i.stop(),e(a+n)},n,r),i}var Zc=Bt("start","end","cancel","interrupt"),eu=[],$a=0,ii=1,nr=2,an=3,ai=4,rr=5,sn=6;function kn(e,n,r,i,a,s){var o=e.__transition;if(!o)e.__transition={};else if(r in o)return;tu(e,r,{name:n,index:i,group:a,on:Zc,tween:eu,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:$a})}function Nr(e,n){var r=Ce(e,n);if(r.state>$a)throw new Error("too late; already scheduled");return r}function Pe(e,n){var r=Ce(e,n);if(r.state>an)throw new Error("too late; already running");return r}function Ce(e,n){var r=e.__transition;if(!r||!(r=r[n]))throw new Error("transition not found");return r}function tu(e,n,r){var i=e.__transition,a;i[n]=r,r.timer=wr(s,0,r.time);function s(d){r.state=ii,r.timer.restart(o,r.delay,r.time),r.delay<=d&&o(d-r.delay)}function o(d){var h,f,p,m;if(r.state!==ii)return u();for(h in i)if(m=i[h],m.name===r.name){if(m.state===an)return ri(o);m.state===ai?(m.state=sn,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete i[h]):+h<n&&(m.state=sn,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete i[h])}if(ri(function(){r.state===an&&(r.state=ai,r.timer.restart(c,r.delay,r.time),c(d))}),r.state=nr,r.on.call("start",e,e.__data__,r.index,r.group),r.state===nr){for(r.state=an,a=new Array(p=r.tween.length),h=0,f=-1;h<p;++h)(m=r.tween[h].value.call(e,e.__data__,r.index,r.group))&&(a[++f]=m);a.length=f+1}}function c(d){for(var h=d<r.duration?r.ease.call(null,d/r.duration):(r.timer.restart(u),r.state=rr,1),f=-1,p=a.length;++f<p;)a[f].call(e,h);r.state===rr&&(r.on.call("end",e,e.__data__,r.index,r.group),u())}function u(){r.state=sn,r.timer.stop(),delete i[n];for(var d in i)return;delete e.__transition}}function on(e,n){var r=e.__transition,i,a,s=!0,o;if(r){n=n==null?null:n+"";for(o in r){if((i=r[o]).name!==n){s=!1;continue}a=i.state>nr&&i.state<rr,i.state=sn,i.timer.stop(),i.on.call(a?"interrupt":"cancel",e,e.__data__,i.index,i.group),delete r[o]}s&&delete e.__transition}}function nu(e){return this.each(function(){on(this,e)})}function ru(e,n){var r,i;return function(){var a=Pe(this,e),s=a.tween;if(s!==r){i=r=s;for(var o=0,c=i.length;o<c;++o)if(i[o].name===n){i=i.slice(),i.splice(o,1);break}}a.tween=i}}function iu(e,n,r){var i,a;if(typeof r!="function")throw new Error;return function(){var s=Pe(this,e),o=s.tween;if(o!==i){a=(i=o).slice();for(var c={name:n,value:r},u=0,d=a.length;u<d;++u)if(a[u].name===n){a[u]=c;break}u===d&&a.push(c)}s.tween=a}}function au(e,n){var r=this._id;if(e+="",arguments.length<2){for(var i=Ce(this.node(),r).tween,a=0,s=i.length,o;a<s;++a)if((o=i[a]).name===e)return o.value;return null}return this.each((n==null?ru:iu)(r,e,n))}function jr(e,n,r){var i=e._id;return e.each(function(){var a=Pe(this,i);(a.value||(a.value={}))[n]=r.apply(this,arguments)}),function(a){return Ce(a,i).value[n]}}function Fa(e,n){var r;return(typeof n=="number"?Ke:n instanceof Ft?Zr:(r=Ft(n))?(n=r,Zr):Lc)(e,n)}function su(e){return function(){this.removeAttribute(e)}}function ou(e){return function(){this.removeAttributeNS(e.space,e.local)}}function lu(e,n,r){var i,a=r+"",s;return function(){var o=this.getAttribute(e);return o===a?null:o===i?s:s=n(i=o,r)}}function cu(e,n,r){var i,a=r+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===a?null:o===i?s:s=n(i=o,r)}}function uu(e,n,r){var i,a,s;return function(){var o,c=r(this),u;return c==null?void this.removeAttribute(e):(o=this.getAttribute(e),u=c+"",o===u?null:o===i&&u===a?s:(a=u,s=n(i=o,c)))}}function du(e,n,r){var i,a,s;return function(){var o,c=r(this),u;return c==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),u=c+"",o===u?null:o===i&&u===a?s:(a=u,s=n(i=o,c)))}}function fu(e,n){var r=Nn(e),i=r==="transform"?Bc:Fa;return this.attrTween(e,typeof n=="function"?(r.local?du:uu)(r,i,jr(this,"attr."+e,n)):n==null?(r.local?ou:su)(r):(r.local?cu:lu)(r,i,n))}function hu(e,n){return function(r){this.setAttribute(e,n.call(this,r))}}function pu(e,n){return function(r){this.setAttributeNS(e.space,e.local,n.call(this,r))}}function mu(e,n){var r,i;function a(){var s=n.apply(this,arguments);return s!==i&&(r=(i=s)&&pu(e,s)),r}return a._value=n,a}function gu(e,n){var r,i;function a(){var s=n.apply(this,arguments);return s!==i&&(r=(i=s)&&hu(e,s)),r}return a._value=n,a}function xu(e,n){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(n==null)return this.tween(r,null);if(typeof n!="function")throw new Error;var i=Nn(e);return this.tween(r,(i.local?mu:gu)(i,n))}function yu(e,n){return function(){Nr(this,e).delay=+n.apply(this,arguments)}}function bu(e,n){return n=+n,function(){Nr(this,e).delay=n}}function vu(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?yu:bu)(n,e)):Ce(this.node(),n).delay}function _u(e,n){return function(){Pe(this,e).duration=+n.apply(this,arguments)}}function wu(e,n){return n=+n,function(){Pe(this,e).duration=n}}function Nu(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?_u:wu)(n,e)):Ce(this.node(),n).duration}function ju(e,n){if(typeof n!="function")throw new Error;return function(){Pe(this,e).ease=n}}function ku(e){var n=this._id;return arguments.length?this.each(ju(n,e)):Ce(this.node(),n).ease}function Su(e,n){return function(){var r=n.apply(this,arguments);if(typeof r!="function")throw new Error;Pe(this,e).ease=r}}function Cu(e){if(typeof e!="function")throw new Error;return this.each(Su(this._id,e))}function Au(e){typeof e!="function"&&(e=ya(e));for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a)for(var s=n[a],o=s.length,c=i[a]=[],u,d=0;d<o;++d)(u=s[d])&&e.call(u,u.__data__,d,s)&&c.push(u);return new Ve(i,this._parents,this._name,this._id)}function Tu(e){if(e._id!==this._id)throw new Error;for(var n=this._groups,r=e._groups,i=n.length,a=r.length,s=Math.min(i,a),o=new Array(i),c=0;c<s;++c)for(var u=n[c],d=r[c],h=u.length,f=o[c]=new Array(h),p,m=0;m<h;++m)(p=u[m]||d[m])&&(f[m]=p);for(;c<i;++c)o[c]=n[c];return new Ve(o,this._parents,this._name,this._id)}function Ou(e){return(e+"").trim().split(/^|\s+/).every(function(n){var r=n.indexOf(".");return r>=0&&(n=n.slice(0,r)),!n||n==="start"})}function Mu(e,n,r){var i,a,s=Ou(n)?Nr:Pe;return function(){var o=s(this,e),c=o.on;c!==i&&(a=(i=c).copy()).on(n,r),o.on=a}}function Eu(e,n){var r=this._id;return arguments.length<2?Ce(this.node(),r).on.on(e):this.each(Mu(r,e,n))}function Pu(e){return function(){var n=this.parentNode;for(var r in this.__transition)if(+r!==e)return;n&&n.removeChild(this)}}function Iu(){return this.on("end.remove",Pu(this._id))}function Ru(e){var n=this._name,r=this._id;typeof e!="function"&&(e=yr(e));for(var i=this._groups,a=i.length,s=new Array(a),o=0;o<a;++o)for(var c=i[o],u=c.length,d=s[o]=new Array(u),h,f,p=0;p<u;++p)(h=c[p])&&(f=e.call(h,h.__data__,p,c))&&("__data__"in h&&(f.__data__=h.__data__),d[p]=f,kn(d[p],n,r,p,d,Ce(h,r)));return new Ve(s,this._parents,n,r)}function Du(e){var n=this._name,r=this._id;typeof e!="function"&&(e=xa(e));for(var i=this._groups,a=i.length,s=[],o=[],c=0;c<a;++c)for(var u=i[c],d=u.length,h,f=0;f<d;++f)if(h=u[f]){for(var p=e.call(h,h.__data__,f,u),m,g=Ce(h,r),v=0,b=p.length;v<b;++v)(m=p[v])&&kn(m,n,r,v,p,g);s.push(p),o.push(h)}return new Ve(s,o,n,r)}var zu=Ht.prototype.constructor;function $u(){return new zu(this._groups,this._parents)}function Fu(e,n){var r,i,a;return function(){var s=ct(this,e),o=(this.style.removeProperty(e),ct(this,e));return s===o?null:s===r&&o===i?a:a=n(r=s,i=o)}}function La(e){return function(){this.style.removeProperty(e)}}function Lu(e,n,r){var i,a=r+"",s;return function(){var o=ct(this,e);return o===a?null:o===i?s:s=n(i=o,r)}}function qu(e,n,r){var i,a,s;return function(){var o=ct(this,e),c=r(this),u=c+"";return c==null&&(u=c=(this.style.removeProperty(e),ct(this,e))),o===u?null:o===i&&u===a?s:(a=u,s=n(i=o,c))}}function Uu(e,n){var r,i,a,s="style."+n,o="end."+s,c;return function(){var u=Pe(this,e),d=u.on,h=u.value[s]==null?c||(c=La(n)):void 0;(d!==r||a!==h)&&(i=(r=d).copy()).on(o,a=h),u.on=i}}function Hu(e,n,r){var i=(e+="")=="transform"?Hc:Fa;return n==null?this.styleTween(e,Fu(e,i)).on("end.style."+e,La(e)):typeof n=="function"?this.styleTween(e,qu(e,i,jr(this,"style."+e,n))).each(Uu(this._id,e)):this.styleTween(e,Lu(e,i,n),r).on("end.style."+e,null)}function Bu(e,n,r){return function(i){this.style.setProperty(e,n.call(this,i),r)}}function Vu(e,n,r){var i,a;function s(){var o=n.apply(this,arguments);return o!==a&&(i=(a=o)&&Bu(e,o,r)),i}return s._value=n,s}function Gu(e,n,r){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(n==null)return this.tween(i,null);if(typeof n!="function")throw new Error;return this.tween(i,Vu(e,n,r??""))}function Wu(e){return function(){this.textContent=e}}function Ku(e){return function(){var n=e(this);this.textContent=n??""}}function Yu(e){return this.tween("text",typeof e=="function"?Ku(jr(this,"text",e)):Wu(e==null?"":e+""))}function Ju(e){return function(n){this.textContent=e.call(this,n)}}function Xu(e){var n,r;function i(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&Ju(a)),n}return i._value=e,i}function Qu(e){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,Xu(e))}function Zu(){for(var e=this._name,n=this._id,r=qa(),i=this._groups,a=i.length,s=0;s<a;++s)for(var o=i[s],c=o.length,u,d=0;d<c;++d)if(u=o[d]){var h=Ce(u,n);kn(u,e,r,d,o,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Ve(i,this._parents,e,r)}function ed(){var e,n,r=this,i=r._id,a=r.size();return new Promise(function(s,o){var c={value:o},u={value:function(){--a===0&&s()}};r.each(function(){var d=Pe(this,i),h=d.on;h!==e&&(n=(e=h).copy(),n._.cancel.push(c),n._.interrupt.push(c),n._.end.push(u)),d.on=n}),a===0&&s()})}var td=0;function Ve(e,n,r,i){this._groups=e,this._parents=n,this._name=r,this._id=i}function qa(){return++td}var Re=Ht.prototype;Ve.prototype={constructor:Ve,select:Ru,selectAll:Du,selectChild:Re.selectChild,selectChildren:Re.selectChildren,filter:Au,merge:Tu,selection:$u,transition:Zu,call:Re.call,nodes:Re.nodes,node:Re.node,size:Re.size,empty:Re.empty,each:Re.each,on:Eu,attr:fu,attrTween:xu,style:Hu,styleTween:Gu,text:Yu,textTween:Qu,remove:Iu,tween:au,delay:vu,duration:Nu,ease:ku,easeVarying:Cu,end:ed,[Symbol.iterator]:Re[Symbol.iterator]};function nd(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var rd={time:null,delay:0,duration:250,ease:nd};function id(e,n){for(var r;!(r=e.__transition)||!(r=r[n]);)if(!(e=e.parentNode))throw new Error(`transition ${n} not found`);return r}function ad(e){var n,r;e instanceof Ve?(n=e._id,e=e._name):(n=qa(),(r=rd).time=_r(),e=e==null?null:e+"");for(var i=this._groups,a=i.length,s=0;s<a;++s)for(var o=i[s],c=o.length,u,d=0;d<c;++d)(u=o[d])&&kn(u,e,n,d,o,r||id(u,n));return new Ve(i,this._parents,e,n)}Ht.prototype.interrupt=nu;Ht.prototype.transition=ad;const Qt=e=>()=>e;function sd(e,{sourceEvent:n,target:r,transform:i,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:a}})}function Ue(e,n,r){this.k=e,this.x=n,this.y=r}Ue.prototype={constructor:Ue,scale:function(e){return e===1?this:new Ue(this.k*e,this.x,this.y)},translate:function(e,n){return e===0&n===0?this:new Ue(this.k,this.x+this.k*e,this.y+this.k*n)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var kr=new Ue(1,0,0);Ae.prototype=Ue.prototype;function Ae(e){for(;!e.__zoom;)if(!(e=e.parentNode))return kr;return e.__zoom}function zn(e){e.stopImmediatePropagation()}function mt(e){e.preventDefault(),e.stopImmediatePropagation()}function od(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function ld(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function si(){return this.__zoom||kr}function cd(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function ud(){return navigator.maxTouchPoints||"ontouchstart"in this}function dd(e,n,r){var i=e.invertX(n[0][0])-r[0][0],a=e.invertX(n[1][0])-r[1][0],s=e.invertY(n[0][1])-r[0][1],o=e.invertY(n[1][1])-r[1][1];return e.translate(a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function fd(){var e=od,n=ld,r=dd,i=cd,a=ud,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],c=250,u=Kc,d=Bt("start","zoom","end"),h,f,p,m=500,g=150,v=0,b=10;function x(S){S.property("__zoom",si).on("wheel.zoom",y,{passive:!1}).on("mousedown.zoom",T).on("dblclick.zoom",k).filter(a).on("touchstart.zoom",O).on("touchmove.zoom",P).on("touchend.zoom touchcancel.zoom",z).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}x.transform=function(S,R,N,I){var $=S.selection?S.selection():S;$.property("__zoom",si),S!==$?_(S,R,N,I):$.interrupt().each(function(){M(this,arguments).event(I).start().zoom(null,typeof R=="function"?R.apply(this,arguments):R).end()})},x.scaleBy=function(S,R,N,I){x.scaleTo(S,function(){var $=this.__zoom.k,L=typeof R=="function"?R.apply(this,arguments):R;return $*L},N,I)},x.scaleTo=function(S,R,N,I){x.transform(S,function(){var $=n.apply(this,arguments),L=this.__zoom,B=N==null?w($):typeof N=="function"?N.apply(this,arguments):N,G=L.invert(B),W=typeof R=="function"?R.apply(this,arguments):R;return r(C(j(L,W),B,G),$,o)},N,I)},x.translateBy=function(S,R,N,I){x.transform(S,function(){return r(this.__zoom.translate(typeof R=="function"?R.apply(this,arguments):R,typeof N=="function"?N.apply(this,arguments):N),n.apply(this,arguments),o)},null,I)},x.translateTo=function(S,R,N,I,$){x.transform(S,function(){var L=n.apply(this,arguments),B=this.__zoom,G=I==null?w(L):typeof I=="function"?I.apply(this,arguments):I;return r(kr.translate(G[0],G[1]).scale(B.k).translate(typeof R=="function"?-R.apply(this,arguments):-R,typeof N=="function"?-N.apply(this,arguments):-N),L,o)},I,$)};function j(S,R){return R=Math.max(s[0],Math.min(s[1],R)),R===S.k?S:new Ue(R,S.x,S.y)}function C(S,R,N){var I=R[0]-N[0]*S.k,$=R[1]-N[1]*S.k;return I===S.x&&$===S.y?S:new Ue(S.k,I,$)}function w(S){return[(+S[0][0]+ +S[1][0])/2,(+S[0][1]+ +S[1][1])/2]}function _(S,R,N,I){S.on("start.zoom",function(){M(this,arguments).event(I).start()}).on("interrupt.zoom end.zoom",function(){M(this,arguments).event(I).end()}).tween("zoom",function(){var $=this,L=arguments,B=M($,L).event(I),G=n.apply($,L),W=N==null?w(G):typeof N=="function"?N.apply($,L):N,F=Math.max(G[1][0]-G[0][0],G[1][1]-G[0][1]),U=$.__zoom,K=typeof R=="function"?R.apply($,L):R,Y=u(U.invert(W).concat(F/U.k),K.invert(W).concat(F/K.k));return function(se){if(se===1)se=K;else{var ge=Y(se),Ie=F/ge[2];se=new Ue(Ie,W[0]-ge[0]*Ie,W[1]-ge[1]*Ie)}B.zoom(null,se)}})}function M(S,R,N){return!N&&S.__zooming||new E(S,R)}function E(S,R){this.that=S,this.args=R,this.active=0,this.sourceEvent=null,this.extent=n.apply(S,R),this.taps=0}E.prototype={event:function(S){return S&&(this.sourceEvent=S),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(S,R){return this.mouse&&S!=="mouse"&&(this.mouse[1]=R.invert(this.mouse[0])),this.touch0&&S!=="touch"&&(this.touch0[1]=R.invert(this.touch0[0])),this.touch1&&S!=="touch"&&(this.touch1[1]=R.invert(this.touch1[0])),this.that.__zoom=R,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(S){var R=we(this.that).datum();d.call(S,this.that,new sd(S,{sourceEvent:this.sourceEvent,target:x,transform:this.that.__zoom,dispatch:d}),R)}};function y(S,...R){if(!e.apply(this,arguments))return;var N=M(this,R).event(S),I=this.__zoom,$=Math.max(s[0],Math.min(s[1],I.k*Math.pow(2,i.apply(this,arguments)))),L=Te(S);if(N.wheel)(N.mouse[0][0]!==L[0]||N.mouse[0][1]!==L[1])&&(N.mouse[1]=I.invert(N.mouse[0]=L)),clearTimeout(N.wheel);else{if(I.k===$)return;N.mouse=[L,I.invert(L)],on(this),N.start()}mt(S),N.wheel=setTimeout(B,g),N.zoom("mouse",r(C(j(I,$),N.mouse[0],N.mouse[1]),N.extent,o));function B(){N.wheel=null,N.end()}}function T(S,...R){if(p||!e.apply(this,arguments))return;var N=S.currentTarget,I=M(this,R,!0).event(S),$=we(S.view).on("mousemove.zoom",W,!0).on("mouseup.zoom",F,!0),L=Te(S,N),B=S.clientX,G=S.clientY;Aa(S.view),zn(S),I.mouse=[L,this.__zoom.invert(L)],on(this),I.start();function W(U){if(mt(U),!I.moved){var K=U.clientX-B,Y=U.clientY-G;I.moved=K*K+Y*Y>v}I.event(U).zoom("mouse",r(C(I.that.__zoom,I.mouse[0]=Te(U,N),I.mouse[1]),I.extent,o))}function F(U){$.on("mousemove.zoom mouseup.zoom",null),Ta(U.view,I.moved),mt(U),I.event(U).end()}}function k(S,...R){if(e.apply(this,arguments)){var N=this.__zoom,I=Te(S.changedTouches?S.changedTouches[0]:S,this),$=N.invert(I),L=N.k*(S.shiftKey?.5:2),B=r(C(j(N,L),I,$),n.apply(this,R),o);mt(S),c>0?we(this).transition().duration(c).call(_,B,I,S):we(this).call(x.transform,B,I,S)}}function O(S,...R){if(e.apply(this,arguments)){var N=S.touches,I=N.length,$=M(this,R,S.changedTouches.length===I).event(S),L,B,G,W;for(zn(S),B=0;B<I;++B)G=N[B],W=Te(G,this),W=[W,this.__zoom.invert(W),G.identifier],$.touch0?!$.touch1&&$.touch0[2]!==W[2]&&($.touch1=W,$.taps=0):($.touch0=W,L=!0,$.taps=1+!!h);h&&(h=clearTimeout(h)),L&&($.taps<2&&(f=W[0],h=setTimeout(function(){h=null},m)),on(this),$.start())}}function P(S,...R){if(this.__zooming){var N=M(this,R).event(S),I=S.changedTouches,$=I.length,L,B,G,W;for(mt(S),L=0;L<$;++L)B=I[L],G=Te(B,this),N.touch0&&N.touch0[2]===B.identifier?N.touch0[0]=G:N.touch1&&N.touch1[2]===B.identifier&&(N.touch1[0]=G);if(B=N.that.__zoom,N.touch1){var F=N.touch0[0],U=N.touch0[1],K=N.touch1[0],Y=N.touch1[1],se=(se=K[0]-F[0])*se+(se=K[1]-F[1])*se,ge=(ge=Y[0]-U[0])*ge+(ge=Y[1]-U[1])*ge;B=j(B,Math.sqrt(se/ge)),G=[(F[0]+K[0])/2,(F[1]+K[1])/2],W=[(U[0]+Y[0])/2,(U[1]+Y[1])/2]}else if(N.touch0)G=N.touch0[0],W=N.touch0[1];else return;N.zoom("touch",r(C(B,G,W),N.extent,o))}}function z(S,...R){if(this.__zooming){var N=M(this,R).event(S),I=S.changedTouches,$=I.length,L,B;for(zn(S),p&&clearTimeout(p),p=setTimeout(function(){p=null},m),L=0;L<$;++L)B=I[L],N.touch0&&N.touch0[2]===B.identifier?delete N.touch0:N.touch1&&N.touch1[2]===B.identifier&&delete N.touch1;if(N.touch1&&!N.touch0&&(N.touch0=N.touch1,delete N.touch1),N.touch0)N.touch0[1]=this.__zoom.invert(N.touch0[0]);else if(N.end(),N.taps===2&&(B=Te(B,this),Math.hypot(f[0]-B[0],f[1]-B[1])<b)){var G=we(this).on("dblclick.zoom");G&&G.apply(this,arguments)}}}return x.wheelDelta=function(S){return arguments.length?(i=typeof S=="function"?S:Qt(+S),x):i},x.filter=function(S){return arguments.length?(e=typeof S=="function"?S:Qt(!!S),x):e},x.touchable=function(S){return arguments.length?(a=typeof S=="function"?S:Qt(!!S),x):a},x.extent=function(S){return arguments.length?(n=typeof S=="function"?S:Qt([[+S[0][0],+S[0][1]],[+S[1][0],+S[1][1]]]),x):n},x.scaleExtent=function(S){return arguments.length?(s[0]=+S[0],s[1]=+S[1],x):[s[0],s[1]]},x.translateExtent=function(S){return arguments.length?(o[0][0]=+S[0][0],o[1][0]=+S[1][0],o[0][1]=+S[0][1],o[1][1]=+S[1][1],x):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},x.constrain=function(S){return arguments.length?(r=S,x):r},x.duration=function(S){return arguments.length?(c=+S,x):c},x.interpolate=function(S){return arguments.length?(u=S,x):u},x.on=function(){var S=d.on.apply(d,arguments);return S===d?x:S},x.clickDistance=function(S){return arguments.length?(v=(S=+S)*S,x):Math.sqrt(v)},x.tapDistance=function(S){return arguments.length?(b=+S,x):b},x}class oi extends Map{constructor(n,r=md){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),n!=null)for(const[i,a]of n)this.set(i,a)}get(n){return super.get(li(this,n))}has(n){return super.has(li(this,n))}set(n,r){return super.set(hd(this,n),r)}delete(n){return super.delete(pd(this,n))}}function li({_intern:e,_key:n},r){const i=n(r);return e.has(i)?e.get(i):r}function hd({_intern:e,_key:n},r){const i=n(r);return e.has(i)?e.get(i):(e.set(i,r),r)}function pd({_intern:e,_key:n},r){const i=n(r);return e.has(i)&&(r=e.get(i),e.delete(i)),r}function md(e){return e!==null&&typeof e=="object"?e.valueOf():e}function ci(e,n){let r;if(n===void 0)for(const i of e)i!=null&&(r<i||r===void 0&&i>=i)&&(r=i);else{let i=-1;for(let a of e)(a=n(a,++i,e))!=null&&(r<a||r===void 0&&a>=a)&&(r=a)}return r}function ui(e,n){let r;if(n===void 0)for(const i of e)i!=null&&(r>i||r===void 0&&i>=i)&&(r=i);else{let i=-1;for(let a of e)(a=n(a,++i,e))!=null&&(r>a||r===void 0&&a>=a)&&(r=a)}return r}function gd(e,n){let r=0;for(let i of e)(i=+i)&&(r+=i);return r}var xd=typeof global=="object"&&global&&global.Object===Object&&global,yd=typeof self=="object"&&self&&self.Object===Object&&self,Ua=xd||yd||Function("return this")(),xn=Ua.Symbol,Ha=Object.prototype,bd=Ha.hasOwnProperty,vd=Ha.toString,gt=xn?xn.toStringTag:void 0;function _d(e){var n=bd.call(e,gt),r=e[gt];try{e[gt]=void 0;var i=!0}catch{}var a=vd.call(e);return i&&(n?e[gt]=r:delete e[gt]),a}var wd=Object.prototype,Nd=wd.toString;function jd(e){return Nd.call(e)}var kd="[object Null]",Sd="[object Undefined]",di=xn?xn.toStringTag:void 0;function Cd(e){return e==null?e===void 0?Sd:kd:di&&di in Object(e)?_d(e):jd(e)}function Ad(e){return e!=null&&typeof e=="object"}var Td="[object Symbol]";function Od(e){return typeof e=="symbol"||Ad(e)&&Cd(e)==Td}var Md=/\s/;function Ed(e){for(var n=e.length;n--&&Md.test(e.charAt(n)););return n}var Pd=/^\s+/;function Id(e){return e&&e.slice(0,Ed(e)+1).replace(Pd,"")}function yn(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}var fi=NaN,Rd=/^[-+]0x[0-9a-f]+$/i,Dd=/^0b[01]+$/i,zd=/^0o[0-7]+$/i,$d=parseInt;function hi(e){if(typeof e=="number")return e;if(Od(e))return fi;if(yn(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=yn(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=Id(e);var r=Dd.test(e);return r||zd.test(e)?$d(e.slice(2),r?2:8):Rd.test(e)?fi:+e}var $n=function(){return Ua.Date.now()},Fd="Expected a function",Ld=Math.max,qd=Math.min;function Ba(e,n,r){var i,a,s,o,c,u,d=0,h=!1,f=!1,p=!0;if(typeof e!="function")throw new TypeError(Fd);n=hi(n)||0,yn(r)&&(h=!!r.leading,f="maxWait"in r,s=f?Ld(hi(r.maxWait)||0,n):s,p="trailing"in r?!!r.trailing:p);function m(M){var E=i,y=a;return i=a=void 0,d=M,o=e.apply(y,E),o}function g(M){return d=M,c=setTimeout(x,n),h?m(M):o}function v(M){var E=M-u,y=M-d,T=n-E;return f?qd(T,s-y):T}function b(M){var E=M-u,y=M-d;return u===void 0||E>=n||E<0||f&&y>=s}function x(){var M=$n();if(b(M))return j(M);c=setTimeout(x,v(M))}function j(M){return c=void 0,p&&i?m(M):(i=a=void 0,o)}function C(){c!==void 0&&clearTimeout(c),d=0,i=u=a=c=void 0}function w(){return c===void 0?o:j($n())}function _(){var M=$n(),E=b(M);if(i=arguments,a=this,u=M,E){if(c===void 0)return g(u);if(f)return clearTimeout(c),c=setTimeout(x,n),m(u)}return c===void 0&&(c=setTimeout(x,n)),o}return _.cancel=C,_.flush=w,_}var Ud="Expected a function";function Hd(e,n,r){var i=!0,a=!0;if(typeof e!="function")throw new TypeError(Ud);return yn(r)&&(i="leading"in r?!!r.leading:i,a="trailing"in r?!!r.trailing:a),Ba(e,n,{leading:i,maxWait:n,trailing:a})}var nt=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return e},Out:function(e){return e},InOut:function(e){return e}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return .5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return e===0?0:Math.pow(1024,e-1)},Out:function(e){return e===1?1:1-Math.pow(2,-10*e)},InOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return e===0?0:e===1?1:-Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI)},Out:function(e){return e===0?0:e===1?1:Math.pow(2,-10*e)*Math.sin((e-.1)*5*Math.PI)+1},InOut:function(e){return e===0?0:e===1?1:(e*=2,e<1?-.5*Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin((e-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(e){var n=1.70158;return e===1?1:e*e*((n+1)*e-n)},Out:function(e){var n=1.70158;return e===0?0:--e*e*((n+1)*e+n)+1},InOut:function(e){var n=2.5949095;return(e*=2)<1?.5*(e*e*((n+1)*e-n)):.5*((e-=2)*e*((n+1)*e+n)+2)}}),Bounce:Object.freeze({In:function(e){return 1-nt.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?nt.Bounce.In(e*2)*.5:nt.Bounce.Out(e*2-1)*.5+.5}}),generatePow:function(e){return e===void 0&&(e=4),e=e<Number.EPSILON?Number.EPSILON:e,e=e>1e4?1e4:e,{In:function(n){return Math.pow(n,e)},Out:function(n){return 1-Math.pow(1-n,e)},InOut:function(n){return n<.5?Math.pow(n*2,e)/2:(1-Math.pow(2-n*2,e))/2+.5}}}}),jt=function(){return performance.now()},Va=(function(){function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,n)}return e.prototype.getAll=function(){var n=this;return Object.keys(this._tweens).map(function(r){return n._tweens[r]})},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];for(var a=0,s=r;a<s.length;a++){var o=s[a];(n=o._group)===null||n===void 0||n.remove(o),o._group=this,this._tweens[o.getId()]=o,this._tweensAddedDuringUpdate[o.getId()]=o}},e.prototype.remove=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var s=a[i];s._group=void 0,delete this._tweens[s.getId()],delete this._tweensAddedDuringUpdate[s.getId()]}},e.prototype.allStopped=function(){return this.getAll().every(function(n){return!n.isPlaying()})},e.prototype.update=function(n,r){n===void 0&&(n=jt()),r===void 0&&(r=!0);var i=Object.keys(this._tweens);if(i.length!==0)for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var a=0;a<i.length;a++){var s=this._tweens[i[a]],o=!r;s&&s.update(n,o)===!1&&!r&&this.remove(s)}i=Object.keys(this._tweensAddedDuringUpdate)}},e})(),ir={Linear:function(e,n){var r=e.length-1,i=r*n,a=Math.floor(i),s=ir.Utils.Linear;return n<0?s(e[0],e[1],i):n>1?s(e[r],e[r-1],r-i):s(e[a],e[a+1>r?r:a+1],i-a)},Utils:{Linear:function(e,n,r){return(n-e)*r+e}}},Ga=(function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e})(),ar=new Va,pi=(function(){function e(n,r){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=nt.Linear.None,this._interpolationFunction=ir.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=Ga.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=n,typeof r=="object"?(this._group=r,r.add(this)):r===!0&&(this._group=ar,ar.add(this))}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.getDuration=function(){return this._duration},e.prototype.to=function(n,r){if(r===void 0&&(r=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=n,this._propertiesAreSetUp=!1,this._duration=r<0?0:r,this},e.prototype.duration=function(n){return n===void 0&&(n=1e3),this._duration=n<0?0:n,this},e.prototype.dynamic=function(n){return n===void 0&&(n=!1),this._isDynamic=n,this},e.prototype.start=function(n,r){if(n===void 0&&(n=jt()),r===void 0&&(r=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=n,this._startTime+=this._delayTime,!this._propertiesAreSetUp||r){if(this._propertiesAreSetUp=!0,!this._isDynamic){var a={};for(var s in this._valuesEnd)a[s]=this._valuesEnd[s];this._valuesEnd=a}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,r)}return this},e.prototype.startFromCurrentValues=function(n){return this.start(n,!0)},e.prototype._setupProperties=function(n,r,i,a,s){for(var o in i){var c=n[o],u=Array.isArray(c),d=u?"array":typeof c,h=!u&&Array.isArray(i[o]);if(!(d==="undefined"||d==="function")){if(h){var f=i[o];if(f.length===0)continue;for(var p=[c],m=0,g=f.length;m<g;m+=1){var v=this._handleRelativeValue(c,f[m]);if(isNaN(v)){h=!1,console.warn("Found invalid interpolation list. Skipping.");break}p.push(v)}h&&(i[o]=p)}if((d==="object"||u)&&c&&!h){r[o]=u?[]:{};var b=c;for(var x in b)r[o][x]=b[x];a[o]=u?[]:{};var f=i[o];if(!this._isDynamic){var j={};for(var x in f)j[x]=f[x];i[o]=f=j}this._setupProperties(b,r[o],f,a[o],s)}else(typeof r[o]>"u"||s)&&(r[o]=c),u||(r[o]*=1),h?a[o]=i[o].slice().reverse():a[o]=r[o]||0}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},e.prototype.pause=function(n){return n===void 0&&(n=jt()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=n,this)},e.prototype.resume=function(n){return n===void 0&&(n=jt()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=n-this._pauseStart,this._pauseStart=0,this)},e.prototype.stopChainedTweens=function(){for(var n=0,r=this._chainedTweens.length;n<r;n++)this._chainedTweens[n].stop();return this},e.prototype.group=function(n){return n?(n.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},e.prototype.remove=function(){var n;return(n=this._group)===null||n===void 0||n.remove(this),this},e.prototype.delay=function(n){return n===void 0&&(n=0),this._delayTime=n,this},e.prototype.repeat=function(n){return n===void 0&&(n=0),this._initialRepeat=n,this._repeat=n,this},e.prototype.repeatDelay=function(n){return this._repeatDelayTime=n,this},e.prototype.yoyo=function(n){return n===void 0&&(n=!1),this._yoyo=n,this},e.prototype.easing=function(n){return n===void 0&&(n=nt.Linear.None),this._easingFunction=n,this},e.prototype.interpolation=function(n){return n===void 0&&(n=ir.Linear),this._interpolationFunction=n,this},e.prototype.chain=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return this._chainedTweens=n,this},e.prototype.onStart=function(n){return this._onStartCallback=n,this},e.prototype.onEveryStart=function(n){return this._onEveryStartCallback=n,this},e.prototype.onUpdate=function(n){return this._onUpdateCallback=n,this},e.prototype.onRepeat=function(n){return this._onRepeatCallback=n,this},e.prototype.onComplete=function(n){return this._onCompleteCallback=n,this},e.prototype.onStop=function(n){return this._onStopCallback=n,this},e.prototype.update=function(n,r){var i=this,a;if(n===void 0&&(n=jt()),r===void 0&&(r=e.autoStartOnUpdate),this._isPaused)return!0;var s;if(!this._goToEnd&&!this._isPlaying)if(r)this.start(n,!0);else return!1;if(this._goToEnd=!1,n<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=n-this._startTime,c=this._duration+((a=this._repeatDelayTime)!==null&&a!==void 0?a:this._delayTime),u=this._duration+this._repeat*c,d=function(){if(i._duration===0||o>u)return 1;var v=Math.trunc(o/c),b=o-v*c,x=Math.min(b/i._duration,1);return x===0&&o===i._duration?1:x},h=d(),f=this._easingFunction(h);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,f),this._onUpdateCallback&&this._onUpdateCallback(this._object,h),this._duration===0||o>=this._duration)if(this._repeat>0){var p=Math.min(Math.trunc((o-this._duration)/c)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=p);for(s in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[s]=="string"&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=c*p,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var m=0,g=this._chainedTweens.length;m<g;m++)this._chainedTweens[m].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(n,r,i,a){for(var s in i)if(r[s]!==void 0){var o=r[s]||0,c=i[s],u=Array.isArray(n[s]),d=Array.isArray(c),h=!u&&d;h?n[s]=this._interpolationFunction(c,a):typeof c=="object"&&c?this._updateProperties(n[s],o,c,a):(c=this._handleRelativeValue(o,c),typeof c=="number"&&(n[s]=o+(c-o)*a))}},e.prototype._handleRelativeValue=function(n,r){return typeof r!="string"?r:r.charAt(0)==="+"||r.charAt(0)==="-"?n+parseFloat(r):parseFloat(r)},e.prototype._swapEndStartRepeatValues=function(n){var r=this._valuesStartRepeat[n],i=this._valuesEnd[n];typeof i=="string"?this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(i):this._valuesStartRepeat[n]=this._valuesEnd[n],this._valuesEnd[n]=r},e.autoStartOnUpdate=!1,e})();Ga.nextId;var Ee=ar;Ee.getAll.bind(Ee);Ee.removeAll.bind(Ee);Ee.add.bind(Ee);Ee.remove.bind(Ee);Ee.update.bind(Ee);function mi(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,i=Array(n);r<n;r++)i[r]=e[r];return i}function Bd(e){if(Array.isArray(e))return e}function Vd(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function Gd(e,n,r){return Object.defineProperty(e,"prototype",{writable:!1}),e}function Wd(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,s,o,c=[],u=!0,d=!1;try{if(s=(r=r.call(e)).next,n!==0)for(;!(u=(i=s.call(r)).done)&&(c.push(i.value),c.length!==n);u=!0);}catch(h){d=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return c}}function Kd(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yd(e,n){return Bd(e)||Wd(e,n)||Jd(e,n)||Kd()}function Jd(e,n){if(e){if(typeof e=="string")return mi(e,n);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mi(e,n):void 0}}var Xd=Gd(function e(n,r){var i=r.default,a=i===void 0?null:i,s=r.triggerUpdate,o=s===void 0?!0:s,c=r.onChange,u=c===void 0?function(d,h){}:c;Vd(this,e),this.name=n,this.defaultVal=a,this.triggerUpdate=o,this.onChange=u});function Sr(e){var n=e.stateInit,r=n===void 0?function(){return{}}:n,i=e.props,a=i===void 0?{}:i,s=e.methods,o=s===void 0?{}:s,c=e.aliases,u=c===void 0?{}:c,d=e.init,h=d===void 0?function(){}:d,f=e.update,p=f===void 0?function(){}:f,m=Object.keys(a).map(function(g){return new Xd(g,a[g])});return function g(){for(var v=arguments.length,b=new Array(v),x=0;x<v;x++)b[x]=arguments[x];var j=!!(this instanceof g&&this.constructor),C=j?b.shift():void 0,w=b[0],_=w===void 0?{}:w,M=Object.assign({},r instanceof Function?r(_):r,{initialised:!1}),E={};function y(O){return T(O,_),k(),y}var T=function(P,z){h.call(y,P,M,z),M.initialised=!0},k=Ba(function(){M.initialised&&(p.call(y,M,E),E={})},1);return m.forEach(function(O){y[O.name]=P(O);function P(z){var S=z.name,R=z.triggerUpdate,N=R===void 0?!1:R,I=z.onChange,$=I===void 0?function(G,W){}:I,L=z.defaultVal,B=L===void 0?null:L;return function(G){var W=M[S];if(!arguments.length)return W;var F=G===void 0?B:G;return M[S]=F,$.call(y,F,M,W),!E.hasOwnProperty(S)&&(E[S]=W),N&&k(),y}}}),Object.keys(o).forEach(function(O){y[O]=function(){for(var P,z=arguments.length,S=new Array(z),R=0;R<z;R++)S[R]=arguments[R];return(P=o[O]).call.apply(P,[y,M].concat(S))}}),Object.entries(u).forEach(function(O){var P=Yd(O,2),z=P[0],S=P[1];return y[z]=y[S]}),y.resetProps=function(){return m.forEach(function(O){y[O.name](O.defaultVal)}),y},y.resetProps(),M._rerender=k,j&&C&&y(C),y}}var J=(function(e){return typeof e=="function"?e:typeof e=="string"?function(n){return n[e]}:function(n){return e}});function bn(e){"@babel/helpers - typeof";return bn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},bn(e)}var Qd=/^\s+/,Zd=/\s+$/;function H(e,n){if(e=e||"",n=n||{},e instanceof H)return e;if(!(this instanceof H))return new H(e,n);var r=ef(e);this._originalInput=e,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=n.format||r.format,this._gradientType=n.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}H.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var n=this.toRgb();return(n.r*299+n.g*587+n.b*114)/1e3},getLuminance:function(){var n=this.toRgb(),r,i,a,s,o,c;return r=n.r/255,i=n.g/255,a=n.b/255,r<=.03928?s=r/12.92:s=Math.pow((r+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),a<=.03928?c=a/12.92:c=Math.pow((a+.055)/1.055,2.4),.2126*s+.7152*o+.0722*c},setAlpha:function(n){return this._a=Wa(n),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var n=xi(this._r,this._g,this._b);return{h:n.h*360,s:n.s,v:n.v,a:this._a}},toHsvString:function(){var n=xi(this._r,this._g,this._b),r=Math.round(n.h*360),i=Math.round(n.s*100),a=Math.round(n.v*100);return this._a==1?"hsv("+r+", "+i+"%, "+a+"%)":"hsva("+r+", "+i+"%, "+a+"%, "+this._roundA+")"},toHsl:function(){var n=gi(this._r,this._g,this._b);return{h:n.h*360,s:n.s,l:n.l,a:this._a}},toHslString:function(){var n=gi(this._r,this._g,this._b),r=Math.round(n.h*360),i=Math.round(n.s*100),a=Math.round(n.l*100);return this._a==1?"hsl("+r+", "+i+"%, "+a+"%)":"hsla("+r+", "+i+"%, "+a+"%, "+this._roundA+")"},toHex:function(n){return yi(this._r,this._g,this._b,n)},toHexString:function(n){return"#"+this.toHex(n)},toHex8:function(n){return af(this._r,this._g,this._b,this._a,n)},toHex8String:function(n){return"#"+this.toHex8(n)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(re(this._r,255)*100)+"%",g:Math.round(re(this._g,255)*100)+"%",b:Math.round(re(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(re(this._r,255)*100)+"%, "+Math.round(re(this._g,255)*100)+"%, "+Math.round(re(this._b,255)*100)+"%)":"rgba("+Math.round(re(this._r,255)*100)+"%, "+Math.round(re(this._g,255)*100)+"%, "+Math.round(re(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:xf[yi(this._r,this._g,this._b,!0)]||!1},toFilter:function(n){var r="#"+bi(this._r,this._g,this._b,this._a),i=r,a=this._gradientType?"GradientType = 1, ":"";if(n){var s=H(n);i="#"+bi(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+a+"startColorstr="+r+",endColorstr="+i+")"},toString:function(n){var r=!!n;n=n||this._format;var i=!1,a=this._a<1&&this._a>=0,s=!r&&a&&(n==="hex"||n==="hex6"||n==="hex3"||n==="hex4"||n==="hex8"||n==="name");return s?n==="name"&&this._a===0?this.toName():this.toRgbString():(n==="rgb"&&(i=this.toRgbString()),n==="prgb"&&(i=this.toPercentageRgbString()),(n==="hex"||n==="hex6")&&(i=this.toHexString()),n==="hex3"&&(i=this.toHexString(!0)),n==="hex4"&&(i=this.toHex8String(!0)),n==="hex8"&&(i=this.toHex8String()),n==="name"&&(i=this.toName()),n==="hsl"&&(i=this.toHslString()),n==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},clone:function(){return H(this.toString())},_applyModification:function(n,r){var i=n.apply(null,[this].concat([].slice.call(r)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(cf,arguments)},brighten:function(){return this._applyModification(uf,arguments)},darken:function(){return this._applyModification(df,arguments)},desaturate:function(){return this._applyModification(sf,arguments)},saturate:function(){return this._applyModification(of,arguments)},greyscale:function(){return this._applyModification(lf,arguments)},spin:function(){return this._applyModification(ff,arguments)},_applyCombination:function(n,r){return n.apply(null,[this].concat([].slice.call(r)))},analogous:function(){return this._applyCombination(mf,arguments)},complement:function(){return this._applyCombination(hf,arguments)},monochromatic:function(){return this._applyCombination(gf,arguments)},splitcomplement:function(){return this._applyCombination(pf,arguments)},triad:function(){return this._applyCombination(vi,[3])},tetrad:function(){return this._applyCombination(vi,[4])}};H.fromRatio=function(e,n){if(bn(e)=="object"){var r={};for(var i in e)e.hasOwnProperty(i)&&(i==="a"?r[i]=e[i]:r[i]=kt(e[i]));e=r}return H(e,n)};function ef(e){var n={r:0,g:0,b:0},r=1,i=null,a=null,s=null,o=!1,c=!1;return typeof e=="string"&&(e=_f(e)),bn(e)=="object"&&(De(e.r)&&De(e.g)&&De(e.b)?(n=tf(e.r,e.g,e.b),o=!0,c=String(e.r).substr(-1)==="%"?"prgb":"rgb"):De(e.h)&&De(e.s)&&De(e.v)?(i=kt(e.s),a=kt(e.v),n=rf(e.h,i,a),o=!0,c="hsv"):De(e.h)&&De(e.s)&&De(e.l)&&(i=kt(e.s),s=kt(e.l),n=nf(e.h,i,s),o=!0,c="hsl"),e.hasOwnProperty("a")&&(r=e.a)),r=Wa(r),{ok:o,format:e.format||c,r:Math.min(255,Math.max(n.r,0)),g:Math.min(255,Math.max(n.g,0)),b:Math.min(255,Math.max(n.b,0)),a:r}}function tf(e,n,r){return{r:re(e,255)*255,g:re(n,255)*255,b:re(r,255)*255}}function gi(e,n,r){e=re(e,255),n=re(n,255),r=re(r,255);var i=Math.max(e,n,r),a=Math.min(e,n,r),s,o,c=(i+a)/2;if(i==a)s=o=0;else{var u=i-a;switch(o=c>.5?u/(2-i-a):u/(i+a),i){case e:s=(n-r)/u+(n<r?6:0);break;case n:s=(r-e)/u+2;break;case r:s=(e-n)/u+4;break}s/=6}return{h:s,s:o,l:c}}function nf(e,n,r){var i,a,s;e=re(e,360),n=re(n,100),r=re(r,100);function o(d,h,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?d+(h-d)*6*f:f<1/2?h:f<2/3?d+(h-d)*(2/3-f)*6:d}if(n===0)i=a=s=r;else{var c=r<.5?r*(1+n):r+n-r*n,u=2*r-c;i=o(u,c,e+1/3),a=o(u,c,e),s=o(u,c,e-1/3)}return{r:i*255,g:a*255,b:s*255}}function xi(e,n,r){e=re(e,255),n=re(n,255),r=re(r,255);var i=Math.max(e,n,r),a=Math.min(e,n,r),s,o,c=i,u=i-a;if(o=i===0?0:u/i,i==a)s=0;else{switch(i){case e:s=(n-r)/u+(n<r?6:0);break;case n:s=(r-e)/u+2;break;case r:s=(e-n)/u+4;break}s/=6}return{h:s,s:o,v:c}}function rf(e,n,r){e=re(e,360)*6,n=re(n,100),r=re(r,100);var i=Math.floor(e),a=e-i,s=r*(1-n),o=r*(1-a*n),c=r*(1-(1-a)*n),u=i%6,d=[r,o,s,s,c,r][u],h=[c,r,r,o,s,s][u],f=[s,s,c,r,r,o][u];return{r:d*255,g:h*255,b:f*255}}function yi(e,n,r,i){var a=[Se(Math.round(e).toString(16)),Se(Math.round(n).toString(16)),Se(Math.round(r).toString(16))];return i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function af(e,n,r,i,a){var s=[Se(Math.round(e).toString(16)),Se(Math.round(n).toString(16)),Se(Math.round(r).toString(16)),Se(Ka(i))];return a&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function bi(e,n,r,i){var a=[Se(Ka(i)),Se(Math.round(e).toString(16)),Se(Math.round(n).toString(16)),Se(Math.round(r).toString(16))];return a.join("")}H.equals=function(e,n){return!e||!n?!1:H(e).toRgbString()==H(n).toRgbString()};H.random=function(){return H.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function sf(e,n){n=n===0?0:n||10;var r=H(e).toHsl();return r.s-=n/100,r.s=Sn(r.s),H(r)}function of(e,n){n=n===0?0:n||10;var r=H(e).toHsl();return r.s+=n/100,r.s=Sn(r.s),H(r)}function lf(e){return H(e).desaturate(100)}function cf(e,n){n=n===0?0:n||10;var r=H(e).toHsl();return r.l+=n/100,r.l=Sn(r.l),H(r)}function uf(e,n){n=n===0?0:n||10;var r=H(e).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(n/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(n/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(n/100)))),H(r)}function df(e,n){n=n===0?0:n||10;var r=H(e).toHsl();return r.l-=n/100,r.l=Sn(r.l),H(r)}function ff(e,n){var r=H(e).toHsl(),i=(r.h+n)%360;return r.h=i<0?360+i:i,H(r)}function hf(e){var n=H(e).toHsl();return n.h=(n.h+180)%360,H(n)}function vi(e,n){if(isNaN(n)||n<=0)throw new Error("Argument to polyad must be a positive number");for(var r=H(e).toHsl(),i=[H(e)],a=360/n,s=1;s<n;s++)i.push(H({h:(r.h+s*a)%360,s:r.s,l:r.l}));return i}function pf(e){var n=H(e).toHsl(),r=n.h;return[H(e),H({h:(r+72)%360,s:n.s,l:n.l}),H({h:(r+216)%360,s:n.s,l:n.l})]}function mf(e,n,r){n=n||6,r=r||30;var i=H(e).toHsl(),a=360/r,s=[H(e)];for(i.h=(i.h-(a*n>>1)+720)%360;--n;)i.h=(i.h+a)%360,s.push(H(i));return s}function gf(e,n){n=n||6;for(var r=H(e).toHsv(),i=r.h,a=r.s,s=r.v,o=[],c=1/n;n--;)o.push(H({h:i,s:a,v:s})),s=(s+c)%1;return o}H.mix=function(e,n,r){r=r===0?0:r||50;var i=H(e).toRgb(),a=H(n).toRgb(),s=r/100,o={r:(a.r-i.r)*s+i.r,g:(a.g-i.g)*s+i.g,b:(a.b-i.b)*s+i.b,a:(a.a-i.a)*s+i.a};return H(o)};H.readability=function(e,n){var r=H(e),i=H(n);return(Math.max(r.getLuminance(),i.getLuminance())+.05)/(Math.min(r.getLuminance(),i.getLuminance())+.05)};H.isReadable=function(e,n,r){var i=H.readability(e,n),a,s;switch(s=!1,a=wf(r),a.level+a.size){case"AAsmall":case"AAAlarge":s=i>=4.5;break;case"AAlarge":s=i>=3;break;case"AAAsmall":s=i>=7;break}return s};H.mostReadable=function(e,n,r){var i=null,a=0,s,o,c,u;r=r||{},o=r.includeFallbackColors,c=r.level,u=r.size;for(var d=0;d<n.length;d++)s=H.readability(e,n[d]),s>a&&(a=s,i=H(n[d]));return H.isReadable(e,i,{level:c,size:u})||!o?i:(r.includeFallbackColors=!1,H.mostReadable(e,["#fff","#000"],r))};var sr=H.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},xf=H.hexNames=yf(sr);function yf(e){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[e[r]]=r);return n}function Wa(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function re(e,n){bf(e)&&(e="100%");var r=vf(e);return e=Math.min(n,Math.max(0,parseFloat(e))),r&&(e=parseInt(e*n,10)/100),Math.abs(e-n)<1e-6?1:e%n/parseFloat(n)}function Sn(e){return Math.min(1,Math.max(0,e))}function xe(e){return parseInt(e,16)}function bf(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function vf(e){return typeof e=="string"&&e.indexOf("%")!=-1}function Se(e){return e.length==1?"0"+e:""+e}function kt(e){return e<=1&&(e=e*100+"%"),e}function Ka(e){return Math.round(parseFloat(e)*255).toString(16)}function _i(e){return xe(e)/255}var je=(function(){var e="[-\\+]?\\d+%?",n="[-\\+]?\\d*\\.\\d+%?",r="(?:"+n+")|(?:"+e+")",i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",a="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+a),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+a),hsv:new RegExp("hsv"+i),hsva:new RegExp("hsva"+a),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}})();function De(e){return!!je.CSS_UNIT.exec(e)}function _f(e){e=e.replace(Qd,"").replace(Zd,"").toLowerCase();var n=!1;if(sr[e])e=sr[e],n=!0;else if(e=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=je.rgb.exec(e))?{r:r[1],g:r[2],b:r[3]}:(r=je.rgba.exec(e))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=je.hsl.exec(e))?{h:r[1],s:r[2],l:r[3]}:(r=je.hsla.exec(e))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=je.hsv.exec(e))?{h:r[1],s:r[2],v:r[3]}:(r=je.hsva.exec(e))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=je.hex8.exec(e))?{r:xe(r[1]),g:xe(r[2]),b:xe(r[3]),a:_i(r[4]),format:n?"name":"hex8"}:(r=je.hex6.exec(e))?{r:xe(r[1]),g:xe(r[2]),b:xe(r[3]),format:n?"name":"hex"}:(r=je.hex4.exec(e))?{r:xe(r[1]+""+r[1]),g:xe(r[2]+""+r[2]),b:xe(r[3]+""+r[3]),a:_i(r[4]+""+r[4]),format:n?"name":"hex8"}:(r=je.hex3.exec(e))?{r:xe(r[1]+""+r[1]),g:xe(r[2]+""+r[2]),b:xe(r[3]+""+r[3]),format:n?"name":"hex"}:!1}function wf(e){var n,r;return e=e||{level:"AA",size:"small"},n=(e.level||"AA").toUpperCase(),r=(e.size||"small").toLowerCase(),n!=="AA"&&n!=="AAA"&&(n="AA"),r!=="small"&&r!=="large"&&(r="small"),{level:n,size:r}}function or(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,i=Array(n);r<n;r++)i[r]=e[r];return i}function Nf(e){if(Array.isArray(e))return or(e)}function Ya(e,n,r){if(typeof e=="function"?e===n:e.has(n))return arguments.length<3?n:r;throw new TypeError("Private element is not present on this object")}function jf(e,n){if(n.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kf(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function ve(e,n){return e.get(Ya(e,n))}function wi(e,n,r){jf(e,n),n.set(e,r)}function Ni(e,n,r){return e.set(Ya(e,n),r),r}function Sf(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Ef(i.key),i)}}function Cf(e,n,r){return n&&Sf(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Af(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Tf(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Of(e){return Nf(e)||Af(e)||Pf(e)||Tf()}function Mf(e,n){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Ef(e){var n=Mf(e,"string");return typeof n=="symbol"?n:n+""}function Pf(e,n){if(e){if(typeof e=="string")return or(e,n);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?or(e,n):void 0}}var If=123,Rf=function(n){return"#".concat(Math.min(n,Math.pow(2,24)).toString(16).padStart(6,"0"))},Ja=function(n,r,i){return(n<<16)+(r<<8)+i},Df=function(n){var r=H(n).toRgb(),i=r.r,a=r.g,s=r.b;return Ja(i,a,s)},ji=function(n,r){return n*If%Math.pow(2,r)},Xe=new WeakMap,ze=new WeakMap,zf=(function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:6;kf(this,e),wi(this,Xe,void 0),wi(this,ze,void 0),Ni(ze,this,n),this.reset()}return Cf(e,[{key:"reset",value:function(){Ni(Xe,this,["__reserved for background__"])}},{key:"register",value:function(r){if(ve(Xe,this).length>=Math.pow(2,24-ve(ze,this)))return null;var i=ve(Xe,this).length,a=ji(i,ve(ze,this)),s=Rf(i+(a<<24-ve(ze,this)));return ve(Xe,this).push(r),s}},{key:"lookup",value:function(r){if(!r)return null;var i=typeof r=="string"?Df(r):Ja.apply(void 0,Of(r));if(!i)return null;var a=i&Math.pow(2,24-ve(ze,this))-1,s=i>>24-ve(ze,this)&Math.pow(2,ve(ze,this))-1;return ji(a,ve(ze,this))!==s||a>=ve(Xe,this).length?null:ve(Xe,this)[a]}}])})(),Gt,ie,Xa,Qa,Ze,ki,Za,es,ts,Cr,lr,cr,qt={},ns=[],$f=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Cn=Array.isArray;function Oe(e,n){for(var r in n)e[r]=n[r];return e}function Ar(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Ff(e,n,r){var i,a,s,o={};for(s in n)s=="key"?i=n[s]:s=="ref"?a=n[s]:o[s]=n[s];if(arguments.length>2&&(o.children=arguments.length>3?Gt.call(arguments,2):r),typeof e=="function"&&e.defaultProps!=null)for(s in e.defaultProps)o[s]===void 0&&(o[s]=e.defaultProps[s]);return Mt(e,o,i,a,null)}function Mt(e,n,r,i,a){var s={type:e,props:n,key:r,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:a??++Xa,__i:-1,__u:0};return a==null&&ie.vnode!=null&&ie.vnode(s),s}function An(e){return e.children}function ln(e,n){this.props=e,this.context=n}function dt(e,n){if(n==null)return e.__?dt(e.__,e.__i+1):null;for(var r;n<e.__k.length;n++)if((r=e.__k[n])!=null&&r.__e!=null)return r.__e;return typeof e.type=="function"?dt(e):null}function rs(e){var n,r;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,n=0;n<e.__k.length;n++)if((r=e.__k[n])!=null&&r.__e!=null){e.__e=e.__c.base=r.__e;break}return rs(e)}}function Si(e){(!e.__d&&(e.__d=!0)&&Ze.push(e)&&!vn.__r++||ki!=ie.debounceRendering)&&((ki=ie.debounceRendering)||Za)(vn)}function vn(){for(var e,n,r,i,a,s,o,c=1;Ze.length;)Ze.length>c&&Ze.sort(es),e=Ze.shift(),c=Ze.length,e.__d&&(r=void 0,i=void 0,a=(i=(n=e).__v).__e,s=[],o=[],n.__P&&((r=Oe({},i)).__v=i.__v+1,ie.vnode&&ie.vnode(r),Tr(n.__P,r,i,n.__n,n.__P.namespaceURI,32&i.__u?[a]:null,s,a??dt(i),!!(32&i.__u),o),r.__v=i.__v,r.__.__k[r.__i]=r,ss(s,r,o),i.__e=i.__=null,r.__e!=a&&rs(r)));vn.__r=0}function is(e,n,r,i,a,s,o,c,u,d,h){var f,p,m,g,v,b,x,j=i&&i.__k||ns,C=n.length;for(u=Lf(r,n,j,u,C),f=0;f<C;f++)(m=r.__k[f])!=null&&(p=m.__i==-1?qt:j[m.__i]||qt,m.__i=f,b=Tr(e,m,p,a,s,o,c,u,d,h),g=m.__e,m.ref&&p.ref!=m.ref&&(p.ref&&Or(p.ref,null,m),h.push(m.ref,m.__c||g,m)),v==null&&g!=null&&(v=g),(x=!!(4&m.__u))||p.__k===m.__k?u=as(m,u,e,x):typeof m.type=="function"&&b!==void 0?u=b:g&&(u=g.nextSibling),m.__u&=-7);return r.__e=v,u}function Lf(e,n,r,i,a){var s,o,c,u,d,h=r.length,f=h,p=0;for(e.__k=new Array(a),s=0;s<a;s++)(o=n[s])!=null&&typeof o!="boolean"&&typeof o!="function"?(typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?o=e.__k[s]=Mt(null,o,null,null,null):Cn(o)?o=e.__k[s]=Mt(An,{children:o},null,null,null):o.constructor===void 0&&o.__b>0?o=e.__k[s]=Mt(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):e.__k[s]=o,u=s+p,o.__=e,o.__b=e.__b+1,c=null,(d=o.__i=qf(o,r,u,f))!=-1&&(f--,(c=r[d])&&(c.__u|=2)),c==null||c.__v==null?(d==-1&&(a>h?p--:a<h&&p++),typeof o.type!="function"&&(o.__u|=4)):d!=u&&(d==u-1?p--:d==u+1?p++:(d>u?p--:p++,o.__u|=4))):e.__k[s]=null;if(f)for(s=0;s<h;s++)(c=r[s])!=null&&(2&c.__u)==0&&(c.__e==i&&(i=dt(c)),ls(c,c));return i}function as(e,n,r,i){var a,s;if(typeof e.type=="function"){for(a=e.__k,s=0;a&&s<a.length;s++)a[s]&&(a[s].__=e,n=as(a[s],n,r,i));return n}e.__e!=n&&(i&&(n&&e.type&&!n.parentNode&&(n=dt(e)),r.insertBefore(e.__e,n||null)),n=e.__e);do n=n&&n.nextSibling;while(n!=null&&n.nodeType==8);return n}function qf(e,n,r,i){var a,s,o,c=e.key,u=e.type,d=n[r],h=d!=null&&(2&d.__u)==0;if(d===null&&c==null||h&&c==d.key&&u==d.type)return r;if(i>(h?1:0)){for(a=r-1,s=r+1;a>=0||s<n.length;)if((d=n[o=a>=0?a--:s++])!=null&&(2&d.__u)==0&&c==d.key&&u==d.type)return o}return-1}function Ci(e,n,r){n[0]=="-"?e.setProperty(n,r??""):e[n]=r==null?"":typeof r!="number"||$f.test(n)?r:r+"px"}function Zt(e,n,r,i,a){var s,o;e:if(n=="style")if(typeof r=="string")e.style.cssText=r;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(n in i)r&&n in r||Ci(e.style,n,"");if(r)for(n in r)i&&r[n]==i[n]||Ci(e.style,n,r[n])}else if(n[0]=="o"&&n[1]=="n")s=n!=(n=n.replace(ts,"$1")),o=n.toLowerCase(),n=o in e||n=="onFocusOut"||n=="onFocusIn"?o.slice(2):n.slice(2),e.l||(e.l={}),e.l[n+s]=r,r?i?r.u=i.u:(r.u=Cr,e.addEventListener(n,s?cr:lr,s)):e.removeEventListener(n,s?cr:lr,s);else{if(a=="http://www.w3.org/2000/svg")n=n.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(n!="width"&&n!="height"&&n!="href"&&n!="list"&&n!="form"&&n!="tabIndex"&&n!="download"&&n!="rowSpan"&&n!="colSpan"&&n!="role"&&n!="popover"&&n in e)try{e[n]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&n[4]!="-"?e.removeAttribute(n):e.setAttribute(n,n=="popover"&&r==1?"":r))}}function Ai(e){return function(n){if(this.l){var r=this.l[n.type+e];if(n.t==null)n.t=Cr++;else if(n.t<r.u)return;return r(ie.event?ie.event(n):n)}}}function Tr(e,n,r,i,a,s,o,c,u,d){var h,f,p,m,g,v,b,x,j,C,w,_,M,E,y,T,k,O=n.type;if(n.constructor!==void 0)return null;128&r.__u&&(u=!!(32&r.__u),s=[c=n.__e=r.__e]),(h=ie.__b)&&h(n);e:if(typeof O=="function")try{if(x=n.props,j="prototype"in O&&O.prototype.render,C=(h=O.contextType)&&i[h.__c],w=h?C?C.props.value:h.__:i,r.__c?b=(f=n.__c=r.__c).__=f.__E:(j?n.__c=f=new O(x,w):(n.__c=f=new ln(x,w),f.constructor=O,f.render=Hf),C&&C.sub(f),f.state||(f.state={}),f.__n=i,p=f.__d=!0,f.__h=[],f._sb=[]),j&&f.__s==null&&(f.__s=f.state),j&&O.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=Oe({},f.__s)),Oe(f.__s,O.getDerivedStateFromProps(x,f.__s))),m=f.props,g=f.state,f.__v=n,p)j&&O.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),j&&f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(j&&O.getDerivedStateFromProps==null&&x!==m&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(x,w),n.__v==r.__v||!f.__e&&f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(x,f.__s,w)===!1){for(n.__v!=r.__v&&(f.props=x,f.state=f.__s,f.__d=!1),n.__e=r.__e,n.__k=r.__k,n.__k.some(function(P){P&&(P.__=n)}),_=0;_<f._sb.length;_++)f.__h.push(f._sb[_]);f._sb=[],f.__h.length&&o.push(f);break e}f.componentWillUpdate!=null&&f.componentWillUpdate(x,f.__s,w),j&&f.componentDidUpdate!=null&&f.__h.push(function(){f.componentDidUpdate(m,g,v)})}if(f.context=w,f.props=x,f.__P=e,f.__e=!1,M=ie.__r,E=0,j){for(f.state=f.__s,f.__d=!1,M&&M(n),h=f.render(f.props,f.state,f.context),y=0;y<f._sb.length;y++)f.__h.push(f._sb[y]);f._sb=[]}else do f.__d=!1,M&&M(n),h=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++E<25);f.state=f.__s,f.getChildContext!=null&&(i=Oe(Oe({},i),f.getChildContext())),j&&!p&&f.getSnapshotBeforeUpdate!=null&&(v=f.getSnapshotBeforeUpdate(m,g)),T=h,h!=null&&h.type===An&&h.key==null&&(T=os(h.props.children)),c=is(e,Cn(T)?T:[T],n,r,i,a,s,o,c,u,d),f.base=n.__e,n.__u&=-161,f.__h.length&&o.push(f),b&&(f.__E=f.__=null)}catch(P){if(n.__v=null,u||s!=null)if(P.then){for(n.__u|=u?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;s[s.indexOf(c)]=null,n.__e=c}else{for(k=s.length;k--;)Ar(s[k]);ur(n)}else n.__e=r.__e,n.__k=r.__k,P.then||ur(n);ie.__e(P,n,r)}else s==null&&n.__v==r.__v?(n.__k=r.__k,n.__e=r.__e):c=n.__e=Uf(r.__e,n,r,i,a,s,o,u,d);return(h=ie.diffed)&&h(n),128&n.__u?void 0:c}function ur(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(ur)}function ss(e,n,r){for(var i=0;i<r.length;i++)Or(r[i],r[++i],r[++i]);ie.__c&&ie.__c(n,e),e.some(function(a){try{e=a.__h,a.__h=[],e.some(function(s){s.call(a)})}catch(s){ie.__e(s,a.__v)}})}function os(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:Cn(e)?e.map(os):Oe({},e)}function Uf(e,n,r,i,a,s,o,c,u){var d,h,f,p,m,g,v,b=r.props||qt,x=n.props,j=n.type;if(j=="svg"?a="http://www.w3.org/2000/svg":j=="math"?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),s!=null){for(d=0;d<s.length;d++)if((m=s[d])&&"setAttribute"in m==!!j&&(j?m.localName==j:m.nodeType==3)){e=m,s[d]=null;break}}if(e==null){if(j==null)return document.createTextNode(x);e=document.createElementNS(a,j,x.is&&x),c&&(ie.__m&&ie.__m(n,s),c=!1),s=null}if(j==null)b===x||c&&e.data==x||(e.data=x);else{if(s=s&&Gt.call(e.childNodes),!c&&s!=null)for(b={},d=0;d<e.attributes.length;d++)b[(m=e.attributes[d]).name]=m.value;for(d in b)if(m=b[d],d!="children"){if(d=="dangerouslySetInnerHTML")f=m;else if(!(d in x)){if(d=="value"&&"defaultValue"in x||d=="checked"&&"defaultChecked"in x)continue;Zt(e,d,null,m,a)}}for(d in x)m=x[d],d=="children"?p=m:d=="dangerouslySetInnerHTML"?h=m:d=="value"?g=m:d=="checked"?v=m:c&&typeof m!="function"||b[d]===m||Zt(e,d,m,b[d],a);if(h)c||f&&(h.__html==f.__html||h.__html==e.innerHTML)||(e.innerHTML=h.__html),n.__k=[];else if(f&&(e.innerHTML=""),is(n.type=="template"?e.content:e,Cn(p)?p:[p],n,r,i,j=="foreignObject"?"http://www.w3.org/1999/xhtml":a,s,o,s?s[0]:r.__k&&dt(r,0),c,u),s!=null)for(d=s.length;d--;)Ar(s[d]);c||(d="value",j=="progress"&&g==null?e.removeAttribute("value"):g!=null&&(g!==e[d]||j=="progress"&&!g||j=="option"&&g!=b[d])&&Zt(e,d,g,b[d],a),d="checked",v!=null&&v!=e[d]&&Zt(e,d,v,b[d],a))}return e}function Or(e,n,r){try{if(typeof e=="function"){var i=typeof e.__u=="function";i&&e.__u(),i&&n==null||(e.__u=e(n))}else e.current=n}catch(a){ie.__e(a,r)}}function ls(e,n,r){var i,a;if(ie.unmount&&ie.unmount(e),(i=e.ref)&&(i.current&&i.current!=e.__e||Or(i,null,n)),(i=e.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(s){ie.__e(s,n)}i.base=i.__P=null}if(i=e.__k)for(a=0;a<i.length;a++)i[a]&&ls(i[a],n,r||typeof e.type!="function");r||Ar(e.__e),e.__c=e.__=e.__e=void 0}function Hf(e,n,r){return this.constructor(e,r)}function Bf(e,n,r){var i,a,s,o;n==document&&(n=document.documentElement),ie.__&&ie.__(e,n),a=(i=!1)?null:n.__k,s=[],o=[],Tr(n,e=n.__k=Ff(An,null,[e]),a||qt,qt,n.namespaceURI,a?null:n.firstChild?Gt.call(n.childNodes):null,s,a?a.__e:n.firstChild,i,o),ss(s,e,o)}function cs(e,n,r){var i,a,s,o,c=Oe({},e.props);for(s in e.type&&e.type.defaultProps&&(o=e.type.defaultProps),n)s=="key"?i=n[s]:s=="ref"?a=n[s]:c[s]=n[s]===void 0&&o!=null?o[s]:n[s];return arguments.length>2&&(c.children=arguments.length>3?Gt.call(arguments,2):r),Mt(e.type,c,i||e.key,a||e.ref,null)}Gt=ns.slice,ie={__e:function(e,n,r,i){for(var a,s,o;n=n.__;)if((a=n.__c)&&!a.__)try{if((s=a.constructor)&&s.getDerivedStateFromError!=null&&(a.setState(s.getDerivedStateFromError(e)),o=a.__d),a.componentDidCatch!=null&&(a.componentDidCatch(e,i||{}),o=a.__d),o)return a.__E=a}catch(c){e=c}throw e}},Xa=0,Qa=function(e){return e!=null&&e.constructor===void 0},ln.prototype.setState=function(e,n){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Oe({},this.state),typeof e=="function"&&(e=e(Oe({},r),this.props)),e&&Oe(r,e),e!=null&&this.__v&&(n&&this._sb.push(n),Si(this))},ln.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Si(this))},ln.prototype.render=An,Ze=[],Za=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,es=function(e,n){return e.__v.__b-n.__v.__b},vn.__r=0,ts=/(PointerCapture)$|Capture$/i,Cr=0,lr=Ai(!1),cr=Ai(!0);function Ti(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,i=Array(n);r<n;r++)i[r]=e[r];return i}function Vf(e){if(Array.isArray(e))return e}function Gf(e,n,r){return(n=Qf(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function Wf(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,s,o,c=[],u=!0,d=!1;try{if(s=(r=r.call(e)).next,n!==0)for(;!(u=(i=s.call(r)).done)&&(c.push(i.value),c.length!==n);u=!0);}catch(h){d=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return c}}function Kf(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oi(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function Yf(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Oi(Object(r),!0).forEach(function(i){Gf(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oi(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Jf(e,n){return Vf(e)||Wf(e,n)||Zf(e,n)||Kf()}function Xf(e,n){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Qf(e){var n=Xf(e,"string");return typeof n=="symbol"?n:n+""}function _n(e){"@babel/helpers - typeof";return _n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_n(e)}function Zf(e,n){if(e){if(typeof e=="string")return Ti(e,n);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ti(e,n):void 0}}var dr=function(n){if(_n(n)!=="object")return n;var r=cs(n);if(r.props){var i;r.props=Yf({},r.props),r!=null&&(i=r.props)!==null&&i!==void 0&&i.children&&(r.props.children=Array.isArray(r.props.children)?r.props.children.map(dr):dr(r.props.children))}return r},eh=function(n){return Qa(cs(n))},th=function(n,r){delete r.__k,Bf(dr(n),r)};function nh(e,n){n===void 0&&(n={});var r=n.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",r==="top"&&i.firstChild?i.insertBefore(a,i.firstChild):i.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var rh=`.float-tooltip-kap {
  position: absolute;
  width: max-content; /* prevent shrinking near right edge */
  max-width: max(50%, 150px);
  padding: 3px 5px;
  border-radius: 3px;
  font: 12px sans-serif;
  color: #eee;
  background: rgba(0,0,0,0.6);
  pointer-events: none;
}
`;nh(rh);var ih=Sr({props:{content:{default:!1},offsetX:{triggerUpdate:!1},offsetY:{triggerUpdate:!1}},init:function(n,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.style,s=a===void 0?{}:a,o=!!n&&_n(n)==="object"&&!!n.node&&typeof n.node=="function",c=we(o?n.node():n);c.style("position")==="static"&&c.style("position","relative"),r.tooltipEl=c.append("div").attr("class","float-tooltip-kap"),Object.entries(s).forEach(function(d){var h=Jf(d,2),f=h[0],p=h[1];return r.tooltipEl.style(f,p)}),r.tooltipEl.style("left","-10000px").style("display","none");var u="tooltip-".concat(Math.round(Math.random()*1e12));r.mouseInside=!1,c.on("mousemove.".concat(u),function(d){r.mouseInside=!0;var h=Te(d),f=c.node(),p=f.offsetWidth,m=f.offsetHeight,g=[r.offsetX===null||r.offsetX===void 0?"-".concat(h[0]/p*100,"%"):typeof r.offsetX=="number"?"calc(-50% + ".concat(r.offsetX,"px)"):r.offsetX,r.offsetY===null||r.offsetY===void 0?m>130&&m-h[1]<100?"calc(-100% - 6px)":"21px":typeof r.offsetY=="number"?r.offsetY<0?"calc(-100% - ".concat(Math.abs(r.offsetY),"px)"):"".concat(r.offsetY,"px"):r.offsetY];r.tooltipEl.style("left",h[0]+"px").style("top",h[1]+"px").style("transform","translate(".concat(g.join(","),")")),r.content&&r.tooltipEl.style("display","inline")}),c.on("mouseover.".concat(u),function(){r.mouseInside=!0,r.content&&r.tooltipEl.style("display","inline")}),c.on("mouseout.".concat(u),function(){r.mouseInside=!1,r.tooltipEl.style("display","none")})},update:function(n){n.tooltipEl.style("display",n.content&&n.mouseInside?"inline":"none"),n.content?n.content instanceof HTMLElement?(n.tooltipEl.text(""),n.tooltipEl.append(function(){return n.content})):typeof n.content=="string"?n.tooltipEl.html(n.content):eh(n.content)?(n.tooltipEl.text(""),th(n.content,n.tooltipEl.node())):(n.tooltipEl.style("display","none"),console.warn("Tooltip content is invalid, skipping.",n.content,n.content.toString())):n.tooltipEl.text("")}});function ah(e,n,r){var i,a=1;e==null&&(e=0),n==null&&(n=0),r==null&&(r=0);function s(){var o,c=i.length,u,d=0,h=0,f=0;for(o=0;o<c;++o)u=i[o],d+=u.x||0,h+=u.y||0,f+=u.z||0;for(d=(d/c-e)*a,h=(h/c-n)*a,f=(f/c-r)*a,o=0;o<c;++o)u=i[o],d&&(u.x-=d),h&&(u.y-=h),f&&(u.z-=f)}return s.initialize=function(o){i=o},s.x=function(o){return arguments.length?(e=+o,s):e},s.y=function(o){return arguments.length?(n=+o,s):n},s.z=function(o){return arguments.length?(r=+o,s):r},s.strength=function(o){return arguments.length?(a=+o,s):a},s}function sh(e){const n=+this._x.call(null,e);return us(this.cover(n),n,e)}function us(e,n,r){if(isNaN(n))return e;var i,a=e._root,s={data:r},o=e._x0,c=e._x1,u,d,h,f,p;if(!a)return e._root=s,e;for(;a.length;)if((h=n>=(u=(o+c)/2))?o=u:c=u,i=a,!(a=a[f=+h]))return i[f]=s,e;if(d=+e._x.call(null,a.data),n===d)return s.next=a,i?i[f]=s:e._root=s,e;do i=i?i[f]=new Array(2):e._root=new Array(2),(h=n>=(u=(o+c)/2))?o=u:c=u;while((f=+h)==(p=+(d>=u)));return i[p]=a,i[f]=s,e}function oh(e){Array.isArray(e)||(e=Array.from(e));const n=e.length,r=new Float64Array(n);let i=1/0,a=-1/0;for(let s=0,o;s<n;++s)isNaN(o=+this._x.call(null,e[s]))||(r[s]=o,o<i&&(i=o),o>a&&(a=o));if(i>a)return this;this.cover(i).cover(a);for(let s=0;s<n;++s)us(this,r[s],e[s]);return this}function lh(e){if(isNaN(e=+e))return this;var n=this._x0,r=this._x1;if(isNaN(n))r=(n=Math.floor(e))+1;else{for(var i=r-n||1,a=this._root,s,o;n>e||e>=r;)switch(o=+(e<n),s=new Array(2),s[o]=a,a=s,i*=2,o){case 0:r=n+i;break;case 1:n=r-i;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._x1=r,this}function ch(){var e=[];return this.visit(function(n){if(!n.length)do e.push(n.data);while(n=n.next)}),e}function uh(e){return arguments.length?this.cover(+e[0][0]).cover(+e[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function Be(e,n,r){this.node=e,this.x0=n,this.x1=r}function dh(e,n){var r,i=this._x0,a,s,o=this._x1,c=[],u=this._root,d,h;for(u&&c.push(new Be(u,i,o)),n==null?n=1/0:(i=e-n,o=e+n);d=c.pop();)if(!(!(u=d.node)||(a=d.x0)>o||(s=d.x1)<i))if(u.length){var f=(a+s)/2;c.push(new Be(u[1],f,s),new Be(u[0],a,f)),(h=+(e>=f))&&(d=c[c.length-1],c[c.length-1]=c[c.length-1-h],c[c.length-1-h]=d)}else{var p=Math.abs(e-+this._x.call(null,u.data));p<n&&(n=p,i=e-p,o=e+p,r=u.data)}return r}function fh(e){if(isNaN(u=+this._x.call(null,e)))return this;var n,r=this._root,i,a,s,o=this._x0,c=this._x1,u,d,h,f,p;if(!r)return this;if(r.length)for(;;){if((h=u>=(d=(o+c)/2))?o=d:c=d,n=r,!(r=r[f=+h]))return this;if(!r.length)break;n[f+1&1]&&(i=n,p=f)}for(;r.data!==e;)if(a=r,!(r=r.next))return this;return(s=r.next)&&delete r.next,a?(s?a.next=s:delete a.next,this):n?(s?n[f]=s:delete n[f],(r=n[0]||n[1])&&r===(n[1]||n[0])&&!r.length&&(i?i[p]=r:this._root=r),this):(this._root=s,this)}function hh(e){for(var n=0,r=e.length;n<r;++n)this.remove(e[n]);return this}function ph(){return this._root}function mh(){var e=0;return this.visit(function(n){if(!n.length)do++e;while(n=n.next)}),e}function gh(e){var n=[],r,i=this._root,a,s,o;for(i&&n.push(new Be(i,this._x0,this._x1));r=n.pop();)if(!e(i=r.node,s=r.x0,o=r.x1)&&i.length){var c=(s+o)/2;(a=i[1])&&n.push(new Be(a,c,o)),(a=i[0])&&n.push(new Be(a,s,c))}return this}function xh(e){var n=[],r=[],i;for(this._root&&n.push(new Be(this._root,this._x0,this._x1));i=n.pop();){var a=i.node;if(a.length){var s,o=i.x0,c=i.x1,u=(o+c)/2;(s=a[0])&&n.push(new Be(s,o,u)),(s=a[1])&&n.push(new Be(s,u,c))}r.push(i)}for(;i=r.pop();)e(i.node,i.x0,i.x1);return this}function yh(e){return e[0]}function bh(e){return arguments.length?(this._x=e,this):this._x}function ds(e,n){var r=new Mr(n??yh,NaN,NaN);return e==null?r:r.addAll(e)}function Mr(e,n,r){this._x=e,this._x0=n,this._x1=r,this._root=void 0}function Mi(e){for(var n={data:e.data},r=n;e=e.next;)r=r.next={data:e.data};return n}var me=ds.prototype=Mr.prototype;me.copy=function(){var e=new Mr(this._x,this._x0,this._x1),n=this._root,r,i;if(!n)return e;if(!n.length)return e._root=Mi(n),e;for(r=[{source:n,target:e._root=new Array(2)}];n=r.pop();)for(var a=0;a<2;++a)(i=n.source[a])&&(i.length?r.push({source:i,target:n.target[a]=new Array(2)}):n.target[a]=Mi(i));return e};me.add=sh;me.addAll=oh;me.cover=lh;me.data=ch;me.extent=uh;me.find=dh;me.remove=fh;me.removeAll=hh;me.root=ph;me.size=mh;me.visit=gh;me.visitAfter=xh;me.x=bh;function vh(e){const n=+this._x.call(null,e),r=+this._y.call(null,e);return fs(this.cover(n,r),n,r,e)}function fs(e,n,r,i){if(isNaN(n)||isNaN(r))return e;var a,s=e._root,o={data:i},c=e._x0,u=e._y0,d=e._x1,h=e._y1,f,p,m,g,v,b,x,j;if(!s)return e._root=o,e;for(;s.length;)if((v=n>=(f=(c+d)/2))?c=f:d=f,(b=r>=(p=(u+h)/2))?u=p:h=p,a=s,!(s=s[x=b<<1|v]))return a[x]=o,e;if(m=+e._x.call(null,s.data),g=+e._y.call(null,s.data),n===m&&r===g)return o.next=s,a?a[x]=o:e._root=o,e;do a=a?a[x]=new Array(4):e._root=new Array(4),(v=n>=(f=(c+d)/2))?c=f:d=f,(b=r>=(p=(u+h)/2))?u=p:h=p;while((x=b<<1|v)===(j=(g>=p)<<1|m>=f));return a[j]=s,a[x]=o,e}function _h(e){var n,r,i=e.length,a,s,o=new Array(i),c=new Array(i),u=1/0,d=1/0,h=-1/0,f=-1/0;for(r=0;r<i;++r)isNaN(a=+this._x.call(null,n=e[r]))||isNaN(s=+this._y.call(null,n))||(o[r]=a,c[r]=s,a<u&&(u=a),a>h&&(h=a),s<d&&(d=s),s>f&&(f=s));if(u>h||d>f)return this;for(this.cover(u,d).cover(h,f),r=0;r<i;++r)fs(this,o[r],c[r],e[r]);return this}function wh(e,n){if(isNaN(e=+e)||isNaN(n=+n))return this;var r=this._x0,i=this._y0,a=this._x1,s=this._y1;if(isNaN(r))a=(r=Math.floor(e))+1,s=(i=Math.floor(n))+1;else{for(var o=a-r||1,c=this._root,u,d;r>e||e>=a||i>n||n>=s;)switch(d=(n<i)<<1|e<r,u=new Array(4),u[d]=c,c=u,o*=2,d){case 0:a=r+o,s=i+o;break;case 1:r=a-o,s=i+o;break;case 2:a=r+o,i=s-o;break;case 3:r=a-o,i=s-o;break}this._root&&this._root.length&&(this._root=c)}return this._x0=r,this._y0=i,this._x1=a,this._y1=s,this}function Nh(){var e=[];return this.visit(function(n){if(!n.length)do e.push(n.data);while(n=n.next)}),e}function jh(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function fe(e,n,r,i,a){this.node=e,this.x0=n,this.y0=r,this.x1=i,this.y1=a}function kh(e,n,r){var i,a=this._x0,s=this._y0,o,c,u,d,h=this._x1,f=this._y1,p=[],m=this._root,g,v;for(m&&p.push(new fe(m,a,s,h,f)),r==null?r=1/0:(a=e-r,s=n-r,h=e+r,f=n+r,r*=r);g=p.pop();)if(!(!(m=g.node)||(o=g.x0)>h||(c=g.y0)>f||(u=g.x1)<a||(d=g.y1)<s))if(m.length){var b=(o+u)/2,x=(c+d)/2;p.push(new fe(m[3],b,x,u,d),new fe(m[2],o,x,b,d),new fe(m[1],b,c,u,x),new fe(m[0],o,c,b,x)),(v=(n>=x)<<1|e>=b)&&(g=p[p.length-1],p[p.length-1]=p[p.length-1-v],p[p.length-1-v]=g)}else{var j=e-+this._x.call(null,m.data),C=n-+this._y.call(null,m.data),w=j*j+C*C;if(w<r){var _=Math.sqrt(r=w);a=e-_,s=n-_,h=e+_,f=n+_,i=m.data}}return i}function Sh(e){if(isNaN(h=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var n,r=this._root,i,a,s,o=this._x0,c=this._y0,u=this._x1,d=this._y1,h,f,p,m,g,v,b,x;if(!r)return this;if(r.length)for(;;){if((g=h>=(p=(o+u)/2))?o=p:u=p,(v=f>=(m=(c+d)/2))?c=m:d=m,n=r,!(r=r[b=v<<1|g]))return this;if(!r.length)break;(n[b+1&3]||n[b+2&3]||n[b+3&3])&&(i=n,x=b)}for(;r.data!==e;)if(a=r,!(r=r.next))return this;return(s=r.next)&&delete r.next,a?(s?a.next=s:delete a.next,this):n?(s?n[b]=s:delete n[b],(r=n[0]||n[1]||n[2]||n[3])&&r===(n[3]||n[2]||n[1]||n[0])&&!r.length&&(i?i[x]=r:this._root=r),this):(this._root=s,this)}function Ch(e){for(var n=0,r=e.length;n<r;++n)this.remove(e[n]);return this}function Ah(){return this._root}function Th(){var e=0;return this.visit(function(n){if(!n.length)do++e;while(n=n.next)}),e}function Oh(e){var n=[],r,i=this._root,a,s,o,c,u;for(i&&n.push(new fe(i,this._x0,this._y0,this._x1,this._y1));r=n.pop();)if(!e(i=r.node,s=r.x0,o=r.y0,c=r.x1,u=r.y1)&&i.length){var d=(s+c)/2,h=(o+u)/2;(a=i[3])&&n.push(new fe(a,d,h,c,u)),(a=i[2])&&n.push(new fe(a,s,h,d,u)),(a=i[1])&&n.push(new fe(a,d,o,c,h)),(a=i[0])&&n.push(new fe(a,s,o,d,h))}return this}function Mh(e){var n=[],r=[],i;for(this._root&&n.push(new fe(this._root,this._x0,this._y0,this._x1,this._y1));i=n.pop();){var a=i.node;if(a.length){var s,o=i.x0,c=i.y0,u=i.x1,d=i.y1,h=(o+u)/2,f=(c+d)/2;(s=a[0])&&n.push(new fe(s,o,c,h,f)),(s=a[1])&&n.push(new fe(s,h,c,u,f)),(s=a[2])&&n.push(new fe(s,o,f,h,d)),(s=a[3])&&n.push(new fe(s,h,f,u,d))}r.push(i)}for(;i=r.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function Eh(e){return e[0]}function Ph(e){return arguments.length?(this._x=e,this):this._x}function Ih(e){return e[1]}function Rh(e){return arguments.length?(this._y=e,this):this._y}function hs(e,n,r){var i=new Er(n??Eh,r??Ih,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function Er(e,n,r,i,a,s){this._x=e,this._y=n,this._x0=r,this._y0=i,this._x1=a,this._y1=s,this._root=void 0}function Ei(e){for(var n={data:e.data},r=n;e=e.next;)r=r.next={data:e.data};return n}var he=hs.prototype=Er.prototype;he.copy=function(){var e=new Er(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,r,i;if(!n)return e;if(!n.length)return e._root=Ei(n),e;for(r=[{source:n,target:e._root=new Array(4)}];n=r.pop();)for(var a=0;a<4;++a)(i=n.source[a])&&(i.length?r.push({source:i,target:n.target[a]=new Array(4)}):n.target[a]=Ei(i));return e};he.add=vh;he.addAll=_h;he.cover=wh;he.data=Nh;he.extent=jh;he.find=kh;he.remove=Sh;he.removeAll=Ch;he.root=Ah;he.size=Th;he.visit=Oh;he.visitAfter=Mh;he.x=Ph;he.y=Rh;function Dh(e){const n=+this._x.call(null,e),r=+this._y.call(null,e),i=+this._z.call(null,e);return ps(this.cover(n,r,i),n,r,i,e)}function ps(e,n,r,i,a){if(isNaN(n)||isNaN(r)||isNaN(i))return e;var s,o=e._root,c={data:a},u=e._x0,d=e._y0,h=e._z0,f=e._x1,p=e._y1,m=e._z1,g,v,b,x,j,C,w,_,M,E,y;if(!o)return e._root=c,e;for(;o.length;)if((w=n>=(g=(u+f)/2))?u=g:f=g,(_=r>=(v=(d+p)/2))?d=v:p=v,(M=i>=(b=(h+m)/2))?h=b:m=b,s=o,!(o=o[E=M<<2|_<<1|w]))return s[E]=c,e;if(x=+e._x.call(null,o.data),j=+e._y.call(null,o.data),C=+e._z.call(null,o.data),n===x&&r===j&&i===C)return c.next=o,s?s[E]=c:e._root=c,e;do s=s?s[E]=new Array(8):e._root=new Array(8),(w=n>=(g=(u+f)/2))?u=g:f=g,(_=r>=(v=(d+p)/2))?d=v:p=v,(M=i>=(b=(h+m)/2))?h=b:m=b;while((E=M<<2|_<<1|w)===(y=(C>=b)<<2|(j>=v)<<1|x>=g));return s[y]=o,s[E]=c,e}function zh(e){Array.isArray(e)||(e=Array.from(e));const n=e.length,r=new Float64Array(n),i=new Float64Array(n),a=new Float64Array(n);let s=1/0,o=1/0,c=1/0,u=-1/0,d=-1/0,h=-1/0;for(let f=0,p,m,g,v;f<n;++f)isNaN(m=+this._x.call(null,p=e[f]))||isNaN(g=+this._y.call(null,p))||isNaN(v=+this._z.call(null,p))||(r[f]=m,i[f]=g,a[f]=v,m<s&&(s=m),m>u&&(u=m),g<o&&(o=g),g>d&&(d=g),v<c&&(c=v),v>h&&(h=v));if(s>u||o>d||c>h)return this;this.cover(s,o,c).cover(u,d,h);for(let f=0;f<n;++f)ps(this,r[f],i[f],a[f],e[f]);return this}function $h(e,n,r){if(isNaN(e=+e)||isNaN(n=+n)||isNaN(r=+r))return this;var i=this._x0,a=this._y0,s=this._z0,o=this._x1,c=this._y1,u=this._z1;if(isNaN(i))o=(i=Math.floor(e))+1,c=(a=Math.floor(n))+1,u=(s=Math.floor(r))+1;else{for(var d=o-i||1,h=this._root,f,p;i>e||e>=o||a>n||n>=c||s>r||r>=u;)switch(p=(r<s)<<2|(n<a)<<1|e<i,f=new Array(8),f[p]=h,h=f,d*=2,p){case 0:o=i+d,c=a+d,u=s+d;break;case 1:i=o-d,c=a+d,u=s+d;break;case 2:o=i+d,a=c-d,u=s+d;break;case 3:i=o-d,a=c-d,u=s+d;break;case 4:o=i+d,c=a+d,s=u-d;break;case 5:i=o-d,c=a+d,s=u-d;break;case 6:o=i+d,a=c-d,s=u-d;break;case 7:i=o-d,a=c-d,s=u-d;break}this._root&&this._root.length&&(this._root=h)}return this._x0=i,this._y0=a,this._z0=s,this._x1=o,this._y1=c,this._z1=u,this}function Fh(){var e=[];return this.visit(function(n){if(!n.length)do e.push(n.data);while(n=n.next)}),e}function Lh(e){return arguments.length?this.cover(+e[0][0],+e[0][1],+e[0][2]).cover(+e[1][0],+e[1][1],+e[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function Q(e,n,r,i,a,s,o){this.node=e,this.x0=n,this.y0=r,this.z0=i,this.x1=a,this.y1=s,this.z1=o}function qh(e,n,r,i){var a,s=this._x0,o=this._y0,c=this._z0,u,d,h,f,p,m,g=this._x1,v=this._y1,b=this._z1,x=[],j=this._root,C,w;for(j&&x.push(new Q(j,s,o,c,g,v,b)),i==null?i=1/0:(s=e-i,o=n-i,c=r-i,g=e+i,v=n+i,b=r+i,i*=i);C=x.pop();)if(!(!(j=C.node)||(u=C.x0)>g||(d=C.y0)>v||(h=C.z0)>b||(f=C.x1)<s||(p=C.y1)<o||(m=C.z1)<c))if(j.length){var _=(u+f)/2,M=(d+p)/2,E=(h+m)/2;x.push(new Q(j[7],_,M,E,f,p,m),new Q(j[6],u,M,E,_,p,m),new Q(j[5],_,d,E,f,M,m),new Q(j[4],u,d,E,_,M,m),new Q(j[3],_,M,h,f,p,E),new Q(j[2],u,M,h,_,p,E),new Q(j[1],_,d,h,f,M,E),new Q(j[0],u,d,h,_,M,E)),(w=(r>=E)<<2|(n>=M)<<1|e>=_)&&(C=x[x.length-1],x[x.length-1]=x[x.length-1-w],x[x.length-1-w]=C)}else{var y=e-+this._x.call(null,j.data),T=n-+this._y.call(null,j.data),k=r-+this._z.call(null,j.data),O=y*y+T*T+k*k;if(O<i){var P=Math.sqrt(i=O);s=e-P,o=n-P,c=r-P,g=e+P,v=n+P,b=r+P,a=j.data}}return a}const Uh=(e,n,r,i,a,s)=>Math.sqrt((e-i)**2+(n-a)**2+(r-s)**2);function Hh(e,n,r,i){const a=[],s=e-i,o=n-i,c=r-i,u=e+i,d=n+i,h=r+i;return this.visit((f,p,m,g,v,b,x)=>{if(!f.length)do{const j=f.data;Uh(e,n,r,this._x(j),this._y(j),this._z(j))<=i&&a.push(j)}while(f=f.next);return p>u||m>d||g>h||v<s||b<o||x<c}),a}function Bh(e){if(isNaN(p=+this._x.call(null,e))||isNaN(m=+this._y.call(null,e))||isNaN(g=+this._z.call(null,e)))return this;var n,r=this._root,i,a,s,o=this._x0,c=this._y0,u=this._z0,d=this._x1,h=this._y1,f=this._z1,p,m,g,v,b,x,j,C,w,_,M;if(!r)return this;if(r.length)for(;;){if((j=p>=(v=(o+d)/2))?o=v:d=v,(C=m>=(b=(c+h)/2))?c=b:h=b,(w=g>=(x=(u+f)/2))?u=x:f=x,n=r,!(r=r[_=w<<2|C<<1|j]))return this;if(!r.length)break;(n[_+1&7]||n[_+2&7]||n[_+3&7]||n[_+4&7]||n[_+5&7]||n[_+6&7]||n[_+7&7])&&(i=n,M=_)}for(;r.data!==e;)if(a=r,!(r=r.next))return this;return(s=r.next)&&delete r.next,a?(s?a.next=s:delete a.next,this):n?(s?n[_]=s:delete n[_],(r=n[0]||n[1]||n[2]||n[3]||n[4]||n[5]||n[6]||n[7])&&r===(n[7]||n[6]||n[5]||n[4]||n[3]||n[2]||n[1]||n[0])&&!r.length&&(i?i[M]=r:this._root=r),this):(this._root=s,this)}function Vh(e){for(var n=0,r=e.length;n<r;++n)this.remove(e[n]);return this}function Gh(){return this._root}function Wh(){var e=0;return this.visit(function(n){if(!n.length)do++e;while(n=n.next)}),e}function Kh(e){var n=[],r,i=this._root,a,s,o,c,u,d,h;for(i&&n.push(new Q(i,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));r=n.pop();)if(!e(i=r.node,s=r.x0,o=r.y0,c=r.z0,u=r.x1,d=r.y1,h=r.z1)&&i.length){var f=(s+u)/2,p=(o+d)/2,m=(c+h)/2;(a=i[7])&&n.push(new Q(a,f,p,m,u,d,h)),(a=i[6])&&n.push(new Q(a,s,p,m,f,d,h)),(a=i[5])&&n.push(new Q(a,f,o,m,u,p,h)),(a=i[4])&&n.push(new Q(a,s,o,m,f,p,h)),(a=i[3])&&n.push(new Q(a,f,p,c,u,d,m)),(a=i[2])&&n.push(new Q(a,s,p,c,f,d,m)),(a=i[1])&&n.push(new Q(a,f,o,c,u,p,m)),(a=i[0])&&n.push(new Q(a,s,o,c,f,p,m))}return this}function Yh(e){var n=[],r=[],i;for(this._root&&n.push(new Q(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));i=n.pop();){var a=i.node;if(a.length){var s,o=i.x0,c=i.y0,u=i.z0,d=i.x1,h=i.y1,f=i.z1,p=(o+d)/2,m=(c+h)/2,g=(u+f)/2;(s=a[0])&&n.push(new Q(s,o,c,u,p,m,g)),(s=a[1])&&n.push(new Q(s,p,c,u,d,m,g)),(s=a[2])&&n.push(new Q(s,o,m,u,p,h,g)),(s=a[3])&&n.push(new Q(s,p,m,u,d,h,g)),(s=a[4])&&n.push(new Q(s,o,c,g,p,m,f)),(s=a[5])&&n.push(new Q(s,p,c,g,d,m,f)),(s=a[6])&&n.push(new Q(s,o,m,g,p,h,f)),(s=a[7])&&n.push(new Q(s,p,m,g,d,h,f))}r.push(i)}for(;i=r.pop();)e(i.node,i.x0,i.y0,i.z0,i.x1,i.y1,i.z1);return this}function Jh(e){return e[0]}function Xh(e){return arguments.length?(this._x=e,this):this._x}function Qh(e){return e[1]}function Zh(e){return arguments.length?(this._y=e,this):this._y}function ep(e){return e[2]}function tp(e){return arguments.length?(this._z=e,this):this._z}function ms(e,n,r,i){var a=new Pr(n??Jh,r??Qh,i??ep,NaN,NaN,NaN,NaN,NaN,NaN);return e==null?a:a.addAll(e)}function Pr(e,n,r,i,a,s,o,c,u){this._x=e,this._y=n,this._z=r,this._x0=i,this._y0=a,this._z0=s,this._x1=o,this._y1=c,this._z1=u,this._root=void 0}function Pi(e){for(var n={data:e.data},r=n;e=e.next;)r=r.next={data:e.data};return n}var ce=ms.prototype=Pr.prototype;ce.copy=function(){var e=new Pr(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),n=this._root,r,i;if(!n)return e;if(!n.length)return e._root=Pi(n),e;for(r=[{source:n,target:e._root=new Array(8)}];n=r.pop();)for(var a=0;a<8;++a)(i=n.source[a])&&(i.length?r.push({source:i,target:n.target[a]=new Array(8)}):n.target[a]=Pi(i));return e};ce.add=Dh;ce.addAll=zh;ce.cover=$h;ce.data=Fh;ce.extent=Lh;ce.find=qh;ce.findAllWithinRadius=Hh;ce.remove=Bh;ce.removeAll=Vh;ce.root=Gh;ce.size=Wh;ce.visit=Kh;ce.visitAfter=Yh;ce.x=Xh;ce.y=Zh;ce.z=tp;function He(e){return function(){return e}}function qe(e){return(e()-.5)*1e-6}function np(e){return e.index}function Ii(e,n){var r=e.get(n);if(!r)throw new Error("node not found: "+n);return r}function rp(e){var n=np,r=p,i,a=He(30),s,o,c,u,d,h,f=1;e==null&&(e=[]);function p(x){return 1/Math.min(u[x.source.index],u[x.target.index])}function m(x){for(var j=0,C=e.length;j<f;++j)for(var w=0,_,M,E,y=0,T=0,k=0,O,P;w<C;++w)_=e[w],M=_.source,E=_.target,y=E.x+E.vx-M.x-M.vx||qe(h),c>1&&(T=E.y+E.vy-M.y-M.vy||qe(h)),c>2&&(k=E.z+E.vz-M.z-M.vz||qe(h)),O=Math.sqrt(y*y+T*T+k*k),O=(O-s[w])/O*x*i[w],y*=O,T*=O,k*=O,E.vx-=y*(P=d[w]),c>1&&(E.vy-=T*P),c>2&&(E.vz-=k*P),M.vx+=y*(P=1-P),c>1&&(M.vy+=T*P),c>2&&(M.vz+=k*P)}function g(){if(o){var x,j=o.length,C=e.length,w=new Map(o.map((M,E)=>[n(M,E,o),M])),_;for(x=0,u=new Array(j);x<C;++x)_=e[x],_.index=x,typeof _.source!="object"&&(_.source=Ii(w,_.source)),typeof _.target!="object"&&(_.target=Ii(w,_.target)),u[_.source.index]=(u[_.source.index]||0)+1,u[_.target.index]=(u[_.target.index]||0)+1;for(x=0,d=new Array(C);x<C;++x)_=e[x],d[x]=u[_.source.index]/(u[_.source.index]+u[_.target.index]);i=new Array(C),v(),s=new Array(C),b()}}function v(){if(o)for(var x=0,j=e.length;x<j;++x)i[x]=+r(e[x],x,e)}function b(){if(o)for(var x=0,j=e.length;x<j;++x)s[x]=+a(e[x],x,e)}return m.initialize=function(x,...j){o=x,h=j.find(C=>typeof C=="function")||Math.random,c=j.find(C=>[1,2,3].includes(C))||2,g()},m.links=function(x){return arguments.length?(e=x,g(),m):e},m.id=function(x){return arguments.length?(n=x,m):n},m.iterations=function(x){return arguments.length?(f=+x,m):f},m.strength=function(x){return arguments.length?(r=typeof x=="function"?x:He(+x),v(),m):r},m.distance=function(x){return arguments.length?(a=typeof x=="function"?x:He(+x),b(),m):a},m}const ip=1664525,ap=1013904223,Ri=4294967296;function sp(){let e=1;return()=>(e=(ip*e+ap)%Ri)/Ri}var Di=3;function Fn(e){return e.x}function zi(e){return e.y}function op(e){return e.z}var lp=10,cp=Math.PI*(3-Math.sqrt(5)),up=Math.PI*20/(9+Math.sqrt(221));function dp(e,n){n=n||2;var r=Math.min(Di,Math.max(1,Math.round(n))),i,a=1,s=.001,o=1-Math.pow(s,1/300),c=0,u=.6,d=new Map,h=wr(m),f=Bt("tick","end"),p=sp();e==null&&(e=[]);function m(){g(),f.call("tick",i),a<s&&(h.stop(),f.call("end",i))}function g(x){var j,C=e.length,w;x===void 0&&(x=1);for(var _=0;_<x;++_)for(a+=(c-a)*o,d.forEach(function(M){M(a)}),j=0;j<C;++j)w=e[j],w.fx==null?w.x+=w.vx*=u:(w.x=w.fx,w.vx=0),r>1&&(w.fy==null?w.y+=w.vy*=u:(w.y=w.fy,w.vy=0)),r>2&&(w.fz==null?w.z+=w.vz*=u:(w.z=w.fz,w.vz=0));return i}function v(){for(var x=0,j=e.length,C;x<j;++x){if(C=e[x],C.index=x,C.fx!=null&&(C.x=C.fx),C.fy!=null&&(C.y=C.fy),C.fz!=null&&(C.z=C.fz),isNaN(C.x)||r>1&&isNaN(C.y)||r>2&&isNaN(C.z)){var w=lp*(r>2?Math.cbrt(.5+x):r>1?Math.sqrt(.5+x):x),_=x*cp,M=x*up;r===1?C.x=w:r===2?(C.x=w*Math.cos(_),C.y=w*Math.sin(_)):(C.x=w*Math.sin(_)*Math.cos(M),C.y=w*Math.cos(_),C.z=w*Math.sin(_)*Math.sin(M))}(isNaN(C.vx)||r>1&&isNaN(C.vy)||r>2&&isNaN(C.vz))&&(C.vx=0,r>1&&(C.vy=0),r>2&&(C.vz=0))}}function b(x){return x.initialize&&x.initialize(e,p,r),x}return v(),i={tick:g,restart:function(){return h.restart(m),i},stop:function(){return h.stop(),i},numDimensions:function(x){return arguments.length?(r=Math.min(Di,Math.max(1,Math.round(x))),d.forEach(b),i):r},nodes:function(x){return arguments.length?(e=x,v(),d.forEach(b),i):e},alpha:function(x){return arguments.length?(a=+x,i):a},alphaMin:function(x){return arguments.length?(s=+x,i):s},alphaDecay:function(x){return arguments.length?(o=+x,i):+o},alphaTarget:function(x){return arguments.length?(c=+x,i):c},velocityDecay:function(x){return arguments.length?(u=1-x,i):1-u},randomSource:function(x){return arguments.length?(p=x,d.forEach(b),i):p},force:function(x,j){return arguments.length>1?(j==null?d.delete(x):d.set(x,b(j)),i):d.get(x)},find:function(){var x=Array.prototype.slice.call(arguments),j=x.shift()||0,C=(r>1?x.shift():null)||0,w=(r>2?x.shift():null)||0,_=x.shift()||1/0,M=0,E=e.length,y,T,k,O,P,z;for(_*=_,M=0;M<E;++M)P=e[M],y=j-P.x,T=C-(P.y||0),k=w-(P.z||0),O=y*y+T*T+k*k,O<_&&(z=P,_=O);return z},on:function(x,j){return arguments.length>1?(f.on(x,j),i):f.on(x)}}}function fp(){var e,n,r,i,a,s=He(-30),o,c=1,u=1/0,d=.81;function h(g){var v,b=e.length,x=(n===1?ds(e,Fn):n===2?hs(e,Fn,zi):n===3?ms(e,Fn,zi,op):null).visitAfter(p);for(a=g,v=0;v<b;++v)r=e[v],x.visit(m)}function f(){if(e){var g,v=e.length,b;for(o=new Array(v),g=0;g<v;++g)b=e[g],o[b.index]=+s(b,g,e)}}function p(g){var v=0,b,x,j=0,C,w,_,M,E=g.length;if(E){for(C=w=_=M=0;M<E;++M)(b=g[M])&&(x=Math.abs(b.value))&&(v+=b.value,j+=x,C+=x*(b.x||0),w+=x*(b.y||0),_+=x*(b.z||0));v*=Math.sqrt(4/E),g.x=C/j,n>1&&(g.y=w/j),n>2&&(g.z=_/j)}else{b=g,b.x=b.data.x,n>1&&(b.y=b.data.y),n>2&&(b.z=b.data.z);do v+=o[b.data.index];while(b=b.next)}g.value=v}function m(g,v,b,x,j){if(!g.value)return!0;var C=[b,x,j][n-1],w=g.x-r.x,_=n>1?g.y-r.y:0,M=n>2?g.z-r.z:0,E=C-v,y=w*w+_*_+M*M;if(E*E/d<y)return y<u&&(w===0&&(w=qe(i),y+=w*w),n>1&&_===0&&(_=qe(i),y+=_*_),n>2&&M===0&&(M=qe(i),y+=M*M),y<c&&(y=Math.sqrt(c*y)),r.vx+=w*g.value*a/y,n>1&&(r.vy+=_*g.value*a/y),n>2&&(r.vz+=M*g.value*a/y)),!0;if(g.length||y>=u)return;(g.data!==r||g.next)&&(w===0&&(w=qe(i),y+=w*w),n>1&&_===0&&(_=qe(i),y+=_*_),n>2&&M===0&&(M=qe(i),y+=M*M),y<c&&(y=Math.sqrt(c*y)));do g.data!==r&&(E=o[g.data.index]*a/y,r.vx+=w*E,n>1&&(r.vy+=_*E),n>2&&(r.vz+=M*E));while(g=g.next)}return h.initialize=function(g,...v){e=g,i=v.find(b=>typeof b=="function")||Math.random,n=v.find(b=>[1,2,3].includes(b))||2,f()},h.strength=function(g){return arguments.length?(s=typeof g=="function"?g:He(+g),f(),h):s},h.distanceMin=function(g){return arguments.length?(c=g*g,h):Math.sqrt(c)},h.distanceMax=function(g){return arguments.length?(u=g*g,h):Math.sqrt(u)},h.theta=function(g){return arguments.length?(d=g*g,h):Math.sqrt(d)},h}function hp(e,n,r,i){var a,s,o=He(.1),c,u;typeof e!="function"&&(e=He(+e)),n==null&&(n=0),r==null&&(r=0),i==null&&(i=0);function d(f){for(var p=0,m=a.length;p<m;++p){var g=a[p],v=g.x-n||1e-6,b=(g.y||0)-r||1e-6,x=(g.z||0)-i||1e-6,j=Math.sqrt(v*v+b*b+x*x),C=(u[p]-j)*c[p]*f/j;g.vx+=v*C,s>1&&(g.vy+=b*C),s>2&&(g.vz+=x*C)}}function h(){if(a){var f,p=a.length;for(c=new Array(p),u=new Array(p),f=0;f<p;++f)u[f]=+e(a[f],f,a),c[f]=isNaN(u[f])?0:+o(a[f],f,a)}}return d.initialize=function(f,...p){a=f,s=p.find(m=>[1,2,3].includes(m))||2,h()},d.strength=function(f){return arguments.length?(o=typeof f=="function"?f:He(+f),h(),d):o},d.radius=function(f){return arguments.length?(e=typeof f=="function"?f:He(+f),h(),d):e},d.x=function(f){return arguments.length?(n=+f,d):n},d.y=function(f){return arguments.length?(r=+f,d):r},d.z=function(f){return arguments.length?(i=+f,d):i},d}const{abs:xt,cos:$e,sin:it,acos:pp,atan2:yt,sqrt:Ge,pow:_e}=Math;function bt(e){return e<0?-_e(-e,1/3):_e(e,1/3)}const gs=Math.PI,en=2*gs,We=gs/2,mp=1e-6,Ln=Number.MAX_SAFE_INTEGER||9007199254740991,qn=Number.MIN_SAFE_INTEGER||-9007199254740991,gp={x:0,y:0,z:0},q={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(e,n){const r=n(e);let i=r.x*r.x+r.y*r.y;return typeof r.z<"u"&&(i+=r.z*r.z),Ge(i)},compute:function(e,n,r){if(e===0)return n[0].t=0,n[0];const i=n.length-1;if(e===1)return n[i].t=1,n[i];const a=1-e;let s=n;if(i===0)return n[0].t=e,n[0];if(i===1){const c={x:a*s[0].x+e*s[1].x,y:a*s[0].y+e*s[1].y,t:e};return r&&(c.z=a*s[0].z+e*s[1].z),c}if(i<4){let c=a*a,u=e*e,d,h,f,p=0;i===2?(s=[s[0],s[1],s[2],gp],d=c,h=a*e*2,f=u):i===3&&(d=c*a,h=c*e*3,f=a*u*3,p=e*u);const m={x:d*s[0].x+h*s[1].x+f*s[2].x+p*s[3].x,y:d*s[0].y+h*s[1].y+f*s[2].y+p*s[3].y,t:e};return r&&(m.z=d*s[0].z+h*s[1].z+f*s[2].z+p*s[3].z),m}const o=JSON.parse(JSON.stringify(n));for(;o.length>1;){for(let c=0;c<o.length-1;c++)o[c]={x:o[c].x+(o[c+1].x-o[c].x)*e,y:o[c].y+(o[c+1].y-o[c].y)*e},typeof o[c].z<"u"&&(o[c].z=o[c].z+(o[c+1].z-o[c].z)*e);o.splice(o.length-1,1)}return o[0].t=e,o[0]},computeWithRatios:function(e,n,r,i){const a=1-e,s=r,o=n;let c=s[0],u=s[1],d=s[2],h=s[3],f;if(c*=a,u*=e,o.length===2)return f=c+u,{x:(c*o[0].x+u*o[1].x)/f,y:(c*o[0].y+u*o[1].y)/f,z:i?(c*o[0].z+u*o[1].z)/f:!1,t:e};if(c*=a,u*=2*a,d*=e*e,o.length===3)return f=c+u+d,{x:(c*o[0].x+u*o[1].x+d*o[2].x)/f,y:(c*o[0].y+u*o[1].y+d*o[2].y)/f,z:i?(c*o[0].z+u*o[1].z+d*o[2].z)/f:!1,t:e};if(c*=a,u*=1.5*a,d*=3*a,h*=e*e*e,o.length===4)return f=c+u+d+h,{x:(c*o[0].x+u*o[1].x+d*o[2].x+h*o[3].x)/f,y:(c*o[0].y+u*o[1].y+d*o[2].y+h*o[3].y)/f,z:i?(c*o[0].z+u*o[1].z+d*o[2].z+h*o[3].z)/f:!1,t:e}},derive:function(e,n){const r=[];for(let i=e,a=i.length,s=a-1;a>1;a--,s--){const o=[];for(let c=0,u;c<s;c++)u={x:s*(i[c+1].x-i[c].x),y:s*(i[c+1].y-i[c].y)},n&&(u.z=s*(i[c+1].z-i[c].z)),o.push(u);r.push(o),i=o}return r},between:function(e,n,r){return n<=e&&e<=r||q.approximately(e,n)||q.approximately(e,r)},approximately:function(e,n,r){return xt(e-n)<=(r||mp)},length:function(e){const r=q.Tvalues.length;let i=0;for(let a=0,s;a<r;a++)s=.5*q.Tvalues[a]+.5,i+=q.Cvalues[a]*q.arcfn(s,e);return .5*i},map:function(e,n,r,i,a){const s=r-n,o=a-i,c=e-n,u=c/s;return i+o*u},lerp:function(e,n,r){const i={x:n.x+e*(r.x-n.x),y:n.y+e*(r.y-n.y)};return n.z!==void 0&&r.z!==void 0&&(i.z=n.z+e*(r.z-n.z)),i},pointToString:function(e){let n=e.x+"/"+e.y;return typeof e.z<"u"&&(n+="/"+e.z),n},pointsToString:function(e){return"["+e.map(q.pointToString).join(", ")+"]"},copy:function(e){return JSON.parse(JSON.stringify(e))},angle:function(e,n,r){const i=n.x-e.x,a=n.y-e.y,s=r.x-e.x,o=r.y-e.y,c=i*o-a*s,u=i*s+a*o;return yt(c,u)},round:function(e,n){const r=""+e,i=r.indexOf(".");return parseFloat(r.substring(0,i+1+n))},dist:function(e,n){const r=e.x-n.x,i=e.y-n.y;return Ge(r*r+i*i)},closest:function(e,n){let r=_e(2,63),i,a;return e.forEach(function(s,o){a=q.dist(n,s),a<r&&(r=a,i=o)}),{mdist:r,mpos:i}},abcratio:function(e,n){if(n!==2&&n!==3)return!1;if(typeof e>"u")e=.5;else if(e===0||e===1)return e;const r=_e(e,n)+_e(1-e,n),i=r-1;return xt(i/r)},projectionratio:function(e,n){if(n!==2&&n!==3)return!1;if(typeof e>"u")e=.5;else if(e===0||e===1)return e;const r=_e(1-e,n),i=_e(e,n)+r;return r/i},lli8:function(e,n,r,i,a,s,o,c){const u=(e*i-n*r)*(a-o)-(e-r)*(a*c-s*o),d=(e*i-n*r)*(s-c)-(n-i)*(a*c-s*o),h=(e-r)*(s-c)-(n-i)*(a-o);return h==0?!1:{x:u/h,y:d/h}},lli4:function(e,n,r,i){const a=e.x,s=e.y,o=n.x,c=n.y,u=r.x,d=r.y,h=i.x,f=i.y;return q.lli8(a,s,o,c,u,d,h,f)},lli:function(e,n){return q.lli4(e,e.c,n,n.c)},makeline:function(e,n){return new Z(e.x,e.y,(e.x+n.x)/2,(e.y+n.y)/2,n.x,n.y)},findbbox:function(e){let n=Ln,r=Ln,i=qn,a=qn;return e.forEach(function(s){const o=s.bbox();n>o.x.min&&(n=o.x.min),r>o.y.min&&(r=o.y.min),i<o.x.max&&(i=o.x.max),a<o.y.max&&(a=o.y.max)}),{x:{min:n,mid:(n+i)/2,max:i,size:i-n},y:{min:r,mid:(r+a)/2,max:a,size:a-r}}},shapeintersections:function(e,n,r,i,a){if(!q.bboxoverlap(n,i))return[];const s=[],o=[e.startcap,e.forward,e.back,e.endcap],c=[r.startcap,r.forward,r.back,r.endcap];return o.forEach(function(u){u.virtual||c.forEach(function(d){if(d.virtual)return;const h=u.intersects(d,a);h.length>0&&(h.c1=u,h.c2=d,h.s1=e,h.s2=r,s.push(h))})}),s},makeshape:function(e,n,r){const i=n.points.length,a=e.points.length,s=q.makeline(n.points[i-1],e.points[0]),o=q.makeline(e.points[a-1],n.points[0]),c={startcap:s,forward:e,back:n,endcap:o,bbox:q.findbbox([s,e,n,o])};return c.intersections=function(u){return q.shapeintersections(c,c.bbox,u,u.bbox,r)},c},getminmax:function(e,n,r){if(!r)return{min:0,max:0};let i=Ln,a=qn,s,o;r.indexOf(0)===-1&&(r=[0].concat(r)),r.indexOf(1)===-1&&r.push(1);for(let c=0,u=r.length;c<u;c++)s=r[c],o=e.get(s),o[n]<i&&(i=o[n]),o[n]>a&&(a=o[n]);return{min:i,mid:(i+a)/2,max:a,size:a-i}},align:function(e,n){const r=n.p1.x,i=n.p1.y,a=-yt(n.p2.y-i,n.p2.x-r),s=function(o){return{x:(o.x-r)*$e(a)-(o.y-i)*it(a),y:(o.x-r)*it(a)+(o.y-i)*$e(a)}};return e.map(s)},roots:function(e,n){n=n||{p1:{x:0,y:0},p2:{x:1,y:0}};const r=e.length-1,i=q.align(e,n),a=function(E){return 0<=E&&E<=1};if(r===2){const E=i[0].y,y=i[1].y,T=i[2].y,k=E-2*y+T;if(k!==0){const O=-Ge(y*y-E*T),P=-E+y,z=-(O+P)/k,S=-(-O+P)/k;return[z,S].filter(a)}else if(y!==T&&k===0)return[(2*y-T)/(2*y-2*T)].filter(a);return[]}const s=i[0].y,o=i[1].y,c=i[2].y,u=i[3].y;let d=-s+3*o-3*c+u,h=3*s-6*o+3*c,f=-3*s+3*o,p=s;if(q.approximately(d,0)){if(q.approximately(h,0))return q.approximately(f,0)?[]:[-p/f].filter(a);const E=Ge(f*f-4*h*p),y=2*h;return[(E-f)/y,(-f-E)/y].filter(a)}h/=d,f/=d,p/=d;const m=(3*f-h*h)/3,g=m/3,v=(2*h*h*h-9*h*f+27*p)/27,b=v/2,x=b*b+g*g*g;let j,C,w,_,M;if(x<0){const E=-m/3,y=E*E*E,T=Ge(y),k=-v/(2*T),O=k<-1?-1:k>1?1:k,P=pp(O),z=bt(T),S=2*z;return w=S*$e(P/3)-h/3,_=S*$e((P+en)/3)-h/3,M=S*$e((P+2*en)/3)-h/3,[w,_,M].filter(a)}else{if(x===0)return j=b<0?bt(-b):-bt(b),w=2*j-h/3,_=-j-h/3,[w,_].filter(a);{const E=Ge(x);return j=bt(-b+E),C=bt(b+E),[j-C-h/3].filter(a)}}},droots:function(e){if(e.length===3){const n=e[0],r=e[1],i=e[2],a=n-2*r+i;if(a!==0){const s=-Ge(r*r-n*i),o=-n+r,c=-(s+o)/a,u=-(-s+o)/a;return[c,u]}else if(r!==i&&a===0)return[(2*r-i)/(2*(r-i))];return[]}if(e.length===2){const n=e[0],r=e[1];return n!==r?[n/(n-r)]:[]}return[]},curvature:function(e,n,r,i,a){let s,o,c,u,d=0,h=0;const f=q.compute(e,n),p=q.compute(e,r),m=f.x*f.x+f.y*f.y;if(i?(s=Ge(_e(f.y*p.z-p.y*f.z,2)+_e(f.z*p.x-p.z*f.x,2)+_e(f.x*p.y-p.x*f.y,2)),o=_e(m+f.z*f.z,3/2)):(s=f.x*p.y-f.y*p.x,o=_e(m,3/2)),s===0||o===0)return{k:0,r:0};if(d=s/o,h=o/s,!a){const g=q.curvature(e-.001,n,r,i,!0).k,v=q.curvature(e+.001,n,r,i,!0).k;u=(v-d+(d-g))/2,c=(xt(v-d)+xt(d-g))/2}return{k:d,r:h,dk:u,adk:c}},inflections:function(e){if(e.length<4)return[];const n=q.align(e,{p1:e[0],p2:e.slice(-1)[0]}),r=n[2].x*n[1].y,i=n[3].x*n[1].y,a=n[1].x*n[2].y,s=n[3].x*n[2].y,o=18*(-3*r+2*i+3*a-s),c=18*(3*r-i-3*a),u=18*(a-r);if(q.approximately(o,0)){if(!q.approximately(c,0)){let p=-u/c;if(0<=p&&p<=1)return[p]}return[]}const d=2*o;if(q.approximately(d,0))return[];const h=c*c-4*o*u;if(h<0)return[];const f=Math.sqrt(h);return[(f-c)/d,-(c+f)/d].filter(function(p){return 0<=p&&p<=1})},bboxoverlap:function(e,n){const r=["x","y"],i=r.length;for(let a=0,s,o,c,u;a<i;a++)if(s=r[a],o=e[s].mid,c=n[s].mid,u=(e[s].size+n[s].size)/2,xt(o-c)>=u)return!1;return!0},expandbox:function(e,n){n.x.min<e.x.min&&(e.x.min=n.x.min),n.y.min<e.y.min&&(e.y.min=n.y.min),n.z&&n.z.min<e.z.min&&(e.z.min=n.z.min),n.x.max>e.x.max&&(e.x.max=n.x.max),n.y.max>e.y.max&&(e.y.max=n.y.max),n.z&&n.z.max>e.z.max&&(e.z.max=n.z.max),e.x.mid=(e.x.min+e.x.max)/2,e.y.mid=(e.y.min+e.y.max)/2,e.z&&(e.z.mid=(e.z.min+e.z.max)/2),e.x.size=e.x.max-e.x.min,e.y.size=e.y.max-e.y.min,e.z&&(e.z.size=e.z.max-e.z.min)},pairiteration:function(e,n,r){const i=e.bbox(),a=n.bbox(),s=1e5,o=r||.5;if(i.x.size+i.y.size<o&&a.x.size+a.y.size<o)return[(s*(e._t1+e._t2)/2|0)/s+"/"+(s*(n._t1+n._t2)/2|0)/s];let c=e.split(.5),u=n.split(.5),d=[{left:c.left,right:u.left},{left:c.left,right:u.right},{left:c.right,right:u.right},{left:c.right,right:u.left}];d=d.filter(function(f){return q.bboxoverlap(f.left.bbox(),f.right.bbox())});let h=[];return d.length===0||(d.forEach(function(f){h=h.concat(q.pairiteration(f.left,f.right,o))}),h=h.filter(function(f,p){return h.indexOf(f)===p})),h},getccenter:function(e,n,r){const i=n.x-e.x,a=n.y-e.y,s=r.x-n.x,o=r.y-n.y,c=i*$e(We)-a*it(We),u=i*it(We)+a*$e(We),d=s*$e(We)-o*it(We),h=s*it(We)+o*$e(We),f=(e.x+n.x)/2,p=(e.y+n.y)/2,m=(n.x+r.x)/2,g=(n.y+r.y)/2,v=f+c,b=p+u,x=m+d,j=g+h,C=q.lli8(f,p,v,b,m,g,x,j),w=q.dist(C,e);let _=yt(e.y-C.y,e.x-C.x),M=yt(n.y-C.y,n.x-C.x),E=yt(r.y-C.y,r.x-C.x),y;return _<E?((_>M||M>E)&&(_+=en),_>E&&(y=E,E=_,_=y)):E<M&&M<_?(y=E,E=_,_=y):E+=en,C.s=_,C.e=E,C.r=w,C},numberSort:function(e,n){return e-n}};class Et{constructor(n){this.curves=[],this._3d=!1,n&&(this.curves=n,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(n){return q.pointsToString(n.points)}).join(", ")+"]"}addCurve(n){this.curves.push(n),this._3d=this._3d||n._3d}length(){return this.curves.map(function(n){return n.length()}).reduce(function(n,r){return n+r})}curve(n){return this.curves[n]}bbox(){const n=this.curves;for(var r=n[0].bbox(),i=1;i<n.length;i++)q.expandbox(r,n[i].bbox());return r}offset(n){const r=[];return this.curves.forEach(function(i){r.push(...i.offset(n))}),new Et(r)}}const{abs:vt,min:$i,max:Fi,cos:xp,sin:yp,acos:bp,sqrt:_t}=Math,vp=Math.PI;class Z{constructor(n){let r=n&&n.forEach?n:Array.from(arguments).slice(),i=!1;if(typeof r[0]=="object"){i=r.length;const m=[];r.forEach(function(g){["x","y","z"].forEach(function(v){typeof g[v]<"u"&&m.push(g[v])})}),r=m}let a=!1;const s=r.length;if(i){if(i>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");a=!0}}else if(s!==6&&s!==8&&s!==9&&s!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const o=this._3d=!a&&(s===9||s===12)||n&&n[0]&&typeof n[0].z<"u",c=this.points=[];for(let m=0,g=o?3:2;m<s;m+=g){var u={x:r[m],y:r[m+1]};o&&(u.z=r[m+2]),c.push(u)}const d=this.order=c.length-1,h=this.dims=["x","y"];o&&h.push("z"),this.dimlen=h.length;const f=q.align(c,{p1:c[0],p2:c[d]}),p=q.dist(c[0],c[d]);this._linear=f.reduce((m,g)=>m+vt(g.y),0)<p/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(n,r,i,a){if(typeof a>"u"&&(a=.5),a===0)return new Z(r,r,i);if(a===1)return new Z(n,r,r);const s=Z.getABC(2,n,r,i,a);return new Z(n,s.A,i)}static cubicFromPoints(n,r,i,a,s){typeof a>"u"&&(a=.5);const o=Z.getABC(3,n,r,i,a);typeof s>"u"&&(s=q.dist(r,o.C));const c=s*(1-a)/a,u=q.dist(n,i),d=(i.x-n.x)/u,h=(i.y-n.y)/u,f=s*d,p=s*h,m=c*d,g=c*h,v={x:r.x-f,y:r.y-p},b={x:r.x+m,y:r.y+g},x=o.A,j={x:x.x+(v.x-x.x)/(1-a),y:x.y+(v.y-x.y)/(1-a)},C={x:x.x+(b.x-x.x)/a,y:x.y+(b.y-x.y)/a},w={x:n.x+(j.x-n.x)/a,y:n.y+(j.y-n.y)/a},_={x:i.x+(C.x-i.x)/(1-a),y:i.y+(C.y-i.y)/(1-a)};return new Z(n,w,_,i)}static getUtils(){return q}getUtils(){return Z.getUtils()}static get PolyBezier(){return Et}valueOf(){return this.toString()}toString(){return q.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const n=this.points,r=n[0].x,i=n[0].y,a=["M",r,i,this.order===2?"Q":"C"];for(let s=1,o=n.length;s<o;s++)a.push(n[s].x),a.push(n[s].y);return a.join(" ")}setRatios(n){if(n.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=n,this._lut=[]}verify(){const n=this.coordDigest();n!==this._print&&(this._print=n,this.update())}coordDigest(){return this.points.map(function(n,r){return""+r+n.x+n.y+(n.z?n.z:0)}).join("")}update(){this._lut=[],this.dpoints=q.derive(this.points,this._3d),this.computedirection()}computedirection(){const n=this.points,r=q.angle(n[0],n[this.order],n[1]);this.clockwise=r>0}length(){return q.length(this.derivative.bind(this))}static getABC(n=2,r,i,a,s=.5){const o=q.projectionratio(s,n),c=1-o,u={x:o*r.x+c*a.x,y:o*r.y+c*a.y},d=q.abcratio(s,n);return{A:{x:i.x+(i.x-u.x)/d,y:i.y+(i.y-u.y)/d},B:i,C:u,S:r,E:a}}getABC(n,r){r=r||this.get(n);let i=this.points[0],a=this.points[this.order];return Z.getABC(this.order,i,r,a,n)}getLUT(n){if(this.verify(),n=n||100,this._lut.length===n+1)return this._lut;this._lut=[],n++,this._lut=[];for(let r=0,i,a;r<n;r++)a=r/(n-1),i=this.compute(a),i.t=a,this._lut.push(i);return this._lut}on(n,r){r=r||5;const i=this.getLUT(),a=[];for(let s=0,o,c=0;s<i.length;s++)o=i[s],q.dist(o,n)<r&&(a.push(o),c+=s/i.length);return a.length?t/=a.length:!1}project(n){const r=this.getLUT(),i=r.length-1,a=q.closest(r,n),s=a.mpos,o=(s-1)/i,c=(s+1)/i,u=.1/i;let d=a.mdist,h=o,f=h,p;d+=1;for(let m;h<c+u;h+=u)p=this.compute(h),m=q.dist(n,p),m<d&&(d=m,f=h);return f=f<0?0:f>1?1:f,p=this.compute(f),p.t=f,p.d=d,p}get(n){return this.compute(n)}point(n){return this.points[n]}compute(n){return this.ratios?q.computeWithRatios(n,this.points,this.ratios,this._3d):q.compute(n,this.points,this._3d,this.ratios)}raise(){const n=this.points,r=[n[0]],i=n.length;for(let a=1,s,o;a<i;a++)s=n[a],o=n[a-1],r[a]={x:(i-a)/i*s.x+a/i*o.x,y:(i-a)/i*s.y+a/i*o.y};return r[i]=n[i-1],new Z(r)}derivative(n){return q.compute(n,this.dpoints[0],this._3d)}dderivative(n){return q.compute(n,this.dpoints[1],this._3d)}align(){let n=this.points;return new Z(q.align(n,{p1:n[0],p2:n[n.length-1]}))}curvature(n){return q.curvature(n,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return q.inflections(this.points)}normal(n){return this._3d?this.__normal3(n):this.__normal2(n)}__normal2(n){const r=this.derivative(n),i=_t(r.x*r.x+r.y*r.y);return{t:n,x:-r.y/i,y:r.x/i}}__normal3(n){const r=this.derivative(n),i=this.derivative(n+.01),a=_t(r.x*r.x+r.y*r.y+r.z*r.z),s=_t(i.x*i.x+i.y*i.y+i.z*i.z);r.x/=a,r.y/=a,r.z/=a,i.x/=s,i.y/=s,i.z/=s;const o={x:i.y*r.z-i.z*r.y,y:i.z*r.x-i.x*r.z,z:i.x*r.y-i.y*r.x},c=_t(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=c,o.y/=c,o.z/=c;const u=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{t:n,x:u[0]*r.x+u[1]*r.y+u[2]*r.z,y:u[3]*r.x+u[4]*r.y+u[5]*r.z,z:u[6]*r.x+u[7]*r.y+u[8]*r.z}}hull(n){let r=this.points,i=[],a=[],s=0;for(a[s++]=r[0],a[s++]=r[1],a[s++]=r[2],this.order===3&&(a[s++]=r[3]);r.length>1;){i=[];for(let o=0,c,u=r.length-1;o<u;o++)c=q.lerp(n,r[o],r[o+1]),a[s++]=c,i.push(c);r=i}return a}split(n,r){if(n===0&&r)return this.split(r).left;if(r===1)return this.split(n).right;const i=this.hull(n),a={left:this.order===2?new Z([i[0],i[3],i[5]]):new Z([i[0],i[4],i[7],i[9]]),right:this.order===2?new Z([i[5],i[4],i[2]]):new Z([i[9],i[8],i[6],i[3]]),span:i};return a.left._t1=q.map(0,0,1,this._t1,this._t2),a.left._t2=q.map(n,0,1,this._t1,this._t2),a.right._t1=q.map(n,0,1,this._t1,this._t2),a.right._t2=q.map(1,0,1,this._t1,this._t2),r?(r=q.map(r,n,1,0,1),a.right.split(r).left):a}extrema(){const n={};let r=[];return this.dims.forEach((function(i){let a=function(o){return o[i]},s=this.dpoints[0].map(a);n[i]=q.droots(s),this.order===3&&(s=this.dpoints[1].map(a),n[i]=n[i].concat(q.droots(s))),n[i]=n[i].filter(function(o){return o>=0&&o<=1}),r=r.concat(n[i].sort(q.numberSort))}).bind(this)),n.values=r.sort(q.numberSort).filter(function(i,a){return r.indexOf(i)===a}),n}bbox(){const n=this.extrema(),r={};return this.dims.forEach((function(i){r[i]=q.getminmax(this,i,n[i])}).bind(this)),r}overlaps(n){const r=this.bbox(),i=n.bbox();return q.bboxoverlap(r,i)}offset(n,r){if(typeof r<"u"){const i=this.get(n),a=this.normal(n),s={c:i,n:a,x:i.x+a.x*r,y:i.y+a.y*r};return this._3d&&(s.z=i.z+a.z*r),s}if(this._linear){const i=this.normal(0),a=this.points.map(function(s){const o={x:s.x+n*i.x,y:s.y+n*i.y};return s.z&&i.z&&(o.z=s.z+n*i.z),o});return[new Z(a)]}return this.reduce().map(function(i){return i._linear?i.offset(n)[0]:i.scale(n)})}simple(){if(this.order===3){const a=q.angle(this.points[0],this.points[3],this.points[1]),s=q.angle(this.points[0],this.points[3],this.points[2]);if(a>0&&s<0||a<0&&s>0)return!1}const n=this.normal(0),r=this.normal(1);let i=n.x*r.x+n.y*r.y;return this._3d&&(i+=n.z*r.z),vt(bp(i))<vp/3}reduce(){let n,r=0,i=0,a=.01,s,o=[],c=[],u=this.extrema().values;for(u.indexOf(0)===-1&&(u=[0].concat(u)),u.indexOf(1)===-1&&u.push(1),r=u[0],n=1;n<u.length;n++)i=u[n],s=this.split(r,i),s._t1=r,s._t2=i,o.push(s),r=i;return o.forEach(function(d){for(r=0,i=0;i<=1;)for(i=r+a;i<=1+a;i+=a)if(s=d.split(r,i),!s.simple()){if(i-=a,vt(r-i)<a)return[];s=d.split(r,i),s._t1=q.map(r,0,1,d._t1,d._t2),s._t2=q.map(i,0,1,d._t1,d._t2),c.push(s),r=i;break}r<1&&(s=d.split(r,1),s._t1=q.map(r,0,1,d._t1,d._t2),s._t2=d._t2,c.push(s))}),c}translate(n,r,i){i=typeof i=="number"?i:r;const a=this.order;let s=this.points.map((o,c)=>(1-c/a)*r+c/a*i);return new Z(this.points.map((o,c)=>({x:o.x+n.x*s[c],y:o.y+n.y*s[c]})))}scale(n){const r=this.order;let i=!1;if(typeof n=="function"&&(i=n),i&&r===2)return this.raise().scale(i);const a=this.clockwise,s=this.points;if(this._linear)return this.translate(this.normal(0),i?i(0):n,i?i(1):n);const o=i?i(0):n,c=i?i(1):n,u=[this.offset(0,10),this.offset(1,10)],d=[],h=q.lli4(u[0],u[0].c,u[1],u[1].c);if(!h)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(f){const p=d[f*r]=q.copy(s[f*r]);p.x+=(f?c:o)*u[f].n.x,p.y+=(f?c:o)*u[f].n.y}),i?([0,1].forEach(function(f){if(!(r===2&&f)){var p=s[f+1],m={x:p.x-h.x,y:p.y-h.y},g=i?i((f+1)/r):n;i&&!a&&(g=-g);var v=_t(m.x*m.x+m.y*m.y);m.x/=v,m.y/=v,d[f+1]={x:p.x+g*m.x,y:p.y+g*m.y}}}),new Z(d)):([0,1].forEach(f=>{if(r===2&&f)return;const p=d[f*r],m=this.derivative(f),g={x:p.x+m.x,y:p.y+m.y};d[f+1]=q.lli4(p,g,h,s[f+1])}),new Z(d))}outline(n,r,i,a){if(r=r===void 0?n:r,this._linear){const _=this.normal(0),M=this.points[0],E=this.points[this.points.length-1];let y,T,k;i===void 0&&(i=n,a=r),y={x:M.x+_.x*n,y:M.y+_.y*n},k={x:E.x+_.x*i,y:E.y+_.y*i},T={x:(y.x+k.x)/2,y:(y.y+k.y)/2};const O=[y,T,k];y={x:M.x-_.x*r,y:M.y-_.y*r},k={x:E.x-_.x*a,y:E.y-_.y*a},T={x:(y.x+k.x)/2,y:(y.y+k.y)/2};const P=[k,T,y],z=q.makeline(P[2],O[0]),S=q.makeline(O[2],P[0]),R=[z,new Z(O),S,new Z(P)];return new Et(R)}const s=this.reduce(),o=s.length,c=[];let u=[],d,h=0,f=this.length();const p=typeof i<"u"&&typeof a<"u";function m(_,M,E,y,T){return function(k){const O=y/E,P=(y+T)/E,z=M-_;return q.map(k,0,1,_+O*z,_+P*z)}}s.forEach(function(_){const M=_.length();p?(c.push(_.scale(m(n,i,f,h,M))),u.push(_.scale(m(-r,-a,f,h,M)))):(c.push(_.scale(n)),u.push(_.scale(-r))),h+=M}),u=u.map(function(_){return d=_.points,d[3]?_.points=[d[3],d[2],d[1],d[0]]:_.points=[d[2],d[1],d[0]],_}).reverse();const g=c[0].points[0],v=c[o-1].points[c[o-1].points.length-1],b=u[o-1].points[u[o-1].points.length-1],x=u[0].points[0],j=q.makeline(b,g),C=q.makeline(v,x),w=[j].concat(c).concat([C]).concat(u);return new Et(w)}outlineshapes(n,r,i){r=r||n;const a=this.outline(n,r).curves,s=[];for(let o=1,c=a.length;o<c/2;o++){const u=q.makeshape(a[o],a[c-o],i);u.startcap.virtual=o>1,u.endcap.virtual=o<c/2-1,s.push(u)}return s}intersects(n,r){return n?n.p1&&n.p2?this.lineIntersects(n):(n instanceof Z&&(n=n.reduce()),this.curveintersects(this.reduce(),n,r)):this.selfintersects(r)}lineIntersects(n){const r=$i(n.p1.x,n.p2.x),i=$i(n.p1.y,n.p2.y),a=Fi(n.p1.x,n.p2.x),s=Fi(n.p1.y,n.p2.y);return q.roots(this.points,n).filter(o=>{var c=this.get(o);return q.between(c.x,r,a)&&q.between(c.y,i,s)})}selfintersects(n){const r=this.reduce(),i=r.length-2,a=[];for(let s=0,o,c,u;s<i;s++)c=r.slice(s,s+1),u=r.slice(s+2),o=this.curveintersects(c,u,n),a.push(...o);return a}curveintersects(n,r,i){const a=[];n.forEach(function(o){r.forEach(function(c){o.overlaps(c)&&a.push({left:o,right:c})})});let s=[];return a.forEach(function(o){const c=q.pairiteration(o.left,o.right,i);c.length>0&&(s=s.concat(c))}),s}arcs(n){return n=n||.5,this._iterate(n,[])}_error(n,r,i,a){const s=(a-i)/4,o=this.get(i+s),c=this.get(a-s),u=q.dist(n,r),d=q.dist(n,o),h=q.dist(n,c);return vt(d-u)+vt(h-u)}_iterate(n,r){let i=0,a=1,s;do{s=0,a=1;let o=this.get(i),c,u,d,h,f=!1,p=!1,m,g=a,v=1;do if(p=f,h=d,g=(i+a)/2,c=this.get(g),u=this.get(a),d=q.getccenter(o,c,u),d.interval={start:i,end:a},f=this._error(d,o,i,a)<=n,m=p&&!f,m||(v=a),f){if(a>=1){if(d.interval.end=v=1,h=d,a>1){let x={x:d.x+d.r*xp(d.e),y:d.y+d.r*yp(d.e)};d.e+=q.angle({x:d.x,y:d.y},x,this.get(1))}break}a=a+(a-i)/2}else a=g;while(!m&&s++<100);if(s>=100)break;h=h||d,r.push(h),i=v}while(a<1);return r}}function fr(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,i=Array(n);r<n;r++)i[r]=e[r];return i}function _p(e){if(Array.isArray(e))return e}function wp(e){if(Array.isArray(e))return fr(e)}function Np(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jp(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,s,o,c=[],u=!0,d=!1;try{if(s=(r=r.call(e)).next,n!==0)for(;!(u=(i=s.call(r)).done)&&(c.push(i.value),c.length!==n);u=!0);}catch(h){d=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return c}}function kp(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sp(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cp(e,n){if(e==null)return{};var r,i,a=Ap(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)r=s[i],n.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ap(e,n){if(e==null)return{};var r={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(n.includes(i))continue;r[i]=e[i]}return r}function Tp(e,n){return _p(e)||jp(e,n)||xs(e,n)||kp()}function Op(e){return wp(e)||Np(e)||xs(e)||Sp()}function Mp(e,n){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Ep(e){var n=Mp(e,"string");return typeof n=="symbol"?n:n+""}function xs(e,n){if(e){if(typeof e=="string")return fr(e,n);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?fr(e,n):void 0}}var Pp=(function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=(n instanceof Array?n.length?n:[void 0]:[n]).map(function(c){return{keyAccessor:c,isProp:!(c instanceof Function)}}),s=e.reduce(function(c,u){var d=c,h=u;return a.forEach(function(f,p){var m=f.keyAccessor,g=f.isProp,v;if(g){var b=h,x=b[m],j=Cp(b,[m].map(Ep));v=x,h=j}else v=m(h,p);p+1<a.length?(d.hasOwnProperty(v)||(d[v]={}),d=d[v]):r?(d.hasOwnProperty(v)||(d[v]=[]),d[v].push(h)):d[v]=h}),c},{});r instanceof Function&&(function c(u){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;d===a.length?Object.keys(u).forEach(function(h){return u[h]=r(u[h])}):Object.values(u).forEach(function(h){return c(h,d+1)})})(s);var o=s;return i&&(o=[],(function c(u){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];d.length===a.length?o.push({keys:d,vals:u}):Object.entries(u).forEach(function(h){var f=Tp(h,2),p=f[0],m=f[1];return c(m,[].concat(Op(d),[p]))})})(s),n instanceof Array&&n.length===0&&o.length===1&&(o[0].keys=[])),o});function Ip(e,n){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(n).domain(e);break}return this}const Li=Symbol("implicit");function ys(){var e=new oi,n=[],r=[],i=Li;function a(s){let o=e.get(s);if(o===void 0){if(i!==Li)return i;e.set(s,o=n.push(s)-1)}return r[o%r.length]}return a.domain=function(s){if(!arguments.length)return n.slice();n=[],e=new oi;for(const o of s)e.has(o)||e.set(o,n.push(o)-1);return a},a.range=function(s){return arguments.length?(r=Array.from(s),a):r.slice()},a.unknown=function(s){return arguments.length?(i=s,a):i},a.copy=function(){return ys(n,r).unknown(i)},Ip.apply(a,arguments),a}function Rp(e){for(var n=e.length/6|0,r=new Array(n),i=0;i<n;)r[i]="#"+e.slice(i*6,++i*6);return r}const Dp=Rp("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");function zp(e,n){n===void 0&&(n={});var r=n.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",r==="top"&&i.firstChild?i.insertBefore(a,i.firstChild):i.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var $p=`.force-graph-container canvas {
  display: block;
  user-select: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

.force-graph-container .clickable {
  cursor: pointer;
}

.force-graph-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.force-graph-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}
`;zp($p);function hr(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,i=Array(n);r<n;r++)i[r]=e[r];return i}function Fp(e){if(Array.isArray(e))return e}function Lp(e){if(Array.isArray(e))return hr(e)}function qi(e,n,r){if(bs())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,n);var a=new(e.bind.apply(e,i));return a}function Ut(e,n,r){return(n=Gp(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function bs(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bs=function(){return!!e})()}function qp(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Up(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,a,s,o,c=[],u=!0,d=!1;try{if(s=(r=r.call(e)).next,n!==0)for(;!(u=(i=s.call(r)).done)&&(c.push(i.value),c.length!==n);u=!0);}catch(h){d=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return c}}function Hp(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bp(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ui(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,i)}return r}function at(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Ui(Object(r),!0).forEach(function(i){Ut(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ui(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Pt(e,n){return Fp(e)||Up(e,n)||vs(e,n)||Hp()}function Ne(e){return Lp(e)||qp(e)||vs(e)||Bp()}function Vp(e,n){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Gp(e){var n=Vp(e,"string");return typeof n=="symbol"?n:n+""}function pr(e){"@babel/helpers - typeof";return pr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},pr(e)}function vs(e,n){if(e){if(typeof e=="string")return hr(e,n);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?hr(e,n):void 0}}var Wp=ys(Dp);function Hi(e,n,r){!n||typeof r!="string"||e.filter(function(i){return!i[r]}).forEach(function(i){i[r]=Wp(n(i))})}function Kp(e,n){var r=e.nodes,i=e.links,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=a.nodeFilter,o=s===void 0?function(){return!0}:s,c=a.onLoopError,u=c===void 0?function(m){throw"Invalid DAG structure! Found cycle in node path: ".concat(m.join(" -> "),".")}:c,d={};r.forEach(function(m){return d[n(m)]={data:m,out:[],depth:-1,skip:!o(m)}}),i.forEach(function(m){var g=m.source,v=m.target,b=w(g),x=w(v);if(!d.hasOwnProperty(b))throw"Missing source node with id: ".concat(b);if(!d.hasOwnProperty(x))throw"Missing target node with id: ".concat(x);var j=d[b],C=d[x];j.out.push(C);function w(_){return pr(_)==="object"?n(_):_}});var h=[];p(Object.values(d));var f=Object.assign.apply(Object,[{}].concat(Ne(Object.entries(d).filter(function(m){var g=Pt(m,2),v=g[1];return!v.skip}).map(function(m){var g=Pt(m,2),v=g[0],b=g[1];return Ut({},v,b.depth)}))));return f;function p(m){for(var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,b=function(){var w=m[x];if(g.indexOf(w)!==-1){var _=[].concat(Ne(g.slice(g.indexOf(w))),[w]).map(function(M){return n(M.data)});return h.some(function(M){return M.length===_.length&&M.every(function(E,y){return E===_[y]})})||(h.push(_),u(_)),1}v>w.depth&&(w.depth=v,p(w.out,[].concat(Ne(g),[w]),v+(w.skip?0:1)))},x=0,j=m.length;x<j;x++)b()}}var Yp=2,ue=function(n,r){return r.onNeedsRedraw&&r.onNeedsRedraw()},Bi=function(n,r){if(!r.isShadow){var i=J(r.linkDirectionalParticles);r.graphData.links.forEach(function(a){var s=Math.round(Math.abs(i(a)));s?a.__photons=Ne(Array(s)).map(function(){return{}}):delete a.__photons})}},wn=Sr({props:{graphData:{default:{nodes:[],links:[]},onChange:function(n,r){r.engineRunning=!1,Bi(n,r)}},dagMode:{onChange:function(n,r){!n&&(r.graphData.nodes||[]).forEach(function(i){return i.fx=i.fy=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(n){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:ue},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:ue},nodeColor:{default:"color",triggerUpdate:!1,onChange:ue},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:ue},nodeCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:ue},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:ue},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:ue},linkColor:{default:"color",triggerUpdate:!1,onChange:ue},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:ue},linkWidth:{default:1,triggerUpdate:!1,onChange:ue},linkCurvature:{default:0,triggerUpdate:!1,onChange:ue},linkCanvasObject:{triggerUpdate:!1,onChange:ue},linkCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:ue},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:ue},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:ue},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:ue},linkDirectionalParticles:{default:0,triggerUpdate:!1,onChange:Bi},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleOffset:{default:0,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},linkDirectionalParticleCanvasObject:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(n,r){r.forceLayout.alphaDecay(n)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(n,r){r.forceLayout.alphaTarget(n)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(n,r){r.forceLayout.velocityDecay(n)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function(n,r,i){return i===void 0?n.forceLayout.force(r):(n.forceLayout.force(r,i),this)},d3ReheatSimulation:function(n){return n.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(n){return n.cntTicks=0,n.startTickTime=new Date,n.engineRunning=!0,this},isEngineRunning:function(n){return!!n.engineRunning},tickFrame:function(n){return!n.isShadow&&r(),a(),!n.isShadow&&s(),!n.isShadow&&o(),i(),this;function r(){n.engineRunning&&(++n.cntTicks>n.cooldownTicks||new Date-n.startTickTime>n.cooldownTime||n.d3AlphaMin>0&&n.forceLayout.alpha()<n.d3AlphaMin?(n.engineRunning=!1,n.onEngineStop()):(n.forceLayout.tick(),n.onEngineTick()))}function i(){var c=J(n.nodeVisibility),u=J(n.nodeVal),d=J(n.nodeColor),h=J(n.nodeCanvasObjectMode),f=n.ctx,p=n.isShadow/n.globalScale,m=n.graphData.nodes.filter(c);f.save(),m.forEach(function(g){var v=h(g);if(n.nodeCanvasObject&&(v==="before"||v==="replace")&&(n.nodeCanvasObject(g,f,n.globalScale),v==="replace")){f.restore();return}var b=Math.sqrt(Math.max(0,u(g)||1))*n.nodeRelSize+p;f.beginPath(),f.arc(g.x,g.y,b,0,2*Math.PI,!1),f.fillStyle=d(g)||"rgba(31, 120, 180, 0.92)",f.fill(),n.nodeCanvasObject&&v==="after"&&n.nodeCanvasObject(g,n.ctx,n.globalScale)}),f.restore()}function a(){var c=J(n.linkVisibility),u=J(n.linkColor),d=J(n.linkWidth),h=J(n.linkLineDash),f=J(n.linkCurvature),p=J(n.linkCanvasObjectMode),m=n.ctx,g=n.isShadow*2,v=n.graphData.links.filter(c);v.forEach(M);var b=[],x=[],j=v;if(n.linkCanvasObject){var C=[],w=[];v.forEach(function(E){return({before:b,after:x,replace:C}[p(E)]||w).push(E)}),j=[].concat(Ne(b),x,w),b=b.concat(C)}m.save(),b.forEach(function(E){return n.linkCanvasObject(E,m,n.globalScale)}),m.restore();var _=Pp(j,[u,d,h]);m.save(),Object.entries(_).forEach(function(E){var y=Pt(E,2),T=y[0],k=y[1],O=!T||T==="undefined"?"rgba(0,0,0,0.15)":T;Object.entries(k).forEach(function(P){var z=Pt(P,2),S=z[0],R=z[1],N=(S||1)/n.globalScale+g;Object.entries(R).forEach(function(I){var $=Pt(I,2);$[0];var L=$[1],B=h(L[0]);m.beginPath(),L.forEach(function(G){var W=G.source,F=G.target;if(!(!W||!F||!W.hasOwnProperty("x")||!F.hasOwnProperty("x"))){m.moveTo(W.x,W.y);var U=G.__controlPoints;U?m[U.length===2?"quadraticCurveTo":"bezierCurveTo"].apply(m,Ne(U).concat([F.x,F.y])):m.lineTo(F.x,F.y)}}),m.strokeStyle=O,m.lineWidth=N,m.setLineDash(B||[]),m.stroke()})})}),m.restore(),m.save(),x.forEach(function(E){return n.linkCanvasObject(E,m,n.globalScale)}),m.restore();function M(E){var y=f(E);if(!y){E.__controlPoints=null;return}var T=E.source,k=E.target;if(!(!T||!k||!T.hasOwnProperty("x")||!k.hasOwnProperty("x"))){var O=Math.sqrt(Math.pow(k.x-T.x,2)+Math.pow(k.y-T.y,2));if(O>0){var P=Math.atan2(k.y-T.y,k.x-T.x),z=O*y,S={x:(T.x+k.x)/2+z*Math.cos(P-Math.PI/2),y:(T.y+k.y)/2+z*Math.sin(P-Math.PI/2)};E.__controlPoints=[S.x,S.y]}else{var R=y*70;E.__controlPoints=[k.x,k.y-R,k.x+R,k.y]}}}}function s(){var c=1.6,u=.2,d=J(n.linkDirectionalArrowLength),h=J(n.linkDirectionalArrowRelPos),f=J(n.linkVisibility),p=J(n.linkDirectionalArrowColor||n.linkColor),m=J(n.nodeVal),g=n.ctx;g.save(),n.graphData.links.filter(f).forEach(function(v){var b=d(v);if(!(!b||b<0)){var x=v.source,j=v.target;if(!(!x||!j||!x.hasOwnProperty("x")||!j.hasOwnProperty("x"))){var C=Math.sqrt(Math.max(0,m(x)||1))*n.nodeRelSize,w=Math.sqrt(Math.max(0,m(j)||1))*n.nodeRelSize,_=Math.min(1,Math.max(0,h(v))),M=p(v)||"rgba(0,0,0,0.28)",E=b/c/2,y=v.__controlPoints&&qi(Z,[x.x,x.y].concat(Ne(v.__controlPoints),[j.x,j.y])),T=y?function(N){return y.get(N)}:function(N){return{x:x.x+(j.x-x.x)*N||0,y:x.y+(j.y-x.y)*N||0}},k=y?y.length():Math.sqrt(Math.pow(j.x-x.x,2)+Math.pow(j.y-x.y,2)),O=C+b+(k-C-w-b)*_,P=T(O/k),z=T((O-b)/k),S=T((O-b*(1-u))/k),R=Math.atan2(P.y-z.y,P.x-z.x)-Math.PI/2;g.beginPath(),g.moveTo(P.x,P.y),g.lineTo(z.x+E*Math.cos(R),z.y+E*Math.sin(R)),g.lineTo(S.x,S.y),g.lineTo(z.x-E*Math.cos(R),z.y-E*Math.sin(R)),g.fillStyle=M,g.fill()}}}),g.restore()}function o(){var c=J(n.linkDirectionalParticles),u=J(n.linkDirectionalParticleSpeed),d=J(n.linkDirectionalParticleOffset),h=J(n.linkDirectionalParticleWidth),f=J(n.linkVisibility),p=J(n.linkDirectionalParticleColor||n.linkColor),m=n.ctx;m.save(),n.graphData.links.filter(f).forEach(function(g){var v=c(g);if(!(!g.hasOwnProperty("__photons")||!g.__photons.length)){var b=g.source,x=g.target;if(!(!b||!x||!b.hasOwnProperty("x")||!x.hasOwnProperty("x"))){var j=u(g),C=Math.abs(d(g)),w=g.__photons||[],_=Math.max(0,h(g)/2)/Math.sqrt(n.globalScale),M=p(g)||"rgba(0,0,0,0.28)";m.fillStyle=M;var E=g.__controlPoints?qi(Z,[b.x,b.y].concat(Ne(g.__controlPoints),[x.x,x.y])):null,y=0,T=!1;w.forEach(function(k){var O=!!k.__singleHop;if(k.hasOwnProperty("__progressRatio")||(k.__progressRatio=O?0:(y+C)/v),!O&&y++,k.__progressRatio+=j,k.__progressRatio>=1)if(!O)k.__progressRatio=k.__progressRatio%1;else{T=!0;return}var P=k.__progressRatio,z=E?E.get(P):{x:b.x+(x.x-b.x)*P||0,y:b.y+(x.y-b.y)*P||0};n.linkDirectionalParticleCanvasObject?n.linkDirectionalParticleCanvasObject(z.x,z.y,g,m,n.globalScale):(m.beginPath(),m.arc(z.x,z.y,_,0,2*Math.PI,!1),m.fill())}),T&&(g.__photons=g.__photons.filter(function(k){return!k.__singleHop||k.__progressRatio<=1}))}}}),m.restore()}},emitParticle:function(n,r){return r&&(!r.__photons&&(r.__photons=[]),r.__photons.push({__singleHop:!0})),this}},stateInit:function(){return{forceLayout:dp().force("link",rp()).force("charge",fp()).force("center",ah()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(n,r){r.ctx=n},update:function(n,r){n.engineRunning=!1,n.onUpdate(),n.nodeAutoColorBy!==null&&Hi(n.graphData.nodes,J(n.nodeAutoColorBy),n.nodeColor),n.linkAutoColorBy!==null&&Hi(n.graphData.links,J(n.linkAutoColorBy),n.linkColor),n.graphData.links.forEach(function(p){p.source=p[n.linkSource],p.target=p[n.linkTarget]}),n.forceLayout.stop().alpha(1).nodes(n.graphData.nodes);var i=n.forceLayout.force("link");i&&i.id(function(p){return p[n.nodeId]}).links(n.graphData.links);var a=n.dagMode&&Kp(n.graphData,function(p){return p[n.nodeId]},{nodeFilter:n.dagNodeFilter,onLoopError:n.onDagError||void 0}),s=Math.max.apply(Math,Ne(Object.values(a||[]))),o=n.dagLevelDistance||n.graphData.nodes.length/(s||1)*Yp*(["radialin","radialout"].indexOf(n.dagMode)!==-1?.7:1);if(["lr","rl","td","bu"].includes(r.dagMode)){var c=["lr","rl"].includes(r.dagMode)?"fx":"fy";n.graphData.nodes.filter(n.dagNodeFilter).forEach(function(p){return delete p[c]})}if(["lr","rl","td","bu"].includes(n.dagMode)){var u=["rl","bu"].includes(n.dagMode),d=function(m){return(a[m[n.nodeId]]-s/2)*o*(u?-1:1)},h=["lr","rl"].includes(n.dagMode)?"fx":"fy";n.graphData.nodes.filter(n.dagNodeFilter).forEach(function(p){return p[h]=d(p)})}n.forceLayout.force("dagRadial",["radialin","radialout"].indexOf(n.dagMode)!==-1?hp(function(p){var m=a[p[n.nodeId]]||-1;return(n.dagMode==="radialin"?s-m:m)*o}).strength(function(p){return n.dagNodeFilter(p)?1:0}):null);for(var f=0;f<n.warmupTicks&&!(n.d3AlphaMin>0&&n.forceLayout.alpha()<n.d3AlphaMin);f++)n.forceLayout.tick();this.resetCountdown(),n.onFinishUpdate()}});function _s(e,n){var r=e instanceof Array?e:[e],i=new n;return i._destructor&&i._destructor(),{linkProp:function(s){return{default:i[s](),onChange:function(c,u){r.forEach(function(d){return u[d][s](c)})},triggerUpdate:!1}},linkMethod:function(s){return function(o){for(var c=arguments.length,u=new Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=arguments[d];var h=[];return r.forEach(function(f){var p=o[f],m=p[s].apply(p,u);m!==p&&h.push(m)}),h.length?h[0]:this}}}}var Jp=800,Xp=4,Qp=5,ws=_s("forceGraph",wn),Zp=_s(["forceGraph","shadowGraph"],wn),em=Object.assign.apply(Object,Ne(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleOffset","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleCanvasObject","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(e){return Ut({},e,ws.linkProp(e))})).concat(Ne(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map(function(e){return Ut({},e,Zp.linkProp(e))})))),tm=Object.assign.apply(Object,Ne(["d3Force","d3ReheatSimulation","emitParticle"].map(function(e){return Ut({},e,ws.linkMethod(e))})));function Un(e){if(e.canvas){var n=e.canvas.width,r=e.canvas.height;n===300&&r===150&&(n=r=0);var i=window.devicePixelRatio;n/=i,r/=i,[e.canvas,e.shadowCanvas].forEach(function(s){s.style.width="".concat(e.width,"px"),s.style.height="".concat(e.height,"px"),s.width=e.width*i,s.height=e.height*i,!n&&!r&&s.getContext("2d").scale(i,i)});var a=Ae(e.canvas).k;e.zoom.translateBy(e.zoom.__baseElem,(e.width-n)/2/a,(e.height-r)/2/a),e.needsRedraw=!0}}function Ns(e){var n=window.devicePixelRatio;e.setTransform(n,0,0,n,0,0)}function Vi(e,n,r){e.save(),Ns(e),e.clearRect(0,0,n,r),e.restore()}var nm=Sr({props:at({width:{default:window.innerWidth,onChange:function(n,r){return Un(r)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function(n,r){return Un(r)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(n,r){[n.nodes,n.links].every(function(a){return(a||[]).every(function(s){return!s.hasOwnProperty("__indexColor")})})&&r.colorTracker.reset(),[{type:"Node",objs:n.nodes},{type:"Link",objs:n.links}].forEach(i),r.forceGraph.graphData(n),r.shadowGraph.graphData(n);function i(a){var s=a.type,o=a.objs;o.filter(function(c){if(!c.hasOwnProperty("__indexColor"))return!0;var u=r.colorTracker.lookup(c.__indexColor);return!u||!u.hasOwnProperty("d")||u.d!==c}).forEach(function(c){c.__indexColor=r.colorTracker.register({type:s,d:c})})}},triggerUpdate:!1},backgroundColor:{onChange:function(n,r){r.canvas&&n&&(r.canvas.style.background=n)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function(n,r){r.shadowGraph.nodeCanvasObject(n?function(i,a,s){return n(i,i.__indexColor,a,s)}:null),r.flushShadowCanvas&&r.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function(n,r){r.shadowGraph.linkCanvasObject(n?function(i,a,s){return n(i,i.__indexColor,a,s)}:null),r.flushShadowCanvas&&r.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function(n,r){r.zoom.scaleExtent([n,r.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function(n,r){r.zoom.scaleExtent([r.zoom.scaleExtent()[0],n])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function(n,r){r.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},showPointerCursor:{default:!0,triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},em),aliases:{stopAnimation:"pauseAnimation"},methods:at({graph2ScreenCoords:function(n,r,i){var a=Ae(n.canvas);return{x:r*a.k+a.x,y:i*a.k+a.y}},screen2GraphCoords:function(n,r,i){var a=Ae(n.canvas);return{x:(r-a.x)/a.k,y:(i-a.y)/a.k}},centerAt:function(n,r,i,a){if(!n.canvas)return null;if(r!==void 0||i!==void 0){var s=Object.assign({},r!==void 0?{x:r}:{},i!==void 0?{y:i}:{});return a?n.tweenGroup.add(new pi(o()).to(s,a).easing(nt.Quadratic.Out).onUpdate(c).start()):c(s),this}return o();function o(){var u=Ae(n.canvas);return{x:(n.width/2-u.x)/u.k,y:(n.height/2-u.y)/u.k}}function c(u){var d=u.x,h=u.y;n.zoom.translateTo(n.zoom.__baseElem,d===void 0?o().x:d,h===void 0?o().y:h),n.needsRedraw=!0}},zoom:function(n,r,i){if(!n.canvas)return null;if(r!==void 0)return i?n.tweenGroup.add(new pi({k:a()}).to({k:r},i).easing(nt.Quadratic.Out).onUpdate(function(o){var c=o.k;return s(c)}).start()):s(r),this;return a();function a(){return Ae(n.canvas).k}function s(o){n.zoom.scaleTo(n.zoom.__baseElem,o),n.needsRedraw=!0}},zoomToFit:function(n){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,a=arguments.length,s=new Array(a>3?a-3:0),o=3;o<a;o++)s[o-3]=arguments[o];var c=this.getGraphBbox.apply(this,s);if(c){var u={x:(c.x[0]+c.x[1])/2,y:(c.y[0]+c.y[1])/2},d=Math.max(1e-12,Math.min(1e12,(n.width-i*2)/(c.x[1]-c.x[0]),(n.height-i*2)/(c.y[1]-c.y[0])));this.centerAt(u.x,u.y,r),this.zoom(d,r)}return this},getGraphBbox:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},i=J(n.nodeVal),a=function(c){return Math.sqrt(Math.max(0,i(c)||1))*n.nodeRelSize},s=n.graphData.nodes.filter(r).map(function(o){return{x:o.x,y:o.y,r:a(o)}});return s.length?{x:[ui(s,function(o){return o.x-o.r}),ci(s,function(o){return o.x+o.r})],y:[ui(s,function(o){return o.y-o.r}),ci(s,function(o){return o.y+o.r})]}:null},pauseAnimation:function(n){return n.animationFrameRequestId&&(cancelAnimationFrame(n.animationFrameRequestId),n.animationFrameRequestId=null),this},resumeAnimation:function(n){return n.animationFrameRequestId||this._animationCycle(),this},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},tm),stateInit:function(){return{lastSetZoom:1,zoom:fd(),forceGraph:new wn,shadowGraph:new wn().cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new zf,tweenGroup:new Va}},init:function(n,r){var i=this;n.innerHTML="";var a=document.createElement("div");a.classList.add("force-graph-container"),a.style.position="relative",n.appendChild(a),r.canvas=document.createElement("canvas"),r.backgroundColor&&(r.canvas.style.background=r.backgroundColor),a.appendChild(r.canvas),r.shadowCanvas=document.createElement("canvas");var s=r.canvas.getContext("2d"),o=r.shadowCanvas.getContext("2d",{willReadFrequently:!0}),c={x:-1e12,y:-1e12},u=function(){var f=null,p=window.devicePixelRatio,m=c.x>0&&c.y>0?o.getImageData(c.x*p,c.y*p,1,1):null;return m&&(f=r.colorTracker.lookup(m.data)),f};we(r.canvas).call(wc().subject(function(){if(!r.enableNodeDrag)return null;var h=u();return h&&h.type==="Node"?h.d:null}).on("start",function(h){var f=h.subject;f.__initialDragPos={x:f.x,y:f.y,fx:f.fx,fy:f.fy},h.active||(f.fx=f.x,f.fy=f.y),r.canvas.classList.add("grabbable")}).on("drag",function(h){var f=h.subject,p=f.__initialDragPos,m=h,g=Ae(r.canvas).k,v={x:p.x+(m.x-p.x)/g-f.x,y:p.y+(m.y-p.y)/g-f.y};["x","y"].forEach(function(b){return f["f".concat(b)]=f[b]=p[b]+(m[b]-p[b])/g}),!(!f.__dragged&&Qp>=Math.sqrt(gd(["x","y"].map(function(b){return Math.pow(h[b]-p[b],2)}))))&&(r.forceGraph.d3AlphaTarget(.3).resetCountdown(),r.isPointerDragging=!0,f.__dragged=!0,r.onNodeDrag(f,v))}).on("end",function(h){var f=h.subject,p=f.__initialDragPos,m={x:f.x-p.x,y:f.y-p.y};p.fx===void 0&&(f.fx=void 0),p.fy===void 0&&(f.fy=void 0),delete f.__initialDragPos,r.forceGraph.d3AlphaTarget()&&r.forceGraph.d3AlphaTarget(0).resetCountdown(),r.canvas.classList.remove("grabbable"),r.isPointerDragging=!1,f.__dragged&&(delete f.__dragged,r.onNodeDragEnd(f,m))})),r.zoom(r.zoom.__baseElem=we(r.canvas)),r.zoom.__baseElem.on("dblclick.zoom",null),r.zoom.filter(function(h){return!h.button&&r.enableZoomPanInteraction&&(h.type!=="wheel"||J(r.enableZoomInteraction)(h))&&(h.type==="wheel"||J(r.enablePanInteraction)(h))}).on("zoom",function(h){var f=h.transform;[s,o].forEach(function(p){Ns(p),p.translate(f.x,f.y),p.scale(f.k,f.k)}),r.isPointerDragging=!0,r.onZoom&&r.onZoom(at(at({},f),i.centerAt())),r.needsRedraw=!0}).on("end",function(h){r.isPointerDragging=!1,r.onZoomEnd&&r.onZoomEnd(at(at({},h.transform),i.centerAt()))}),Un(r),r.forceGraph.onNeedsRedraw(function(){return r.needsRedraw=!0}).onFinishUpdate(function(){Ae(r.canvas).k===r.lastSetZoom&&r.graphData.nodes.length&&(r.zoom.scaleTo(r.zoom.__baseElem,r.lastSetZoom=Xp/Math.cbrt(r.graphData.nodes.length)),r.needsRedraw=!0)}),r.tooltip=new ih(a),["pointermove","pointerdown"].forEach(function(h){return a.addEventListener(h,function(f){h==="pointerdown"&&(r.isPointerPressed=!0,r.pointerDownEvent=f),!r.isPointerDragging&&f.type==="pointermove"&&r.onBackgroundClick&&(f.pressure>0||r.isPointerPressed)&&(f.pointerType==="mouse"||f.movementX===void 0||[f.movementX,f.movementY].some(function(g){return Math.abs(g)>1}))&&(r.isPointerDragging=!0);var p=m(a);c.x=f.pageX-p.left,c.y=f.pageY-p.top;function m(g){var v=g.getBoundingClientRect(),b=window.pageXOffset||document.documentElement.scrollLeft,x=window.pageYOffset||document.documentElement.scrollTop;return{top:v.top+x,left:v.left+b}}},{passive:!0})}),a.addEventListener("pointerup",function(h){if(r.isPointerPressed){if(r.isPointerPressed=!1,r.isPointerDragging){r.isPointerDragging=!1;return}var f=[h,r.pointerDownEvent];requestAnimationFrame(function(){if(h.button===0)if(r.hoverObj){var p=r["on".concat(r.hoverObj.type,"Click")];p&&p.apply(void 0,[r.hoverObj.d].concat(f))}else r.onBackgroundClick&&r.onBackgroundClick.apply(r,f);if(h.button===2)if(r.hoverObj){var m=r["on".concat(r.hoverObj.type,"RightClick")];m&&m.apply(void 0,[r.hoverObj.d].concat(f))}else r.onBackgroundRightClick&&r.onBackgroundRightClick.apply(r,f)})}},{passive:!0}),a.addEventListener("contextmenu",function(h){return!r.onBackgroundRightClick&&!r.onNodeRightClick&&!r.onLinkRightClick?!0:(h.preventDefault(),!1)}),r.forceGraph(s),r.shadowGraph(o);var d=Hd(function(){Vi(o,r.width,r.height),r.shadowGraph.linkWidth(function(f){return J(r.linkWidth)(f)+r.linkHoverPrecision});var h=Ae(r.canvas);r.shadowGraph.globalScale(h.k).tickFrame()},Jp);r.flushShadowCanvas=d.flush,(this._animationCycle=function h(){var f=!r.autoPauseRedraw||!!r.needsRedraw||r.forceGraph.isEngineRunning()||r.graphData.links.some(function(C){return C.__photons&&C.__photons.length});if(r.needsRedraw=!1,r.enablePointerInteraction){var p=r.isPointerDragging?null:u();if(p!==r.hoverObj){var m=r.hoverObj,g=m?m.type:null,v=p?p.type:null;if(g&&g!==v){var b=r["on".concat(g,"Hover")];b&&b(null,m.d)}if(v){var x=r["on".concat(v,"Hover")];x&&x(p.d,g===v?m.d:null)}r.tooltip.content(p&&J(r["".concat(p.type.toLowerCase(),"Label")])(p.d)||null),r.canvas.classList[(p&&r["on".concat(v,"Click")]||!p&&r.onBackgroundClick)&&J(r.showPointerCursor)(p?.d)?"add":"remove"]("clickable"),r.hoverObj=p}f&&d()}if(f){Vi(s,r.width,r.height);var j=Ae(r.canvas).k;r.onRenderFramePre&&r.onRenderFramePre(s,j),r.forceGraph.globalScale(j).tickFrame(),r.onRenderFramePost&&r.onRenderFramePost(s,j)}r.tweenGroup.update(),r.animationFrameRequestId=requestAnimationFrame(h)})()},update:function(n){}}),Hn={exports:{}},Bn,Gi;function rm(){if(Gi)return Bn;Gi=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Bn=e,Bn}var Vn,Wi;function im(){if(Wi)return Vn;Wi=1;var e=rm();function n(){}function r(){}return r.resetWarningCache=n,Vn=function(){function i(o,c,u,d,h,f){if(f!==e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}i.isRequired=i;function a(){return i}var s={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:a,element:i,elementType:i,instanceOf:a,node:i,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:r,resetWarningCache:n};return s.PropTypes=s,s},Vn}var Ki;function am(){return Ki||(Ki=1,Hn.exports=im()()),Hn.exports}var sm=am();const A=Os(sm),Tn={width:A.number,height:A.number,graphData:A.shape({nodes:A.arrayOf(A.object).isRequired,links:A.arrayOf(A.object).isRequired}),backgroundColor:A.string,nodeRelSize:A.number,nodeId:A.string,nodeLabel:A.oneOfType([A.string,A.func]),nodeVal:A.oneOfType([A.number,A.string,A.func]),nodeVisibility:A.oneOfType([A.bool,A.string,A.func]),nodeColor:A.oneOfType([A.string,A.func]),nodeAutoColorBy:A.oneOfType([A.string,A.func]),onNodeHover:A.func,onNodeClick:A.func,linkSource:A.string,linkTarget:A.string,linkLabel:A.oneOfType([A.string,A.func]),linkVisibility:A.oneOfType([A.bool,A.string,A.func]),linkColor:A.oneOfType([A.string,A.func]),linkAutoColorBy:A.oneOfType([A.string,A.func]),linkWidth:A.oneOfType([A.number,A.string,A.func]),linkCurvature:A.oneOfType([A.number,A.string,A.func]),linkDirectionalArrowLength:A.oneOfType([A.number,A.string,A.func]),linkDirectionalArrowColor:A.oneOfType([A.string,A.func]),linkDirectionalArrowRelPos:A.oneOfType([A.number,A.string,A.func]),linkDirectionalParticles:A.oneOfType([A.number,A.string,A.func]),linkDirectionalParticleSpeed:A.oneOfType([A.number,A.string,A.func]),linkDirectionalParticleOffset:A.oneOfType([A.number,A.string,A.func]),linkDirectionalParticleWidth:A.oneOfType([A.number,A.string,A.func]),linkDirectionalParticleColor:A.oneOfType([A.string,A.func]),onLinkHover:A.func,onLinkClick:A.func,dagMode:A.oneOf(["td","bu","lr","rl","zin","zout","radialin","radialout"]),dagLevelDistance:A.number,dagNodeFilter:A.func,onDagError:A.func,d3AlphaMin:A.number,d3AlphaDecay:A.number,d3VelocityDecay:A.number,warmupTicks:A.number,cooldownTicks:A.number,cooldownTime:A.number,onEngineTick:A.func,onEngineStop:A.func,getGraphBbox:A.func},js={zoomToFit:A.func,onNodeRightClick:A.func,onNodeDrag:A.func,onNodeDragEnd:A.func,onLinkRightClick:A.func,linkHoverPrecision:A.number,onBackgroundClick:A.func,onBackgroundRightClick:A.func,showPointerCursor:A.oneOfType([A.bool,A.func]),enablePointerInteraction:A.bool,enableNodeDrag:A.bool},Ir={showNavInfo:A.bool,nodeOpacity:A.number,nodeResolution:A.number,nodeThreeObject:A.oneOfType([A.object,A.string,A.func]),nodeThreeObjectExtend:A.oneOfType([A.bool,A.string,A.func]),nodePositionUpdate:A.func,linkOpacity:A.number,linkResolution:A.number,linkCurveRotation:A.oneOfType([A.number,A.string,A.func]),linkMaterial:A.oneOfType([A.object,A.string,A.func]),linkThreeObject:A.oneOfType([A.object,A.string,A.func]),linkThreeObjectExtend:A.oneOfType([A.bool,A.string,A.func]),linkPositionUpdate:A.func,linkDirectionalArrowResolution:A.number,linkDirectionalParticleResolution:A.number,linkDirectionalParticleThreeObject:A.oneOfType([A.object,A.string,A.func]),forceEngine:A.oneOf(["d3","ngraph"]),ngraphPhysics:A.object,numDimensions:A.oneOf([1,2,3])},om=Object.assign({},Tn,js,{linkLineDash:A.oneOfType([A.arrayOf(A.number),A.string,A.func]),nodeCanvasObjectMode:A.oneOfType([A.string,A.func]),nodeCanvasObject:A.func,nodePointerAreaPaint:A.func,linkCanvasObjectMode:A.oneOfType([A.string,A.func]),linkCanvasObject:A.func,linkPointerAreaPaint:A.func,linkDirectionalParticleCanvasObject:A.func,autoPauseRedraw:A.bool,minZoom:A.number,maxZoom:A.number,enableZoomInteraction:A.oneOfType([A.bool,A.func]),enablePanInteraction:A.oneOfType([A.bool,A.func]),onZoom:A.func,onZoomEnd:A.func,onRenderFramePre:A.func,onRenderFramePost:A.func});Object.assign({},Tn,js,Ir,{enableNavigationControls:A.bool,controlType:A.oneOf(["trackball","orbit","fly"]),rendererConfig:A.object,extraRenderers:A.arrayOf(A.shape({render:A.func.isRequired}))});Object.assign({},Tn,Ir,{nodeDesc:A.oneOfType([A.string,A.func]),linkDesc:A.oneOfType([A.string,A.func])});Object.assign({},Tn,Ir,{markerAttrs:A.object,yOffset:A.number,glScale:A.number});const On=Io(nm,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","centerAt","zoom","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords"]});On.displayName="ForceGraph2D";On.propTypes=om;const ks={"":"#6366f1",School:"#22d3ee",Clinical:"#f472b6",Research:"#a78bfa",Personal:"#34d399"};function Yi(e){const n=e.split("/")[0];return ks[n]||"#6366f1"}function lm({onNodeClick:e}){const n=D.useRef(null),r=D.useRef(),[i,a]=D.useState({nodes:[],links:[]}),[s,o]=D.useState(!0),[c,u]=D.useState(null),[d,h]=D.useState(null),[f,p]=D.useState(null),[m,g]=D.useState(1),[v,b]=D.useState(new Set),[x,j]=D.useState(!1);D.useEffect(()=>{const k=n.current;if(!k)return;const O=()=>{const z=k.getBoundingClientRect();h({width:Math.max(1,Math.floor(z.width)-2),height:Math.max(1,Math.floor(z.height)-2)})};O();const P=new ResizeObserver(O);return P.observe(k),()=>P.disconnect()},[]),D.useEffect(()=>{let k=!1;return o(!0),V.obsidian.getGraph().then(O=>{k||(O.success?a({nodes:O.nodes,links:O.links}):u("Failed to load graph data"),o(!1))}).catch(()=>{k||(u("Network error loading graph"),o(!1))}),()=>{k=!0}},[]);const C=D.useMemo(()=>{const k=new Set;for(const O of i.nodes){const P=O.folder?.split("/")[0]||"(root)";k.add(P)}return Array.from(k).sort()},[i.nodes]);D.useEffect(()=>{C.length>0&&!x&&(j(!0),b(new Set(C)))},[C,x]);const w=D.useMemo(()=>{if(v.size===0||v.size===C.length)return i;const k=new Set,O=i.nodes.filter(z=>{const S=z.folder?.split("/")[0]||"(root)",R=v.has(S);return R&&k.add(z.id),R}),P=i.links.filter(z=>{const S=typeof z.source=="string"?z.source:z.source.id,R=typeof z.target=="string"?z.target:z.target.id;return k.has(S)&&k.has(R)});return{nodes:O,links:P}},[i,v,C.length]),_=k=>{b(O=>{const P=new Set(O);return P.has(k)?P.delete(k):P.add(k),P})},M=D.useCallback(k=>{e?.(k.name)},[e]),E=D.useCallback(k=>{const O=Math.max(.1,Math.min(10,k));g(O);const P=r.current;P?.zoom&&P.zoom(O,200)},[]),y=D.useCallback((k,O,P)=>{const z=k.name,S=Math.max(10/P,2),R=Math.max(4,3+w.links.filter($=>(typeof $.source=="string"?$.source:$.source.id)===k.id||(typeof $.target=="string"?$.target:$.target.id)===k.id).length*.5),N=Yi(k.folder),I=f?.id===k.id;O.beginPath(),O.arc(k.x||0,k.y||0,R,0,2*Math.PI),O.fillStyle=I?"#ffffff":N,O.fill(),(I||P>1.5)&&(O.font=`${S}px monospace`,O.textAlign="center",O.textBaseline="top",O.fillStyle="rgba(255,255,255,0.9)",O.fillText(z,k.x||0,(k.y||0)+R+2))},[w.links,f]),T=!s&&!c&&d;return l.jsxs("div",{className:"flex h-full",children:[l.jsx("div",{className:"w-[180px] shrink-0 border-r border-secondary/30 bg-black/60",children:l.jsx(Ye,{className:"h-full",children:l.jsxs("div",{className:"p-3 space-y-3",children:[l.jsx("div",{className:"font-arcade text-[10px] text-primary mb-2",children:"FOLDERS"}),l.jsxs("label",{className:"flex items-center gap-2 py-1 cursor-pointer",children:[l.jsx(ye,{checked:v.size===C.length,onCheckedChange:k=>{b(k?new Set(C):new Set)},className:"border-primary data-[state=checked]:bg-primary"}),l.jsx("span",{className:"font-terminal text-xs text-primary",children:"All Folders"})]}),C.map(k=>l.jsxs("label",{className:"flex items-center gap-2 py-0.5 cursor-pointer",children:[l.jsx(ye,{checked:v.has(k),onCheckedChange:()=>_(k),className:"border-primary data-[state=checked]:bg-primary"}),l.jsx("span",{className:"font-terminal text-xs truncate",style:{color:Yi(k==="(root)"?"":k)},children:k})]},k)),l.jsxs("div",{className:"pt-2 border-t border-secondary/30 space-y-1",children:[l.jsx("div",{className:"font-arcade text-[10px] text-muted-foreground mb-1",children:"COLORS"}),Object.entries(ks).filter(([k])=>k).map(([k,O])=>l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-2.5 h-2.5 rounded-full",style:{backgroundColor:O}}),l.jsx("span",{className:"font-terminal text-[10px]",style:{color:O},children:k})]},k))]}),l.jsxs("div",{className:"pt-2 border-t border-secondary/30 font-terminal text-[10px] text-muted-foreground",children:[l.jsxs("div",{children:["Notes: ",w.nodes.length]}),l.jsxs("div",{children:["Links: ",w.links.length]})]})]})})}),l.jsxs("div",{ref:n,className:"flex-1 relative bg-black/80 rounded border border-primary/30 overflow-hidden",children:[s&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-primary font-terminal z-10",children:l.jsx("div",{className:"animate-pulse",children:"SCANNING VAULT CONNECTIONS..."})}),c&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-red-400 font-terminal z-10",children:c}),T&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"absolute top-2 left-2 right-2 z-10 flex items-center justify-between pointer-events-none",children:[l.jsx("div",{className:"flex items-center gap-2 pointer-events-auto",children:l.jsx("button",{onClick:()=>{r.current?.zoomToFit?.(400,40),setTimeout(()=>{const k=r.current;k?.zoom&&g(k.zoom())},450)},className:"px-2 py-0.5 text-xs font-terminal bg-primary/20 border border-primary/40 text-primary hover:bg-primary/30 rounded-none",children:"CENTER"})}),l.jsxs("div",{className:"flex items-center gap-1.5 pointer-events-auto bg-black/70 border border-primary/30 rounded-none px-2 py-1",children:[l.jsx("button",{onClick:()=>E(m/1.3),className:"text-primary hover:text-white font-mono text-sm w-5 h-5 flex items-center justify-center",children:"-"}),l.jsx("input",{type:"range",min:-2.3,max:2.3,step:.01,value:Math.log(m),onChange:k=>E(Math.exp(parseFloat(k.target.value))),className:"w-24 h-1 accent-primary cursor-pointer"}),l.jsx("button",{onClick:()=>E(m*1.3),className:"text-primary hover:text-white font-mono text-sm w-5 h-5 flex items-center justify-center",children:"+"}),l.jsxs("span",{className:"text-[10px] font-terminal text-primary/50 w-8 text-right",children:[Math.round(m*100),"%"]})]})]}),l.jsx(On,{ref:r,graphData:w,width:d.width,height:d.height,nodeCanvasObject:y,nodePointerAreaPaint:(k,O,P)=>{P.beginPath(),P.arc(k.x||0,k.y||0,6,0,2*Math.PI),P.fillStyle=O,P.fill()},onNodeClick:M,onNodeHover:k=>p(k),onZoom:({k})=>g(k),linkColor:()=>"rgba(99, 102, 241, 0.15)",linkWidth:.5,backgroundColor:"transparent",cooldownTicks:100,d3AlphaDecay:.02,d3VelocityDecay:.3})]})]})]})}const cm={course:"#22d3ee",module:"#facc15",lo:"#4ade80"},um={course:"rgba(34,211,238,0.15)",module:"rgba(250,204,21,0.12)",lo:"rgba(74,222,128,0.08)"};function dm(){const e=D.useRef(null),n=D.useRef(null),r=D.useRef(!1),[i,a]=D.useState(null),[s,o]=D.useState(new Set),[c,u]=D.useState(new Set),[d,h]=D.useState(!0),[f,p]=D.useState(null),{data:m=[]}=X({queryKey:["courses"],queryFn:()=>V.courses.getActive()}),g=m.map(y=>y.id).sort(),{data:v=[]}=X({queryKey:["modules","all",g],queryFn:async()=>(await Promise.all(m.map(T=>V.modules.getByCourse(T.id)))).flat(),enabled:m.length>0}),{data:b=[]}=X({queryKey:["learningObjectives","all",g,d],queryFn:async()=>(await Promise.all(m.map(T=>V.learningObjectives.getByCourse(T.id)))).flat(),enabled:m.length>0&&d});D.useEffect(()=>{const y=e.current;if(!y)return;const T=()=>{const O=y.getBoundingClientRect();a({width:Math.max(1,Math.floor(O.width)-2),height:Math.max(1,Math.floor(O.height)-2)})};T();const k=new ResizeObserver(T);return k.observe(y),()=>k.disconnect()},[]),D.useEffect(()=>{m.length>0&&!r.current&&(r.current=!0,o(new Set(m.map(y=>y.id))))},[m]);const x=D.useMemo(()=>{const y=[],T=[],k=new Map;for(const P of v){const z=k.get(P.courseId)??[];z.push(P),k.set(P.courseId,z)}const O=new Map;for(const P of b){const z=O.get(P.moduleId)??[];z.push(P),O.set(P.moduleId,z)}for(const P of m){if(!s.has(P.id))continue;const z=`course-${P.id}`;y.push({id:z,name:P.name,type:"course"});const S=k.get(P.id)??[];for(const R of S){if(c.size>0&&!c.has(R.id))continue;const N=`module-${R.id}`;if(y.push({id:N,name:R.name,type:"module"}),T.push({source:z,target:N}),d){const I=O.get(R.id)??[];for(const $ of I){const L=`lo-${$.id}`;y.push({id:L,name:`${$.loCode}: ${$.title}`,type:"lo"}),T.push({source:N,target:L})}}}}return{nodes:y,links:T}},[m,v,b,s,c,d]),j=y=>{o(T=>{const k=new Set(T);return k.has(y)?k.delete(y):k.add(y),k})},C=y=>{u(T=>{const k=new Set(T);return k.has(y)?k.delete(y):k.add(y),k})},w=D.useCallback((y,T,k)=>{const O=cm[y.type]||"#6366f1",P=um[y.type]||"rgba(99,102,241,0.1)",z=f===y.id,S=y.x||0,R=y.y||0,N=y.type==="course"?14:y.type==="module"?11:9,I=Math.max(N/k,2);T.font=`${y.type==="course"?"bold ":""}${I}px monospace`;const $=y.type==="lo"?50:35,L=y.name.length>$?y.name.slice(0,$)+"...":y.name,B=T.measureText(L).width,G=8/k,W=5/k,F=B+G*2,U=I+W*2,K=4/k;T.beginPath(),T.roundRect(S-F/2,R-U/2,F,U,K),T.fillStyle=z?O:P,T.fill(),T.strokeStyle=z?"#ffffff":O,T.lineWidth=(y.type==="course"?2:1)/k,T.stroke(),T.textAlign="center",T.textBaseline="middle",T.fillStyle=z?"#000000":O,T.fillText(L,S,R)},[f]),_=D.useCallback((y,T,k,O)=>{const P=y.x||0,z=y.y||0,R=(y.type==="course"?60:y.type==="module"?45:30)/O;k.fillStyle=T,k.fillRect(P-R/2,z-R/2,R,R)},[]),M=D.useCallback((y,T,k)=>{const O=y.source,P=y.target;if(!O||!P)return;const z=O.x||0,S=O.y||0,R=P.x||0,N=P.y||0,I=(z+R)/2,$=(S+N)/2,L=R-z,B=N-S,G=I-B*.15,W=$+L*.15;T.beginPath(),T.moveTo(z,S),T.quadraticCurveTo(G,W,R,N),T.strokeStyle="rgba(148, 163, 184, 0.25)",T.lineWidth=Math.max(1.5/k,.3),T.stroke()},[]),E=v.filter(y=>s.has(y.courseId));return l.jsxs("div",{className:"flex h-full",children:[l.jsx("div",{className:"w-[220px] shrink-0 border-r border-secondary/30 bg-black/60",children:l.jsx(Ye,{className:"h-full",children:l.jsxs("div",{className:"p-3 space-y-4",children:[l.jsxs("div",{children:[l.jsx("div",{className:"font-arcade text-[10px] text-primary mb-2",children:"COURSES"}),m.map(y=>l.jsxs("label",{className:"flex items-center gap-2 py-1 cursor-pointer",children:[l.jsx(ye,{checked:s.has(y.id),onCheckedChange:()=>j(y.id),className:"border-cyan-500 data-[state=checked]:bg-cyan-500"}),l.jsx("span",{className:"font-terminal text-xs text-cyan-300",children:y.name})]},y.id))]}),E.length>0&&l.jsxs("div",{children:[l.jsx("div",{className:"font-arcade text-[10px] text-yellow-400 mb-2",children:"MODULES"}),l.jsxs("label",{className:"flex items-center gap-2 py-1 cursor-pointer mb-1",children:[l.jsx(ye,{checked:c.size===0,onCheckedChange:()=>u(new Set),className:"border-yellow-500 data-[state=checked]:bg-yellow-500"}),l.jsx("span",{className:"font-terminal text-xs text-yellow-200",children:"All Modules"})]}),E.map(y=>l.jsxs("label",{className:"flex items-center gap-2 py-0.5 cursor-pointer",children:[l.jsx(ye,{checked:c.size===0||c.has(y.id),onCheckedChange:()=>C(y.id),className:"border-yellow-500 data-[state=checked]:bg-yellow-500"}),l.jsx("span",{className:"font-terminal text-[10px] text-yellow-100 truncate",children:y.name})]},y.id))]}),l.jsx("div",{children:l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx(ye,{checked:d,onCheckedChange:y=>h(!!y),className:"border-green-500 data-[state=checked]:bg-green-500"}),l.jsx("span",{className:"font-terminal text-xs text-green-300",children:"Show Learning Objectives"})]})}),l.jsxs("div",{className:"pt-2 border-t border-secondary/30 space-y-1",children:[l.jsx("div",{className:"font-arcade text-[10px] text-muted-foreground mb-1",children:"LEGEND"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-sm border-2 border-cyan-400 bg-cyan-400/15"}),l.jsx("span",{className:"font-terminal text-[10px] text-cyan-300",children:"Course"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-sm border border-yellow-400 bg-yellow-400/12"}),l.jsx("span",{className:"font-terminal text-[10px] text-yellow-300",children:"Module"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-sm border border-green-400 bg-green-400/8"}),l.jsx("span",{className:"font-terminal text-[10px] text-green-300",children:"Learning Objective"})]})]}),l.jsxs("div",{className:"pt-2 border-t border-secondary/30 font-terminal text-[10px] text-muted-foreground",children:[l.jsxs("div",{children:["Nodes: ",x.nodes.length]}),l.jsxs("div",{children:["Links: ",x.links.length]})]})]})})}),l.jsxs("div",{ref:e,className:"flex-1 relative bg-black/80 overflow-hidden",children:[i&&x.nodes.length>0&&l.jsx(On,{ref:n,graphData:x,width:i.width,height:i.height,dagMode:"lr",dagLevelDistance:120,nodeCanvasObject:w,nodePointerAreaPaint:_,linkCanvasObject:M,onNodeHover:y=>p(y?.id??null),linkColor:()=>"transparent",linkWidth:0,backgroundColor:"transparent",cooldownTicks:100,d3AlphaDecay:.025,d3VelocityDecay:.35}),x.nodes.length===0&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center font-terminal text-xs text-muted-foreground",children:"Select courses to build mind map"})]})]})}const fm=/(\[\[.*?\]\])/g,hm=/!\[\[(.*?)\]\]/g,pm=[".png",".jpg",".jpeg",".gif",".svg",".webp",".bmp"],mm=/^\[!([\w-]+)\]\s*(.*)?$/,Ji={note:"border-blue-500/50 bg-blue-500/10",tip:"border-green-500/50 bg-green-500/10",important:"border-purple-500/50 bg-purple-500/10",warning:"border-yellow-500/50 bg-yellow-500/10",caution:"border-red-500/50 bg-red-500/10",info:"border-blue-400/50 bg-blue-400/10",abstract:"border-cyan-500/50 bg-cyan-500/10",summary:"border-cyan-500/50 bg-cyan-500/10",todo:"border-blue-500/50 bg-blue-500/10",success:"border-green-500/50 bg-green-500/10",question:"border-yellow-400/50 bg-yellow-400/10",example:"border-purple-400/50 bg-purple-400/10",quote:"border-gray-400/50 bg-gray-400/10",bug:"border-red-400/50 bg-red-400/10",danger:"border-red-500/50 bg-red-500/10",fail:"border-red-500/50 bg-red-500/10",failure:"border-red-500/50 bg-red-500/10"};function Gn(e,n){return e.split(fm).map((r,i)=>{const a=r.match(/^\[\[(.*?)\]\]$/);if(a){const s=a[1].includes("|")?a[1].split("|")[1]:a[1],o=a[1].includes("|")?a[1].split("|")[0]:a[1];return l.jsx("span",{className:"text-blue-400 hover:text-blue-300 cursor-pointer underline decoration-dotted",onClick:c=>n?.(o,c.shiftKey),title:`${o} (Shift+click for Obsidian app)`,children:s},i)}return l.jsx("span",{children:r},i)})}function gm(e){return e.replace(hm,(n,r)=>{const i=r.toLowerCase();return pm.some(s=>i.endsWith(s))?`![${r}](/api/obsidian/vault-file/${encodeURIComponent(r)})`:`[[${r}]]`})}function xm(e){const n=e.split(`
`),r=[];let i=!1,a="",s="",o=[];const c=()=>{if(!i)return;const u=Ji[a.toLowerCase()]||Ji.note,d=s||a.charAt(0).toUpperCase()+a.slice(1);r.push(`<div class="callout ${u} border-l-4 rounded px-3 py-2 my-2">`),r.push(`<div class="font-bold text-xs uppercase tracking-wider mb-1">${d}</div>`),r.push(""),r.push(o.join(`
`)),r.push(""),r.push("</div>"),i=!1,o=[]};for(const u of n){if(u.startsWith("> ")){const d=u.slice(2),h=d.match(mm);if(h&&!i){i=!0,a=h[1],s=h[2]||"";continue}if(i){o.push(d);continue}}else if(u===">"&&i){o.push("");continue}else c();r.push(u)}return c(),r.join(`
`)}function ym({content:e,onWikilinkClick:n}){const r=xm(gm(e)),i={h1:({children:a})=>l.jsx("h1",{className:"text-xl font-bold text-primary border-b border-primary/30 pb-1 mb-3 mt-4",children:a}),h2:({children:a})=>l.jsx("h2",{className:"text-lg font-bold text-primary/90 border-b border-primary/20 pb-1 mb-2 mt-3",children:a}),h3:({children:a})=>l.jsx("h3",{className:"text-base font-semibold text-primary/80 mb-2 mt-3",children:a}),h4:({children:a})=>l.jsx("h4",{className:"text-sm font-semibold text-primary/70 mb-1 mt-2",children:a}),p:({children:a})=>typeof a=="string"?l.jsx("p",{className:"mb-2 leading-relaxed",children:Gn(a,n)}):l.jsx("p",{className:"mb-2 leading-relaxed",children:a}),strong:({children:a})=>l.jsx("strong",{className:"font-bold text-foreground",children:a}),em:({children:a})=>l.jsx("em",{className:"italic text-foreground/90",children:a}),ul:({children:a})=>l.jsx("ul",{className:"list-disc list-inside mb-2 space-y-0.5 ml-2",children:a}),ol:({children:a})=>l.jsx("ol",{className:"list-decimal list-inside mb-2 space-y-0.5 ml-2",children:a}),li:({children:a})=>typeof a=="string"?l.jsx("li",{className:"leading-relaxed",children:Gn(a,n)}):l.jsx("li",{className:"leading-relaxed",children:a}),blockquote:({children:a})=>l.jsx("blockquote",{className:"border-l-4 border-primary/30 pl-3 my-2 text-muted-foreground italic",children:a}),code:({children:a,className:s})=>s?.startsWith("language-")?l.jsx("code",{className:"block bg-black/80 border border-secondary/40 rounded p-3 my-2 text-xs font-mono overflow-x-auto whitespace-pre",children:a}):l.jsx("code",{className:"bg-secondary/40 px-1.5 py-0.5 rounded text-xs font-mono text-primary",children:a}),pre:({children:a})=>l.jsx("pre",{className:"my-2",children:a}),hr:()=>l.jsx("hr",{className:"border-primary/20 my-4"}),a:({href:a,children:s})=>l.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:s}),table:({children:a})=>l.jsx("div",{className:"overflow-x-auto my-2",children:l.jsx("table",{className:"w-full text-xs border-collapse border border-secondary/40",children:a})}),th:({children:a})=>l.jsx("th",{className:"border border-secondary/40 bg-secondary/20 px-2 py-1 text-left font-semibold",children:a}),td:({children:a})=>typeof a=="string"?l.jsx("td",{className:"border border-secondary/40 px-2 py-1",children:Gn(a,n)}):l.jsx("td",{className:"border border-secondary/40 px-2 py-1",children:a}),img:({src:a,alt:s})=>l.jsx("img",{src:a,alt:s||"",className:"max-w-full rounded border border-secondary/40 my-2",loading:"lazy"}),del:({children:a})=>l.jsx("del",{className:"line-through text-muted-foreground",children:a}),input:({checked:a,...s})=>l.jsx("input",{type:"checkbox",checked:a,readOnly:!0,className:"mr-1.5 accent-primary",...s})};return l.jsx("div",{className:"obsidian-preview prose-invert max-w-none text-sm leading-relaxed",children:l.jsx(Hs,{remarkPlugins:[Bs],components:i,allowedElements:void 0,unwrapDisallowed:!1,children:r})})}const Xi=[{name:"EBP",path:"School/Evidence Based Practice"},{name:"ExPhys",path:"School/Exercise Physiology"},{name:"MS1",path:"School/Movement Science 1"},{name:"Neuro",path:"School/Neuroscience"},{name:"TI",path:"School/Theraputic Intervention"}];function bm({onWikilinkClick:e}){const[n,r]=D.useState("School"),[i,a]=D.useState(null),[s,o]=D.useState(""),[c,u]=D.useState(!1),[d,h]=D.useState(!1),[f,p]=D.useState(!1),[m,g]=D.useState(!1),{data:v}=X({queryKey:["obsidian","status"],queryFn:V.obsidian.getStatus,refetchInterval:3e4}),{data:b}=X({queryKey:["obsidian","config"],queryFn:V.obsidian.getConfig}),{data:x}=X({queryKey:["obsidian","vault-index"],queryFn:()=>V.obsidian.getVaultIndex(),enabled:v?.connected===!0}),{data:j}=X({queryKey:["obsidian","files",n],queryFn:()=>V.obsidian.getFiles(n),enabled:v?.connected===!0}),C=async y=>{try{const T=await V.obsidian.getFile(y);T.success&&T.content!==void 0&&(a(y),o(T.content),h(!1))}catch(T){console.error("Failed to load file:",T)}},w=async()=>{if(i){u(!0);try{(await V.obsidian.saveFile(i,s)).success&&h(!1)}catch(y){console.error("Failed to save file:",y)}finally{u(!1)}}},_=y=>{r(y),a(null),o("")},M=()=>{const y=new Date().toISOString().split("T")[0],T=n?`${n}/Session-${y}.md`:`Session-${y}.md`,k=`# Study Session - ${y}

## Summary


## Concepts Covered
- 

## Strengths
- 

## Areas to Review
- 

## Notes

`;a(T),o(k),h(!0)},E=async(y,T)=>{if(T){const O=b?.vaultName||"PT School Semester 2";window.open(`obsidian://open?vault=${encodeURIComponent(O)}&file=${encodeURIComponent(y)}`,"_blank");return}const k=x?.paths?.[y];if(k){await C(k),p(!0);return}for(const O of Xi)try{await C(`${O.path}/${y}.md`),p(!0);return}catch{}console.warn(`Note not found: ${y}`),e?.(y,T)};return l.jsxs(ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsxs(ae,{className:"border-b border-primary/50 p-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs(oe,{className:"font-arcade text-sm flex items-center gap-3",children:[l.jsx(Vs,{className:"w-4 h-4"}),"OBSIDIAN VAULT",v?.connected?l.jsx(nn,{className:"w-3 h-3 text-green-500"}):l.jsx(It,{className:"w-3 h-3 text-red-500"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs(ne,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:M,disabled:!v?.connected,children:[l.jsx(Gs,{className:"w-3 h-3 mr-1"}),"New Note"]}),l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:m,onChange:y=>g(y.target.checked),disabled:!v?.connected,className:"w-4 h-4 accent-primary"}),l.jsx("span",{className:"font-terminal text-xs",children:"Auto-Sync"})]})]})]}),l.jsx("div",{className:"flex items-center gap-1 mt-2 flex-wrap",children:Xi.map(y=>l.jsx(ne,{size:"sm",variant:n===y.path?"default":"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:()=>_(y.path),children:y.name},y.path))}),n&&l.jsxs("div",{className:"flex items-center gap-1 mt-2 font-terminal text-xs text-muted-foreground",children:[l.jsx("button",{onClick:()=>_(""),className:"hover:text-primary",children:"vault"}),n.split("/").map((y,T,k)=>l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(Es,{className:"w-3 h-3"}),l.jsx("button",{onClick:()=>_(k.slice(0,T+1).join("/")),className:"hover:text-primary",children:y})]},T))]})]}),l.jsx(te,{className:"p-0",children:v?.connected?l.jsxs("div",{className:"grid md:grid-cols-[200px_1fr] h-[400px] md:h-[500px]",children:[l.jsx("div",{className:"border-r border-secondary/30",children:l.jsx(Ye,{className:"h-[400px] md:h-[500px]",children:l.jsxs("div",{className:"p-2 space-y-1",children:[n&&l.jsxs("button",{onClick:()=>{const y=n.split("/");y.pop(),_(y.join("/"))},className:"w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs text-muted-foreground",children:[l.jsx(zr,{className:"w-3 h-3"}),".."]}),j?.files?.map(y=>{const T=typeof y=="string"?y:y.path,k=T.endsWith("/"),O=T.replace(/\/$/,"").split("/").pop()||T;return l.jsxs("button",{onClick:()=>{if(k){const P=O.replace(/\/$/,"");_(n?`${n}/${P}`:P)}else{const P=n?`${n}/${O}`:O;C(P)}},className:`w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs ${i?.endsWith(O)?"bg-primary/20 text-primary":""}`,children:[k?l.jsx(zr,{className:"w-3 h-3 text-yellow-500"}):l.jsx(no,{className:"w-3 h-3 text-blue-400"}),O]},T)})]})})}),l.jsx("div",{className:"flex flex-col h-[400px] md:h-[500px]",children:i?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-secondary/30",children:[l.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[l.jsxs("span",{className:"font-terminal text-xs text-primary truncate",children:[i.split("/").pop(),d&&l.jsx("span",{className:"text-yellow-500 ml-1",children:"*"})]}),l.jsx("button",{onClick:()=>{const y=b?.vaultName||"PT School Semester 2",T=i.replace(/\.md$/,"");window.open(`obsidian://open?vault=${encodeURIComponent(y)}&file=${encodeURIComponent(T)}`,"_blank")},className:"text-muted-foreground hover:text-primary shrink-0",title:"Open in Obsidian app",children:l.jsx(Fs,{className:"w-3 h-3"})})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(ne,{size:"sm",variant:"ghost",className:"h-6 px-2 text-[10px]",onClick:()=>p(!f),children:f?"Edit":"Preview"}),l.jsxs(ne,{size:"sm",variant:"ghost",onClick:w,disabled:!d||c,className:"h-6 px-2",children:[l.jsx(gr,{className:"w-3 h-3 mr-1"}),c?"Saving...":"Save"]})]})]}),f?l.jsx("div",{className:"flex-1 w-full p-3 bg-black/60 font-terminal overflow-y-auto",children:l.jsx(ym,{content:s,onWikilinkClick:E})}):l.jsx("textarea",{value:s,onChange:y=>{o(y.target.value),h(!0)},className:"flex-1 w-full p-3 bg-black/60 font-terminal text-sm resize-none focus:outline-none focus:ring-1 focus:ring-primary overflow-y-auto",placeholder:"File content..."})]}):l.jsx("div",{className:"flex-1 flex items-center justify-center font-terminal text-xs text-muted-foreground",children:"Select a file to edit"})})]}):l.jsxs("div",{className:"p-8 text-center",children:[l.jsx("p",{className:"font-terminal text-xs text-red-400 mb-2",children:"Obsidian Offline"}),l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Obsidian with Local REST API plugin enabled"})]})})]})}function vm({totalCards:e}){const[n,r]=D.useState(new Set),[i,a]=D.useState(null),[s,o]=D.useState({front:"",back:"",deckName:""}),c=ht(),{data:u,isLoading:d,refetch:h}=X({queryKey:["anki","status"],queryFn:V.anki.getStatus,refetchInterval:3e4}),{data:f}=X({queryKey:["anki","due"],queryFn:V.anki.getDue,enabled:u?.connected===!0}),{data:p=[],refetch:m}=X({queryKey:["anki","drafts"],queryFn:V.anki.getDrafts}),g=p.filter(_=>_.status==="pending"),v=de({mutationFn:V.anki.sync,onSuccess:()=>{c.invalidateQueries({queryKey:["anki"]}),m()}}),b=de({mutationFn:_=>V.anki.approveDraft(_),onSuccess:()=>m()}),x=de({mutationFn:_=>V.anki.deleteDraft(_),onSuccess:()=>m()}),j=de({mutationFn:({id:_,data:M})=>V.anki.updateDraft(_,M),onSuccess:()=>{m(),a(null)}}),C=_=>{a(_.id),o({front:_.front,back:_.back,deckName:_.deckName})},w=()=>{i!==null&&j.mutate({id:i,data:s})};return l.jsxs(l.Fragment,{children:[l.jsxs(ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ae,{className:"border-b border-primary/50 p-4",children:l.jsxs(oe,{className:"font-arcade text-sm flex items-center gap-3",children:[l.jsx(Rt,{className:"w-4 h-4"}),"ANKI INTEGRATION",u?.connected?l.jsx(nn,{className:"w-3 h-3 text-green-500 ml-auto"}):l.jsx(It,{className:"w-3 h-3 text-red-500 ml-auto"})]})}),l.jsx(te,{className:"p-4 space-y-3",children:d?l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Checking Anki..."}):u?.connected?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex flex-wrap items-center gap-4 font-terminal text-xs",children:[l.jsx(un,{variant:"outline",className:"bg-green-500/20 text-green-400 border-green-500",children:"Connected"}),l.jsxs("span",{className:"text-muted-foreground",children:["Cards: ",l.jsx("span",{className:"text-primary font-arcade",children:e})]}),l.jsxs("span",{className:"text-muted-foreground",children:["Due: ",l.jsx("span",{className:"text-secondary font-arcade",children:f?.dueCount||0})]}),l.jsxs("span",{className:"text-muted-foreground",children:["Reviewed: ",l.jsx("span",{className:"font-arcade",children:u.reviewedToday||0})]}),l.jsxs("span",{className:"text-muted-foreground",children:["Decks: ",l.jsx("span",{className:"font-arcade",children:u.decks?.length||0})]})]}),l.jsxs("div",{className:"pt-2 flex gap-2",children:[l.jsxs(ne,{size:"sm",variant:"outline",className:"flex-1 font-terminal text-xs",onClick:()=>h(),children:[l.jsx(Rr,{className:"w-3 h-3 mr-1"}),"Refresh"]}),l.jsx(ne,{size:"sm",className:"flex-1 font-terminal text-xs bg-secondary hover:bg-secondary/80",onClick:()=>v.mutate(),disabled:v.isPending,children:v.isPending?"Syncing...":"Sync Cards"})]}),g.length>0&&l.jsxs("div",{className:"pt-3 border-t border-secondary/30",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsxs("span",{className:"font-arcade text-[10px] text-yellow-400",children:["PENDING CARDS (",g.length,")"]}),l.jsx("div",{className:"flex gap-1",children:l.jsx(ne,{size:"sm",variant:"outline",className:"h-5 px-2 text-[10px] font-terminal",onClick:()=>{n.size===g.length?r(new Set):r(new Set(g.map(_=>_.id)))},children:n.size===g.length?"None":"All"})})]}),n.size>0&&l.jsxs("div",{className:"flex gap-1 mb-2",children:[l.jsxs(ne,{size:"sm",className:"h-6 px-2 text-[10px] font-terminal bg-green-600 hover:bg-green-700",onClick:()=>{n.forEach(_=>b.mutate(_)),r(new Set)},children:[l.jsx(nn,{className:"w-3 h-3 mr-1"}),"Approve (",n.size,")"]}),l.jsxs(ne,{size:"sm",variant:"destructive",className:"h-6 px-2 text-[10px] font-terminal",onClick:()=>{n.forEach(_=>x.mutate(_)),r(new Set)},children:[l.jsx(st,{className:"w-3 h-3 mr-1"}),"Delete (",n.size,")"]})]}),l.jsx(Ye,{className:"h-[140px]",children:l.jsx("div",{className:"space-y-2",children:g.map(_=>l.jsx("div",{className:`p-2 bg-black/40 border text-xs ${n.has(_.id)?"border-primary":"border-secondary/30"}`,children:l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx(ye,{checked:n.has(_.id),onCheckedChange:M=>{const E=new Set(n);M?E.add(_.id):E.delete(_.id),r(E)},className:"mt-1 border-secondary data-[state=checked]:bg-primary"}),l.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[l.jsx("div",{className:"font-terminal text-primary truncate",children:_.front}),l.jsx("div",{className:"font-terminal text-muted-foreground mt-1 truncate",children:_.back}),l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx(un,{variant:"outline",className:"text-[9px] border-blue-500/50 text-blue-400 shrink-0",children:_.deckName}),l.jsx(ne,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-yellow-500/50 text-yellow-400 hover:bg-yellow-500/20",onClick:()=>C(_),title:"Edit card",children:l.jsx(cn,{className:"w-3 h-3"})}),l.jsx(ne,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-green-500/50 text-green-400 hover:bg-green-500/20",onClick:()=>b.mutate(_.id),title:"Approve card",children:l.jsx(nn,{className:"w-3 h-3"})}),l.jsx(ne,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-red-500/50 text-red-400 hover:bg-red-500/20",onClick:()=>x.mutate(_.id),title:"Delete card",children:l.jsx(st,{className:"w-3 h-3"})})]})]})]})},_.id))})})]})]}):l.jsxs("div",{className:"text-center space-y-2",children:[l.jsx("p",{className:"font-terminal text-xs text-red-400",children:u?.error||"Anki not connected"}),l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Anki with AnkiConnect plugin"}),l.jsxs(ne,{size:"sm",variant:"outline",className:"font-terminal text-xs",onClick:()=>h(),children:[l.jsx(Rr,{className:"w-3 h-3 mr-1"}),"Retry"]})]})})]}),l.jsx(ea,{open:i!==null,onOpenChange:_=>{_||a(null)},children:l.jsxs(ta,{"data-modal":"brain-edit-draft",className:"bg-black border-2 border-primary rounded-none max-w-lg translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[l.jsxs(na,{children:[l.jsxs(ra,{className:"font-arcade text-primary flex items-center gap-2",children:[l.jsx(cn,{className:"w-5 h-5"}),"EDIT CARD"]}),l.jsx(ia,{className:"font-terminal text-muted-foreground",children:"Edit card content and select target deck"})]}),l.jsxs("div",{className:"space-y-4 font-terminal",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Front (Question)"}),l.jsx(Qe,{value:s.front,onChange:_=>o(M=>({...M,front:_.target.value})),placeholder:"Card front...",className:"rounded-none border-secondary min-h-[80px]"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Back (Answer)"}),l.jsx(Qe,{value:s.back,onChange:_=>o(M=>({...M,back:_.target.value})),placeholder:"Card back...",className:"rounded-none border-secondary min-h-[80px]"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Target Deck"}),l.jsxs(Ct,{value:s.deckName,onValueChange:_=>o(M=>({...M,deckName:_})),children:[l.jsx(At,{className:"rounded-none border-secondary",children:l.jsx(Tt,{placeholder:"Select deck"})}),l.jsxs(Ot,{className:"rounded-none border-secondary bg-black max-h-[200px]",children:[l.jsx(le,{value:"PT::EBP",children:"PT::EBP (Evidence Based Practice)"}),l.jsx(le,{value:"PT::ExPhys",children:"PT::ExPhys (Exercise Physiology)"}),l.jsx(le,{value:"PT::MS1",children:"PT::MS1 (Movement Science 1)"}),l.jsx(le,{value:"PT::Neuro",children:"PT::Neuro (Neuroscience)"}),l.jsx(le,{value:"PT::TI",children:"PT::TI (Therapeutic Intervention)"}),l.jsx(le,{value:"PT::General",children:"PT::General"}),u?.decks?.filter(_=>!_.startsWith("PT::")).map(_=>l.jsx(le,{value:_,children:_},_))]})]}),l.jsxs("p",{className:"text-[10px] text-muted-foreground mt-1",children:["Current: ",l.jsx("span",{className:"text-blue-400",children:s.deckName})]})]})]}),l.jsxs(aa,{className:"gap-2",children:[l.jsxs(ne,{variant:"outline",onClick:()=>a(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[l.jsx(It,{className:"w-4 h-4 mr-2"}),"Cancel"]}),l.jsxs(ne,{onClick:w,disabled:j.isPending,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[l.jsx(gr,{className:"w-4 h-4 mr-2"}),j.isPending?"Saving...":"Save"]})]})]})})]})}const Ss=D.forwardRef(({className:e,...n},r)=>l.jsx("div",{className:"relative w-full overflow-auto",children:l.jsx("table",{ref:r,className:Je("w-full caption-bottom text-sm",e),...n})}));Ss.displayName="Table";const Cs=D.forwardRef(({className:e,...n},r)=>l.jsx("thead",{ref:r,className:Je("[&_tr]:border-b",e),...n}));Cs.displayName="TableHeader";const As=D.forwardRef(({className:e,...n},r)=>l.jsx("tbody",{ref:r,className:Je("[&_tr:last-child]:border-0",e),...n}));As.displayName="TableBody";const _m=D.forwardRef(({className:e,...n},r)=>l.jsx("tfoot",{ref:r,className:Je("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...n}));_m.displayName="TableFooter";const mr=D.forwardRef(({className:e,...n},r)=>l.jsx("tr",{ref:r,className:Je("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...n}));mr.displayName="TableRow";const Fe=D.forwardRef(({className:e,...n},r)=>l.jsx("th",{ref:r,className:Je("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...n}));Fe.displayName="TableHead";const Le=D.forwardRef(({className:e,...n},r)=>l.jsx("td",{ref:r,className:Je("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...n}));Le.displayName="TableCell";const wm=D.forwardRef(({className:e,...n},r)=>l.jsx("caption",{ref:r,className:Je("mt-4 text-sm text-muted-foreground",e),...n}));wm.displayName="TableCaption";const Nm=(e,n="MM/dd")=>{if(!e)return"-";try{const r=e instanceof Date?e:new Date(e);return Ws(r)?Ks(r,n):"-"}catch{return"-"}},tn=e=>{if(Array.isArray(e))return e.filter(n=>typeof n=="string");if(typeof e=="string"){const n=e.trim();if(!n)return[];try{const r=JSON.parse(n);if(Array.isArray(r))return r.filter(i=>typeof i=="string")}catch{}return n.split(",").map(r=>r.trim()).filter(Boolean)}return[]};function jm(){const[e,n]=D.useState(new Set),[r,i]=D.useState(null),[a,s]=D.useState(!1),[o,c]=D.useState([]),[u,d]=D.useState("all"),[h,f]=D.useState("all"),[p,m]=D.useState(""),[g,v]=D.useState(""),[b,x]=D.useState({mode:"",minutes:"",cards:"",confusions:"",weakAnchors:"",concepts:"",issues:"",notes:""});D.useEffect(()=>{const N=new URLSearchParams(window.location.search);d(N.get("semester")||"all"),m(N.get("start")||""),v(N.get("end")||"")},[]);const{data:j=[]}=X({queryKey:["courses"],queryFn:()=>V.courses.getActive()}),{data:C=[],isLoading:w}=X({queryKey:["sessions",u,p,g],queryFn:async()=>{const N=new URLSearchParams;u!=="all"&&N.append("semester",u),p&&N.append("start",p),g&&N.append("end",g);const I=N.toString(),$=I?`/sessions?${I}`:"/sessions",L=await fetch(`/api${$}`);if(!L.ok)throw new Error(`API Error: ${L.statusText}`);return L.json()}}),_=ht(),M=de({mutationFn:N=>V.sessions.deleteMany(N),onSuccess:()=>{_.invalidateQueries({queryKey:["sessions"]}),_.invalidateQueries({queryKey:["brain","metrics"]}),n(new Set)}}),E=de({mutationFn:({id:N,updates:I})=>V.sessions.update(N,I),onSuccess:()=>{_.invalidateQueries({queryKey:["sessions"]}),_.invalidateQueries({queryKey:["brain","metrics"]}),i(null)}}),y=N=>{n(I=>{const $=new Set(I);return $.has(N)?$.delete(N):$.add(N),$})},T=()=>{e.size===C.length?n(new Set):n(new Set(C.map(N=>N.id)))},k=()=>{e.size!==0&&(c(Array.from(e)),s(!0))},O=N=>{c([N]),s(!0)},P=()=>{M.mutate(o),s(!1),c([])};D.useEffect(()=>{if(r!==null){const N=C.find(I=>I.id===r);N&&x({mode:N.mode||"",minutes:N.minutes?.toString()||"",cards:N.cards?.toString()||"",confusions:tn(N.confusions).join(", "),weakAnchors:tn(N.weakAnchors).join(", "),concepts:tn(N.concepts).join(", "),issues:tn(N.issues).join(", "),notes:N.notes||""})}},[r,C]);const z=r!==null?C.find(N=>N.id===r):null,S=typeof window<"u"&&new URLSearchParams(window.location.search).has("debugModals");D.useEffect(()=>{r!==null&&!w&&!z&&(S&&console.warn("[ModalDebug][SessionEvidence] Missing session for edit; closing.",{editingSession:r,sessionsCount:C.length}),i(null))},[S,r,z,C.length,w]);const R=()=>{if(r===null)return;const N=$=>$?$.split(",").map(L=>L.trim()).filter(Boolean):[],I=$=>$.length?JSON.stringify($):null;E.mutate({id:r,updates:{mode:b.mode||"study",minutes:parseInt(b.minutes)||0,cards:parseInt(b.cards)||0,confusions:I(N(b.confusions)),weakAnchors:I(N(b.weakAnchors)),concepts:I(N(b.concepts)),issues:I(N(b.issues)),notes:b.notes||null}})};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"mt-8",children:l.jsxs(ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[l.jsx(ae,{className:"border-b border-primary/50 p-4",children:l.jsxs(oe,{className:"font-arcade text-sm flex items-center gap-2",children:[l.jsx(xr,{className:"w-4 h-4"}),"SESSION_EVIDENCE"]})}),l.jsxs(te,{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-5 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-arcade text-primary mb-2 block",children:"Semester"}),l.jsxs(Ct,{value:u,onValueChange:N=>{d(N);const I=new URLSearchParams(window.location.search);N==="all"?I.delete("semester"):I.set("semester",N),window.history.replaceState({},"",`?${I.toString()}`)},children:[l.jsx(At,{className:"rounded-none border-primary",children:l.jsx(Tt,{})}),l.jsxs(Ot,{className:"bg-black border-primary",children:[l.jsx(le,{value:"all",children:"All"}),l.jsx(le,{value:"1",children:"Semester 1 (Fall 2025)"}),l.jsx(le,{value:"2",children:"Semester 2 (Spring 2026)"})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-arcade text-primary mb-2 block",children:"Course"}),l.jsxs(Ct,{value:h,onValueChange:N=>f(N),children:[l.jsx(At,{className:"rounded-none border-primary",children:l.jsx(Tt,{})}),l.jsxs(Ot,{className:"bg-black border-primary",children:[l.jsx(le,{value:"all",children:"All"}),j.map(N=>l.jsx(le,{value:String(N.id),children:N.name},N.id))]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-arcade text-primary mb-2 block",children:"Start Date"}),l.jsx(Wt,{type:"date",value:p,onChange:N=>{m(N.target.value);const I=new URLSearchParams(window.location.search);N.target.value?I.set("start",N.target.value):I.delete("start"),window.history.replaceState({},"",`?${I.toString()}`)},className:"rounded-none border-primary"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-arcade text-primary mb-2 block",children:"End Date"}),l.jsx(Wt,{type:"date",value:g,onChange:N=>{v(N.target.value);const I=new URLSearchParams(window.location.search);N.target.value?I.set("end",N.target.value):I.delete("end"),window.history.replaceState({},"",`?${I.toString()}`)},className:"rounded-none border-primary"})]}),l.jsx("div",{className:"flex items-end",children:l.jsx(ne,{variant:"outline",onClick:()=>{d("all"),f("all"),m(""),v(""),window.history.replaceState({},"",window.location.pathname)},className:"rounded-none border-primary w-full",children:"Clear Filters"})})]}),w?l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Loading sessions..."})}):C.length===0?l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"No sessions found"})}):l.jsx(Ye,{className:"h-[400px]",children:l.jsxs(Ss,{children:[l.jsx(Cs,{children:l.jsxs(mr,{className:"border-secondary/30",children:[l.jsx(Fe,{className:"w-12",children:l.jsx(ye,{checked:e.size===C.length&&C.length>0,onCheckedChange:T,className:"border-secondary"})}),l.jsx(Fe,{className:"font-arcade text-xs text-primary",children:"Date"}),l.jsx(Fe,{className:"font-arcade text-xs text-primary",children:"Course"}),l.jsx(Fe,{className:"font-arcade text-xs text-primary",children:"Mode"}),l.jsx(Fe,{className:"font-arcade text-xs text-primary",children:"Minutes"}),l.jsx(Fe,{className:"font-arcade text-xs text-primary",children:"Cards"}),l.jsx(Fe,{className:"font-arcade text-xs text-primary",children:"Concepts"}),l.jsx(Fe,{className:"font-arcade text-xs text-primary",children:"Actions"})]})}),l.jsx(As,{children:C.filter(N=>h==="all"||String(N.courseId)===h).map(N=>l.jsxs(mr,{className:"border-secondary/30 hover:bg-secondary/10",children:[l.jsx(Le,{children:l.jsx(ye,{checked:e.has(N.id),onCheckedChange:()=>y(N.id),className:"border-secondary"})}),l.jsx(Le,{className:"font-terminal text-xs",children:Nm(N.createdAt,"MMM dd, yyyy")}),l.jsx(Le,{className:"font-terminal text-xs text-muted-foreground",children:N.topic||"-"}),l.jsx(Le,{className:"font-terminal text-xs text-muted-foreground",children:N.mode||"-"}),l.jsx(Le,{className:"font-terminal text-xs text-muted-foreground",children:N.minutes||"-"}),l.jsx(Le,{className:"font-terminal text-xs text-muted-foreground",children:N.cards||"-"}),l.jsx(Le,{className:"font-terminal text-xs text-muted-foreground",children:Array.isArray(N.concepts)?N.concepts.length:0}),l.jsxs(Le,{className:"flex gap-1",children:[l.jsx(ne,{size:"icon",variant:"outline",className:"h-6 w-6 border-yellow-500/50 text-yellow-400 hover:bg-yellow-500/20",onClick:()=>i(N.id),children:l.jsx(cn,{className:"w-3 h-3"})}),l.jsx(ne,{size:"icon",variant:"outline",className:"h-6 w-6 border-red-500/50 text-red-400 hover:bg-red-500/20",onClick:()=>O(N.id),children:l.jsx(st,{className:"w-3 h-3"})})]})]},N.id))})]})}),e.size>0&&l.jsx("div",{className:"flex gap-2 pt-4 border-t border-secondary/30",children:l.jsxs(ne,{size:"sm",className:"flex-1 font-terminal text-xs bg-red-600 hover:bg-red-700",onClick:k,children:[l.jsx(st,{className:"w-3 h-3 mr-1"}),"Delete Selected (",e.size,")"]})})]})]})}),l.jsx(ea,{open:!!z,onOpenChange:N=>{N||i(null)},children:l.jsxs(ta,{"data-modal":"brain-edit-session",className:"bg-black border-2 border-primary rounded-none max-w-2xl translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[l.jsxs(na,{children:[l.jsxs(ra,{className:"font-arcade text-primary flex items-center gap-2",children:[l.jsx(cn,{className:"w-5 h-5"}),"EDIT SESSION #",r]}),l.jsx(ia,{className:"font-terminal text-muted-foreground",children:"Update WRAP methodology fields for this study session"})]}),l.jsxs("div",{className:"space-y-4 font-terminal",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Mode"}),l.jsxs(Ct,{value:b.mode,onValueChange:N=>x(I=>({...I,mode:N})),children:[l.jsx(At,{className:"rounded-none border-secondary",children:l.jsx(Tt,{placeholder:"Select mode"})}),l.jsxs(Ot,{className:"rounded-none border-secondary bg-black",children:[l.jsx(le,{value:"Core",children:"Core"}),l.jsx(le,{value:"Sprint",children:"Sprint"}),l.jsx(le,{value:"Drill",children:"Drill"}),l.jsx(le,{value:"study",children:"Study"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Minutes"}),l.jsx(Wt,{type:"number",value:b.minutes,onChange:N=>x(I=>({...I,minutes:N.target.value})),className:"rounded-none border-secondary"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Cards"}),l.jsx(Wt,{type:"number",value:b.cards,onChange:N=>x(I=>({...I,cards:N.target.value})),className:"rounded-none border-secondary"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Confusions (comma-separated)"}),l.jsx(Qe,{value:b.confusions,onChange:N=>x(I=>({...I,confusions:N.target.value})),placeholder:"e.g., muscle insertion points, nerve pathways",className:"rounded-none border-secondary min-h-[60px]"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Weak Anchors (comma-separated)"}),l.jsx(Qe,{value:b.weakAnchors,onChange:N=>x(I=>({...I,weakAnchors:N.target.value})),placeholder:"e.g., brachial plexus diagram, ROM measurements",className:"rounded-none border-secondary min-h-[60px]"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Concepts (comma-separated)"}),l.jsx(Qe,{value:b.concepts,onChange:N=>x(I=>({...I,concepts:N.target.value})),placeholder:"e.g., upper extremity anatomy, peripheral nerves",className:"rounded-none border-secondary min-h-[60px]"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Issues (comma-separated)"}),l.jsx(Qe,{value:b.issues,onChange:N=>x(I=>({...I,issues:N.target.value})),placeholder:"e.g., interrupted by phone, lost focus after 30 min",className:"rounded-none border-secondary min-h-[60px]"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Notes"}),l.jsx(Qe,{value:b.notes,onChange:N=>x(I=>({...I,notes:N.target.value})),placeholder:"Free-form observations about the session",className:"rounded-none border-secondary min-h-[80px]"})]})]}),l.jsxs(aa,{className:"gap-2",children:[l.jsxs(ne,{variant:"outline",onClick:()=>i(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[l.jsx(It,{className:"w-4 h-4 mr-2"}),"Cancel"]}),l.jsxs(ne,{onClick:R,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[l.jsx(gr,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})}),l.jsx(sa,{open:a&&o.length>0,onOpenChange:s,children:l.jsxs(oa,{"data-modal":"brain-delete-session",className:"bg-black border-2 border-destructive rounded-none translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[l.jsxs(la,{children:[l.jsxs(ca,{className:"font-arcade text-destructive flex items-center gap-2",children:[l.jsx(st,{className:"w-5 h-5"}),"CONFIRM DELETE"]}),l.jsxs(ua,{className:"font-terminal text-muted-foreground",children:["Are you sure you want to delete ",o.length," session",o.length!==1?"s":"","? This action cannot be undone."]})]}),l.jsxs(da,{className:"gap-2",children:[l.jsx(fa,{className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:"Cancel"}),l.jsxs(ha,{onClick:P,className:"font-terminal rounded-none bg-destructive hover:bg-destructive/80 text-destructive-foreground",children:[l.jsx(st,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})})]})}const St=5;function km(e,n,r,i,a){const s=Math.min(a,St),o=Array.from({length:s},(f,p)=>{const m=r.filter((v,b)=>b%s===p),g=m.length>0?m.map(v=>`  - ${v}`).join(`
`):"  - (assign LOs here)";return`### Cluster ${p+1}: (name this cluster)

**LOs:**
${g}

**Key Facts (with source anchors):**
- [ ] Fact 1 — (page/slide ref)
- [ ] Fact 2 — (page/slide ref)

**Interpretation:**
(plain-language explanation)

**Application:**
(clinical scenario or exam pattern)`}).join(`

`),c=Array.from({length:s},(f,p)=>`    C${p+1}["Cluster ${p+1}"]`).join(`
`),u=Array.from({length:s},(f,p)=>`    Topic --> C${p+1}`).join(`
`),d=Array.from({length:s},(f,p)=>`#### Cluster ${p+1}
1. (free-recall question)
2. (fill-in or label question)`).join(`

`),h=i.trim()?`## Source Excerpt

> ${i.trim().replace(/\n/g,`
> `)}
`:`## Source Excerpt

> (paste source material here)
`;return`# ${n}

**Course:** ${e||"(unspecified)"}
**Date:** ${new Date().toISOString().slice(0,10)}
**Status:** Draft — UNVERIFIED until source anchors are filled

---

## Learning Objectives

${r.length>0?r.map(f=>`- ${f}`).join(`
`):"- (add LOs here)"}

---

${h}

---

## Clusters (${s})

${o}

---

## Concept Map

\`\`\`mermaid
graph TD
    Topic["${n}"]
${c}
${u}
\`\`\`

---

## Retrieval Practice

${d}

### Transfer Question
(apply knowledge from multiple clusters to a new context)

---

## Next Micro-Task

> (<=15 words: what to study next and when)

---

*Generated by Six-Phase Topic Note Builder*
`}function Sm(){const{toast:e}=Zi(),[n,r]=D.useState(""),[i,a]=D.useState(""),[s,o]=D.useState(""),[c,u]=D.useState(""),[d,h]=D.useState(4),[f,p]=D.useState(""),m=()=>{if(!i.trim()){e({title:"Topic required",variant:"destructive"});return}const v=s.split(`
`).map(x=>x.trim()).filter(Boolean);if(v.length>0&&d>St){e({title:"Too many clusters",description:`Max ${St} clusters. Consider splitting into Part 1 / Part 2.`,variant:"destructive"});return}const b=km(n,i.trim(),v,c,d);p(b),e({title:"Note generated",description:"Copy to Obsidian when ready."})},g=async()=>{try{await navigator.clipboard.writeText(f),e({title:"Copied to clipboard"})}catch{e({title:"Copy failed",description:"Select and copy manually.",variant:"destructive"})}};return l.jsxs(ee,{className:"bg-black/40 border-2 border-secondary/50 rounded-none",children:[l.jsxs(ae,{className:"p-3 border-b border-secondary/30",children:[l.jsx(oe,{className:"font-arcade text-xs",children:"SIX-PHASE TOPIC NOTE BUILDER"}),l.jsx("p",{className:"font-terminal text-[10px] text-muted-foreground mt-1",children:"Generate an Obsidian-ready topic note following the Six-Phase SOP. No LLM required — template only."})]}),l.jsxs(te,{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"font-terminal text-[10px] text-muted-foreground block mb-1",children:"Course"}),l.jsx("input",{value:n,onChange:v=>r(v.target.value),placeholder:"e.g., Anatomy",className:"w-full bg-black border border-secondary/50 rounded-none px-2 py-1.5 font-terminal text-xs text-white placeholder:text-muted-foreground focus:border-primary outline-none"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"font-terminal text-[10px] text-muted-foreground block mb-1",children:"Topic Title *"}),l.jsx("input",{value:i,onChange:v=>a(v.target.value),placeholder:"e.g., Brachial Plexus",className:"w-full bg-black border border-secondary/50 rounded-none px-2 py-1.5 font-terminal text-xs text-white placeholder:text-muted-foreground focus:border-primary outline-none"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"font-terminal text-[10px] text-muted-foreground block mb-1",children:"Learning Objectives (1 per line)"}),l.jsx("textarea",{value:s,onChange:v=>o(v.target.value),placeholder:`Identify the roots of the brachial plexus
Describe the trunks and divisions
List terminal branches`,rows:4,className:"w-full bg-black border border-secondary/50 rounded-none px-2 py-1.5 font-terminal text-xs text-white placeholder:text-muted-foreground focus:border-primary outline-none resize-y"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"font-terminal text-[10px] text-muted-foreground block mb-1",children:"Source Excerpt (optional — paste key content)"}),l.jsx("textarea",{value:c,onChange:v=>u(v.target.value),placeholder:"Paste relevant source material here...",rows:3,className:"w-full bg-black border border-secondary/50 rounded-none px-2 py-1.5 font-terminal text-xs text-white placeholder:text-muted-foreground focus:border-primary outline-none resize-y"})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("label",{className:"font-terminal text-[10px] text-muted-foreground",children:"Clusters (3-5):"}),l.jsx("input",{type:"number",min:3,max:St,value:d,onChange:v=>h(Math.min(St,Math.max(3,parseInt(v.target.value)||3))),className:"w-16 bg-black border border-secondary/50 rounded-none px-2 py-1 font-terminal text-xs text-white text-center focus:border-primary outline-none"}),l.jsx("button",{onClick:m,className:"px-4 py-1.5 bg-primary text-black font-arcade text-xs rounded-none hover:bg-primary/80",children:"GENERATE NOTE"})]}),f&&l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"font-arcade text-[10px] text-primary",children:"OUTPUT"}),l.jsx("button",{onClick:g,className:"px-3 py-1 border border-primary/50 text-xs font-arcade text-primary hover:bg-primary/10 rounded-none",children:"COPY TO CLIPBOARD"})]}),l.jsx("pre",{className:"bg-black border border-secondary/30 p-3 font-terminal text-[10px] text-white overflow-auto max-h-96 whitespace-pre-wrap",children:f})]})]})]})}const Qi=[{id:"study",label:"Study (Tutor)",tab:null,section:null},{id:"wrap",label:"Lite Wrap Ledger",tab:null,section:null},{id:"generate",label:"Generate JSON",tab:"daily",section:"section-ingestion"},{id:"attach",label:"Attach JSON",tab:"daily",section:"section-ingestion"},{id:"planner",label:"Planner Queue",tab:"weekly",section:"section-planner"},{id:"actions",label:"Next Actions",tab:"daily",section:"section-actions"}];function Lm(){const[e,n]=D.useState("vault"),[r,i]=D.useState("daily"),{data:a}=X({queryKey:["obsidian","status"],queryFn:V.obsidian.getStatus,refetchInterval:3e4}),{data:s}=X({queryKey:["anki","status"],queryFn:V.anki.getStatus,refetchInterval:3e4}),{data:o=[]}=X({queryKey:["anki","drafts"],queryFn:V.anki.getDrafts}),{data:c}=X({queryKey:["brain","metrics"],queryFn:V.brain.getMetrics}),{data:u=[]}=X({queryKey:["sessions"],queryFn:V.sessions.getAll}),{data:d=[]}=X({queryKey:["planner-queue"],queryFn:V.planner.getQueue}),h=o.filter(j=>j.status==="pending"),f=new Date,p=`${f.getFullYear()}-${String(f.getMonth()+1).padStart(2,"0")}-${String(f.getDate()).padStart(2,"0")}`,m=u.some(j=>j.session_date===p),g=d.length>0,v=u.some(j=>j.session_date===p&&j.understanding_level!=null),b={study:m,wrap:m,generate:v,attach:v,planner:g,actions:g},x=D.useCallback(j=>{j.tab&&(i(j.tab),j.section&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{const C=document.getElementById(j.section);C&&(C.scrollIntoView({behavior:"smooth",block:"start"}),C.classList.add("ring-2","ring-primary/50"),setTimeout(()=>C.classList.remove("ring-2","ring-primary/50"),1500))})}))},[]);return l.jsx(Ps,{children:l.jsxs("div",{className:"space-y-4 min-w-0 overflow-hidden",children:[l.jsxs(ee,{className:"bg-black/40 border-2 border-primary/50 rounded-none",children:[l.jsx(ae,{className:"p-3 border-b border-primary/30",children:l.jsx(oe,{className:"font-arcade text-[10px] text-primary",children:"STUDY FLOW"})}),l.jsx(te,{className:"p-3",children:l.jsx("div",{className:"flex items-center gap-1 overflow-x-auto",children:Qi.map((j,C)=>{const w=b[j.id]??!1;return l.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[l.jsxs("button",{onClick:()=>x(j),className:`flex items-center gap-1 px-2 py-1 text-[9px] font-terminal border rounded-none transition-colors ${w?"border-green-500/50 text-green-400 bg-green-500/10":"border-secondary/30 text-muted-foreground hover:text-white hover:border-secondary"} ${j.tab?"cursor-pointer":"cursor-default"}`,children:[w?l.jsx($s,{className:"w-3 h-3"}):l.jsx(Ls,{className:"w-3 h-3"}),j.label]}),C<Qi.length-1&&l.jsx(Js,{className:"w-3 h-3 text-muted-foreground shrink-0"})]},j.id)})})})]}),l.jsx(mo,{}),l.jsxs("div",{className:"flex flex-wrap items-center gap-4 font-terminal text-xs px-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:`w-2 h-2 rounded-full ${a?.connected?"bg-green-500":"bg-red-500"}`}),l.jsx("span",{className:"text-muted-foreground",children:"Obsidian"}),l.jsx("span",{className:"text-white",children:a?.connected?"Online":"Offline"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:`w-2 h-2 rounded-full ${s?.connected?"bg-green-500":"bg-red-500"}`}),l.jsx("span",{className:"text-muted-foreground",children:"Anki"}),l.jsx("span",{className:"text-white",children:s?.connected?"Connected":"Offline"})]}),l.jsxs("span",{className:"text-muted-foreground",children:["Cards: ",l.jsx("span",{className:"text-white",children:c?.totalCards||0})]}),l.jsxs("span",{className:"text-muted-foreground",children:["Drafts: ",l.jsx("span",{className:"text-white",children:h.length})]}),c?.averages&&l.jsxs(l.Fragment,{children:[l.jsxs("span",{className:"text-muted-foreground",children:["Avg Understanding: ",l.jsx("span",{className:"text-white",children:c.averages.understanding})]}),l.jsxs("span",{className:"text-muted-foreground",children:["Avg Retention: ",l.jsx("span",{className:"text-white",children:c.averages.retention})]})]})]}),l.jsxs(Ds,{value:r,onValueChange:i,className:"w-full space-y-4",children:[l.jsxs(zs,{className:"grid w-full grid-cols-3 rounded-none bg-black/40 border-2 border-primary p-0 h-auto",children:[l.jsx(En,{value:"daily",className:"font-arcade text-xs py-3 rounded-none data-[state=active]:bg-primary data-[state=active]:text-black data-[state=inactive]:text-muted-foreground border-r border-primary/30",children:"DAILY"}),l.jsx(En,{value:"weekly",className:"font-arcade text-xs py-3 rounded-none data-[state=active]:bg-primary data-[state=active]:text-black data-[state=inactive]:text-muted-foreground border-r border-primary/30",children:"WEEKLY"}),l.jsx(En,{value:"advanced",className:"font-arcade text-xs py-3 rounded-none data-[state=active]:bg-primary data-[state=active]:text-black data-[state=inactive]:text-muted-foreground",children:"ADVANCED"})]}),l.jsxs(Pn,{value:"daily",className:"space-y-6",children:[!m&&l.jsx(ee,{className:"bg-black/40 border-2 border-secondary/50 rounded-none",children:l.jsxs(te,{className:"p-6 text-center",children:[l.jsx("p",{className:"font-arcade text-xs text-primary mb-2",children:"NO SESSIONS TODAY"}),l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Start a study session with the Tutor → complete a Lite Wrap → come back here to generate and attach JSON."})]})}),l.jsx("div",{id:"section-ingestion",className:"transition-all duration-300",children:l.jsxs(ee,{className:"bg-black/40 border-2 border-secondary/50 rounded-none",children:[l.jsxs(ae,{className:"p-3 border-b border-secondary/30",children:[l.jsx(oe,{className:"font-arcade text-xs",children:"ATTACH JSON TO SESSION"}),l.jsx("p",{className:"font-terminal text-[10px] text-muted-foreground mt-1",children:"Paste your Tracker or Enhanced JSON from Brain ingestion prompt. Auto-detects format."})]}),l.jsx(te,{className:"p-4",children:l.jsx(uo,{})})]})}),l.jsx("div",{id:"section-actions",className:"transition-all duration-300",children:l.jsxs(ee,{className:"bg-black/40 border-2 border-secondary/50 rounded-none",children:[l.jsx(ae,{className:"p-3 border-b border-secondary/30",children:l.jsx(oe,{className:"font-arcade text-xs",children:"TODAY'S ACTIONS"})}),l.jsx(te,{className:"p-4",children:g?l.jsx(Dr,{filter:"today"}):l.jsx("div",{className:"text-center py-4",children:l.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"No planner tasks yet. Attach session JSON with weak_anchors to auto-generate review tasks."})})})]})}),l.jsx(jm,{})]}),l.jsxs(Pn,{value:"weekly",className:"space-y-6",children:[l.jsx("div",{id:"section-planner",className:"transition-all duration-300",children:l.jsxs(ee,{className:"bg-black/40 border-2 border-secondary/50 rounded-none",children:[l.jsxs(ae,{className:"p-3 border-b border-secondary/30",children:[l.jsx(oe,{className:"font-arcade text-xs",children:"PLANNER QUEUE"}),l.jsx("p",{className:"font-terminal text-[10px] text-muted-foreground mt-1",children:"Full planner queue with upcoming tasks. Use settings to adjust spacing strategy."})]}),l.jsx(te,{className:"p-4",children:l.jsx(Dr,{filter:"all"})})]})}),l.jsxs(ee,{className:"bg-black/40 border-2 border-secondary/50 rounded-none",children:[l.jsx(ae,{className:"p-3 border-b border-secondary/30",children:l.jsx(oe,{className:"font-arcade text-xs",children:"SESSION DATA"})}),l.jsx(te,{className:"p-0",children:l.jsx(fo,{})})]}),c?.staleTopics&&c.staleTopics.length>0&&l.jsxs(ee,{className:"bg-black/40 border-2 border-destructive/50 rounded-none",children:[l.jsx(ae,{className:"p-3 border-b border-destructive/30",children:l.jsx(oe,{className:"font-arcade text-xs text-destructive",children:"STALE TOPICS (14+ DAYS)"})}),l.jsx(te,{className:"p-4",children:l.jsx("div",{className:"space-y-2",children:c.staleTopics.map((j,C)=>l.jsxs("div",{className:"flex justify-between font-terminal text-xs",children:[l.jsx("span",{children:j.topic}),l.jsxs(un,{variant:"outline",className:"rounded-none text-[9px] border-destructive/50 text-destructive",children:[j.daysSince,"d ago"]})]},C))})})]})]}),l.jsxs(Pn,{value:"advanced",className:"space-y-6",children:[l.jsx(Sm,{}),l.jsxs("div",{className:"space-y-6 min-w-0",children:[l.jsx(bm,{}),l.jsx(vm,{totalCards:c?.totalCards||0})]}),l.jsx(ho,{}),l.jsxs(ee,{className:"bg-black/40 border-2 border-secondary/50 rounded-none",children:[l.jsx(ae,{className:"p-0",children:l.jsxs("div",{className:"flex items-center gap-0 border-b border-secondary/40",children:[l.jsx("button",{onClick:()=>n("vault"),className:`px-4 py-2 font-arcade text-xs transition-colors ${e==="vault"?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,children:"VAULT GRAPH"}),l.jsx("button",{onClick:()=>n("mindmap"),className:`px-4 py-2 font-arcade text-xs transition-colors ${e==="mindmap"?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,children:"MIND MAP"})]})}),l.jsx(te,{className:"p-0",children:l.jsx("div",{className:"h-[calc(100vh-200px)] flex flex-col min-w-0 overflow-hidden",children:e==="vault"?l.jsx(lm,{}):l.jsx(dm,{})})})]})]})]})]})})}export{Lm as default};

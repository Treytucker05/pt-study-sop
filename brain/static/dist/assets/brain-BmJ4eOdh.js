const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ConceptMapEditor-CHX0C_KC.js","assets/index-BlIQbSc0.js","assets/index-DwVEBd3I.css","assets/tldraw-D17luaDH.js","assets/layout-C86aYSKx.js","assets/select-BUrSvSjK.js","assets/index-pa7MxtiB.js","assets/tabs-BPgAyLyB.js","assets/tldraw-BWDvGoXv.css","assets/zoom-DwwqPMg_.js","assets/colors-BDuz-soV.js","assets/plus-CySFaxly.js","assets/triangle-alert-CkApm5yX.js","assets/file-text-BCA-dFlW.js","assets/badge-B3guh5-J.js","assets/circle-check-4OnSvwUb.js","assets/star-zljDwMNl.js","assets/refresh-cw-FI0DLzA5.js","assets/index-Cz3vMQuw.js","assets/search-mB0V9wL2.js","assets/message-square-DNBlkCz-.js","assets/loader-circle-pT6mUQtf.js","assets/send-paQJ2ODr.js","assets/checkbox-DqsCOQw9.js","assets/external-link-0kZv5A0w.js","assets/ConceptMapEditor-BZV40eAE.css","assets/VaultGraphView-ZJonYEc9.js","assets/react-force-graph-2d-CgUsMqCe.js","assets/MindMapView-D27glrju.js"])))=>i.map(i=>d[i]);
import{c as te,r as c,R as yn,j as t,b as oe,X as vt,f as Ss,e as vn,P as Ze,d as kt,g as ks,h as Cs,u as et,a as tt,_ as Ct}from"./index-BlIQbSc0.js";import{G as Es,f as Y,a as G,B,I as Ce,S as _e,p as wt,r as Ps,g as Et,i as Pt,j as Rt,k as It,l as zt,s as At,n as Ke,u as me,o as ct,m as Ue,t as Kt,v as Rs,L as Is}from"./layout-C86aYSKx.js";import{B as We,C as Ee,a as Pe,b as Re,c as Ie}from"./badge-B3guh5-J.js";import{C as zs}from"./circle-check-4OnSvwUb.js";import{C as wn,T as Tt,A as As}from"./triangle-alert-CkApm5yX.js";import{A as Ts,S as Ms}from"./star-zljDwMNl.js";import{R as Ae}from"./refresh-cw-FI0DLzA5.js";import{F as jn,M as Ds,r as $s,D as Ls}from"./index-Cz3vMQuw.js";import{S as Os}from"./search-mB0V9wL2.js";import{F as Mt}from"./file-text-BCA-dFlW.js";import{C as _s,S as Fs,a as Hs,b as Vs,c as Gs,d as xe}from"./select-BUrSvSjK.js";import{C as Bs,u as qs}from"./index-pa7MxtiB.js";import{M as Nn}from"./message-square-DNBlkCz-.js";import{L as Fe,c as Sn,R as Ks,I as Us,T as Ws,a as Js,b as dt,d as ut,C as Ys}from"./tabs-BPgAyLyB.js";import{L as Dt}from"./loader-circle-pT6mUQtf.js";import{S as Qs}from"./send-paQJ2ODr.js";import{C as kn}from"./checkbox-DqsCOQw9.js";import{C as Xs}from"./colors-BDuz-soV.js";import{E as Zs}from"./external-link-0kZv5A0w.js";import{P as Ut}from"./plus-CySFaxly.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],tr=te("brain-circuit",er);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Wt=te("calendar-days",nr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]],rr=te("columns-2",sr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],or=te("copy",ar);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],$t=te("download",ir);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],cr=te("file",lr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],ur=te("folder",dr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],fr=te("image",mr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],pr=te("maximize-2",hr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],gr=te("minimize-2",xr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]],yr=te("network",br);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}]],wr=te("rows-2",vr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]],Nr=te("table-2",jr),nt=c.createContext(null);nt.displayName="PanelGroupContext";const W={group:"data-panel-group",groupDirection:"data-panel-group-direction",groupId:"data-panel-group-id",panel:"data-panel",panelCollapsible:"data-panel-collapsible",panelId:"data-panel-id",panelSize:"data-panel-size",resizeHandle:"data-resize-handle",resizeHandleActive:"data-resize-handle-active",resizeHandleEnabled:"data-panel-resize-handle-enabled",resizeHandleId:"data-panel-resize-handle-id",resizeHandleState:"data-resize-handle-state"},Lt=10,ye=c.useLayoutEffect,Jt=yn.useId,Sr=typeof Jt=="function"?Jt:()=>null;let kr=0;function Ot(e=null){const n=Sr(),s=c.useRef(e||n||null);return s.current===null&&(s.current=""+kr++),e??s.current}function Cn({children:e,className:n="",collapsedSize:s,collapsible:r,defaultSize:a,forwardedRef:o,id:l,maxSize:i,minSize:d,onCollapse:h,onExpand:x,onResize:b,order:g,style:y,tagName:w="div",...P}){const f=c.useContext(nt);if(f===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:u,expandPanel:p,getPanelSize:v,getPanelStyle:N,groupId:D,isPanelCollapsed:T,reevaluatePanelConstraints:R,registerPanel:k,resizePanel:H,unregisterPanel:j}=f,C=Ot(l),A=c.useRef({callbacks:{onCollapse:h,onExpand:x,onResize:b},constraints:{collapsedSize:s,collapsible:r,defaultSize:a,maxSize:i,minSize:d},id:C,idIsFromProps:l!==void 0,order:g});c.useRef({didLogMissingDefaultSizeWarning:!1}),ye(()=>{const{callbacks:$,constraints:M}=A.current,F={...M};A.current.id=C,A.current.idIsFromProps=l!==void 0,A.current.order=g,$.onCollapse=h,$.onExpand=x,$.onResize=b,M.collapsedSize=s,M.collapsible=r,M.defaultSize=a,M.maxSize=i,M.minSize=d,(F.collapsedSize!==M.collapsedSize||F.collapsible!==M.collapsible||F.maxSize!==M.maxSize||F.minSize!==M.minSize)&&R(A.current,F)}),ye(()=>{const $=A.current;return k($),()=>{j($)}},[g,C,k,j]),c.useImperativeHandle(o,()=>({collapse:()=>{u(A.current)},expand:$=>{p(A.current,$)},getId(){return C},getSize(){return v(A.current)},isCollapsed(){return T(A.current)},isExpanded(){return!T(A.current)},resize:$=>{H(A.current,$)}}),[u,p,v,T,C,H]);const _=N(A.current,a);return c.createElement(w,{...P,children:e,className:n,id:C,style:{..._,...y},[W.groupId]:D,[W.panel]:"",[W.panelCollapsible]:r||void 0,[W.panelId]:C,[W.panelSize]:parseFloat(""+_.flexGrow).toFixed(1)})}const En=c.forwardRef((e,n)=>c.createElement(Cn,{...e,forwardedRef:n}));Cn.displayName="Panel";En.displayName="forwardRef(Panel)";let jt=null,qe=-1,he=null;function Cr(e,n){if(n){const s=(n&An)!==0,r=(n&Tn)!==0,a=(n&Mn)!==0,o=(n&Dn)!==0;if(s)return a?"se-resize":o?"ne-resize":"e-resize";if(r)return a?"sw-resize":o?"nw-resize":"w-resize";if(a)return"s-resize";if(o)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function Er(){he!==null&&(document.head.removeChild(he),jt=null,he=null,qe=-1)}function mt(e,n){var s,r;const a=Cr(e,n);if(jt!==a){if(jt=a,he===null&&(he=document.createElement("style"),document.head.appendChild(he)),qe>=0){var o;(o=he.sheet)===null||o===void 0||o.removeRule(qe)}qe=(s=(r=he.sheet)===null||r===void 0?void 0:r.insertRule(`*{cursor: ${a} !important;}`))!==null&&s!==void 0?s:-1}}function Pn(e){return e.type==="keydown"}function Rn(e){return e.type.startsWith("pointer")}function In(e){return e.type.startsWith("mouse")}function st(e){if(Rn(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(In(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}function Pr(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function Rr(e,n,s){return e.x<n.x+n.width&&e.x+e.width>n.x&&e.y<n.y+n.height&&e.y+e.height>n.y}function Ir(e,n){if(e===n)throw new Error("Cannot compare node with itself");const s={a:Xt(e),b:Xt(n)};let r;for(;s.a.at(-1)===s.b.at(-1);)e=s.a.pop(),n=s.b.pop(),r=e;O(r,"Stacking order can only be calculated for elements with a common ancestor");const a={a:Qt(Yt(s.a)),b:Qt(Yt(s.b))};if(a.a===a.b){const o=r.childNodes,l={a:s.a.at(-1),b:s.b.at(-1)};let i=o.length;for(;i--;){const d=o[i];if(d===l.a)return 1;if(d===l.b)return-1}}return Math.sign(a.a-a.b)}const zr=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function Ar(e){var n;const s=getComputedStyle((n=zn(e))!==null&&n!==void 0?n:e).display;return s==="flex"||s==="inline-flex"}function Tr(e){const n=getComputedStyle(e);return!!(n.position==="fixed"||n.zIndex!=="auto"&&(n.position!=="static"||Ar(e))||+n.opacity<1||"transform"in n&&n.transform!=="none"||"webkitTransform"in n&&n.webkitTransform!=="none"||"mixBlendMode"in n&&n.mixBlendMode!=="normal"||"filter"in n&&n.filter!=="none"||"webkitFilter"in n&&n.webkitFilter!=="none"||"isolation"in n&&n.isolation==="isolate"||zr.test(n.willChange)||n.webkitOverflowScrolling==="touch")}function Yt(e){let n=e.length;for(;n--;){const s=e[n];if(O(s,"Missing node"),Tr(s))return s}return null}function Qt(e){return e&&Number(getComputedStyle(e).zIndex)||0}function Xt(e){const n=[];for(;e;)n.push(e),e=zn(e);return n}function zn(e){const{parentNode:n}=e;return n&&n instanceof ShadowRoot?n.host:n}const An=1,Tn=2,Mn=4,Dn=8,Mr=Pr()==="coarse";let ie=[],Te=!1,be=new Map,rt=new Map;const He=new Set;function Dr(e,n,s,r,a){var o;const{ownerDocument:l}=n,i={direction:s,element:n,hitAreaMargins:r,setResizeHandlerState:a},d=(o=be.get(l))!==null&&o!==void 0?o:0;return be.set(l,d+1),He.add(i),Je(),function(){var x;rt.delete(e),He.delete(i);const b=(x=be.get(l))!==null&&x!==void 0?x:1;if(be.set(l,b-1),Je(),b===1&&be.delete(l),ie.includes(i)){const g=ie.indexOf(i);g>=0&&ie.splice(g,1),Ft(),a("up",!0,null)}}}function $r(e){const{target:n}=e,{x:s,y:r}=st(e);Te=!0,_t({target:n,x:s,y:r}),Je(),ie.length>0&&(Ye("down",e),e.preventDefault(),$n(n)||e.stopImmediatePropagation())}function ft(e){const{x:n,y:s}=st(e);if(Te&&e.buttons===0&&(Te=!1,Ye("up",e)),!Te){const{target:r}=e;_t({target:r,x:n,y:s})}Ye("move",e),Ft(),ie.length>0&&e.preventDefault()}function ht(e){const{target:n}=e,{x:s,y:r}=st(e);rt.clear(),Te=!1,ie.length>0&&(e.preventDefault(),$n(n)||e.stopImmediatePropagation()),Ye("up",e),_t({target:n,x:s,y:r}),Ft(),Je()}function $n(e){let n=e;for(;n;){if(n.hasAttribute(W.resizeHandle))return!0;n=n.parentElement}return!1}function _t({target:e,x:n,y:s}){ie.splice(0);let r=null;(e instanceof HTMLElement||e instanceof SVGElement)&&(r=e),He.forEach(a=>{const{element:o,hitAreaMargins:l}=a,i=o.getBoundingClientRect(),{bottom:d,left:h,right:x,top:b}=i,g=Mr?l.coarse:l.fine;if(n>=h-g&&n<=x+g&&s>=b-g&&s<=d+g){if(r!==null&&document.contains(r)&&o!==r&&!o.contains(r)&&!r.contains(o)&&Ir(r,o)>0){let w=r,P=!1;for(;w&&!w.contains(o);){if(Rr(w.getBoundingClientRect(),i)){P=!0;break}w=w.parentElement}if(P)return}ie.push(a)}})}function pt(e,n){rt.set(e,n)}function Ft(){let e=!1,n=!1;ie.forEach(r=>{const{direction:a}=r;a==="horizontal"?e=!0:n=!0});let s=0;rt.forEach(r=>{s|=r}),e&&n?mt("intersection",s):e?mt("horizontal",s):n?mt("vertical",s):Er()}let xt=new AbortController;function Je(){xt.abort(),xt=new AbortController;const e={capture:!0,signal:xt.signal};He.size&&(Te?(ie.length>0&&be.forEach((n,s)=>{const{body:r}=s;n>0&&(r.addEventListener("contextmenu",ht,e),r.addEventListener("pointerleave",ft,e),r.addEventListener("pointermove",ft,e))}),window.addEventListener("pointerup",ht,e),window.addEventListener("pointercancel",ht,e)):be.forEach((n,s)=>{const{body:r}=s;n>0&&(r.addEventListener("pointerdown",$r,e),r.addEventListener("pointermove",ft,e))}))}function Ye(e,n){He.forEach(s=>{const{setResizeHandlerState:r}=s,a=ie.includes(s);r(e,a,n)})}function Lr(){const[e,n]=c.useState(0);return c.useCallback(()=>n(s=>s+1),[])}function O(e,n){if(!e)throw console.error(n),Error(n)}function ve(e,n,s=Lt){return e.toFixed(s)===n.toFixed(s)?0:e>n?1:-1}function ue(e,n,s=Lt){return ve(e,n,s)===0}function ee(e,n,s){return ve(e,n,s)===0}function Or(e,n,s){if(e.length!==n.length)return!1;for(let r=0;r<e.length;r++){const a=e[r],o=n[r];if(!ee(a,o,s))return!1}return!0}function ze({panelConstraints:e,panelIndex:n,size:s}){const r=e[n];O(r!=null,`Panel constraints not found for index ${n}`);let{collapsedSize:a=0,collapsible:o,maxSize:l=100,minSize:i=0}=r;if(ve(s,i)<0)if(o){const d=(a+i)/2;ve(s,d)<0?s=a:s=i}else s=i;return s=Math.min(l,s),s=parseFloat(s.toFixed(Lt)),s}function Le({delta:e,initialLayout:n,panelConstraints:s,pivotIndices:r,prevLayout:a,trigger:o}){if(ee(e,0))return n;const l=[...n],[i,d]=r;O(i!=null,"Invalid first pivot index"),O(d!=null,"Invalid second pivot index");let h=0;if(o==="keyboard"){{const b=e<0?d:i,g=s[b];O(g,`Panel constraints not found for index ${b}`);const{collapsedSize:y=0,collapsible:w,minSize:P=0}=g;if(w){const f=n[b];if(O(f!=null,`Previous layout not found for panel index ${b}`),ee(f,y)){const u=P-f;ve(u,Math.abs(e))>0&&(e=e<0?0-u:u)}}}{const b=e<0?i:d,g=s[b];O(g,`No panel constraints found for index ${b}`);const{collapsedSize:y=0,collapsible:w,minSize:P=0}=g;if(w){const f=n[b];if(O(f!=null,`Previous layout not found for panel index ${b}`),ee(f,P)){const u=f-y;ve(u,Math.abs(e))>0&&(e=e<0?0-u:u)}}}}{const b=e<0?1:-1;let g=e<0?d:i,y=0;for(;;){const P=n[g];O(P!=null,`Previous layout not found for panel index ${g}`);const u=ze({panelConstraints:s,panelIndex:g,size:100})-P;if(y+=u,g+=b,g<0||g>=s.length)break}const w=Math.min(Math.abs(e),Math.abs(y));e=e<0?0-w:w}{let g=e<0?i:d;for(;g>=0&&g<s.length;){const y=Math.abs(e)-Math.abs(h),w=n[g];O(w!=null,`Previous layout not found for panel index ${g}`);const P=w-y,f=ze({panelConstraints:s,panelIndex:g,size:P});if(!ee(w,f)&&(h+=w-f,l[g]=f,h.toPrecision(3).localeCompare(Math.abs(e).toPrecision(3),void 0,{numeric:!0})>=0))break;e<0?g--:g++}}if(Or(a,l))return a;{const b=e<0?d:i,g=n[b];O(g!=null,`Previous layout not found for panel index ${b}`);const y=g+h,w=ze({panelConstraints:s,panelIndex:b,size:y});if(l[b]=w,!ee(w,y)){let P=y-w,u=e<0?d:i;for(;u>=0&&u<s.length;){const p=l[u];O(p!=null,`Previous layout not found for panel index ${u}`);const v=p+P,N=ze({panelConstraints:s,panelIndex:u,size:v});if(ee(p,N)||(P-=N-p,l[u]=N),ee(P,0))break;e>0?u--:u++}}}const x=l.reduce((b,g)=>g+b,0);return ee(x,100)?l:a}function _r({layout:e,panelsArray:n,pivotIndices:s}){let r=0,a=100,o=0,l=0;const i=s[0];O(i!=null,"No pivot index found"),n.forEach((b,g)=>{const{constraints:y}=b,{maxSize:w=100,minSize:P=0}=y;g===i?(r=P,a=w):(o+=P,l+=w)});const d=Math.min(a,100-o),h=Math.max(r,100-l),x=e[i];return{valueMax:d,valueMin:h,valueNow:x}}function Ve(e,n=document){return Array.from(n.querySelectorAll(`[${W.resizeHandleId}][data-panel-group-id="${e}"]`))}function Ln(e,n,s=document){const a=Ve(e,s).findIndex(o=>o.getAttribute(W.resizeHandleId)===n);return a??null}function On(e,n,s){const r=Ln(e,n,s);return r!=null?[r,r+1]:[-1,-1]}function _n(e,n=document){var s;if(n instanceof HTMLElement&&(n==null||(s=n.dataset)===null||s===void 0?void 0:s.panelGroupId)==e)return n;const r=n.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return r||null}function at(e,n=document){const s=n.querySelector(`[${W.resizeHandleId}="${e}"]`);return s||null}function Fr(e,n,s,r=document){var a,o,l,i;const d=at(n,r),h=Ve(e,r),x=d?h.indexOf(d):-1,b=(a=(o=s[x])===null||o===void 0?void 0:o.id)!==null&&a!==void 0?a:null,g=(l=(i=s[x+1])===null||i===void 0?void 0:i.id)!==null&&l!==void 0?l:null;return[b,g]}function Hr({committedValuesRef:e,eagerValuesRef:n,groupId:s,layout:r,panelDataArray:a,panelGroupElement:o,setLayout:l}){c.useRef({didWarnAboutMissingResizeHandle:!1}),ye(()=>{if(!o)return;const i=Ve(s,o);for(let d=0;d<a.length-1;d++){const{valueMax:h,valueMin:x,valueNow:b}=_r({layout:r,panelsArray:a,pivotIndices:[d,d+1]}),g=i[d];if(g!=null){const y=a[d];O(y,`No panel data found for index "${d}"`),g.setAttribute("aria-controls",y.id),g.setAttribute("aria-valuemax",""+Math.round(h)),g.setAttribute("aria-valuemin",""+Math.round(x)),g.setAttribute("aria-valuenow",b!=null?""+Math.round(b):"")}}return()=>{i.forEach((d,h)=>{d.removeAttribute("aria-controls"),d.removeAttribute("aria-valuemax"),d.removeAttribute("aria-valuemin"),d.removeAttribute("aria-valuenow")})}},[s,r,a,o]),c.useEffect(()=>{if(!o)return;const i=n.current;O(i,"Eager values not found");const{panelDataArray:d}=i,h=_n(s,o);O(h!=null,`No group found for id "${s}"`);const x=Ve(s,o);O(x,`No resize handles found for group id "${s}"`);const b=x.map(g=>{const y=g.getAttribute(W.resizeHandleId);O(y,"Resize handle element has no handle id attribute");const[w,P]=Fr(s,y,d,o);if(w==null||P==null)return()=>{};const f=u=>{if(!u.defaultPrevented)switch(u.key){case"Enter":{u.preventDefault();const p=d.findIndex(v=>v.id===w);if(p>=0){const v=d[p];O(v,`No panel data found for index ${p}`);const N=r[p],{collapsedSize:D=0,collapsible:T,minSize:R=0}=v.constraints;if(N!=null&&T){const k=Le({delta:ee(N,D)?R-D:D-N,initialLayout:r,panelConstraints:d.map(H=>H.constraints),pivotIndices:On(s,y,o),prevLayout:r,trigger:"keyboard"});r!==k&&l(k)}}break}}};return g.addEventListener("keydown",f),()=>{g.removeEventListener("keydown",f)}});return()=>{b.forEach(g=>g())}},[o,e,n,s,r,a,l])}function Zt(e,n){if(e.length!==n.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!==n[s])return!1;return!0}function Fn(e,n){const s=e==="horizontal",{x:r,y:a}=st(n);return s?r:a}function Vr(e,n,s,r,a){const o=s==="horizontal",l=at(n,a);O(l,`No resize handle element found for id "${n}"`);const i=l.getAttribute(W.groupId);O(i,"Resize handle element has no group id attribute");let{initialCursorPosition:d}=r;const h=Fn(s,e),x=_n(i,a);O(x,`No group element found for id "${i}"`);const b=x.getBoundingClientRect(),g=o?b.width:b.height;return(h-d)/g*100}function Gr(e,n,s,r,a,o){if(Pn(e)){const l=s==="horizontal";let i=0;e.shiftKey?i=100:a!=null?i=a:i=10;let d=0;switch(e.key){case"ArrowDown":d=l?0:i;break;case"ArrowLeft":d=l?-i:0;break;case"ArrowRight":d=l?i:0;break;case"ArrowUp":d=l?0:-i;break;case"End":d=100;break;case"Home":d=-100;break}return d}else return r==null?0:Vr(e,n,s,r,o)}function Br({panelDataArray:e}){const n=Array(e.length),s=e.map(o=>o.constraints);let r=0,a=100;for(let o=0;o<e.length;o++){const l=s[o];O(l,`Panel constraints not found for index ${o}`);const{defaultSize:i}=l;i!=null&&(r++,n[o]=i,a-=i)}for(let o=0;o<e.length;o++){const l=s[o];O(l,`Panel constraints not found for index ${o}`);const{defaultSize:i}=l;if(i!=null)continue;const d=e.length-r,h=a/d;r++,n[o]=h,a-=h}return n}function we(e,n,s){n.forEach((r,a)=>{const o=e[a];O(o,`Panel data not found for index ${a}`);const{callbacks:l,constraints:i,id:d}=o,{collapsedSize:h=0,collapsible:x}=i,b=s[d];if(b==null||r!==b){s[d]=r;const{onCollapse:g,onExpand:y,onResize:w}=l;w&&w(r,b),x&&(g||y)&&(y&&(b==null||ue(b,h))&&!ue(r,h)&&y(),g&&(b==null||!ue(b,h))&&ue(r,h)&&g())}})}function Be(e,n){if(e.length!==n.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!=n[s])return!1;return!0}function qr({defaultSize:e,dragState:n,layout:s,panelData:r,panelIndex:a,precision:o=3}){const l=s[a];let i;return l==null?i=e!=null?e.toPrecision(o):"1":r.length===1?i="1":i=l.toPrecision(o),{flexBasis:0,flexGrow:i,flexShrink:1,overflow:"hidden",pointerEvents:n!==null?"none":void 0}}function Kr(e,n=10){let s=null;return(...a)=>{s!==null&&clearTimeout(s),s=setTimeout(()=>{e(...a)},n)}}function en(e){try{if(typeof localStorage<"u")e.getItem=n=>localStorage.getItem(n),e.setItem=(n,s)=>{localStorage.setItem(n,s)};else throw new Error("localStorage not supported in this environment")}catch(n){console.error(n),e.getItem=()=>null,e.setItem=()=>{}}}function Hn(e){return`react-resizable-panels:${e}`}function Vn(e){return e.map(n=>{const{constraints:s,id:r,idIsFromProps:a,order:o}=n;return a?r:o?`${o}:${JSON.stringify(s)}`:JSON.stringify(s)}).sort((n,s)=>n.localeCompare(s)).join(",")}function Gn(e,n){try{const s=Hn(e),r=n.getItem(s);if(r){const a=JSON.parse(r);if(typeof a=="object"&&a!=null)return a}}catch{}return null}function Ur(e,n,s){var r,a;const o=(r=Gn(e,s))!==null&&r!==void 0?r:{},l=Vn(n);return(a=o[l])!==null&&a!==void 0?a:null}function Wr(e,n,s,r,a){var o;const l=Hn(e),i=Vn(n),d=(o=Gn(e,a))!==null&&o!==void 0?o:{};d[i]={expandToSizes:Object.fromEntries(s.entries()),layout:r};try{a.setItem(l,JSON.stringify(d))}catch(h){console.error(h)}}function tn({layout:e,panelConstraints:n}){const s=[...e],r=s.reduce((o,l)=>o+l,0);if(s.length!==n.length)throw Error(`Invalid ${n.length} panel layout: ${s.map(o=>`${o}%`).join(", ")}`);if(!ee(r,100)&&s.length>0)for(let o=0;o<n.length;o++){const l=s[o];O(l!=null,`No layout data found for index ${o}`);const i=100/r*l;s[o]=i}let a=0;for(let o=0;o<n.length;o++){const l=s[o];O(l!=null,`No layout data found for index ${o}`);const i=ze({panelConstraints:n,panelIndex:o,size:l});l!=i&&(a+=l-i,s[o]=i)}if(!ee(a,0))for(let o=0;o<n.length;o++){const l=s[o];O(l!=null,`No layout data found for index ${o}`);const i=l+a,d=ze({panelConstraints:n,panelIndex:o,size:i});if(l!==d&&(a-=d-l,s[o]=d,ee(a,0)))break}return s}const Jr=100,Oe={getItem:e=>(en(Oe),Oe.getItem(e)),setItem:(e,n)=>{en(Oe),Oe.setItem(e,n)}},nn={};function Bn({autoSaveId:e=null,children:n,className:s="",direction:r,forwardedRef:a,id:o=null,onLayout:l=null,keyboardResizeBy:i=null,storage:d=Oe,style:h,tagName:x="div",...b}){const g=Ot(o),y=c.useRef(null),[w,P]=c.useState(null),[f,u]=c.useState([]),p=Lr(),v=c.useRef({}),N=c.useRef(new Map),D=c.useRef(0),T=c.useRef({autoSaveId:e,direction:r,dragState:w,id:g,keyboardResizeBy:i,onLayout:l,storage:d}),R=c.useRef({layout:f,panelDataArray:[],panelDataArrayChanged:!1});c.useRef({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),c.useImperativeHandle(a,()=>({getId:()=>T.current.id,getLayout:()=>{const{layout:m}=R.current;return m},setLayout:m=>{const{onLayout:S}=T.current,{layout:z,panelDataArray:E}=R.current,I=tn({layout:m,panelConstraints:E.map(L=>L.constraints)});Zt(z,I)||(u(I),R.current.layout=I,S&&S(I),we(E,I,v.current))}}),[]),ye(()=>{T.current.autoSaveId=e,T.current.direction=r,T.current.dragState=w,T.current.id=g,T.current.onLayout=l,T.current.storage=d}),Hr({committedValuesRef:T,eagerValuesRef:R,groupId:g,layout:f,panelDataArray:R.current.panelDataArray,setLayout:u,panelGroupElement:y.current}),c.useEffect(()=>{const{panelDataArray:m}=R.current;if(e){if(f.length===0||f.length!==m.length)return;let S=nn[e];S==null&&(S=Kr(Wr,Jr),nn[e]=S);const z=[...m],E=new Map(N.current);S(e,z,E,f,d)}},[e,f,d]),c.useEffect(()=>{});const k=c.useCallback(m=>{const{onLayout:S}=T.current,{layout:z,panelDataArray:E}=R.current;if(m.constraints.collapsible){const I=E.map(le=>le.constraints),{collapsedSize:L=0,panelSize:V,pivotIndices:K}=ge(E,m,z);if(O(V!=null,`Panel size not found for panel "${m.id}"`),!ue(V,L)){N.current.set(m.id,V);const ce=Se(E,m)===E.length-1?V-L:L-V,U=Le({delta:ce,initialLayout:z,panelConstraints:I,pivotIndices:K,prevLayout:z,trigger:"imperative-api"});Be(z,U)||(u(U),R.current.layout=U,S&&S(U),we(E,U,v.current))}}},[]),H=c.useCallback((m,S)=>{const{onLayout:z}=T.current,{layout:E,panelDataArray:I}=R.current;if(m.constraints.collapsible){const L=I.map(ae=>ae.constraints),{collapsedSize:V=0,panelSize:K=0,minSize:le=0,pivotIndices:ce}=ge(I,m,E),U=S??le;if(ue(K,V)){const ae=N.current.get(m.id),Me=ae!=null&&ae>=U?ae:U,lt=Se(I,m)===I.length-1?K-Me:Me-K,Q=Le({delta:lt,initialLayout:E,panelConstraints:L,pivotIndices:ce,prevLayout:E,trigger:"imperative-api"});Be(E,Q)||(u(Q),R.current.layout=Q,z&&z(Q),we(I,Q,v.current))}}},[]),j=c.useCallback(m=>{const{layout:S,panelDataArray:z}=R.current,{panelSize:E}=ge(z,m,S);return O(E!=null,`Panel size not found for panel "${m.id}"`),E},[]),C=c.useCallback((m,S)=>{const{panelDataArray:z}=R.current,E=Se(z,m);return qr({defaultSize:S,dragState:w,layout:f,panelData:z,panelIndex:E})},[w,f]),A=c.useCallback(m=>{const{layout:S,panelDataArray:z}=R.current,{collapsedSize:E=0,collapsible:I,panelSize:L}=ge(z,m,S);return O(L!=null,`Panel size not found for panel "${m.id}"`),I===!0&&ue(L,E)},[]),_=c.useCallback(m=>{const{layout:S,panelDataArray:z}=R.current,{collapsedSize:E=0,collapsible:I,panelSize:L}=ge(z,m,S);return O(L!=null,`Panel size not found for panel "${m.id}"`),!I||ve(L,E)>0},[]),$=c.useCallback(m=>{const{panelDataArray:S}=R.current;S.push(m),S.sort((z,E)=>{const I=z.order,L=E.order;return I==null&&L==null?0:I==null?-1:L==null?1:I-L}),R.current.panelDataArrayChanged=!0,p()},[p]);ye(()=>{if(R.current.panelDataArrayChanged){R.current.panelDataArrayChanged=!1;const{autoSaveId:m,onLayout:S,storage:z}=T.current,{layout:E,panelDataArray:I}=R.current;let L=null;if(m){const K=Ur(m,I,z);K&&(N.current=new Map(Object.entries(K.expandToSizes)),L=K.layout)}L==null&&(L=Br({panelDataArray:I}));const V=tn({layout:L,panelConstraints:I.map(K=>K.constraints)});Zt(E,V)||(u(V),R.current.layout=V,S&&S(V),we(I,V,v.current))}}),ye(()=>{const m=R.current;return()=>{m.layout=[]}},[]);const M=c.useCallback(m=>{let S=!1;const z=y.current;return z&&window.getComputedStyle(z,null).getPropertyValue("direction")==="rtl"&&(S=!0),function(I){I.preventDefault();const L=y.current;if(!L)return()=>null;const{direction:V,dragState:K,id:le,keyboardResizeBy:ce,onLayout:U}=T.current,{layout:ae,panelDataArray:Me}=R.current,{initialLayout:Ge}=K??{},lt=On(le,m,L);let Q=Gr(I,m,V,K,ce,L);const Bt=V==="horizontal";Bt&&S&&(Q=-Q);const js=Me.map(Ns=>Ns.constraints),De=Le({delta:Q,initialLayout:Ge??ae,panelConstraints:js,pivotIndices:lt,prevLayout:ae,trigger:Pn(I)?"keyboard":"mouse-or-touch"}),qt=!Be(ae,De);(Rn(I)||In(I))&&D.current!=Q&&(D.current=Q,!qt&&Q!==0?Bt?pt(m,Q<0?An:Tn):pt(m,Q<0?Mn:Dn):pt(m,0)),qt&&(u(De),R.current.layout=De,U&&U(De),we(Me,De,v.current))}},[]),F=c.useCallback((m,S)=>{const{onLayout:z}=T.current,{layout:E,panelDataArray:I}=R.current,L=I.map(ae=>ae.constraints),{panelSize:V,pivotIndices:K}=ge(I,m,E);O(V!=null,`Panel size not found for panel "${m.id}"`);const ce=Se(I,m)===I.length-1?V-S:S-V,U=Le({delta:ce,initialLayout:E,panelConstraints:L,pivotIndices:K,prevLayout:E,trigger:"imperative-api"});Be(E,U)||(u(U),R.current.layout=U,z&&z(U),we(I,U,v.current))},[]),q=c.useCallback((m,S)=>{const{layout:z,panelDataArray:E}=R.current,{collapsedSize:I=0,collapsible:L}=S,{collapsedSize:V=0,collapsible:K,maxSize:le=100,minSize:ce=0}=m.constraints,{panelSize:U}=ge(E,m,z);U!=null&&(L&&K&&ue(U,I)?ue(I,V)||F(m,V):U<ce?F(m,ce):U>le&&F(m,le))},[F]),J=c.useCallback((m,S)=>{const{direction:z}=T.current,{layout:E}=R.current;if(!y.current)return;const I=at(m,y.current);O(I,`Drag handle element not found for id "${m}"`);const L=Fn(z,S);P({dragHandleId:m,dragHandleRect:I.getBoundingClientRect(),initialCursorPosition:L,initialLayout:E})},[]),ne=c.useCallback(()=>{P(null)},[]),de=c.useCallback(m=>{const{panelDataArray:S}=R.current,z=Se(S,m);z>=0&&(S.splice(z,1),delete v.current[m.id],R.current.panelDataArrayChanged=!0,p())},[p]),re=c.useMemo(()=>({collapsePanel:k,direction:r,dragState:w,expandPanel:H,getPanelSize:j,getPanelStyle:C,groupId:g,isPanelCollapsed:A,isPanelExpanded:_,reevaluatePanelConstraints:q,registerPanel:$,registerResizeHandle:M,resizePanel:F,startDragging:J,stopDragging:ne,unregisterPanel:de,panelGroupElement:y.current}),[k,w,r,H,j,C,g,A,_,q,$,M,F,J,ne,de]),se={display:"flex",flexDirection:r==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return c.createElement(nt.Provider,{value:re},c.createElement(x,{...b,children:n,className:s,id:o,ref:y,style:{...se,...h},[W.group]:"",[W.groupDirection]:r,[W.groupId]:g}))}const qn=c.forwardRef((e,n)=>c.createElement(Bn,{...e,forwardedRef:n}));Bn.displayName="PanelGroup";qn.displayName="forwardRef(PanelGroup)";function Se(e,n){return e.findIndex(s=>s===n||s.id===n.id)}function ge(e,n,s){const r=Se(e,n),o=r===e.length-1?[r-1,r]:[r,r+1],l=s[r];return{...n.constraints,panelSize:l,pivotIndices:o}}function Yr({disabled:e,handleId:n,resizeHandler:s,panelGroupElement:r}){c.useEffect(()=>{if(e||s==null||r==null)return;const a=at(n,r);if(a==null)return;const o=l=>{if(!l.defaultPrevented)switch(l.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{l.preventDefault(),s(l);break}case"F6":{l.preventDefault();const i=a.getAttribute(W.groupId);O(i,`No group element found for id "${i}"`);const d=Ve(i,r),h=Ln(i,n,r);O(h!==null,`No resize element found for id "${n}"`);const x=l.shiftKey?h>0?h-1:d.length-1:h+1<d.length?h+1:0;d[x].focus();break}}};return a.addEventListener("keydown",o),()=>{a.removeEventListener("keydown",o)}},[r,e,n,s])}function Kn({children:e=null,className:n="",disabled:s=!1,hitAreaMargins:r,id:a,onBlur:o,onClick:l,onDragging:i,onFocus:d,onPointerDown:h,onPointerUp:x,style:b={},tabIndex:g=0,tagName:y="div",...w}){var P,f;const u=c.useRef(null),p=c.useRef({onClick:l,onDragging:i,onPointerDown:h,onPointerUp:x});c.useEffect(()=>{p.current.onClick=l,p.current.onDragging=i,p.current.onPointerDown=h,p.current.onPointerUp=x});const v=c.useContext(nt);if(v===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:N,groupId:D,registerResizeHandle:T,startDragging:R,stopDragging:k,panelGroupElement:H}=v,j=Ot(a),[C,A]=c.useState("inactive"),[_,$]=c.useState(!1),[M,F]=c.useState(null),q=c.useRef({state:C});ye(()=>{q.current.state=C}),c.useEffect(()=>{if(s)F(null);else{const re=T(j);F(()=>re)}},[s,j,T]);const J=(P=r?.coarse)!==null&&P!==void 0?P:15,ne=(f=r?.fine)!==null&&f!==void 0?f:5;c.useEffect(()=>{if(s||M==null)return;const re=u.current;O(re,"Element ref not attached");let se=!1;return Dr(j,re,N,{coarse:J,fine:ne},(S,z,E)=>{if(!z){A("inactive");return}switch(S){case"down":{A("drag"),se=!1,O(E,'Expected event to be defined for "down" action'),R(j,E);const{onDragging:I,onPointerDown:L}=p.current;I?.(!0),L?.();break}case"move":{const{state:I}=q.current;se=!0,I!=="drag"&&A("hover"),O(E,'Expected event to be defined for "move" action'),M(E);break}case"up":{A("hover"),k();const{onClick:I,onDragging:L,onPointerUp:V}=p.current;L?.(!1),V?.(),se||I?.();break}}})},[J,N,s,ne,T,j,M,R,k]),Yr({disabled:s,handleId:j,resizeHandler:M,panelGroupElement:H});const de={touchAction:"none",userSelect:"none"};return c.createElement(y,{...w,children:e,className:n,id:a,onBlur:()=>{$(!1),o?.()},onFocus:()=>{$(!0),d?.()},ref:u,role:"separator",style:{...de,...b},tabIndex:g,[W.groupDirection]:N,[W.groupId]:D,[W.resizeHandle]:"",[W.resizeHandleActive]:C==="drag"?"pointer":_?"keyboard":void 0,[W.resizeHandleEnabled]:!s,[W.resizeHandleId]:j,[W.resizeHandleState]:C})}Kn.displayName="PanelResizeHandle";const Qr=({className:e,...n})=>t.jsx(qn,{className:oe("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",e),...n}),sn=En,Xr=({withHandle:e,className:n,...s})=>t.jsx(Kn,{className:oe("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",n),...s,children:e&&t.jsx("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:t.jsx(Es,{className:"h-2.5 w-2.5"})})}),Un=[{id:"ebp",name:"EBP",path:"School/Evidence Based Practice"},{id:"exphys",name:"ExPhys",path:"School/Exercise Physiology"},{id:"ms1",name:"MS1",path:"School/Movement Science 1"},{id:"neuro",name:"Neuro",path:"School/Neuroscience"},{id:"ti",name:"TI",path:"School/Therapeutic Intervention"}];function Zr(){return Un.map(e=>e.path)}function ea(e,n){try{const s=localStorage.getItem(e);if(s!==null)return JSON.parse(s)}catch{}return n}function ta(e,n){try{localStorage.setItem(e,JSON.stringify(n))}catch{}}function na(){const[e,n]=c.useState(()=>ea("brain-main-mode","edit")),[s,r]=c.useState(null),[a,o]=c.useState(""),[l,i]=c.useState(!1),[d,h]=c.useState(!1),[x,b]=c.useState(!1),[g,y]=c.useState(!1),w=c.useCallback(j=>{n(j),ta("brain-main-mode",j)},[]),{data:P}=Y({queryKey:["obsidian","status"],queryFn:G.obsidian.getStatus,refetchInterval:3e4}),{data:f}=Y({queryKey:["obsidian","config"],queryFn:G.obsidian.getConfig}),{data:u}=Y({queryKey:["obsidian","vault-index"],queryFn:()=>G.obsidian.getVaultIndex(),enabled:P?.connected===!0}),{data:p}=Y({queryKey:["anki","status"],queryFn:G.anki.getStatus,refetchInterval:3e4}),{data:v}=Y({queryKey:["brain","metrics"],queryFn:G.brain.getMetrics}),{data:N=[]}=Y({queryKey:["anki","drafts"],queryFn:G.anki.getDrafts}),D=N.filter(j=>j.status==="pending"),T=c.useCallback(async j=>{try{const C=await G.obsidian.getFile(j);C.success&&C.content!==void 0&&(r(j),o(C.content),i(!1),h(!1))}catch(C){console.error("Failed to load file:",C)}},[]),R=c.useCallback(async()=>{if(s){b(!0);try{(await G.obsidian.saveFile(s,a)).success&&i(!1)}catch(j){console.error("Failed to save file:",j)}finally{b(!1)}}},[s,a]),k=c.useCallback(j=>{o(j),i(!0)},[]),H=c.useCallback(async(j,C)=>{if(C){const _=f?.vaultName||"Treys School";window.open(`obsidian://open?vault=${encodeURIComponent(_)}&file=${encodeURIComponent(j)}`,"_blank");return}const A=u?.paths?.[j];if(A){await T(A),h(!0);return}for(const _ of Zr())try{const $=await G.obsidian.getFile(`${_}/${j}.md`);if($.success&&$.content!==void 0){r(`${_}/${j}.md`),o($.content),i(!1),h(!0);return}}catch{}console.warn(`Note not found: ${j}`)},[f,u,T]);return{mainMode:e,setMainMode:w,currentFile:s,setCurrentFile:r,fileContent:a,setFileContent:k,hasChanges:l,setHasChanges:i,previewMode:d,setPreviewMode:h,isSaving:x,openFile:T,saveFile:R,importOpen:g,setImportOpen:y,handleWikilinkClick:H,obsidianStatus:P,obsidianConfig:f,vaultIndex:u,ankiStatus:p,metrics:v,ankiDrafts:N,pendingDrafts:D}}const rn=[{id:"study",label:"Study",tab:null,section:null},{id:"wrap",label:"Wrap",tab:null,section:null},{id:"generate",label:"Generate JSON",tab:null,section:null},{id:"attach",label:"Attach JSON",tab:null,section:null},{id:"planner",label:"Planner",tab:null,section:null},{id:"actions",label:"Actions",tab:null,section:null}];function sa({workspace:e}){const[n,s]=c.useState(!1),{data:r=[]}=Y({queryKey:["sessions"],queryFn:G.sessions.getAll}),{data:a=[]}=Y({queryKey:["planner-queue"],queryFn:G.planner.getQueue}),o=new Date,l=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")}`,i=y=>{const w=typeof y=="string"?new Date(y):y;return`${w.getFullYear()}-${String(w.getMonth()+1).padStart(2,"0")}-${String(w.getDate()).padStart(2,"0")}`===l},d=r.some(y=>i(y.date)),h=a.length>0,x=r.some(y=>i(y.date)&&y.cards>0),b={study:d,wrap:d,generate:x,attach:x,planner:h,actions:h},g=c.useCallback(y=>{y.preventDefault(),s(!1),Array.from(y.dataTransfer.files).length>0&&e.setImportOpen(!0)},[e]);return t.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 border-b-2 border-primary/50 bg-black/60 flex-wrap ${n?"ring-2 ring-primary":""}`,onDragOver:y=>{y.preventDefault(),s(!0)},onDragLeave:()=>s(!1),onDrop:g,children:[t.jsx("div",{role:"list","aria-label":"Study flow",className:"flex items-center gap-0.5 mr-2",children:rn.map((y,w)=>{const P=b[y.id]??!1;return t.jsxs("div",{className:"flex items-center gap-0.5",role:"listitem",children:[t.jsxs("span",{className:`flex items-center gap-0.5 px-1.5 py-0.5 text-xs font-terminal ${P?"text-success":"text-muted-foreground"}`,title:y.label,"aria-label":`${y.label}: ${P?"done":"pending"}`,children:[P?t.jsx(zs,{className:"w-3 h-3","aria-hidden":"true"}):t.jsx(wn,{className:"w-3 h-3","aria-hidden":"true"}),t.jsx("span",{className:"hidden xl:inline",children:y.label})]}),w<rn.length-1&&t.jsx(Ts,{className:"w-2 h-2 text-muted-foreground/50","aria-hidden":"true"})]},y.id)})}),t.jsx("div",{className:"w-px h-5 bg-primary/30"}),t.jsxs(B,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none font-terminal text-xs border-primary/50",onClick:()=>e.setImportOpen(!0),children:[t.jsx($t,{className:"w-3 h-3 mr-1"}),"Import"]}),t.jsxs("div",{className:"flex items-center gap-3 ml-auto font-terminal text-xs",role:"status","aria-label":"Connection status",children:[t.jsxs("span",{className:"flex items-center gap-1","aria-label":e.obsidianStatus?.connected?"Obsidian: connected":"Obsidian: disconnected",children:[t.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${e.obsidianStatus?.connected?"bg-success":"bg-destructive"}`,"aria-hidden":"true"}),t.jsx("span",{className:"text-muted-foreground",children:"Obsidian"})]}),t.jsxs("span",{className:"flex items-center gap-1","aria-label":e.ankiStatus?.connected?"Anki: connected":"Anki: disconnected",children:[t.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${e.ankiStatus?.connected?"bg-success":"bg-destructive"}`,"aria-hidden":"true"}),t.jsx("span",{className:"text-muted-foreground",children:"Anki"})]}),e.pendingDrafts.length>0&&t.jsxs(We,{variant:"outline",className:"h-5 px-1.5 text-xs rounded-none border-secondary/50 text-secondary",children:[e.pendingDrafts.length," drafts"]})]})]})}class ke extends c.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null},this.reset=()=>{this.setState({hasError:!1,error:null})}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,s){console.error("ErrorBoundary caught error:",n,s),this.props.onError?.(n,s)}componentDidUpdate(n){this.state.hasError&&this.props.resetKeys&&this.props.resetKeys.some((r,a)=>r!==n.resetKeys?.[a])&&this.reset()}render(){return this.state.hasError?this.props.fallback?this.props.fallback:t.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center",children:[t.jsx(Tt,{className:"w-10 h-10 text-destructive mb-3"}),t.jsx("h3",{className:"font-arcade text-sm text-destructive mb-2",children:"COMPONENT ERROR"}),t.jsx("p",{className:"font-terminal text-xs text-muted-foreground mb-4 max-w-xs",children:this.state.error?.message||"Something went wrong"}),t.jsxs(B,{variant:"outline",size:"sm",onClick:this.reset,className:"rounded-none font-terminal text-xs",children:[t.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Try Again"]})]}):this.props.children}}function ra({onReset:e}){return t.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center",children:[t.jsx(Tt,{className:"w-8 h-8 text-destructive mb-2"}),t.jsx("p",{className:"font-terminal text-xs text-destructive mb-2",children:"Sidebar Error"}),t.jsxs(B,{variant:"ghost",size:"sm",onClick:e,className:"rounded-none font-terminal text-xs h-6",children:[t.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Retry"]})]})}function $e({tabName:e,onReset:n}){return t.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center",children:[t.jsx(Tt,{className:"w-10 h-10 text-destructive mb-3"}),t.jsxs("h3",{className:"font-arcade text-sm text-destructive mb-2",children:[e," TAB ERROR"]}),t.jsxs("p",{className:"font-terminal text-xs text-muted-foreground mb-4",children:["Failed to load ",e.toLowerCase()," view"]}),t.jsxs(B,{variant:"outline",size:"sm",onClick:n,className:"rounded-none font-terminal text-xs",children:[t.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Reload Tab"]})]})}const aa=12,oa=16;function Wn({name:e,isFolder:n,isExpanded:s,isActive:r,depth:a,onClick:o}){return t.jsxs("button",{type:"button",onClick:o,className:`w-full flex items-center gap-2 py-2 font-terminal text-sm text-left transition-colors focus:outline-none focus-visible:ring-1 focus-visible:ring-primary/50 focus-visible:ring-inset min-h-[36px] ${r?"bg-primary/15 text-primary border-l-2 border-primary/60":"border-l-2 border-transparent hover:bg-primary/10 text-foreground"}`,style:{paddingLeft:`${aa+a*oa}px`},children:[n?t.jsxs(t.Fragment,{children:[s?t.jsx(_s,{className:"w-3.5 h-3.5 text-muted-foreground shrink-0","aria-hidden":"true"}):t.jsx(Bs,{className:"w-3.5 h-3.5 text-muted-foreground shrink-0","aria-hidden":"true"}),t.jsx(ur,{className:"w-4 h-4 text-yellow-500 shrink-0","aria-hidden":"true"})]}):t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"w-3.5 shrink-0"}),t.jsx(cr,{className:"w-4 h-4 text-blue-400 shrink-0","aria-hidden":"true"})]}),t.jsx("span",{className:"truncate min-w-0",children:e})]})}function Jn({folderPath:e,depth:n,expandedFolders:s,toggleFolder:r,workspace:a,connected:o}){const{data:l}=Y({queryKey:["obsidian","files",e],queryFn:()=>G.obsidian.getFiles(e),enabled:o}),i=l?.files||[];return t.jsx(t.Fragment,{children:i.map(d=>{const h=typeof d=="string"?d:d.path,x=h.endsWith("/"),b=h.replace(/\/$/,"").split("/").pop()||h,g=`${e}/${b}`,y=s.has(g);return t.jsxs("div",{children:[t.jsx(Wn,{name:b,isFolder:x,isExpanded:y,isActive:a.currentFile?.endsWith(b)||!1,depth:n,onClick:()=>{x?r(g):a.openFile(g)}}),x&&y&&t.jsx(Jn,{folderPath:g,depth:n+1,expandedFolders:s,toggleFolder:r,workspace:a,connected:o})]},h)})})}function an({workspace:e}){const[n,s]=c.useState("School"),[r,a]=c.useState(""),[o,l]=c.useState(new Set),[i,d]=c.useState(0),h=e.obsidianStatus?.connected===!0,{data:x}=Y({queryKey:["obsidian","files",n],queryFn:()=>G.obsidian.getFiles(n),enabled:h}),b=c.useCallback(p=>{s(p),l(new Set)},[]),g=c.useCallback(()=>{const p=n.split("/");p.pop(),b(p.join("/"))},[n,b]),y=c.useCallback(p=>{l(v=>{const N=new Set(v);return N.has(p)?N.delete(p):N.add(p),N})},[]),w=c.useCallback(()=>{const p=new Date().toISOString().split("T")[0],v=n?`${n}/Session-${p}.md`:`Session-${p}.md`,N=`# Study Session - ${p}

## Summary


## Concepts Covered
- 

## Notes

`;e.setCurrentFile(v),e.setFileContent(N),e.setHasChanges(!0)},[n,e]),P=c.useMemo(()=>{const p=x?.files||[];if(!r.trim())return p;const v=r.toLowerCase();return p.filter(N=>(typeof N=="string"?N:N.path).toLowerCase().includes(v))},[x,r]),f=n.includes("/"),u=c.useMemo(()=>n?n.split("/"):[],[n]);return h?t.jsxs("div",{className:"flex flex-col h-full min-h-0 overflow-hidden",children:[t.jsx("div",{className:"section-block border-primary/30",children:t.jsx("h2",{className:"section-header",children:"Vault"})}),t.jsxs("div",{className:"section-block section-block-gap",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Os,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none","aria-hidden":"true"}),t.jsx(Ce,{value:r,onChange:p=>a(p.target.value),placeholder:"Search filesâ€¦",className:"h-9 pl-9 pr-3 text-sm font-terminal rounded-none border border-primary/20 bg-black/40 placeholder:text-muted-foreground/80 focus-visible:ring-1 focus-visible:ring-primary/60 focus-visible:border-primary/40","aria-label":"Search files"})]}),t.jsxs(B,{size:"sm",variant:"ghost",className:"w-full h-9 text-sm font-terminal rounded-none border border-primary/20 bg-black/30 text-foreground hover:bg-primary/10 hover:border-primary/40 hover:text-primary justify-start gap-2",onClick:w,children:[t.jsx(Mt,{className:"w-4 h-4 shrink-0","aria-hidden":"true"}),"New Note"]})]}),t.jsxs("div",{className:"section-block section-block-gap",children:[t.jsx("h3",{className:"section-header",children:"Courses"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:Un.map(p=>{const v=n===p.path;return t.jsx("button",{type:"button",onClick:()=>b(p.path),className:`min-h-[36px] px-3 py-2 font-terminal text-sm rounded-none border transition-colors focus:outline-none focus-visible:ring-1 focus-visible:ring-primary/50 focus-visible:ring-offset-1 focus-visible:ring-offset-black ${v?"bg-primary/20 text-primary border-primary/50":"border-primary/20 bg-black/30 text-muted-foreground hover:bg-black/50 hover:border-primary/40 hover:text-foreground"}`,"aria-pressed":v,children:p.name},p.path)})})]}),n&&t.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 font-terminal text-sm border-b border-primary/20 shrink-0 min-h-[40px]",children:[f&&t.jsx("button",{type:"button",onClick:g,className:"size-8 flex items-center justify-center rounded-sm hover:bg-primary/20 hover:text-primary focus:outline-none focus-visible:ring-1 focus-visible:ring-primary shrink-0",title:"Go to parent folder","aria-label":"Go to parent folder",children:t.jsx(As,{className:"w-4 h-4","aria-hidden":"true"})}),t.jsx("nav",{"aria-label":"Folder breadcrumb",className:"flex items-center gap-1 flex-wrap text-muted-foreground min-w-0",children:u.map((p,v,N)=>t.jsxs("span",{className:"flex items-center gap-1",children:[v>0&&t.jsx("span",{"aria-hidden":"true",children:"/"}),t.jsx("button",{type:"button",onClick:()=>b(N.slice(0,v+1).join("/")),className:"hover:text-primary focus:outline-none focus-visible:ring-1 focus-visible:ring-primary focus-visible:ring-inset rounded-sm px-1 py-0.5 min-h-[28px] flex items-center",children:p})]},v))})]}),t.jsxs("div",{className:"flex-1 min-h-0 flex flex-col",children:[t.jsx("div",{className:"shrink-0 px-3 py-2 border-b border-primary/20",children:t.jsx("span",{className:"section-header text-primary/90",children:"Files"})}),t.jsx(ke,{fallback:t.jsx(ra,{onReset:()=>d(p=>p+1)}),children:t.jsx(_e,{className:"flex-1 min-h-0",children:t.jsx("div",{className:"py-2",children:P.map(p=>{const v=typeof p=="string"?p:p.path,N=v.endsWith("/"),D=v.replace(/\/$/,"").split("/").pop()||v,T=n?`${n}/${D}`:D,R=o.has(T),k=e.currentFile?.endsWith(D)||!1;return t.jsxs("div",{children:[t.jsx(Wn,{name:D,isFolder:N,isExpanded:R,isActive:k,depth:0,onClick:()=>{N?y(T):e.openFile(T)}}),N&&R&&t.jsx(Jn,{folderPath:T,depth:1,expandedFolders:o,toggleFolder:y,workspace:e,connected:h})]},v)})})})},`filetree-${i}`)]})]}):t.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[t.jsx("div",{className:"section-block border-primary/30",children:t.jsx("h2",{className:"section-header",children:"Vault"})}),t.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-3 py-6 border border-primary/30 bg-black/30 m-3",children:[t.jsx(jn,{className:"w-8 h-8 text-primary/80 mb-3","aria-hidden":"true"}),t.jsx("p",{className:"font-arcade text-sm text-primary/90 text-center",children:"Obsidian offline"}),t.jsx("p",{className:"font-terminal text-sm text-muted-foreground text-center mt-2",children:"Open Obsidian with Local REST API enabled"})]})]})}const ia=`Generate Anki flashcards from the following study material. Output ONLY a numbered list in this exact format:

1. Front: [question]
Back: [answer]
Tags: [comma-separated tags like: Module1, Obj2, TopicName]

Rules:
- Front = the question only (no module/objective prefixes)
- Back = concise answer
- Tags = include Module#, Obj#, and topic keywords
- One card per concept
- No extra text before or after the list

Study material:
[PASTE YOUR NOTES HERE]`;function on(e,n){if(n.length===0)return e;const s=[];for(const r of n)s.push({type:"image_url",image_url:{url:r}});return e.trim()&&s.push({type:"text",text:e}),s}function la({mode:e,setMode:n,ingestTarget:s,setIngestTarget:r,promptCopied:a,setPromptCopied:o}){const l=()=>{navigator.clipboard.writeText(ia),o(!0),setTimeout(()=>o(!1),2e3)};return t.jsxs("div",{className:"px-3 py-1 border-b border-primary/30 flex items-center justify-between gap-2 shrink-0",children:[t.jsxs("div",{className:"flex bg-black/40 border border-primary/40 rounded-none overflow-hidden mr-2",children:[t.jsxs("button",{onClick:()=>n("chat"),className:`flex items-center gap-1 px-2 py-0.5 text-xs font-arcade transition-colors ${e==="chat"?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,children:[t.jsx(Nn,{className:"w-3 h-3"})," CHAT"]}),t.jsxs("button",{onClick:()=>n("ingest"),className:`flex items-center gap-1 px-2 py-0.5 text-xs font-arcade transition-colors ${e==="ingest"?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,children:[t.jsx(tr,{className:"w-3 h-3"})," INGEST"]})]}),t.jsx("p",{className:"text-xs text-muted-foreground truncate flex-1",children:e==="chat"?"Chat with Gemini Flash":"Paste notes to create cards & save sessions"}),e==="ingest"&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex bg-black/40 border border-primary/40 rounded-none overflow-hidden shrink-0",children:["anki","obsidian","both"].map(i=>t.jsxs("button",{onClick:()=>r(i),className:`flex items-center gap-1 px-2 py-0.5 text-xs font-arcade transition-colors ${s===i?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,children:[i==="anki"&&t.jsxs(t.Fragment,{children:[t.jsx(Fe,{className:"w-3 h-3"})," ANKI"]}),i==="obsidian"&&t.jsxs(t.Fragment,{children:[t.jsx(wt,{className:"w-3 h-3"})," OBSIDIAN"]}),i==="both"&&t.jsx(t.Fragment,{children:"BOTH"})]},i))}),t.jsx("button",{type:"button",className:"bg-primary hover:bg-primary/80 px-2 py-0.5 rounded-none text-xs font-terminal shrink-0",onClick:l,children:a?"Copied!":"Copy Prompt"})]})]})}function ca({messages:e,loading:n,mode:s,scrollRef:r}){const a=c.useCallback(()=>{r.current&&(r.current.scrollTop=r.current.scrollHeight)},[r]);return c.useEffect(()=>{a()},[e,a]),t.jsxs("div",{ref:r,className:"flex-1 overflow-y-auto px-4 py-2 space-y-3",children:[e.length===0&&t.jsx("p",{className:"text-muted-foreground text-sm font-terminal text-center py-8",children:s==="chat"?"Ask anything. Paste screenshots with Ctrl+V.":"Paste your study notes to ingest into Brain."}),e.map((o,l)=>t.jsx("div",{className:`flex ${o.role==="user"?"justify-end":"justify-start"}`,children:t.jsxs("div",{className:`max-w-[80%] rounded-none px-3 py-2 text-sm font-terminal whitespace-pre-wrap ${o.role==="user"?"bg-primary/20 text-foreground border border-primary/30":"bg-secondary/40 text-foreground border border-secondary/60"}`,children:[o.images?.map((i,d)=>t.jsx("img",{src:i,alt:"attached",className:"max-h-32 rounded-none mb-1"},d)),o.content]})},l)),n&&t.jsx("div",{className:"flex justify-start",children:t.jsx("div",{className:"bg-secondary/40 border border-secondary/60 rounded-none px-3 py-2",children:t.jsx(Dt,{className:"w-4 h-4 animate-spin text-primary"})})})]})}function da({images:e,onRemove:n}){return e.length===0?null:t.jsx("div",{className:"px-4 py-1 flex gap-2 flex-wrap shrink-0",children:e.map((s,r)=>t.jsxs("div",{className:"relative",children:[t.jsx("img",{src:s,alt:"pending",className:"h-12 rounded-none border border-primary/30"}),t.jsx("button",{onClick:()=>n(r),className:"absolute -top-1 -right-1 bg-destructive rounded-none p-0.5","aria-label":"Remove image",children:t.jsx(vt,{className:"w-3 h-3"})})]},r))})}function ua({input:e,setInput:n,onSend:s,onImageSelect:r,onPaste:a,loading:o,mode:l}){const i=c.useRef(null),d=x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),s())},h=x=>{const b=x.target.files;b&&(r(b),x.target.value="")};return t.jsxs("div",{className:"flex items-end gap-2 px-4 py-2 border-t border-primary/30 shrink-0",children:[t.jsx("input",{ref:i,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:h}),l==="chat"&&t.jsx(B,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 shrink-0",onClick:()=>i.current?.click(),"aria-label":"Attach image",children:t.jsx(fr,{className:"w-4 h-4 text-primary"})}),t.jsx("textarea",{value:e,onChange:x=>n(x.target.value),onKeyDown:d,onPaste:a,placeholder:l==="chat"?"Ask anything... (Ctrl+V to paste images)":"Paste study notes to ingest...",rows:l==="ingest"?3:1,className:"flex-1 bg-black/60 border-2 border-muted-foreground/20 rounded-none px-3 py-1.5 text-sm font-terminal resize-none focus:outline-none focus:ring-1 focus:ring-ring"}),t.jsx(B,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 shrink-0",onClick:s,disabled:o,"aria-label":"Send message",children:t.jsx(Qs,{className:"w-4 h-4 text-primary"})})]})}function Nt(e,n,{checkForDefaultPrevented:s=!0}={}){return function(a){if(e?.(a),s===!1||!a.defaultPrevented)return n?.(a)}}var ma=yn[" useInsertionEffect ".trim().toString()]||Ss;function fa({prop:e,defaultProp:n,onChange:s=()=>{},caller:r}){const[a,o,l]=ha({defaultProp:n,onChange:s}),i=e!==void 0,d=i?e:a;{const x=c.useRef(e!==void 0);c.useEffect(()=>{const b=x.current;b!==i&&console.warn(`${r} is changing from ${b?"controlled":"uncontrolled"} to ${i?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),x.current=i},[i,r])}const h=c.useCallback(x=>{if(i){const b=pa(x)?x(e):x;b!==e&&l.current?.(b)}else o(x)},[i,e,o,l]);return[d,h]}function ha({defaultProp:e,onChange:n}){const[s,r]=c.useState(e),a=c.useRef(s),o=c.useRef(n);return ma(()=>{o.current=n},[n]),c.useEffect(()=>{a.current!==s&&(o.current?.(s),a.current=s)},[s,a]),[s,r,o]}function pa(e){return typeof e=="function"}var Ht="Radio",[xa,Yn]=vn(Ht),[ga,ba]=xa(Ht),Qn=c.forwardRef((e,n)=>{const{__scopeRadio:s,name:r,checked:a=!1,required:o,disabled:l,value:i="on",onCheck:d,form:h,...x}=e,[b,g]=c.useState(null),y=kt(n,f=>g(f)),w=c.useRef(!1),P=b?h||!!b.closest("form"):!0;return t.jsxs(ga,{scope:s,checked:a,disabled:l,children:[t.jsx(Ze.button,{type:"button",role:"radio","aria-checked":a,"data-state":ts(a),"data-disabled":l?"":void 0,disabled:l,value:i,...x,ref:y,onClick:Nt(e.onClick,f=>{a||d?.(),P&&(w.current=f.isPropagationStopped(),w.current||f.stopPropagation())})}),P&&t.jsx(es,{control:b,bubbles:!w.current,name:r,value:i,checked:a,required:o,disabled:l,form:h,style:{transform:"translateX(-100%)"}})]})});Qn.displayName=Ht;var Xn="RadioIndicator",Zn=c.forwardRef((e,n)=>{const{__scopeRadio:s,forceMount:r,...a}=e,o=ba(Xn,s);return t.jsx(ks,{present:r||o.checked,children:t.jsx(Ze.span,{"data-state":ts(o.checked),"data-disabled":o.disabled?"":void 0,...a,ref:n})})});Zn.displayName=Xn;var ya="RadioBubbleInput",es=c.forwardRef(({__scopeRadio:e,control:n,checked:s,bubbles:r=!0,...a},o)=>{const l=c.useRef(null),i=kt(l,o),d=qs(s),h=Cs(n);return c.useEffect(()=>{const x=l.current;if(!x)return;const b=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(b,"checked").set;if(d!==s&&y){const w=new Event("click",{bubbles:r});y.call(x,s),x.dispatchEvent(w)}},[d,s,r]),t.jsx(Ze.input,{type:"radio","aria-hidden":!0,defaultChecked:s,...a,tabIndex:-1,ref:i,style:{...a.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});es.displayName=ya;function ts(e){return e?"checked":"unchecked"}var va=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ot="RadioGroup",[wa]=vn(ot,[Sn,Yn]),ns=Sn(),ss=Yn(),[ja,Na]=wa(ot),rs=c.forwardRef((e,n)=>{const{__scopeRadioGroup:s,name:r,defaultValue:a,value:o,required:l=!1,disabled:i=!1,orientation:d,dir:h,loop:x=!0,onValueChange:b,...g}=e,y=ns(s),w=Ps(h),[P,f]=fa({prop:o,defaultProp:a??null,onChange:b,caller:ot});return t.jsx(ja,{scope:s,name:r,required:l,disabled:i,value:P,onValueChange:f,children:t.jsx(Ks,{asChild:!0,...y,orientation:d,dir:w,loop:x,children:t.jsx(Ze.div,{role:"radiogroup","aria-required":l,"aria-orientation":d,"data-disabled":i?"":void 0,dir:w,...g,ref:n})})})});rs.displayName=ot;var as="RadioGroupItem",os=c.forwardRef((e,n)=>{const{__scopeRadioGroup:s,disabled:r,...a}=e,o=Na(as,s),l=o.disabled||r,i=ns(s),d=ss(s),h=c.useRef(null),x=kt(n,h),b=o.value===a.value,g=c.useRef(!1);return c.useEffect(()=>{const y=P=>{va.includes(P.key)&&(g.current=!0)},w=()=>g.current=!1;return document.addEventListener("keydown",y),document.addEventListener("keyup",w),()=>{document.removeEventListener("keydown",y),document.removeEventListener("keyup",w)}},[]),t.jsx(Us,{asChild:!0,...i,focusable:!l,active:b,children:t.jsx(Qn,{disabled:l,required:o.required,checked:b,...d,...a,name:o.name,ref:x,onCheck:()=>o.onValueChange(a.value),onKeyDown:Nt(y=>{y.key==="Enter"&&y.preventDefault()}),onFocus:Nt(a.onFocus,()=>{g.current&&h.current?.click()})})})});os.displayName=as;var Sa="RadioGroupIndicator",is=c.forwardRef((e,n)=>{const{__scopeRadioGroup:s,...r}=e,a=ss(s);return t.jsx(Zn,{...a,...r,ref:n})});is.displayName=Sa;var ls=rs,cs=os,ka=is;const ds=c.forwardRef(({className:e,...n},s)=>t.jsx(ls,{className:oe("grid gap-2",e),...n,ref:s}));ds.displayName=ls.displayName;const us=c.forwardRef(({className:e,...n},s)=>t.jsx(cs,{ref:s,className:oe("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),...n,children:t.jsx(ka,{className:"flex items-center justify-center",children:t.jsx(wn,{className:"h-3.5 w-3.5 fill-primary"})})}));us.displayName=cs.displayName;const Ca=/(\[\[.*?\]\])/g,Ea=/!\[\[(.*?)\]\]/g,Pa=[".png",".jpg",".jpeg",".gif",".svg",".webp",".bmp"],Ra=/^\[!([\w-]+)\]\s*(.*)?$/,ln=Xs;function gt(e,n){return e.split(Ca).map((s,r)=>{const a=s.match(/^\[\[(.*?)\]\]$/);if(a){const o=a[1].includes("|")?a[1].split("|")[1]:a[1],l=a[1].includes("|")?a[1].split("|")[0]:a[1];return t.jsx("span",{className:"text-blue-400 hover:text-blue-300 cursor-pointer underline decoration-dotted",onClick:i=>n?.(l,i.shiftKey),title:`${l} (Shift+click for Obsidian app)`,children:o},r)}return t.jsx("span",{children:s},r)})}function Ia(e){return e.replace(Ea,(n,s)=>{const r=s.toLowerCase();return Pa.some(o=>r.endsWith(o))?`![${s}](/api/obsidian/vault-file/${encodeURIComponent(s)})`:`[[${s}]]`})}function za(e){const n=e.split(`
`),s=[];let r=!1,a="",o="",l=[];const i=()=>{if(!r)return;const d=ln[a.toLowerCase()]||ln.note,h=o||a.charAt(0).toUpperCase()+a.slice(1);s.push(`<div class="callout ${d} border-l-4 rounded px-3 py-2 my-2">`),s.push(`<div class="font-bold text-xs uppercase tracking-wider mb-1">${h}</div>`),s.push(""),s.push(l.join(`
`)),s.push(""),s.push("</div>"),r=!1,l=[]};for(const d of n){if(d.startsWith("> ")){const h=d.slice(2),x=h.match(Ra);if(x&&!r){r=!0,a=x[1],o=x[2]||"";continue}if(r){l.push(h);continue}}else if(d===">"&&r){l.push("");continue}else i();s.push(d)}return i(),s.join(`
`)}function ms({content:e,onWikilinkClick:n}){const s=za(Ia(e)),r={h1:({children:a})=>t.jsx("h1",{className:"text-xl font-bold text-primary border-b border-primary/30 pb-1 mb-3 mt-4",children:a}),h2:({children:a})=>t.jsx("h2",{className:"text-lg font-bold text-primary/90 border-b border-primary/20 pb-1 mb-2 mt-3",children:a}),h3:({children:a})=>t.jsx("h3",{className:"text-base font-semibold text-primary/80 mb-2 mt-3",children:a}),h4:({children:a})=>t.jsx("h4",{className:"text-sm font-semibold text-primary/70 mb-1 mt-2",children:a}),p:({children:a})=>typeof a=="string"?t.jsx("p",{className:"mb-2 leading-relaxed",children:gt(a,n)}):t.jsx("p",{className:"mb-2 leading-relaxed",children:a}),strong:({children:a})=>t.jsx("strong",{className:"font-bold text-foreground",children:a}),em:({children:a})=>t.jsx("em",{className:"italic text-foreground/90",children:a}),ul:({children:a})=>t.jsx("ul",{className:"list-disc list-inside mb-2 space-y-0.5 ml-2",children:a}),ol:({children:a})=>t.jsx("ol",{className:"list-decimal list-inside mb-2 space-y-0.5 ml-2",children:a}),li:({children:a})=>typeof a=="string"?t.jsx("li",{className:"leading-relaxed",children:gt(a,n)}):t.jsx("li",{className:"leading-relaxed",children:a}),blockquote:({children:a})=>t.jsx("blockquote",{className:"border-l-4 border-primary/30 pl-3 my-2 text-muted-foreground italic",children:a}),code:({children:a,className:o})=>o?.startsWith("language-")?t.jsx("code",{className:"block bg-black/80 border border-secondary/40 rounded p-3 my-2 text-xs font-mono overflow-x-auto whitespace-pre",children:a}):t.jsx("code",{className:"bg-secondary/40 px-1.5 py-0.5 rounded text-xs font-mono text-primary",children:a}),pre:({children:a})=>t.jsx("pre",{className:"my-2",children:a}),hr:()=>t.jsx("hr",{className:"border-primary/20 my-4"}),a:({href:a,children:o})=>t.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:o}),table:({children:a})=>t.jsx("div",{className:"overflow-x-auto my-2",children:t.jsx("table",{className:"w-full text-xs border-collapse border border-secondary/40",children:a})}),th:({children:a})=>t.jsx("th",{className:"border border-secondary/40 bg-secondary/20 px-2 py-1 text-left font-semibold",children:a}),td:({children:a})=>typeof a=="string"?t.jsx("td",{className:"border border-secondary/40 px-2 py-1",children:gt(a,n)}):t.jsx("td",{className:"border border-secondary/40 px-2 py-1",children:a}),img:({src:a,alt:o})=>t.jsx("img",{src:a,alt:o||"",className:"max-w-full rounded border border-secondary/40 my-2",loading:"lazy"}),del:({children:a})=>t.jsx("del",{className:"line-through text-muted-foreground",children:a}),input:({checked:a,...o})=>t.jsx("input",{type:"checkbox",checked:a,readOnly:!0,className:"mr-1.5 accent-primary",...o})};return t.jsx("div",{className:"obsidian-preview prose-invert max-w-none text-sm leading-relaxed",children:t.jsx(Ds,{remarkPlugins:[$s],components:r,allowedElements:void 0,unwrapDisallowed:!1,children:s})})}function Aa({line:e,index:n}){const s=e.startsWith("+"),r=e.startsWith("-");return t.jsx("div",{className:`font-terminal text-[11px] px-2 ${s?"bg-green-900/30 text-green-400":r?"bg-red-900/30 text-red-400":"text-muted-foreground"}`,children:e})}function Ta({open:e,onOpenChange:n,loading:s,error:r,rawNotes:a,organized:o,destination:l,selectedDestinationId:i,setSelectedDestinationId:d,customDestination:h,setCustomDestination:x,checklistState:b,onToggleChecklist:g,diffLines:y,onConfirm:w,onCancel:P}){const f=Object.values(b).length===0?!0:Object.values(b).every(Boolean),p=l?i==="custom"?h.trim():l.options.find(N=>N.id===i)?.path||"":"";return t.jsx(Et,{open:e,onOpenChange:n,children:t.jsxs(Pt,{className:"max-w-6xl w-full h-[85vh] bg-black border-2 border-primary rounded-none p-4 overflow-hidden",children:[t.jsxs(Rt,{className:"space-y-1",children:[t.jsxs(It,{className:"font-arcade text-sm text-primary flex items-center gap-2",children:[t.jsx(Mt,{className:"w-4 h-4"}),"ORGANIZE + REVIEW"]}),t.jsx(zt,{className:"font-terminal text-[11px] text-muted-foreground",children:"Review the organized notes, compare to raw, then choose where to save."})]}),r&&t.jsx("div",{className:"border border-red-500/50 bg-red-900/20 text-red-200 font-terminal text-xs p-2 rounded-none",children:r}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 h-[70vh]",children:[t.jsx("div",{className:"col-span-2 flex flex-col gap-3",children:t.jsxs(Ws,{defaultValue:"preview",className:"w-full",children:[t.jsxs(Js,{className:"grid grid-cols-3 rounded-none",children:[t.jsx(dt,{value:"preview",className:"rounded-none text-xs",children:"Preview"}),t.jsx(dt,{value:"raw",className:"rounded-none text-xs",children:"Raw"}),t.jsx(dt,{value:"diff",className:"rounded-none text-xs",children:"Diff"})]}),t.jsx(ut,{value:"preview",className:"mt-2",children:t.jsx(_e,{className:"h-[56vh] border border-secondary/40 rounded-none bg-black/40 p-3",children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"font-arcade text-xs text-primary",children:o?.title||"Untitled"}),t.jsx(ms,{content:o?.markdown||""})]})})}),t.jsx(ut,{value:"raw",className:"mt-2",children:t.jsx(_e,{className:"h-[56vh] border border-secondary/40 rounded-none bg-black/40 p-3",children:t.jsx("pre",{className:"whitespace-pre-wrap font-terminal text-[11px] text-foreground",children:a})})}),t.jsx(ut,{value:"diff",className:"mt-2",children:t.jsx(_e,{className:"h-[56vh] border border-secondary/40 rounded-none bg-black/40 p-0",children:t.jsx("div",{className:"p-2",children:y.length===0?t.jsx("div",{className:"text-muted-foreground font-terminal text-xs",children:"No diff available."}):y.map((v,N)=>t.jsx(Aa,{line:v,index:N},N))})})})]})}),t.jsxs("div",{className:"col-span-1 flex flex-col gap-3",children:[t.jsxs("div",{className:"border border-secondary/50 bg-black/40 p-3 rounded-none",children:[t.jsx("div",{className:"font-arcade text-[10px] text-primary mb-2",children:"DESTINATION"}),t.jsx(ds,{value:i,onValueChange:d,className:"space-y-2",children:(l?.options||[]).map(v=>t.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[t.jsx(us,{value:v.id,className:"mt-1"}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"font-terminal text-[11px] text-foreground flex items-center gap-1",children:[v.label,v.exists&&t.jsx(We,{variant:"outline",className:"text-[9px]",children:"existing"})]}),t.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground break-all",children:v.path||"Custom path"})]})]},v.id))}),i==="custom"&&t.jsxs("div",{className:"mt-2 space-y-1",children:[t.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground",children:"Custom path"}),t.jsx(Ce,{value:h,onChange:v=>x(v.target.value),placeholder:"School/Therapeutic Intervention/Module 01 - Title.md",className:"bg-black border-secondary/60 rounded-none text-xs font-terminal"})]})]}),t.jsxs("div",{className:"border border-secondary/50 bg-black/40 p-3 rounded-none",children:[t.jsx("div",{className:"font-arcade text-[10px] text-primary mb-2",children:"REVIEW CHECKLIST"}),t.jsx("div",{className:"space-y-2",children:(o?.checklist||[]).map(v=>t.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[t.jsx(kn,{checked:!!b[v],onCheckedChange:()=>g(v)}),t.jsx("span",{className:"font-terminal text-[11px] text-foreground",children:v})]},v))})]}),(o?.suggested_links||[]).length>0&&t.jsxs("div",{className:"border border-secondary/50 bg-black/40 p-3 rounded-none",children:[t.jsx("div",{className:"font-arcade text-[10px] text-primary mb-2",children:"SUGGESTED LINKS"}),t.jsx("div",{className:"space-y-1",children:o?.suggested_links?.map(v=>t.jsxs("div",{className:"font-terminal text-[11px] text-muted-foreground",children:["[[",v,"]]"]},v))})]}),t.jsxs("div",{className:"flex gap-2 mt-auto",children:[t.jsx(B,{variant:"outline",className:"flex-1 rounded-none font-terminal text-xs",onClick:P,disabled:s,children:"Cancel"}),t.jsxs(B,{className:"flex-1 bg-primary hover:bg-primary/80 rounded-none font-terminal text-xs",onClick:w,disabled:!f||s||!p,children:[t.jsx(Ys,{className:"w-3 h-3 mr-1"}),s?"Saving...":"Confirm & Save"]})]})]})]})]})})}function Ma(){const[e,n]=c.useState(!1),[s,r]=c.useState(!1),[a,o]=c.useState(null),[l,i]=c.useState(""),[d,h]=c.useState(null),[x,b]=c.useState(null),[g,y]=c.useState(""),[w,P]=c.useState(""),[f,u]=c.useState({}),[p,v]=c.useState([]),N=(j,C)=>{const A=j.split(`
`),_=C.split(`
`),$=[];let M=0,F=0;for(;M<A.length||F<_.length;){const q=A[M],J=_[F];if(M<A.length&&F<_.length&&q===J){$.push(` ${q}`),M+=1,F+=1;continue}M<A.length&&($.push(`-${q}`),M+=1),F<_.length&&($.push(`+${J}`),F+=1)}return $},D=c.useCallback(()=>{n(!1),r(!1),o(null),i(""),h(null),b(null),y(""),P(""),u({}),v([])},[]),T=c.useCallback(async j=>{r(!0),o(null),i(j);try{const C=await G.brain.organizePreview(j);if(!C.success||!C.organized||!C.destination)throw new Error(C.error||"Unable to organize notes.");h(C.organized),b(C.destination),y("recommended");const A=C.organized.checklist??[],_={};return A.forEach($=>{_[$]=!1}),u(_),v(N(j,C.organized.markdown||"")),n(!0),!0}catch(C){const A=C instanceof Error?C.message:String(C);return o(A),!1}finally{r(!1)}},[]),R=c.useCallback(j=>{u(C=>({...C,[j]:!C[j]}))},[]),k=c.useCallback(()=>x?g==="custom"?w.trim():x.options.find(C=>C.id===g)?.path||"":"",[x,g,w]),H=Object.values(f).length===0?!0:Object.values(f).every(Boolean);return{open:e,setOpen:n,loading:s,error:a,rawNotes:l,organized:d,destination:x,selectedDestinationId:g,setSelectedDestinationId:y,customDestination:w,setCustomDestination:P,checklistState:f,diffLines:p,allChecklistChecked:H,reset:D,startPreview:T,toggleChecklist:R,getSelectedDestinationPath:k}}function Da(){const[e,n]=c.useState("chat"),[s,r]=c.useState([]),[a,o]=c.useState(""),[l,i]=c.useState([]),[d,h]=c.useState(!1),[x,b]=c.useState("anki"),[g,y]=c.useState(!1),w=c.useRef(null),P=et(),{toast:f}=tt(),u=Ma(),p=c.useCallback(j=>{const C=new FileReader;C.onload=()=>{typeof C.result=="string"&&i(A=>[...A,C.result])},C.readAsDataURL(j)},[]),v=c.useCallback(j=>{const C=j.clipboardData?.items;if(C){for(const A of Array.from(C))if(A.type.startsWith("image/")){j.preventDefault();const _=A.getAsFile();_&&p(_)}}},[p]),N=c.useCallback(j=>{for(const C of Array.from(j))C.type.startsWith("image/")&&p(C)},[p]),D=c.useCallback(j=>{i(C=>C.filter((A,_)=>_!==j))},[]),T=c.useCallback(async(j,C)=>{r(q=>[...q,{role:"assistant",content:""}]);const A=s.map(q=>({role:q.role,content:q.images?.length?on(q.content,q.images):q.content})).concat([{role:"user",content:on(j,C)}]),$=(await fetch("/api/brain/quick-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:A})})).body?.getReader(),M=new TextDecoder;if(!$)throw new Error("No response body");let F="";for(;;){const{done:q,value:J}=await $.read();if(q)break;F+=M.decode(J,{stream:!0});const ne=F.split(`
`);F=ne.pop()??"";for(const de of ne){if(!de.startsWith("data: "))continue;const re=de.slice(6);if(re==="[DONE]")break;try{const se=JSON.parse(re);if(se.error){r(m=>{const S=[...m];return S[S.length-1]={role:"assistant",content:`Error: ${se.error}`},S});return}se.content&&r(m=>{const S=[...m],z=S[S.length-1];return S[S.length-1]={...z,content:z.content+se.content},S})}catch{}}}},[s]),R=c.useCallback(async(j,C)=>{try{const $={message:j,syncToObsidian:x==="obsidian"||x==="both",mode:x==="both"?"all":x,destinationPath:C?.destinationPath,organizedMarkdown:C?.organizedMarkdown,organizedTitle:C?.organizedTitle,confirmWrite:C?.confirmWrite},M=await G.brain.chat($);let F=M.response;const q={cardsCreated:M.cardsCreated,sessionSaved:M.sessionSaved,sessionId:M.sessionId},J=[];M.sessionSaved&&J.push(`Session saved (ID: ${M.sessionId})`),M.cardsCreated&&J.push(`${M.cardsCreated} Anki cards created`),M.obsidianSynced&&J.push("Synced to Obsidian"),M.obsidianError&&J.push(`Obsidian error: ${M.obsidianError}`),J.length>0&&(F=`${J.join(" | ")}

${F}`),r(ne=>[...ne,{role:"assistant",content:F,meta:q}]),P.invalidateQueries({queryKey:["anki","drafts"]}),P.invalidateQueries({queryKey:["brain","metrics"]}),P.invalidateQueries({queryKey:["sessions"]})}catch(A){const _=A instanceof Error?A.message:String(A);r($=>[...$,{role:"assistant",content:`Error: ${_}`}]),f({title:"Ingest failed",description:_,variant:"destructive"})}},[x,P,f]),k=c.useCallback(async()=>{const j=a.trim();if(!j&&l.length===0)return;const C={role:"user",content:j,images:[...l]};r(A=>[...A,C]),o(""),i([]),h(!0);try{e==="chat"?await T(j,C.images??[]):x==="obsidian"||x==="both"?await u.startPreview(j)||r(_=>[..._,{role:"assistant",content:"Error: Unable to prepare preview."}]):await R(j)}catch(A){const _=A instanceof Error?A.message:String(A);r($=>{const M=$[$.length-1];if(M?.role==="assistant"&&!M.content){const F=[...$];return F[F.length-1]={role:"assistant",content:`Error: ${_}`},F}return[...$,{role:"assistant",content:`Error: ${_}`}]})}finally{h(!1)}},[a,l,e,x,T,R,u]),H=c.useCallback(async()=>{if(!u.organized)return;const j=u.getSelectedDestinationPath();if(!j){u.setOpen(!1),f({title:"Error",description:"Select a destination path.",variant:"destructive"});return}h(!0);try{await R(u.rawNotes,{destinationPath:j,organizedMarkdown:u.organized.markdown,organizedTitle:u.organized.title,confirmWrite:!0}),u.reset()}catch(C){const A=C instanceof Error?C.message:String(C);f({title:"Save failed",description:A,variant:"destructive"})}finally{h(!1)}},[u,R,f]);return t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsx(la,{mode:e,setMode:n,ingestTarget:x,setIngestTarget:b,promptCopied:g,setPromptCopied:y}),t.jsx(ca,{messages:s,loading:d,mode:e,scrollRef:w}),t.jsx(da,{images:l,onRemove:D}),t.jsx(ua,{input:a,setInput:o,onSend:k,onImageSelect:N,onPaste:v,loading:d,mode:e}),t.jsx(Ta,{open:u.open,onOpenChange:j=>{j?u.setOpen(!0):u.reset()},loading:u.loading,error:u.error,rawNotes:u.rawNotes,organized:u.organized,destination:u.destination,selectedDestinationId:u.selectedDestinationId,setSelectedDestinationId:u.setSelectedDestinationId,customDestination:u.customDestination,setCustomDestination:u.setCustomDestination,checklistState:u.checklistState,onToggleChecklist:u.toggleChecklist,diffLines:u.diffLines,onConfirm:H,onCancel:u.reset})]})}const $a="/assets/TreysStudySystemIMAGE-nejJlbV0.jpg";function La({workspace:e}){const[n,s]=c.useState(!1);return c.useEffect(()=>{if(!n)return;const r=a=>{a.key==="Escape"&&s(!1)};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[n]),e.currentFile?t.jsxs("div",{className:oe("flex flex-col",n?"fixed inset-0 z-50 bg-black":"h-full"),children:[t.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5 border-b border-secondary/30 bg-black/40",children:[t.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[t.jsxs("span",{className:"font-terminal text-sm text-primary truncate",children:[e.currentFile.split("/").pop(),e.hasChanges&&t.jsx("span",{className:"text-yellow-500 ml-1",children:"*"})]}),t.jsx("button",{onClick:()=>{const r=e.obsidianConfig?.vaultName||"Treys School",a=e.currentFile.replace(/\.md$/,"");window.open(`obsidian://open?vault=${encodeURIComponent(r)}&file=${encodeURIComponent(a)}`,"_blank")},className:"text-muted-foreground hover:text-primary shrink-0",title:"Open in Obsidian",children:t.jsx(Zs,{className:"w-3 h-3"})})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(B,{size:"sm",variant:"ghost",className:"h-5 px-2 text-xs font-terminal",onClick:()=>e.setPreviewMode(!e.previewMode),children:e.previewMode?"Edit":"Preview"}),t.jsxs(B,{size:"sm",variant:"ghost",onClick:e.saveFile,disabled:!e.hasChanges||e.isSaving,className:"h-5 px-2 text-xs font-terminal",children:[t.jsx(At,{className:"w-3 h-3 mr-1"}),e.isSaving?"Saving...":"Save"]}),t.jsx(B,{size:"sm",variant:"ghost",className:"h-5 px-1.5 text-xs font-terminal",onClick:()=>s(!n),title:n?"Exit fullscreen":"Fullscreen",children:n?t.jsx(gr,{className:"w-3 h-3"}):t.jsx(pr,{className:"w-3 h-3"})})]})]}),e.previewMode?t.jsx("div",{className:"flex-1 p-3 bg-black/60 font-terminal overflow-y-auto",children:t.jsx(ms,{content:e.fileContent,onWikilinkClick:e.handleWikilinkClick})}):t.jsx("textarea",{value:e.fileContent,onChange:r=>e.setFileContent(r.target.value),className:"flex-1 w-full p-3 bg-black/60 font-terminal text-sm resize-none focus:outline-none focus:ring-1 focus:ring-primary overflow-y-auto min-h-[200px]",placeholder:"File content...",style:{height:"100%"}})]}):t.jsxs("div",{className:"brain-workspace__empty flex-1 flex flex-col items-center justify-center gap-4 relative overflow-hidden min-h-[200px]",children:[t.jsx("img",{src:$a,alt:"",className:"absolute inset-0 w-full h-full object-cover opacity-[0.12] pointer-events-none select-none"}),t.jsxs("div",{className:"relative z-10 flex flex-col items-center gap-3 text-center px-4",children:[t.jsx(Mt,{className:"brain-empty-icon w-10 h-10 text-primary/60","aria-hidden":"true"}),t.jsx("p",{className:"font-arcade text-xs text-primary/90 tracking-widest uppercase",children:"No file open"}),t.jsx("p",{className:"font-terminal text-sm text-muted-foreground max-w-[260px]",children:"Select a file from the vault sidebar or create a new note"})]})]})}const Oa=c.lazy(()=>Ct(()=>import("./ConceptMapEditor-CHX0C_KC.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25])).then(e=>({default:e.ConceptMapEditor}))),_a=c.lazy(()=>Ct(()=>import("./VaultGraphView-ZJonYEc9.js"),__vite__mapDeps([26,1,2,27,9,4,23,6,10])).then(e=>({default:e.VaultGraphView}))),Fa=c.lazy(()=>Ct(()=>import("./MindMapView-D27glrju.js"),__vite__mapDeps([28,1,2,27,9,4,3,5,6,7,8,23])).then(e=>({default:e.MindMapView})));class Ha extends c.Component{constructor(){super(...arguments),this.state={error:null}}static getDerivedStateFromError(n){return{error:n.message}}render(){return this.state.error?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-2 p-4",children:[t.jsx("p",{className:"font-arcade text-xs text-red-400",children:"GRAPH RENDER ERROR"}),t.jsx("p",{className:"font-terminal text-xs text-muted-foreground text-center",children:this.state.error}),t.jsx("button",{className:"font-terminal text-sm text-primary underline",onClick:()=>this.setState({error:null}),children:"Try again"})]}):this.props.children}}function Va(){return t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx(Dt,{className:"w-6 h-6 animate-spin text-primary"})})}function Ga(){const[e,n]=c.useState("concept"),s=[{id:"concept",label:"Concept Map"},{id:"vault",label:"Vault Graph"},{id:"mindmap",label:"Mind Map"}];return t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsx("div",{className:"tab-sub-bar",role:"tablist","aria-label":"Graph view",children:s.map(r=>t.jsx("button",{role:"tab","aria-selected":e===r.id,onClick:()=>n(r.id),className:oe("tab-sub-item",e===r.id&&"active"),children:r.label},r.id))}),t.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:t.jsx(Ha,{children:t.jsxs(c.Suspense,{fallback:t.jsx(Va,{}),children:[e==="concept"&&t.jsx(Oa,{}),e==="vault"&&t.jsx(_a,{}),e==="mindmap"&&t.jsx(Fa,{})]})})})]})}function Ba(e,n){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const s=document.implementation.createHTMLDocument(),r=s.createElement("base"),a=s.createElement("a");return s.head.appendChild(r),s.body.appendChild(a),n&&(r.href=n),a.href=e,a.href}const qa=(()=>{let e=0;const n=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${n()}${e}`)})();function pe(e){const n=[];for(let s=0,r=e.length;s<r;s++)n.push(e[s]);return n}let je=null;function fs(e={}){return je||(e.includeStyleProperties?(je=e.includeStyleProperties,je):(je=pe(window.getComputedStyle(document.documentElement)),je))}function Qe(e,n){const r=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(n);return r?parseFloat(r.replace("px","")):0}function Ka(e){const n=Qe(e,"border-left-width"),s=Qe(e,"border-right-width");return e.clientWidth+n+s}function Ua(e){const n=Qe(e,"border-top-width"),s=Qe(e,"border-bottom-width");return e.clientHeight+n+s}function hs(e,n={}){const s=n.width||Ka(e),r=n.height||Ua(e);return{width:s,height:r}}function Wa(){let e,n;try{n=process}catch{}const s=n&&n.env?n.env.devicePixelRatio:null;return s&&(e=parseInt(s,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const Z=16384;function Ja(e){(e.width>Z||e.height>Z)&&(e.width>Z&&e.height>Z?e.width>e.height?(e.height*=Z/e.width,e.width=Z):(e.width*=Z/e.height,e.height=Z):e.width>Z?(e.height*=Z/e.width,e.width=Z):(e.width*=Z/e.height,e.height=Z))}function Xe(e){return new Promise((n,s)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>n(r))})},r.onerror=s,r.crossOrigin="anonymous",r.decoding="async",r.src=e})}async function Ya(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(n=>`data:image/svg+xml;charset=utf-8,${n}`)}async function Qa(e,n,s){const r="http://www.w3.org/2000/svg",a=document.createElementNS(r,"svg"),o=document.createElementNS(r,"foreignObject");return a.setAttribute("width",`${n}`),a.setAttribute("height",`${s}`),a.setAttribute("viewBox",`0 0 ${n} ${s}`),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("externalResourcesRequired","true"),a.appendChild(o),o.appendChild(e),Ya(a)}const X=(e,n)=>{if(e instanceof n)return!0;const s=Object.getPrototypeOf(e);return s===null?!1:s.constructor.name===n.name||X(s,n)};function Xa(e){const n=e.getPropertyValue("content");return`${e.cssText} content: '${n.replace(/'|"/g,"")}';`}function Za(e,n){return fs(n).map(s=>{const r=e.getPropertyValue(s),a=e.getPropertyPriority(s);return`${s}: ${r}${a?" !important":""};`}).join(" ")}function eo(e,n,s,r){const a=`.${e}:${n}`,o=s.cssText?Xa(s):Za(s,r);return document.createTextNode(`${a}{${o}}`)}function cn(e,n,s,r){const a=window.getComputedStyle(e,s),o=a.getPropertyValue("content");if(o===""||o==="none")return;const l=qa();try{n.className=`${n.className} ${l}`}catch{return}const i=document.createElement("style");i.appendChild(eo(l,s,a,r)),n.appendChild(i)}function to(e,n,s){cn(e,n,":before",s),cn(e,n,":after",s)}const dn="application/font-woff",un="image/jpeg",no={woff:dn,woff2:dn,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:un,jpeg:un,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function so(e){const n=/\.([^./]*?)$/g.exec(e);return n?n[1]:""}function Vt(e){const n=so(e).toLowerCase();return no[n]||""}function ro(e){return e.split(/,/)[1]}function St(e){return e.search(/^(data:)/)!==-1}function ao(e,n){return`data:${n};base64,${e}`}async function ps(e,n,s){const r=await fetch(e,n);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const a=await r.blob();return new Promise((o,l)=>{const i=new FileReader;i.onerror=l,i.onloadend=()=>{try{o(s({res:r,result:i.result}))}catch(d){l(d)}},i.readAsDataURL(a)})}const bt={};function oo(e,n,s){let r=e.replace(/\?.*/,"");return s&&(r=e),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),n?`[${n}]${r}`:r}async function Gt(e,n,s){const r=oo(e,n,s.includeQueryParams);if(bt[r]!=null)return bt[r];s.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let a;try{const o=await ps(e,s.fetchRequestInit,({res:l,result:i})=>(n||(n=l.headers.get("Content-Type")||""),ro(i)));a=ao(o,n)}catch(o){a=s.imagePlaceholder||"";let l=`Failed to fetch resource: ${e}`;o&&(l=typeof o=="string"?o:o.message),l&&console.warn(l)}return bt[r]=a,a}async function io(e){const n=e.toDataURL();return n==="data:,"?e.cloneNode(!1):Xe(n)}async function lo(e,n){if(e.currentSrc){const o=document.createElement("canvas"),l=o.getContext("2d");o.width=e.clientWidth,o.height=e.clientHeight,l?.drawImage(e,0,0,o.width,o.height);const i=o.toDataURL();return Xe(i)}const s=e.poster,r=Vt(s),a=await Gt(s,r,n);return Xe(a)}async function co(e,n){var s;try{if(!((s=e?.contentDocument)===null||s===void 0)&&s.body)return await it(e.contentDocument.body,n,!0)}catch{}return e.cloneNode(!1)}async function uo(e,n){return X(e,HTMLCanvasElement)?io(e):X(e,HTMLVideoElement)?lo(e,n):X(e,HTMLIFrameElement)?co(e,n):e.cloneNode(xs(e))}const mo=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",xs=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function fo(e,n,s){var r,a;if(xs(n))return n;let o=[];return mo(e)&&e.assignedNodes?o=pe(e.assignedNodes()):X(e,HTMLIFrameElement)&&(!((r=e.contentDocument)===null||r===void 0)&&r.body)?o=pe(e.contentDocument.body.childNodes):o=pe(((a=e.shadowRoot)!==null&&a!==void 0?a:e).childNodes),o.length===0||X(e,HTMLVideoElement)||await o.reduce((l,i)=>l.then(()=>it(i,s)).then(d=>{d&&n.appendChild(d)}),Promise.resolve()),n}function ho(e,n,s){const r=n.style;if(!r)return;const a=window.getComputedStyle(e);a.cssText?(r.cssText=a.cssText,r.transformOrigin=a.transformOrigin):fs(s).forEach(o=>{let l=a.getPropertyValue(o);o==="font-size"&&l.endsWith("px")&&(l=`${Math.floor(parseFloat(l.substring(0,l.length-2)))-.1}px`),X(e,HTMLIFrameElement)&&o==="display"&&l==="inline"&&(l="block"),o==="d"&&n.getAttribute("d")&&(l=`path(${n.getAttribute("d")})`),r.setProperty(o,l,a.getPropertyPriority(o))})}function po(e,n){X(e,HTMLTextAreaElement)&&(n.innerHTML=e.value),X(e,HTMLInputElement)&&n.setAttribute("value",e.value)}function xo(e,n){if(X(e,HTMLSelectElement)){const s=n,r=Array.from(s.children).find(a=>e.value===a.getAttribute("value"));r&&r.setAttribute("selected","")}}function go(e,n,s){return X(n,Element)&&(ho(e,n,s),to(e,n,s),po(e,n),xo(e,n)),n}async function bo(e,n){const s=e.querySelectorAll?e.querySelectorAll("use"):[];if(s.length===0)return e;const r={};for(let o=0;o<s.length;o++){const i=s[o].getAttribute("xlink:href");if(i){const d=e.querySelector(i),h=document.querySelector(i);!d&&h&&!r[i]&&(r[i]=await it(h,n,!0))}}const a=Object.values(r);if(a.length){const o="http://www.w3.org/1999/xhtml",l=document.createElementNS(o,"svg");l.setAttribute("xmlns",o),l.style.position="absolute",l.style.width="0",l.style.height="0",l.style.overflow="hidden",l.style.display="none";const i=document.createElementNS(o,"defs");l.appendChild(i);for(let d=0;d<a.length;d++)i.appendChild(a[d]);e.appendChild(l)}return e}async function it(e,n,s){return!s&&n.filter&&!n.filter(e)?null:Promise.resolve(e).then(r=>uo(r,n)).then(r=>fo(e,r,n)).then(r=>go(e,r,n)).then(r=>bo(r,n))}const gs=/url\((['"]?)([^'"]+?)\1\)/g,yo=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,vo=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function wo(e){const n=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${n})(['"]?\\))`,"g")}function jo(e){const n=[];return e.replace(gs,(s,r,a)=>(n.push(a),s)),n.filter(s=>!St(s))}async function No(e,n,s,r,a){try{const o=s?Ba(n,s):n,l=Vt(n);let i;return a||(i=await Gt(o,l,r)),e.replace(wo(n),`$1${i}$3`)}catch{}return e}function So(e,{preferredFontFormat:n}){return n?e.replace(vo,s=>{for(;;){const[r,,a]=yo.exec(s)||[];if(!a)return"";if(a===n)return`src: ${r};`}}):e}function bs(e){return e.search(gs)!==-1}async function ys(e,n,s){if(!bs(e))return e;const r=So(e,s);return jo(r).reduce((o,l)=>o.then(i=>No(i,l,n,s)),Promise.resolve(r))}async function Ne(e,n,s){var r;const a=(r=n.style)===null||r===void 0?void 0:r.getPropertyValue(e);if(a){const o=await ys(a,null,s);return n.style.setProperty(e,o,n.style.getPropertyPriority(e)),!0}return!1}async function ko(e,n){await Ne("background",e,n)||await Ne("background-image",e,n),await Ne("mask",e,n)||await Ne("-webkit-mask",e,n)||await Ne("mask-image",e,n)||await Ne("-webkit-mask-image",e,n)}async function Co(e,n){const s=X(e,HTMLImageElement);if(!(s&&!St(e.src))&&!(X(e,SVGImageElement)&&!St(e.href.baseVal)))return;const r=s?e.src:e.href.baseVal,a=await Gt(r,Vt(r),n);await new Promise((o,l)=>{e.onload=o,e.onerror=n.onImageErrorHandler?(...d)=>{try{o(n.onImageErrorHandler(...d))}catch(h){l(h)}}:l;const i=e;i.decode&&(i.decode=o),i.loading==="lazy"&&(i.loading="eager"),s?(e.srcset="",e.src=a):e.href.baseVal=a})}async function Eo(e,n){const r=pe(e.childNodes).map(a=>vs(a,n));await Promise.all(r).then(()=>e)}async function vs(e,n){X(e,Element)&&(await ko(e,n),await Co(e,n),await Eo(e,n))}function Po(e,n){const{style:s}=e;n.backgroundColor&&(s.backgroundColor=n.backgroundColor),n.width&&(s.width=`${n.width}px`),n.height&&(s.height=`${n.height}px`);const r=n.style;return r!=null&&Object.keys(r).forEach(a=>{s[a]=r[a]}),e}const mn={};async function fn(e){let n=mn[e];if(n!=null)return n;const r=await(await fetch(e)).text();return n={url:e,cssText:r},mn[e]=n,n}async function hn(e,n){let s=e.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,o=(s.match(/url\([^)]+\)/g)||[]).map(async l=>{let i=l.replace(r,"$1");return i.startsWith("https://")||(i=new URL(i,e.url).href),ps(i,n.fetchRequestInit,({result:d})=>(s=s.replace(l,`url(${d})`),[l,d]))});return Promise.all(o).then(()=>s)}function pn(e){if(e==null)return[];const n=[],s=/(\/\*[\s\S]*?\*\/)/gi;let r=e.replace(s,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const d=a.exec(r);if(d===null)break;n.push(d[0])}r=r.replace(a,"");const o=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,l="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",i=new RegExp(l,"gi");for(;;){let d=o.exec(r);if(d===null){if(d=i.exec(r),d===null)break;o.lastIndex=i.lastIndex}else i.lastIndex=o.lastIndex;n.push(d[0])}return n}async function Ro(e,n){const s=[],r=[];return e.forEach(a=>{if("cssRules"in a)try{pe(a.cssRules||[]).forEach((o,l)=>{if(o.type===CSSRule.IMPORT_RULE){let i=l+1;const d=o.href,h=fn(d).then(x=>hn(x,n)).then(x=>pn(x).forEach(b=>{try{a.insertRule(b,b.startsWith("@import")?i+=1:a.cssRules.length)}catch(g){console.error("Error inserting rule from remote css",{rule:b,error:g})}})).catch(x=>{console.error("Error loading remote css",x.toString())});r.push(h)}})}catch(o){const l=e.find(i=>i.href==null)||document.styleSheets[0];a.href!=null&&r.push(fn(a.href).then(i=>hn(i,n)).then(i=>pn(i).forEach(d=>{l.insertRule(d,l.cssRules.length)})).catch(i=>{console.error("Error loading remote stylesheet",i)})),console.error("Error inlining remote css file",o)}}),Promise.all(r).then(()=>(e.forEach(a=>{if("cssRules"in a)try{pe(a.cssRules||[]).forEach(o=>{s.push(o)})}catch(o){console.error(`Error while reading CSS rules from ${a.href}`,o)}}),s))}function Io(e){return e.filter(n=>n.type===CSSRule.FONT_FACE_RULE).filter(n=>bs(n.style.getPropertyValue("src")))}async function zo(e,n){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const s=pe(e.ownerDocument.styleSheets),r=await Ro(s,n);return Io(r)}function ws(e){return e.trim().replace(/["']/g,"")}function Ao(e){const n=new Set;function s(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(o=>{n.add(ws(o))}),Array.from(r.children).forEach(o=>{o instanceof HTMLElement&&s(o)})}return s(e),n}async function To(e,n){const s=await zo(e,n),r=Ao(e);return(await Promise.all(s.filter(o=>r.has(ws(o.style.fontFamily))).map(o=>{const l=o.parentStyleSheet?o.parentStyleSheet.href:null;return ys(o.cssText,l,n)}))).join(`
`)}async function Mo(e,n){const s=n.fontEmbedCSS!=null?n.fontEmbedCSS:n.skipFonts?null:await To(e,n);if(s){const r=document.createElement("style"),a=document.createTextNode(s);r.appendChild(a),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}}async function Do(e,n={}){const{width:s,height:r}=hs(e,n),a=await it(e,n,!0);return await Mo(a,n),await vs(a,n),Po(a,n),await Qa(a,s,r)}async function $o(e,n={}){const{width:s,height:r}=hs(e,n),a=await Do(e,n),o=await Xe(a),l=document.createElement("canvas"),i=l.getContext("2d"),d=n.pixelRatio||Wa(),h=n.canvasWidth||s,x=n.canvasHeight||r;return l.width=h*d,l.height=x*d,n.skipAutoScale||Ja(l),l.style.width=`${h}`,l.style.height=`${x}`,n.backgroundColor&&(i.fillStyle=n.backgroundColor,i.fillRect(0,0,l.width,l.height)),i.drawImage(o,0,0,l.width,l.height),l}async function Lo(e,n={}){return(await $o(e,n)).toDataURL()}const yt={title:"Untitled Comparison",columns:["Concept A","Concept B"],rows:[{feature:"Feature 1",values:["",""],isKey:!1},{feature:"Feature 2",values:["",""],isKey:!1},{feature:"Feature 3",values:["",""],isKey:!1}]};function xn(e){const n=`| Feature | ${e.columns.join(" | ")} |`,s=`|${"----|".repeat(e.columns.length+1)}`,r=e.rows.map(a=>`| ${a.isKey?`**${a.feature}**`:a.feature} | ${a.values.join(" | ")} |`);return[n,s,...r].join(`
`)}function Oo({className:e}){const[n,s]=c.useState(()=>({...yt,columns:[...yt.columns],rows:yt.rows.map(u=>({...u,values:[...u.values]}))})),r=c.useRef(null),{toast:a}=tt(),o=c.useCallback(u=>{s(p=>({...p,title:u}))},[]),l=c.useCallback((u,p)=>{s(v=>{const N=[...v.columns];return N[u]=p,{...v,columns:N}})},[]),i=c.useCallback((u,p)=>{s(v=>{const N=v.rows.map((D,T)=>T===u?{...D,feature:p}:D);return{...v,rows:N}})},[]),d=c.useCallback((u,p,v)=>{s(N=>{const D=N.rows.map((T,R)=>{if(R!==u)return T;const k=[...T.values];return k[p]=v,{...T,values:k}});return{...N,rows:D}})},[]),h=c.useCallback(u=>{s(p=>{const v=p.rows.map((N,D)=>D===u?{...N,isKey:!N.isKey}:N);return{...p,rows:v}})},[]),x=c.useCallback(()=>{s(u=>{if(u.columns.length>=4)return u;const p=[...u.columns,`Concept ${u.columns.length+1}`],v=u.rows.map(N=>({...N,values:[...N.values,""]}));return{...u,columns:p,rows:v}})},[]),b=c.useCallback(u=>{s(p=>{if(p.columns.length<=2)return p;const v=p.columns.filter((D,T)=>T!==u),N=p.rows.map(D=>({...D,values:D.values.filter((T,R)=>R!==u)}));return{...p,columns:v,rows:N}})},[]),g=c.useCallback(()=>{s(u=>({...u,rows:[...u.rows,{feature:`Feature ${u.rows.length+1}`,values:u.columns.map(()=>""),isKey:!1}]}))},[]),y=c.useCallback(u=>{s(p=>p.rows.length<=1?p:{...p,rows:p.rows.filter((v,N)=>N!==u)})},[]),w=c.useCallback(()=>{const u=xn(n);navigator.clipboard.writeText(u),a({title:"Markdown copied to clipboard"})},[n,a]),P=c.useCallback(async()=>{if(r.current)try{const u=await Lo(r.current,{backgroundColor:"#000",quality:1}),p=document.createElement("a");p.download=`${n.title.replace(/[/\\?%*:|"<>]/g,"-")}.png`,p.href=u,p.click(),a({title:"PNG exported"})}catch(u){a({title:"Export failed",description:String(u),variant:"destructive"})}},[n.title,a]),f=c.useCallback(async()=>{const u=xn(n),p=n.title.replace(/[/\\?%*:|"<>]/g,"-"),v=`---
type: comparison-table
created: ${new Date().toISOString()}
---

# ${n.title}

${u}
`,N=`Comparison Tables/${p}.md`;try{await G.obsidian.saveFile(N,v),a({title:"Saved to vault",description:N})}catch(D){a({title:"Save failed",description:String(D),variant:"destructive"})}},[n,a]);return t.jsxs("div",{className:oe("flex flex-col h-full",e),children:[t.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 border-b border-secondary/30 bg-black/40 shrink-0 flex-wrap",children:[t.jsxs(B,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:x,disabled:n.columns.length>=4,title:"Add column",children:[t.jsx(rr,{className:"w-3 h-3"}),t.jsx(Ut,{className:"w-2 h-2"})]}),t.jsxs(B,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:g,title:"Add row",children:[t.jsx(wr,{className:"w-3 h-3"}),t.jsx(Ut,{className:"w-2 h-2"})]}),t.jsx("div",{className:"w-px h-4 bg-secondary/30"}),t.jsx(B,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:w,title:"Copy markdown",children:t.jsx(or,{className:"w-3 h-3"})}),t.jsx(B,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:P,title:"Export PNG",children:t.jsx($t,{className:"w-3 h-3"})}),t.jsx(B,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:f,title:"Save to vault",children:t.jsx(At,{className:"w-3 h-3"})}),t.jsxs("span",{className:"ml-auto text-[9px] font-terminal text-muted-foreground",children:[n.columns.length,"C / ",n.rows.length,"R"]})]}),t.jsx("div",{className:"px-2 py-1 border-b border-secondary/20",children:t.jsx(Ce,{value:n.title,onChange:u=>o(u.target.value),className:"h-6 text-xs font-arcade bg-transparent border-none px-1 text-primary focus-visible:ring-0",placeholder:"Table title..."})}),t.jsx("div",{className:"flex-1 overflow-auto p-2",children:t.jsxs("div",{ref:r,className:"bg-black/80 border-2 border-primary/50",children:[t.jsxs("div",{className:"flex border-b-2 border-primary/50",children:[t.jsx("div",{className:"w-28 shrink-0 p-1 border-r border-secondary/30 bg-black/60",children:t.jsx("span",{className:"font-arcade text-[9px] text-muted-foreground",children:"FEATURE"})}),n.columns.map((u,p)=>t.jsxs("div",{className:"flex-1 min-w-[100px] p-1 border-r border-secondary/30 bg-black/60 flex items-center gap-1",children:[t.jsx(Ce,{value:u,onChange:v=>l(p,v.target.value),className:"h-5 text-[10px] font-arcade bg-transparent border-none px-0 text-primary focus-visible:ring-0 flex-1"}),n.columns.length>2&&t.jsx("button",{onClick:()=>b(p),className:"text-muted-foreground hover:text-destructive shrink-0",children:t.jsx(Ke,{className:"w-2.5 h-2.5"})})]},p))]}),n.rows.map((u,p)=>t.jsxs("div",{className:oe("flex border-b border-secondary/20",u.isKey&&"border-l-2 border-l-primary"),children:[t.jsxs("div",{className:"w-28 shrink-0 p-1 border-r border-secondary/30 flex items-center gap-1",children:[t.jsx("button",{onClick:()=>h(p),className:oe("shrink-0",u.isKey?"text-primary":"text-muted-foreground/40 hover:text-muted-foreground"),title:"Toggle key feature",children:t.jsx(Ms,{className:"w-2.5 h-2.5",fill:u.isKey?"currentColor":"none"})}),t.jsx(Ce,{value:u.feature,onChange:v=>i(p,v.target.value),className:oe("h-5 text-[10px] font-terminal bg-transparent border-none px-0 focus-visible:ring-0 flex-1",u.isKey?"text-primary font-bold":"text-secondary-foreground")}),n.rows.length>1&&t.jsx("button",{onClick:()=>y(p),className:"text-muted-foreground hover:text-destructive shrink-0",children:t.jsx(Ke,{className:"w-2.5 h-2.5"})})]}),u.values.map((v,N)=>t.jsx("div",{className:"flex-1 min-w-[100px] p-1 border-r border-secondary/30",children:t.jsx(Ce,{value:v,onChange:D=>d(p,N,D.target.value),className:"h-5 text-[10px] font-terminal bg-transparent border-none px-0 text-secondary-foreground focus-visible:ring-0",placeholder:"..."})},N))]},p))]})})]})}function _o({totalCards:e,compact:n}){const[s,r]=c.useState(new Set),[a,o]=c.useState(null),[l,i]=c.useState({front:"",back:"",deckName:""}),d=et(),{toast:h}=tt(),{data:x,isLoading:b,refetch:g}=Y({queryKey:["anki","status"],queryFn:G.anki.getStatus,refetchInterval:3e4}),{data:y}=Y({queryKey:["anki","due"],queryFn:G.anki.getDue,enabled:x?.connected===!0}),{data:w=[],refetch:P}=Y({queryKey:["anki","drafts"],queryFn:G.anki.getDrafts}),f=w.filter(k=>k.status==="pending"),u=me({mutationFn:G.anki.sync,onSuccess:k=>{d.invalidateQueries({queryKey:["anki"]}),P(),h({title:"Anki sync complete",description:k.output||"Cards synced successfully"})},onError:k=>{h({title:"Anki sync failed",description:k.message,variant:"destructive"})}}),p=me({mutationFn:k=>G.anki.approveDraft(k),onSuccess:()=>P()}),v=me({mutationFn:k=>G.anki.deleteDraft(k),onMutate:async k=>{await d.cancelQueries({queryKey:["anki","drafts"]});const H=d.getQueryData(["anki","drafts"]);return d.setQueryData(["anki","drafts"],j=>j?j.filter(C=>C.id!==k):[]),{prev:H}},onError:(k,H,j)=>{j?.prev&&d.setQueryData(["anki","drafts"],j.prev)},onSettled:()=>P()}),N=me({mutationFn:({id:k,data:H})=>G.anki.updateDraft(k,H),onSuccess:()=>{P(),o(null)}}),D=k=>{o(k.id),i({front:k.front,back:k.back,deckName:k.deckName})},T=()=>{a!==null&&N.mutate({id:a,data:l})},R=t.jsx("div",{className:n?"p-3 space-y-3":"p-4 space-y-3",children:b?t.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Checking Anki..."}):x?.connected?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-4 font-terminal text-xs",children:[t.jsx(We,{variant:"outline",className:"bg-success/20 text-success border-success",children:"Connected"}),t.jsxs("span",{className:"text-muted-foreground",children:["Cards: ",t.jsx("span",{className:"text-primary font-arcade",children:e})]}),t.jsxs("span",{className:"text-muted-foreground",children:["Due: ",t.jsx("span",{className:"text-secondary font-arcade",children:y?.dueCount||0})]}),t.jsxs("span",{className:"text-muted-foreground",children:["Reviewed: ",t.jsx("span",{className:"font-arcade",children:x.reviewedToday||0})]}),t.jsxs("span",{className:"text-muted-foreground",children:["Decks: ",t.jsx("span",{className:"font-arcade",children:x.decks?.length||0})]})]}),t.jsxs("div",{className:"pt-2 flex gap-2",children:[t.jsxs(B,{size:"sm",variant:"outline",className:"flex-1 font-terminal text-xs",onClick:()=>g(),children:[t.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Refresh"]}),t.jsxs(B,{size:"sm",className:"flex-1 font-terminal text-xs bg-secondary hover:bg-secondary/80",onClick:()=>u.mutate(),disabled:u.isPending,children:[u.isPending?t.jsx(Dt,{className:"w-3 h-3 mr-1 animate-spin"}):t.jsx(Ae,{className:"w-3 h-3 mr-1"}),u.isPending?"Syncing...":"Sync Cards"]})]}),u.isError&&t.jsxs("div",{className:"p-2 bg-destructive/10 border border-destructive/30 text-destructive font-terminal text-[10px]",children:[t.jsx("span",{className:"font-arcade",children:"SYNC ERROR:"})," ",u.error?.message||"Unknown error",t.jsx(B,{size:"sm",variant:"outline",className:"ml-2 h-5 px-2 text-[10px] font-terminal border-destructive/50 text-destructive",onClick:()=>u.mutate(),disabled:u.isPending,children:"Retry"})]}),f.length>0&&t.jsxs("div",{className:"pt-3 border-t border-secondary/30",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsxs("span",{className:"font-arcade text-[10px] text-warning",children:["PENDING CARDS (",f.length,")"]}),t.jsx("div",{className:"flex gap-1",children:t.jsx(B,{size:"sm",variant:"outline",className:"h-5 px-2 text-[10px] font-terminal",onClick:()=>{s.size===f.length?r(new Set):r(new Set(f.map(k=>k.id)))},children:s.size===f.length?"None":"All"})})]}),s.size>0&&t.jsxs("div",{className:"flex gap-1 mb-2",children:[t.jsxs(B,{size:"sm",className:"h-6 px-2 text-[10px] font-terminal bg-success hover:bg-success/80",onClick:()=>{s.forEach(k=>p.mutate(k)),r(new Set)},children:[t.jsx(ct,{className:"w-3 h-3 mr-1"}),"Approve (",s.size,")"]}),t.jsxs(B,{size:"sm",variant:"destructive",className:"h-6 px-2 text-[10px] font-terminal",onClick:()=>{s.forEach(k=>v.mutate(k)),r(new Set)},children:[t.jsx(Ke,{className:"w-3 h-3 mr-1"}),"Delete (",s.size,")"]})]}),t.jsx(_e,{className:"h-[140px]",children:t.jsx("div",{className:"space-y-2",children:f.map(k=>t.jsx("div",{className:`p-2 bg-black/40 border text-xs ${s.has(k.id)?"border-primary":"border-secondary/30"}`,children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(kn,{checked:s.has(k.id),onCheckedChange:H=>{const j=new Set(s);H?j.add(k.id):j.delete(k.id),r(j)},className:"mt-1 border-secondary data-[state=checked]:bg-primary"}),t.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[t.jsx("div",{className:"font-terminal text-primary truncate",children:k.front}),t.jsx("div",{className:"font-terminal text-muted-foreground mt-1 truncate",children:k.back}),t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[t.jsx(We,{variant:"outline",className:"text-[9px] border-info/50 text-info shrink-0",children:k.deckName}),t.jsx(B,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-warning/50 text-warning hover:bg-warning/20",onClick:()=>D(k),title:"Edit card",children:t.jsx(Ue,{className:"w-3 h-3"})}),t.jsx(B,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-success/50 text-success hover:bg-success/20",onClick:()=>p.mutate(k.id),title:"Approve card",children:t.jsx(ct,{className:"w-3 h-3"})}),t.jsx(B,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-destructive/50 text-destructive hover:bg-destructive/20",onClick:()=>v.mutate(k.id),title:"Delete card",children:t.jsx(Ke,{className:"w-3 h-3"})})]})]})]})},k.id))})})]})]}):t.jsxs("div",{className:"text-center space-y-2",children:[t.jsx("p",{className:"font-terminal text-xs text-destructive",children:x?.error||"Anki not connected"}),t.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Anki with AnkiConnect plugin"}),t.jsxs(B,{size:"sm",variant:"outline",className:"font-terminal text-xs",onClick:()=>g(),children:[t.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Retry"]})]})});return t.jsxs(t.Fragment,{children:[n?R:t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-3",children:[t.jsx(Fe,{className:"w-4 h-4"}),"ANKI INTEGRATION",x?.connected?t.jsx(ct,{className:"w-3 h-3 text-success ml-auto"}):t.jsx(vt,{className:"w-3 h-3 text-destructive ml-auto"})]})}),t.jsx(Ie,{className:"p-0",children:R})]}),t.jsx(Et,{open:a!==null,onOpenChange:k=>{k||o(null)},children:t.jsxs(Pt,{"data-modal":"brain-edit-draft",className:"bg-black border-2 border-primary rounded-none max-w-lg translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[t.jsxs(Rt,{children:[t.jsxs(It,{className:"font-arcade text-primary flex items-center gap-2",children:[t.jsx(Ue,{className:"w-5 h-5"}),"EDIT CARD"]}),t.jsx(zt,{className:"font-terminal text-muted-foreground",children:"Edit card content and select target deck"})]}),t.jsxs("div",{className:"space-y-4 font-terminal",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-muted-foreground",children:"Front (Question)"}),t.jsx(Kt,{value:l.front,onChange:k=>i(H=>({...H,front:k.target.value})),placeholder:"Card front...",className:"rounded-none border-secondary min-h-[80px]"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-muted-foreground",children:"Back (Answer)"}),t.jsx(Kt,{value:l.back,onChange:k=>i(H=>({...H,back:k.target.value})),placeholder:"Card back...",className:"rounded-none border-secondary min-h-[80px]"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-muted-foreground",children:"Target Deck"}),t.jsxs(Fs,{value:l.deckName,onValueChange:k=>i(H=>({...H,deckName:k})),children:[t.jsx(Hs,{className:"rounded-none border-secondary",children:t.jsx(Vs,{placeholder:"Select deck"})}),t.jsxs(Gs,{className:"rounded-none border-secondary bg-black max-h-[200px]",children:[t.jsx(xe,{value:"PT::EBP",children:"PT::EBP (Evidence Based Practice)"}),t.jsx(xe,{value:"PT::ExPhys",children:"PT::ExPhys (Exercise Physiology)"}),t.jsx(xe,{value:"PT::MS1",children:"PT::MS1 (Movement Science 1)"}),t.jsx(xe,{value:"PT::Neuro",children:"PT::Neuro (Neuroscience)"}),t.jsx(xe,{value:"PT::TI",children:"PT::TI (Therapeutic Intervention)"}),t.jsx(xe,{value:"PT::General",children:"PT::General"}),x?.decks?.filter(k=>!k.startsWith("PT::")).map(k=>t.jsx(xe,{value:k,children:k},k))]})]}),t.jsxs("p",{className:"text-[10px] text-muted-foreground mt-1",children:["Current: ",t.jsx("span",{className:"text-blue-400",children:l.deckName})]})]})]}),t.jsxs(Rs,{className:"gap-2",children:[t.jsxs(B,{variant:"outline",onClick:()=>o(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[t.jsx(vt,{className:"w-4 h-4 mr-2"}),"Cancel"]}),t.jsxs(B,{onClick:T,disabled:N.isPending,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[t.jsx(At,{className:"w-4 h-4 mr-2"}),N.isPending?"Saving...":"Save"]})]})]})})]})}const fe=[{id:"edit",label:"EDIT",icon:Ue},{id:"chat",label:"CHAT",icon:Nn},{id:"graph",label:"GRAPH",icon:yr},{id:"table",label:"TABLE",icon:Nr},{id:"anki",label:"ANKI",icon:Fe}];function gn({workspace:e}){const[n,s]=c.useState({}),r=c.useCallback(i=>{s(d=>({...d,[i]:(d[i]||0)+1}))},[]);c.useEffect(()=>{const i=d=>{if(!d.altKey||d.ctrlKey||d.metaKey)return;const h=parseInt(d.key,10)-1;h>=0&&h<fe.length&&(d.preventDefault(),e.setMainMode(fe[h].id))};return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[e]);const a=e.mainMode,o=fe.findIndex(i=>i.id===a),l=c.useCallback(i=>{let d=null;i.key==="ArrowLeft"?d=o<=0?fe.length-1:o-1:i.key==="ArrowRight"?d=o>=fe.length-1?0:o+1:i.key==="Home"?d=0:i.key==="End"&&(d=fe.length-1),d!==null&&(i.preventDefault(),e.setMainMode(fe[d].id))},[o,e]);return t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsx("div",{role:"tablist","aria-label":"Main content view",className:"tab-bar",children:fe.map(i=>{const d=i.icon,h=a===i.id,x=`brain-tab-${i.id}`,b=`brain-tabpanel-${i.id}`;return t.jsxs("button",{id:x,role:"tab","aria-selected":h,"aria-controls":b,tabIndex:h?0:-1,onClick:()=>e.setMainMode(i.id),onKeyDown:l,className:oe("tab-item",h&&"active"),children:[t.jsx(d,{className:"w-3.5 h-3.5 shrink-0","aria-hidden":"true"}),i.label,i.id==="anki"&&e.pendingDrafts.length>0&&t.jsx("span",{className:"ml-1 px-1 py-0 text-xs bg-secondary text-primary-foreground font-arcade",children:e.pendingDrafts.length})]},i.id)})}),t.jsxs("div",{className:"flex-1 min-h-0 overflow-hidden flex flex-col",children:[a==="edit"&&t.jsx("div",{id:"brain-tabpanel-edit",role:"tabpanel","aria-labelledby":"brain-tab-edit",className:"flex-1 min-h-0 overflow-hidden flex flex-col",tabIndex:0,children:t.jsx(ke,{fallback:t.jsx($e,{tabName:"EDIT",onReset:()=>r("edit")}),children:t.jsx(La,{workspace:e})},`edit-${n.edit||0}`)}),a==="chat"&&t.jsx("div",{id:"brain-tabpanel-chat",role:"tabpanel","aria-labelledby":"brain-tab-chat",className:"flex-1 min-h-0 overflow-hidden flex flex-col",tabIndex:0,children:t.jsx(ke,{fallback:t.jsx($e,{tabName:"CHAT",onReset:()=>r("chat")}),children:t.jsx(Da,{})},`chat-${n.chat||0}`)}),a==="graph"&&t.jsx("div",{id:"brain-tabpanel-graph",role:"tabpanel","aria-labelledby":"brain-tab-graph",className:"flex-1 min-h-0 overflow-hidden flex flex-col",tabIndex:0,children:t.jsx(ke,{fallback:t.jsx($e,{tabName:"GRAPH",onReset:()=>r("graph")}),children:t.jsx(Ga,{})},`graph-${n.graph||0}`)}),a==="table"&&t.jsx("div",{id:"brain-tabpanel-table",role:"tabpanel","aria-labelledby":"brain-tab-table",className:"flex-1 min-h-0 overflow-hidden flex flex-col",tabIndex:0,children:t.jsx(ke,{fallback:t.jsx($e,{tabName:"TABLE",onReset:()=>r("table")}),children:t.jsx(Oo,{})},`table-${n.table||0}`)}),a==="anki"&&t.jsx("div",{id:"brain-tabpanel-anki",role:"tabpanel","aria-labelledby":"brain-tab-anki",className:"flex-1 min-h-0 overflow-hidden flex flex-col",tabIndex:0,children:t.jsx(ke,{fallback:t.jsx($e,{tabName:"ANKI",onReset:()=>r("anki")}),children:t.jsx(_o,{totalCards:e.metrics?.totalCards||0,compact:!0})},`anki-${n.anki||0}`)})]})]})}function Fo(){const[e,n]=c.useState(""),[s,r]=c.useState(null),[a,o]=c.useState("auto"),[l,i]=c.useState([]),d=et(),{toast:h}=tt(),{data:x=[]}=Y({queryKey:["sessions"],queryFn:G.sessions.getAll}),g=x.map(f=>({id:f.id,date:f.date,topic:f.topic,mainTopic:f.mainTopic,mode:f.mode,createdAt:f.createdAt})).slice().sort((f,u)=>{const p=f.date||f.createdAt||"";return(u.date||u.createdAt||"").localeCompare(p)}).slice(0,20),y=me({mutationFn:()=>G.planner.generate(),onSuccess:f=>{h({title:"Planner tasks generated",description:`${f.tasks_created} review tasks created`}),d.invalidateQueries({queryKey:["planner","queue"]})},onError:f=>{h({title:"Failed to generate tasks",description:f.message,variant:"destructive"})}}),w=me({mutationFn:async()=>{if(!s)throw new Error("Select a session first");let f;try{f=JSON.parse(e)}catch{throw new Error("Invalid JSON â€” check syntax")}let u=a;if(u==="auto"){const N=Object.keys(f),D=["source_lock","plan_of_attack","frameworks_used","buckets","confusables_interleaved","anki_cards","glossary","exit_ticket_blurt","exit_ticket_muddiest","exit_ticket_next_action","retrospective_status","spaced_reviews","next_session","errors_by_type","errors_by_severity","error_patterns","spacing_algorithm","rsr_adaptive_adjustment","adaptive_multipliers"];u=N.some(T=>D.includes(T))?"enhanced":"tracker"}const p=u==="tracker"?f:void 0,v=u==="enhanced"?f:void 0;return G.brain.ingestSessionJson(s,p,v)},onSuccess:f=>{h({title:"JSON ingested",description:`${f.fields_updated} fields updated on session #${f.session_id}`}),d.invalidateQueries({queryKey:["sessions"]}),d.invalidateQueries({queryKey:["brain","metrics"]}),h({title:"Next step: Generate planner tasks?",description:"Create review tasks from weak anchors",duration:1e4,action:t.jsx(B,{size:"sm",onClick:()=>y.mutate(),disabled:y.isPending,className:"bg-primary text-black hover:bg-primary/80",children:y.isPending?"Generating...":"Generate Now"})}),n(""),i([])},onError:f=>{h({title:"Ingestion failed",description:f.message,variant:"destructive"})}});function P(){const f=[];if(s||f.push("Select a session"),!e.trim())f.push("Paste JSON first");else try{const u=JSON.parse(e);(typeof u!="object"||Array.isArray(u))&&f.push("JSON must be an object, not array"),u.schema_version&&u.schema_version!=="9.4"&&f.push(`Expected schema_version 9.4, got ${u.schema_version}`)}catch{f.push("Invalid JSON syntax")}return i(f),f.length===0}return t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 bg-primary inline-block"}),"SESSION_JSON_INGEST"]})}),t.jsxs(Ie,{className:"p-4 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"TARGET SESSION"}),t.jsxs("select",{value:s??"",onChange:f=>r(f.target.value?Number(f.target.value):null),className:"w-full bg-black border border-primary/50 text-white font-terminal text-xs p-2 rounded-none focus:border-primary outline-none",children:[t.jsx("option",{value:"",children:"-- select session --"}),g.map(f=>t.jsxs("option",{value:f.id,children:["#",f.id," | ",f.date?.slice(0,10)||"?"," | ",f.topic||f.mainTopic||"Untitled"," | ",f.mode||"?"]},f.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"JSON TYPE"}),t.jsx("div",{className:"flex gap-2",children:["auto","tracker","enhanced"].map(f=>t.jsx("button",{onClick:()=>o(f),className:`px-3 py-1 font-arcade text-xs rounded-none border ${a===f?"bg-primary text-black border-primary":"border-primary/30 text-muted-foreground hover:text-white"}`,children:f.toUpperCase()},f))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"PASTE TRACKER OR ENHANCED JSON"}),t.jsx("textarea",{value:e,onChange:f=>n(f.target.value),placeholder:'{"schema_version": "9.4", "topic": "...", "mode": "Core", ...}',rows:10,className:"w-full bg-black border border-primary/50 text-green-400 font-terminal text-xs p-2 rounded-none focus:border-primary outline-none resize-y"})]}),l.length>0&&t.jsx("div",{className:"border border-red-500/50 bg-red-500/10 p-2 font-terminal text-xs text-red-400 space-y-1",children:l.map((f,u)=>t.jsxs("div",{children:["- ",f]},u))}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>{P()&&w.mutate()},disabled:w.isPending,className:"px-4 py-2 bg-primary text-black font-arcade text-xs rounded-none hover:bg-primary/80 disabled:opacity-50",children:w.isPending?"INGESTING...":"INGEST"}),t.jsx("button",{onClick:P,className:"px-4 py-2 border border-primary/50 text-primary font-arcade text-xs rounded-none hover:bg-primary/10",children:"VALIDATE"}),t.jsx("button",{onClick:()=>{n(""),i([])},className:"px-4 py-2 border border-primary/30 text-muted-foreground font-arcade text-xs rounded-none hover:text-white",children:"CLEAR"})]})]})]})}const Ho=`You are extracting a course schedule for ingestion.

Return ONLY a valid JSON object with NO additional text, NO markdown code blocks, NO explanation.

Structure:
{
  "name": "Course Name (e.g. Anatomy & Physiology II)",
  "term": {
    "startDate": "2026-01-05",
    "endDate": "2026-04-24",
    "timezone": "America/Chicago"
  },
  "events": [
    {
      "type": "class" | "lecture" | "reading" | "topic" | "assignment" | "quiz" | "exam" | "assessment",
      "title": "string",
      "date": "YYYY-MM-DD",
      "dueDate": "YYYY-MM-DD | null",
      "startTime": "HH:MM | null",
      "endTime": "HH:MM | null",
      "daysOfWeek": ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
      "delivery": "in_person" | "virtual_sync" | "virtual_async" | "hybrid",
      "assessmentType": "EA | null",
      "moduleName": "Module 1: ... | null",
      "notes": "string | null"
    }
  ]
}

Rules:
1. Include ALL schedule items: class meetings, assignments, quizzes, exams, readings, virtual activities, and learning assessments (EA).
2. For repeating class meetings, set daysOfWeek + startTime/endTime, and include term start/end.
3. For one-off items, set date or dueDate.
4. Do NOT include a "modules" array â€” schedule only.
5. Return ONLY the JSON object, nothing else.

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,Vo=`You are extracting course module structure for ingestion.

Return ONLY a valid JSON object with NO additional text, NO markdown code blocks, NO explanation.

Structure:
{
  "modules": [
    {
      "name": "Module 1: Topic Name",
      "orderIndex": 1,
      "topics": ["Topic A", "Topic B"],
      "readings": ["Chapter 1", "Article X"],
      "assessments": ["Quiz 1", "Exam 1"]
    }
  ]
}

Rules:
1. Include ALL modules/units with their topics, readings, and assessments.
2. orderIndex should be sequential starting at 1.
3. Do NOT include dates or events â€” structure only.
4. Return ONLY the JSON object, nothing else.

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,Go=`I need you to extract learning objectives from my course material.

Return ONLY a valid JSON array with NO additional text, NO markdown code blocks, NO explanation.

Structure for each item:
{
  "loCode": "string",
  "title": "string"
}

Rules:
1. loCode: Preserve original numbering if present, or create sequential "1", "2", "3"...
2. title: Keep the objective text exactly as written
3. Return ONLY the JSON array, nothing else

Here are my learning objectives:

[PASTE YOUR LOs BELOW]`,Bo=`I need you to convert my study session notes into WRAP format.

WRAP format has 4 sections:

Section A: Obsidian Notes
- Main concepts and insights from the session
- Key points to remember

Section B: Anki Cards
- Format: "front: [question]" on one line, "back: [answer]" on next line
- Create cards for important facts and concepts

Section C: Spaced Schedule
- R1=tomorrow
- R2=3d
- R3=1w
- R4=2w

Section D: JSON Logs
\`\`\`json
{
  "merged": {
    "topic": "[main topic]",
    "mode": "Core",
    "duration_minutes": [number],
    "understanding": [1-5],
    "retention": [1-5]
  }
}
\`\`\`

Return ONLY the WRAP formatted content, NO additional text or explanation.

Here are my study notes:

[PASTE YOUR NOTES BELOW]`;function qo(){const e=et(),[n,s]=c.useState(null),[r,a]=c.useState(null),[o,l]=c.useState("schedule"),[i,d]=c.useState(""),[h,x]=c.useState(""),[b,g]=c.useState(""),[y,w]=c.useState(""),[P,f]=c.useState(null),[u,p]=c.useState(null),[v,N]=c.useState(null),[D,T]=c.useState(null),[R,k]=c.useState(null),[H,j]=c.useState(null),{data:C=[]}=Y({queryKey:["courses"],queryFn:()=>G.courses.getActive()}),{data:A=[]}=Y({queryKey:["modules",n],queryFn:()=>n?G.modules.getByCourse(n):Promise.resolve([]),enabled:!!n}),{data:_=[]}=Y({queryKey:["learningObjectives",n],queryFn:()=>n?G.learningObjectives.getByCourse(n):Promise.resolve([]),enabled:!!n}),$=m=>{const S=m.trim();if(!S)return"";const z=S.match(/```json\s*([\s\S]*?)```/i)||S.match(/```\s*([\s\S]*?)```/i),E=z?z[1].trim():S,I=E.indexOf("["),L=E.lastIndexOf("]"),V=E.indexOf("{"),K=E.lastIndexOf("}");return I!==-1&&L!==-1&&L>I&&(V===-1||I<V)?E.slice(I,L+1).trim():V!==-1&&K!==-1&&K>V?E.slice(V,K+1).trim():E},M=m=>{navigator.clipboard.writeText(m)},F=me({mutationFn:async m=>{if(!n)throw new Error("Select a course first");const z={...JSON.parse($(m)),modules:[]};return G.syllabus.importBulk(n,z)},onSuccess:m=>{e.invalidateQueries({queryKey:["scheduleEvents"]}),d(""),k(null),N({type:"success",message:`Imported: ${m.eventsCreated} events (${m.classMeetingsExpanded} class meetings expanded)`}),f(null)},onError:m=>{N({type:"error",message:m.message||"Failed to import schedule"})}}),q=me({mutationFn:async m=>{if(!n)throw new Error("Select a course first");const S=JSON.parse($(m)),z=S.modules||S;return G.modules.createBulk(n,z)},onSuccess:()=>{e.invalidateQueries({queryKey:["modules"]}),x(""),j(null),T({type:"success",message:"Modules imported successfully"}),f(null)},onError:m=>{T({type:"error",message:m.message||"Failed to import modules"})}}),J=me({mutationFn:async m=>{if(!n)throw new Error("Select a course first");const S=JSON.parse($(m));return G.learningObjectives.createBulk(n,r,S)},onSuccess:()=>{e.invalidateQueries({queryKey:["learningObjectives"]}),g(""),f(null)},onError:m=>{f(m.message||"Failed to import LOs")}}),ne=m=>{const S=[];try{const z=$(m);if(!z){k({isValid:!1,errors:["No JSON found"]});return}const E=JSON.parse(z);(!E||typeof E!="object")&&S.push("JSON must be an object"),(!E.name||typeof E.name!="string")&&S.push("Missing 'name' field"),!E.term||typeof E.term!="object"?S.push("Missing 'term' object"):(E.term.startDate||S.push("term.startDate is required"),E.term.endDate||S.push("term.endDate is required")),Array.isArray(E.events)||S.push("Missing 'events' array"),S.length===0?k({isValid:!0,errors:[],preview:{courseName:E.name,eventCount:E.events.length,startDate:E.term?.startDate,endDate:E.term?.endDate}}):k({isValid:!1,errors:S})}catch(z){k({isValid:!1,errors:[`Invalid JSON: ${z.message}`]})}},de=m=>{const S=[];try{const z=$(m);if(!z){j({isValid:!1,errors:["No JSON found"]});return}const E=JSON.parse(z),I=E.modules||(Array.isArray(E)?E:null);Array.isArray(I)?I.length===0&&S.push("modules array is empty"):S.push("Missing 'modules' array"),S.length===0?j({isValid:!0,errors:[],preview:{moduleCount:I.length}}):j({isValid:!1,errors:S})}catch(z){j({isValid:!1,errors:[`Invalid JSON: ${z.message}`]})}},re=async()=>{try{p(null);const m=await G.brain.chat(y,!1,"wrap");m.sessionSaved?(p({type:"success",message:`Session saved! ID: ${m.sessionId}, Cards: ${m.cardsCreated||0}`}),w("")):p({type:"error",message:m.sessionError||"Failed to process WRAP content"})}catch(m){p({type:"error",message:m.message||"Failed to ingest"})}},se=[{key:"schedule",label:"SCHEDULE",icon:t.jsx(Wt,{className:"w-3.5 h-3.5"})},{key:"modules",label:"MODULES",icon:t.jsx(Fe,{className:"w-3.5 h-3.5"})},{key:"objectives",label:"OBJECTIVES",icon:t.jsx(wt,{className:"w-3.5 h-3.5"})}];return t.jsxs("div",{className:"space-y-6 p-4",children:[t.jsx(Fo,{}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),t.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:n||"",onChange:m=>{s(m.target.value?parseInt(m.target.value):null),a(null)},children:[t.jsx("option",{value:"",children:"-- Select Course --"}),C.map(m=>t.jsx("option",{value:m.id,children:m.name},m.id))]})]}),!n&&t.jsx("p",{className:"text-center text-muted-foreground font-terminal text-sm py-8",children:"Select a course above to begin ingestion."}),n&&t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none mb-6",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-2",children:[t.jsx(Ls,{className:"w-4 h-4"}),"WRAP SESSION INGESTION"]})}),t.jsxs(Ie,{className:"p-4",children:[u&&t.jsx("div",{className:`mb-4 p-3 rounded-none font-terminal text-sm ${u.type==="success"?"bg-success/20 border border-success text-success":"bg-destructive/20 border border-destructive text-destructive"}`,children:u.message}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("button",{onClick:()=>M(Bo),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),t.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Use ChatGPT to convert your notes to WRAP format, then paste or upload below:"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm mb-2 font-terminal text-muted-foreground",children:"Paste WRAP Content"}),t.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-48 font-terminal text-sm",placeholder:"Paste your WRAP session here...",value:y,onChange:m=>{w(m.target.value),p(null)}})]}),t.jsx("button",{onClick:re,disabled:!y,className:"bg-primary hover:bg-primary/80 disabled:opacity-50 px-6 py-3 rounded-none font-arcade text-sm w-full",type:"button",children:"INGEST WRAP SESSION"})]})]})]}),n&&P&&t.jsx("div",{className:"bg-destructive/20 border border-destructive rounded-none p-3 text-destructive font-terminal",children:P}),n&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex border-b border-primary/50",children:se.map(m=>t.jsxs("button",{onClick:()=>l(m.key),className:`flex items-center gap-1.5 px-4 py-2 font-arcade text-xs border-b-2 transition-colors ${o===m.key?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-primary/70"}`,type:"button",children:[m.icon,m.label]},m.key))}),o==="schedule"&&t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-2",children:[t.jsx(Wt,{className:"w-4 h-4"}),"SCHEDULE IMPORT"]})}),t.jsxs(Ie,{className:"p-4 space-y-4",children:[t.jsx("button",{onClick:()=>M(Ho),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),t.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (schedule JSON) below:"}),t.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-40 font-terminal text-sm",placeholder:'{"name":"...","term":{...},"events":[...]}',value:i,onChange:m=>{d(m.target.value),N(null),m.target.value.trim()?ne(m.target.value):k(null)}}),R&&!R.isValid&&t.jsxs("div",{className:"p-2 border border-destructive bg-destructive/20 rounded-none font-terminal text-xs text-destructive",children:[t.jsx("div",{className:"font-bold mb-1",children:"Validation Errors:"}),R.errors.map((m,S)=>t.jsxs("div",{children:["â€¢ ",m]},S))]}),R?.isValid&&R.preview&&t.jsxs("div",{className:"p-3 border border-primary bg-primary/10 rounded-none font-terminal text-xs text-primary",children:[t.jsx("div",{className:"font-bold mb-2",children:"Valid JSON Preview:"}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Course:"})," ",R.preview.courseName]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Events:"})," ",R.preview.eventCount]}),R.preview.startDate&&t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Start:"})," ",R.preview.startDate]}),R.preview.endDate&&t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"End:"})," ",R.preview.endDate]})]})]}),t.jsx("button",{onClick:()=>F.mutate(i),disabled:!R?.isValid||F.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:F.isPending?"Importing...":"Import Schedule"}),v&&t.jsx("div",{className:`p-2 border font-terminal text-xs ${v.type==="success"?"border-success text-success":"border-destructive text-destructive"}`,children:v.message})]})]}),o==="modules"&&t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-2",children:[t.jsx(Fe,{className:"w-4 h-4"}),"MODULES IMPORT"]})}),t.jsxs(Ie,{className:"p-4 space-y-4",children:[t.jsx("button",{onClick:()=>M(Vo),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),t.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (modules JSON) below:"}),t.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-40 font-terminal text-sm",placeholder:'{"modules":[{"name":"Module 1: ...","orderIndex":1,"topics":[...],"readings":[...],"assessments":[...]}]}',value:h,onChange:m=>{x(m.target.value),T(null),m.target.value.trim()?de(m.target.value):j(null)}}),H&&!H.isValid&&t.jsxs("div",{className:"p-2 border border-destructive bg-destructive/20 rounded-none font-terminal text-xs text-destructive",children:[t.jsx("div",{className:"font-bold mb-1",children:"Validation Errors:"}),H.errors.map((m,S)=>t.jsxs("div",{children:["â€¢ ",m]},S))]}),H?.isValid&&H.preview&&t.jsxs("div",{className:"p-3 border border-primary bg-primary/10 rounded-none font-terminal text-xs text-primary",children:[t.jsx("div",{className:"font-bold mb-2",children:"Valid JSON Preview:"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Modules:"})," ",H.preview.moduleCount]})]}),t.jsx("button",{onClick:()=>q.mutate(h),disabled:!H?.isValid||q.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:q.isPending?"Importing...":"Import Modules"}),D&&t.jsx("div",{className:`p-2 border font-terminal text-xs ${D.type==="success"?"border-success text-success":"border-destructive text-destructive"}`,children:D.message})]})]}),o==="objectives"&&t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-2",children:[t.jsx(wt,{className:"w-4 h-4"}),"LEARNING OBJECTIVES IMPORT"]})}),t.jsxs(Ie,{className:"p-4 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs mb-1 font-terminal text-muted-foreground",children:"Target Module (optional)"}),t.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:r||"",onChange:m=>a(m.target.value?parseInt(m.target.value):null),children:[t.jsx("option",{value:"",children:"-- No Module (Course-level) --"}),A.map(m=>t.jsx("option",{value:m.id,children:m.name},m.id))]})]}),t.jsx("button",{onClick:()=>M(Go),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),t.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (JSON array) below:"}),t.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-32 font-terminal text-sm",placeholder:'[{"loCode": "1.1", "title": "Define..."}]',value:b,onChange:m=>g(m.target.value)}),t.jsx("button",{onClick:()=>J.mutate(b),disabled:!b||J.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:J.isPending?"Importing...":"Import LOs"}),_.length>0&&t.jsxs("div",{children:[t.jsxs("h4",{className:"font-terminal text-xs mb-2",children:["Current LOs (",_.length,")"]}),t.jsx("div",{className:"max-h-48 overflow-y-auto",children:_.map(m=>t.jsxs("div",{className:"text-xs py-1 border-b border-secondary/30 font-terminal",children:[t.jsx("span",{className:"text-primary",children:m.loCode}),": ",m.title,t.jsx("span",{className:`ml-2 text-[10px] px-1 rounded-none ${m.status==="solid"?"bg-success":m.status==="in_progress"?"bg-warning":m.status==="need_review"?"bg-urgent":"bg-secondary"}`,children:m.status})]},m.id))})]})]})]})]})]})}function Ko({workspace:e}){return t.jsx(Et,{open:e.importOpen,onOpenChange:e.setImportOpen,children:t.jsxs(Pt,{"data-modal":"brain-import",className:"max-w-2xl bg-black border-2 border-primary rounded-none",children:[t.jsxs(Rt,{children:[t.jsxs(It,{className:"font-arcade text-sm text-primary flex items-center gap-2",children:[t.jsx($t,{className:"w-4 h-4"}),"IMPORT / INGEST"]}),t.jsx(zt,{className:"font-terminal text-xs text-muted-foreground",children:"Import study materials, JSON session data, or documents into the system."})]}),t.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:t.jsx(qo,{})})]})})}const Uo=["vault","main"];function bn(){if(typeof window>"u")return"main";const n=new URLSearchParams(window.location.search).get("tab");return Uo.includes(n)?n:"main"}function Wo(e){if(typeof window>"u")return;const n=new URLSearchParams(window.location.search);n.set("tab",e);const s=`${window.location.pathname}?${n.toString()}`;window.history.replaceState({},"",s)}function Jo(){const e=na(),[n,s]=c.useState("main"),[r,a]=c.useState(!1),o=c.useRef(!1);c.useEffect(()=>{s(bn())},[]),c.useEffect(()=>{if(o.current)return;o.current=!0;const i=requestAnimationFrame(()=>{requestAnimationFrame(()=>a(!0))});return()=>cancelAnimationFrame(i)},[]);const l=c.useCallback(i=>{s(i),Wo(i)},[]);return c.useEffect(()=>{const i=()=>{s(bn())};return window.addEventListener("popstate",i),()=>window.removeEventListener("popstate",i)},[]),t.jsx(Is,{children:t.jsxs("div",{className:`brain-workspace fixed inset-x-0 top-[68px] bottom-[48px] flex flex-col min-w-0 overflow-hidden z-30 ${r?"brain-workspace--ready":""}`,children:[t.jsx("div",{className:"brain-workspace__top-bar shrink-0",children:t.jsx(sa,{workspace:e})}),t.jsx("div",{className:"hidden lg:flex flex-1 min-h-0",children:t.jsxs(Qr,{direction:"horizontal",autoSaveId:"brain-workspace-v2",className:"h-full",children:[t.jsx(sn,{defaultSize:20,minSize:12,maxSize:35,children:t.jsx("div",{className:"brain-workspace__sidebar-wrap h-full border-r border-primary/30 bg-black/40",children:t.jsx(an,{workspace:e})})}),t.jsx(Xr,{withHandle:!0,className:"hover:bg-primary/10 transition-colors data-[resize-handle-active]:bg-primary/20"}),t.jsx(sn,{defaultSize:80,minSize:50,children:t.jsx("div",{className:"brain-workspace__main-wrap brain-workspace__canvas h-full min-h-0 overflow-hidden",children:t.jsx(gn,{workspace:e})})})]})}),t.jsxs("div",{className:"flex flex-col flex-1 min-h-0 lg:hidden",children:[t.jsxs("div",{className:"brain-workspace__canvas flex-1 min-h-0 overflow-auto",children:[n==="vault"&&t.jsx(an,{workspace:e}),n==="main"&&t.jsx(gn,{workspace:e})]}),t.jsxs("nav",{className:"flex items-center border-t-2 border-primary/50 bg-black/80 shrink-0","aria-label":"Mobile navigation",children:[t.jsxs("button",{onClick:()=>l("vault"),className:`flex-1 flex flex-col items-center gap-0.5 py-3 text-xs font-terminal transition-colors ${n==="vault"?"text-primary":"text-muted-foreground"}`,"aria-current":n==="vault"?"page":void 0,"aria-label":"Vault",children:[t.jsx(jn,{className:"w-5 h-5","aria-hidden":"true"}),"Vault"]}),t.jsxs("button",{onClick:()=>l("main"),className:`flex-1 flex flex-col items-center gap-0.5 py-3 text-xs font-terminal transition-colors ${n==="main"?"text-primary":"text-muted-foreground"}`,"aria-current":n==="main"?"page":void 0,"aria-label":"Content",children:[t.jsx(Ue,{className:"w-5 h-5","aria-hidden":"true"}),"Content"]})]})]}),t.jsx(Ko,{workspace:e})]})})}const xi=Object.freeze(Object.defineProperty({__proto__:null,default:Jo},Symbol.toStringTag,{value:"Module"}));export{$t as D,gr as M,pr as a,xi as b,Lo as t};

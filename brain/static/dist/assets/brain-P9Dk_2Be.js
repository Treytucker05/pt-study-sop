const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ConceptMapEditor-DQGSQfhr.js","assets/index-Dq2i42cU.js","assets/index-em7TAz67.css","assets/tldraw-CYupBORI.js","assets/layout-MVbPqDQb.js","assets/select-DYp6QAUH.js","assets/index-w1J5KrVK.js","assets/tabs-khOR1vqB.js","assets/tldraw-BWDvGoXv.css","assets/zoom-DwwqPMg_.js","assets/colors-BDuz-soV.js","assets/plus-DkBY5gKF.js","assets/triangle-alert-zTkZZD3C.js","assets/file-text-B5MhEYMk.js","assets/refresh-cw-BOYL3V07.js","assets/index-C5llXmyt.js","assets/search-DYkyF6sy.js","assets/message-square-g8S0jRvh.js","assets/loader-circle-CucYDA9g.js","assets/send-CZYNsg88.js","assets/badge-BA71vPQw.js","assets/checkbox-DS-B7bFA.js","assets/external-link-BMMFd1O-.js","assets/star-D4IGpTMF.js","assets/ConceptMapEditor-BZV40eAE.css","assets/VaultGraphView-DCyJtgl0.js","assets/react-force-graph-2d-rix-61MS.js","assets/MindMapView-L7wxlOmN.js"])))=>i.map(i=>d[i]);
import{c as X,r as d,R as wn,j as t,b as Q,X as Nt,f as Cs,e as jn,P as Ze,d as Pt,g as Es,h as Ps,u as et,a as tt,_ as Rt}from"./index-Dq2i42cU.js";import{G as Rs,f as Y,a as G,B,I as Ce,S as Oe,p as St,r as Is,g as It,i as zt,j as At,k as Tt,l as Mt,s as _t,n as Ke,u as me,o as dt,m as Ue,t as Wt,v as zs,L as As}from"./layout-MVbPqDQb.js";import{T as Dt,A as Ts,C as Ms}from"./triangle-alert-zTkZZD3C.js";import{R as Ae}from"./refresh-cw-BOYL3V07.js";import{F as Nn,M as _s,r as Ds,D as $s}from"./index-C5llXmyt.js";import{S as Sn}from"./search-DYkyF6sy.js";import{F as nt}from"./file-text-B5MhEYMk.js";import{a as Ls,C as Os,u as Fs}from"./index-w1J5KrVK.js";import{M as kn}from"./message-square-g8S0jRvh.js";import{L as Fe,c as Cn,R as Hs,I as Vs,T as Gs,a as qs,b as ut,d as mt,C as Bs}from"./tabs-khOR1vqB.js";import{L as $t}from"./loader-circle-CucYDA9g.js";import{S as Ks}from"./send-CZYNsg88.js";import{B as We,C as Ee,a as Pe,b as Re,c as Ie}from"./badge-BA71vPQw.js";import{C as En}from"./checkbox-DS-B7bFA.js";import{C as Us}from"./colors-BDuz-soV.js";import{E as Ws}from"./external-link-BMMFd1O-.js";import{P as Jt}from"./plus-DkBY5gKF.js";import{S as Js}from"./star-D4IGpTMF.js";import{S as Ys,a as Qs,b as Xs,c as Zs,d as xe}from"./select-DYp6QAUH.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],tr=X("brain-circuit",er);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Yt=X("calendar-days",nr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]],rr=X("columns-2",sr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ir=X("copy",ar);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Pn=X("download",or);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],cr=X("file",lr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],ur=X("folder",dr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],fr=X("image",mr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],pr=X("maximize-2",hr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],gr=X("minimize-2",xr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]],yr=X("network",br);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],Qt=X("panel-left-close",vr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]],jr=X("panel-right-open",wr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}]],Sr=X("rows-2",Nr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]],Cr=X("table-2",kr),st=d.createContext(null);st.displayName="PanelGroupContext";const J={group:"data-panel-group",groupDirection:"data-panel-group-direction",groupId:"data-panel-group-id",panel:"data-panel",panelCollapsible:"data-panel-collapsible",panelId:"data-panel-id",panelSize:"data-panel-size",resizeHandle:"data-resize-handle",resizeHandleActive:"data-resize-handle-active",resizeHandleEnabled:"data-panel-resize-handle-enabled",resizeHandleId:"data-panel-resize-handle-id",resizeHandleState:"data-resize-handle-state"},Lt=10,ye=d.useLayoutEffect,Xt=wn.useId,Er=typeof Xt=="function"?Xt:()=>null;let Pr=0;function Ot(e=null){const n=Er(),s=d.useRef(e||n||null);return s.current===null&&(s.current=""+Pr++),e??s.current}function Rn({children:e,className:n="",collapsedSize:s,collapsible:r,defaultSize:a,forwardedRef:i,id:l,maxSize:o,minSize:c,onCollapse:h,onExpand:p,onResize:b,order:x,style:j,tagName:S="div",...I}){const f=d.useContext(st);if(f===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:u,expandPanel:y,getPanelSize:g,getPanelStyle:v,groupId:T,isPanelCollapsed:D,reevaluatePanelConstraints:k,registerPanel:w,resizePanel:F,unregisterPanel:E}=f,P=Ot(l),_=d.useRef({callbacks:{onCollapse:h,onExpand:p,onResize:b},constraints:{collapsedSize:s,collapsible:r,defaultSize:a,maxSize:o,minSize:c},id:P,idIsFromProps:l!==void 0,order:x});d.useRef({didLogMissingDefaultSizeWarning:!1}),ye(()=>{const{callbacks:R,constraints:M}=_.current,L={...M};_.current.id=P,_.current.idIsFromProps=l!==void 0,_.current.order=x,R.onCollapse=h,R.onExpand=p,R.onResize=b,M.collapsedSize=s,M.collapsible=r,M.defaultSize=a,M.maxSize=o,M.minSize=c,(L.collapsedSize!==M.collapsedSize||L.collapsible!==M.collapsible||L.maxSize!==M.maxSize||L.minSize!==M.minSize)&&k(_.current,L)}),ye(()=>{const R=_.current;return w(R),()=>{E(R)}},[x,P,w,E]),d.useImperativeHandle(i,()=>({collapse:()=>{u(_.current)},expand:R=>{y(_.current,R)},getId(){return P},getSize(){return g(_.current)},isCollapsed(){return D(_.current)},isExpanded(){return!D(_.current)},resize:R=>{F(_.current,R)}}),[u,y,g,D,P,F]);const H=v(_.current,a);return d.createElement(S,{...I,children:e,className:n,id:P,style:{...H,...j},[J.groupId]:T,[J.panel]:"",[J.panelCollapsible]:r||void 0,[J.panelId]:P,[J.panelSize]:parseFloat(""+H.flexGrow).toFixed(1)})}const In=d.forwardRef((e,n)=>d.createElement(Rn,{...e,forwardedRef:n}));Rn.displayName="Panel";In.displayName="forwardRef(Panel)";let kt=null,Be=-1,he=null;function Rr(e,n){if(n){const s=(n&_n)!==0,r=(n&Dn)!==0,a=(n&$n)!==0,i=(n&Ln)!==0;if(s)return a?"se-resize":i?"ne-resize":"e-resize";if(r)return a?"sw-resize":i?"nw-resize":"w-resize";if(a)return"s-resize";if(i)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function Ir(){he!==null&&(document.head.removeChild(he),kt=null,he=null,Be=-1)}function ft(e,n){var s,r;const a=Rr(e,n);if(kt!==a){if(kt=a,he===null&&(he=document.createElement("style"),document.head.appendChild(he)),Be>=0){var i;(i=he.sheet)===null||i===void 0||i.removeRule(Be)}Be=(s=(r=he.sheet)===null||r===void 0?void 0:r.insertRule(`*{cursor: ${a} !important;}`))!==null&&s!==void 0?s:-1}}function zn(e){return e.type==="keydown"}function An(e){return e.type.startsWith("pointer")}function Tn(e){return e.type.startsWith("mouse")}function rt(e){if(An(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(Tn(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}function zr(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function Ar(e,n,s){return e.x<n.x+n.width&&e.x+e.width>n.x&&e.y<n.y+n.height&&e.y+e.height>n.y}function Tr(e,n){if(e===n)throw new Error("Cannot compare node with itself");const s={a:tn(e),b:tn(n)};let r;for(;s.a.at(-1)===s.b.at(-1);)e=s.a.pop(),n=s.b.pop(),r=e;O(r,"Stacking order can only be calculated for elements with a common ancestor");const a={a:en(Zt(s.a)),b:en(Zt(s.b))};if(a.a===a.b){const i=r.childNodes,l={a:s.a.at(-1),b:s.b.at(-1)};let o=i.length;for(;o--;){const c=i[o];if(c===l.a)return 1;if(c===l.b)return-1}}return Math.sign(a.a-a.b)}const Mr=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function _r(e){var n;const s=getComputedStyle((n=Mn(e))!==null&&n!==void 0?n:e).display;return s==="flex"||s==="inline-flex"}function Dr(e){const n=getComputedStyle(e);return!!(n.position==="fixed"||n.zIndex!=="auto"&&(n.position!=="static"||_r(e))||+n.opacity<1||"transform"in n&&n.transform!=="none"||"webkitTransform"in n&&n.webkitTransform!=="none"||"mixBlendMode"in n&&n.mixBlendMode!=="normal"||"filter"in n&&n.filter!=="none"||"webkitFilter"in n&&n.webkitFilter!=="none"||"isolation"in n&&n.isolation==="isolate"||Mr.test(n.willChange)||n.webkitOverflowScrolling==="touch")}function Zt(e){let n=e.length;for(;n--;){const s=e[n];if(O(s,"Missing node"),Dr(s))return s}return null}function en(e){return e&&Number(getComputedStyle(e).zIndex)||0}function tn(e){const n=[];for(;e;)n.push(e),e=Mn(e);return n}function Mn(e){const{parentNode:n}=e;return n&&n instanceof ShadowRoot?n.host:n}const _n=1,Dn=2,$n=4,Ln=8,$r=zr()==="coarse";let oe=[],Te=!1,be=new Map,at=new Map;const He=new Set;function Lr(e,n,s,r,a){var i;const{ownerDocument:l}=n,o={direction:s,element:n,hitAreaMargins:r,setResizeHandlerState:a},c=(i=be.get(l))!==null&&i!==void 0?i:0;return be.set(l,c+1),He.add(o),Je(),function(){var p;at.delete(e),He.delete(o);const b=(p=be.get(l))!==null&&p!==void 0?p:1;if(be.set(l,b-1),Je(),b===1&&be.delete(l),oe.includes(o)){const x=oe.indexOf(o);x>=0&&oe.splice(x,1),Ht(),a("up",!0,null)}}}function Or(e){const{target:n}=e,{x:s,y:r}=rt(e);Te=!0,Ft({target:n,x:s,y:r}),Je(),oe.length>0&&(Ye("down",e),e.preventDefault(),On(n)||e.stopImmediatePropagation())}function ht(e){const{x:n,y:s}=rt(e);if(Te&&e.buttons===0&&(Te=!1,Ye("up",e)),!Te){const{target:r}=e;Ft({target:r,x:n,y:s})}Ye("move",e),Ht(),oe.length>0&&e.preventDefault()}function pt(e){const{target:n}=e,{x:s,y:r}=rt(e);at.clear(),Te=!1,oe.length>0&&(e.preventDefault(),On(n)||e.stopImmediatePropagation()),Ye("up",e),Ft({target:n,x:s,y:r}),Ht(),Je()}function On(e){let n=e;for(;n;){if(n.hasAttribute(J.resizeHandle))return!0;n=n.parentElement}return!1}function Ft({target:e,x:n,y:s}){oe.splice(0);let r=null;(e instanceof HTMLElement||e instanceof SVGElement)&&(r=e),He.forEach(a=>{const{element:i,hitAreaMargins:l}=a,o=i.getBoundingClientRect(),{bottom:c,left:h,right:p,top:b}=o,x=$r?l.coarse:l.fine;if(n>=h-x&&n<=p+x&&s>=b-x&&s<=c+x){if(r!==null&&document.contains(r)&&i!==r&&!i.contains(r)&&!r.contains(i)&&Tr(r,i)>0){let S=r,I=!1;for(;S&&!S.contains(i);){if(Ar(S.getBoundingClientRect(),o)){I=!0;break}S=S.parentElement}if(I)return}oe.push(a)}})}function xt(e,n){at.set(e,n)}function Ht(){let e=!1,n=!1;oe.forEach(r=>{const{direction:a}=r;a==="horizontal"?e=!0:n=!0});let s=0;at.forEach(r=>{s|=r}),e&&n?ft("intersection",s):e?ft("horizontal",s):n?ft("vertical",s):Ir()}let gt=new AbortController;function Je(){gt.abort(),gt=new AbortController;const e={capture:!0,signal:gt.signal};He.size&&(Te?(oe.length>0&&be.forEach((n,s)=>{const{body:r}=s;n>0&&(r.addEventListener("contextmenu",pt,e),r.addEventListener("pointerleave",ht,e),r.addEventListener("pointermove",ht,e))}),window.addEventListener("pointerup",pt,e),window.addEventListener("pointercancel",pt,e)):be.forEach((n,s)=>{const{body:r}=s;n>0&&(r.addEventListener("pointerdown",Or,e),r.addEventListener("pointermove",ht,e))}))}function Ye(e,n){He.forEach(s=>{const{setResizeHandlerState:r}=s,a=oe.includes(s);r(e,a,n)})}function Fr(){const[e,n]=d.useState(0);return d.useCallback(()=>n(s=>s+1),[])}function O(e,n){if(!e)throw console.error(n),Error(n)}function ve(e,n,s=Lt){return e.toFixed(s)===n.toFixed(s)?0:e>n?1:-1}function ue(e,n,s=Lt){return ve(e,n,s)===0}function ne(e,n,s){return ve(e,n,s)===0}function Hr(e,n,s){if(e.length!==n.length)return!1;for(let r=0;r<e.length;r++){const a=e[r],i=n[r];if(!ne(a,i,s))return!1}return!0}function ze({panelConstraints:e,panelIndex:n,size:s}){const r=e[n];O(r!=null,`Panel constraints not found for index ${n}`);let{collapsedSize:a=0,collapsible:i,maxSize:l=100,minSize:o=0}=r;if(ve(s,o)<0)if(i){const c=(a+o)/2;ve(s,c)<0?s=a:s=o}else s=o;return s=Math.min(l,s),s=parseFloat(s.toFixed(Lt)),s}function $e({delta:e,initialLayout:n,panelConstraints:s,pivotIndices:r,prevLayout:a,trigger:i}){if(ne(e,0))return n;const l=[...n],[o,c]=r;O(o!=null,"Invalid first pivot index"),O(c!=null,"Invalid second pivot index");let h=0;if(i==="keyboard"){{const b=e<0?c:o,x=s[b];O(x,`Panel constraints not found for index ${b}`);const{collapsedSize:j=0,collapsible:S,minSize:I=0}=x;if(S){const f=n[b];if(O(f!=null,`Previous layout not found for panel index ${b}`),ne(f,j)){const u=I-f;ve(u,Math.abs(e))>0&&(e=e<0?0-u:u)}}}{const b=e<0?o:c,x=s[b];O(x,`No panel constraints found for index ${b}`);const{collapsedSize:j=0,collapsible:S,minSize:I=0}=x;if(S){const f=n[b];if(O(f!=null,`Previous layout not found for panel index ${b}`),ne(f,I)){const u=f-j;ve(u,Math.abs(e))>0&&(e=e<0?0-u:u)}}}}{const b=e<0?1:-1;let x=e<0?c:o,j=0;for(;;){const I=n[x];O(I!=null,`Previous layout not found for panel index ${x}`);const u=ze({panelConstraints:s,panelIndex:x,size:100})-I;if(j+=u,x+=b,x<0||x>=s.length)break}const S=Math.min(Math.abs(e),Math.abs(j));e=e<0?0-S:S}{let x=e<0?o:c;for(;x>=0&&x<s.length;){const j=Math.abs(e)-Math.abs(h),S=n[x];O(S!=null,`Previous layout not found for panel index ${x}`);const I=S-j,f=ze({panelConstraints:s,panelIndex:x,size:I});if(!ne(S,f)&&(h+=S-f,l[x]=f,h.toPrecision(3).localeCompare(Math.abs(e).toPrecision(3),void 0,{numeric:!0})>=0))break;e<0?x--:x++}}if(Hr(a,l))return a;{const b=e<0?c:o,x=n[b];O(x!=null,`Previous layout not found for panel index ${b}`);const j=x+h,S=ze({panelConstraints:s,panelIndex:b,size:j});if(l[b]=S,!ne(S,j)){let I=j-S,u=e<0?c:o;for(;u>=0&&u<s.length;){const y=l[u];O(y!=null,`Previous layout not found for panel index ${u}`);const g=y+I,v=ze({panelConstraints:s,panelIndex:u,size:g});if(ne(y,v)||(I-=v-y,l[u]=v),ne(I,0))break;e>0?u--:u++}}}const p=l.reduce((b,x)=>x+b,0);return ne(p,100)?l:a}function Vr({layout:e,panelsArray:n,pivotIndices:s}){let r=0,a=100,i=0,l=0;const o=s[0];O(o!=null,"No pivot index found"),n.forEach((b,x)=>{const{constraints:j}=b,{maxSize:S=100,minSize:I=0}=j;x===o?(r=I,a=S):(i+=I,l+=S)});const c=Math.min(a,100-i),h=Math.max(r,100-l),p=e[o];return{valueMax:c,valueMin:h,valueNow:p}}function Ve(e,n=document){return Array.from(n.querySelectorAll(`[${J.resizeHandleId}][data-panel-group-id="${e}"]`))}function Fn(e,n,s=document){const a=Ve(e,s).findIndex(i=>i.getAttribute(J.resizeHandleId)===n);return a??null}function Hn(e,n,s){const r=Fn(e,n,s);return r!=null?[r,r+1]:[-1,-1]}function Vn(e,n=document){var s;if(n instanceof HTMLElement&&(n==null||(s=n.dataset)===null||s===void 0?void 0:s.panelGroupId)==e)return n;const r=n.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return r||null}function it(e,n=document){const s=n.querySelector(`[${J.resizeHandleId}="${e}"]`);return s||null}function Gr(e,n,s,r=document){var a,i,l,o;const c=it(n,r),h=Ve(e,r),p=c?h.indexOf(c):-1,b=(a=(i=s[p])===null||i===void 0?void 0:i.id)!==null&&a!==void 0?a:null,x=(l=(o=s[p+1])===null||o===void 0?void 0:o.id)!==null&&l!==void 0?l:null;return[b,x]}function qr({committedValuesRef:e,eagerValuesRef:n,groupId:s,layout:r,panelDataArray:a,panelGroupElement:i,setLayout:l}){d.useRef({didWarnAboutMissingResizeHandle:!1}),ye(()=>{if(!i)return;const o=Ve(s,i);for(let c=0;c<a.length-1;c++){const{valueMax:h,valueMin:p,valueNow:b}=Vr({layout:r,panelsArray:a,pivotIndices:[c,c+1]}),x=o[c];if(x!=null){const j=a[c];O(j,`No panel data found for index "${c}"`),x.setAttribute("aria-controls",j.id),x.setAttribute("aria-valuemax",""+Math.round(h)),x.setAttribute("aria-valuemin",""+Math.round(p)),x.setAttribute("aria-valuenow",b!=null?""+Math.round(b):"")}}return()=>{o.forEach((c,h)=>{c.removeAttribute("aria-controls"),c.removeAttribute("aria-valuemax"),c.removeAttribute("aria-valuemin"),c.removeAttribute("aria-valuenow")})}},[s,r,a,i]),d.useEffect(()=>{if(!i)return;const o=n.current;O(o,"Eager values not found");const{panelDataArray:c}=o,h=Vn(s,i);O(h!=null,`No group found for id "${s}"`);const p=Ve(s,i);O(p,`No resize handles found for group id "${s}"`);const b=p.map(x=>{const j=x.getAttribute(J.resizeHandleId);O(j,"Resize handle element has no handle id attribute");const[S,I]=Gr(s,j,c,i);if(S==null||I==null)return()=>{};const f=u=>{if(!u.defaultPrevented)switch(u.key){case"Enter":{u.preventDefault();const y=c.findIndex(g=>g.id===S);if(y>=0){const g=c[y];O(g,`No panel data found for index ${y}`);const v=r[y],{collapsedSize:T=0,collapsible:D,minSize:k=0}=g.constraints;if(v!=null&&D){const w=$e({delta:ne(v,T)?k-T:T-v,initialLayout:r,panelConstraints:c.map(F=>F.constraints),pivotIndices:Hn(s,j,i),prevLayout:r,trigger:"keyboard"});r!==w&&l(w)}}break}}};return x.addEventListener("keydown",f),()=>{x.removeEventListener("keydown",f)}});return()=>{b.forEach(x=>x())}},[i,e,n,s,r,a,l])}function nn(e,n){if(e.length!==n.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!==n[s])return!1;return!0}function Gn(e,n){const s=e==="horizontal",{x:r,y:a}=rt(n);return s?r:a}function Br(e,n,s,r,a){const i=s==="horizontal",l=it(n,a);O(l,`No resize handle element found for id "${n}"`);const o=l.getAttribute(J.groupId);O(o,"Resize handle element has no group id attribute");let{initialCursorPosition:c}=r;const h=Gn(s,e),p=Vn(o,a);O(p,`No group element found for id "${o}"`);const b=p.getBoundingClientRect(),x=i?b.width:b.height;return(h-c)/x*100}function Kr(e,n,s,r,a,i){if(zn(e)){const l=s==="horizontal";let o=0;e.shiftKey?o=100:a!=null?o=a:o=10;let c=0;switch(e.key){case"ArrowDown":c=l?0:o;break;case"ArrowLeft":c=l?-o:0;break;case"ArrowRight":c=l?o:0;break;case"ArrowUp":c=l?0:-o;break;case"End":c=100;break;case"Home":c=-100;break}return c}else return r==null?0:Br(e,n,s,r,i)}function Ur({panelDataArray:e}){const n=Array(e.length),s=e.map(i=>i.constraints);let r=0,a=100;for(let i=0;i<e.length;i++){const l=s[i];O(l,`Panel constraints not found for index ${i}`);const{defaultSize:o}=l;o!=null&&(r++,n[i]=o,a-=o)}for(let i=0;i<e.length;i++){const l=s[i];O(l,`Panel constraints not found for index ${i}`);const{defaultSize:o}=l;if(o!=null)continue;const c=e.length-r,h=a/c;r++,n[i]=h,a-=h}return n}function we(e,n,s){n.forEach((r,a)=>{const i=e[a];O(i,`Panel data not found for index ${a}`);const{callbacks:l,constraints:o,id:c}=i,{collapsedSize:h=0,collapsible:p}=o,b=s[c];if(b==null||r!==b){s[c]=r;const{onCollapse:x,onExpand:j,onResize:S}=l;S&&S(r,b),p&&(x||j)&&(j&&(b==null||ue(b,h))&&!ue(r,h)&&j(),x&&(b==null||!ue(b,h))&&ue(r,h)&&x())}})}function qe(e,n){if(e.length!==n.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!=n[s])return!1;return!0}function Wr({defaultSize:e,dragState:n,layout:s,panelData:r,panelIndex:a,precision:i=3}){const l=s[a];let o;return l==null?o=e!=null?e.toPrecision(i):"1":r.length===1?o="1":o=l.toPrecision(i),{flexBasis:0,flexGrow:o,flexShrink:1,overflow:"hidden",pointerEvents:n!==null?"none":void 0}}function Jr(e,n=10){let s=null;return(...a)=>{s!==null&&clearTimeout(s),s=setTimeout(()=>{e(...a)},n)}}function sn(e){try{if(typeof localStorage<"u")e.getItem=n=>localStorage.getItem(n),e.setItem=(n,s)=>{localStorage.setItem(n,s)};else throw new Error("localStorage not supported in this environment")}catch(n){console.error(n),e.getItem=()=>null,e.setItem=()=>{}}}function qn(e){return`react-resizable-panels:${e}`}function Bn(e){return e.map(n=>{const{constraints:s,id:r,idIsFromProps:a,order:i}=n;return a?r:i?`${i}:${JSON.stringify(s)}`:JSON.stringify(s)}).sort((n,s)=>n.localeCompare(s)).join(",")}function Kn(e,n){try{const s=qn(e),r=n.getItem(s);if(r){const a=JSON.parse(r);if(typeof a=="object"&&a!=null)return a}}catch{}return null}function Yr(e,n,s){var r,a;const i=(r=Kn(e,s))!==null&&r!==void 0?r:{},l=Bn(n);return(a=i[l])!==null&&a!==void 0?a:null}function Qr(e,n,s,r,a){var i;const l=qn(e),o=Bn(n),c=(i=Kn(e,a))!==null&&i!==void 0?i:{};c[o]={expandToSizes:Object.fromEntries(s.entries()),layout:r};try{a.setItem(l,JSON.stringify(c))}catch(h){console.error(h)}}function rn({layout:e,panelConstraints:n}){const s=[...e],r=s.reduce((i,l)=>i+l,0);if(s.length!==n.length)throw Error(`Invalid ${n.length} panel layout: ${s.map(i=>`${i}%`).join(", ")}`);if(!ne(r,100)&&s.length>0)for(let i=0;i<n.length;i++){const l=s[i];O(l!=null,`No layout data found for index ${i}`);const o=100/r*l;s[i]=o}let a=0;for(let i=0;i<n.length;i++){const l=s[i];O(l!=null,`No layout data found for index ${i}`);const o=ze({panelConstraints:n,panelIndex:i,size:l});l!=o&&(a+=l-o,s[i]=o)}if(!ne(a,0))for(let i=0;i<n.length;i++){const l=s[i];O(l!=null,`No layout data found for index ${i}`);const o=l+a,c=ze({panelConstraints:n,panelIndex:i,size:o});if(l!==c&&(a-=c-l,s[i]=c,ne(a,0)))break}return s}const Xr=100,Le={getItem:e=>(sn(Le),Le.getItem(e)),setItem:(e,n)=>{sn(Le),Le.setItem(e,n)}},an={};function Un({autoSaveId:e=null,children:n,className:s="",direction:r,forwardedRef:a,id:i=null,onLayout:l=null,keyboardResizeBy:o=null,storage:c=Le,style:h,tagName:p="div",...b}){const x=Ot(i),j=d.useRef(null),[S,I]=d.useState(null),[f,u]=d.useState([]),y=Fr(),g=d.useRef({}),v=d.useRef(new Map),T=d.useRef(0),D=d.useRef({autoSaveId:e,direction:r,dragState:S,id:x,keyboardResizeBy:o,onLayout:l,storage:c}),k=d.useRef({layout:f,panelDataArray:[],panelDataArrayChanged:!1});d.useRef({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),d.useImperativeHandle(a,()=>({getId:()=>D.current.id,getLayout:()=>{const{layout:m}=k.current;return m},setLayout:m=>{const{onLayout:N}=D.current,{layout:A,panelDataArray:C}=k.current,z=rn({layout:m,panelConstraints:C.map($=>$.constraints)});nn(A,z)||(u(z),k.current.layout=z,N&&N(z),we(C,z,g.current))}}),[]),ye(()=>{D.current.autoSaveId=e,D.current.direction=r,D.current.dragState=S,D.current.id=x,D.current.onLayout=l,D.current.storage=c}),qr({committedValuesRef:D,eagerValuesRef:k,groupId:x,layout:f,panelDataArray:k.current.panelDataArray,setLayout:u,panelGroupElement:j.current}),d.useEffect(()=>{const{panelDataArray:m}=k.current;if(e){if(f.length===0||f.length!==m.length)return;let N=an[e];N==null&&(N=Jr(Qr,Xr),an[e]=N);const A=[...m],C=new Map(v.current);N(e,A,C,f,c)}},[e,f,c]),d.useEffect(()=>{});const w=d.useCallback(m=>{const{onLayout:N}=D.current,{layout:A,panelDataArray:C}=k.current;if(m.constraints.collapsible){const z=C.map(le=>le.constraints),{collapsedSize:$=0,panelSize:V,pivotIndices:U}=ge(C,m,A);if(O(V!=null,`Panel size not found for panel "${m.id}"`),!ue(V,$)){v.current.set(m.id,V);const ce=Se(C,m)===C.length-1?V-$:$-V,W=$e({delta:ce,initialLayout:A,panelConstraints:z,pivotIndices:U,prevLayout:A,trigger:"imperative-api"});qe(A,W)||(u(W),k.current.layout=W,N&&N(W),we(C,W,g.current))}}},[]),F=d.useCallback((m,N)=>{const{onLayout:A}=D.current,{layout:C,panelDataArray:z}=k.current;if(m.constraints.collapsible){const $=z.map(ie=>ie.constraints),{collapsedSize:V=0,panelSize:U=0,minSize:le=0,pivotIndices:ce}=ge(z,m,C),W=N??le;if(ue(U,V)){const ie=v.current.get(m.id),Me=ie!=null&&ie>=W?ie:W,ct=Se(z,m)===z.length-1?U-Me:Me-U,Z=$e({delta:ct,initialLayout:C,panelConstraints:$,pivotIndices:ce,prevLayout:C,trigger:"imperative-api"});qe(C,Z)||(u(Z),k.current.layout=Z,A&&A(Z),we(z,Z,g.current))}}},[]),E=d.useCallback(m=>{const{layout:N,panelDataArray:A}=k.current,{panelSize:C}=ge(A,m,N);return O(C!=null,`Panel size not found for panel "${m.id}"`),C},[]),P=d.useCallback((m,N)=>{const{panelDataArray:A}=k.current,C=Se(A,m);return Wr({defaultSize:N,dragState:S,layout:f,panelData:A,panelIndex:C})},[S,f]),_=d.useCallback(m=>{const{layout:N,panelDataArray:A}=k.current,{collapsedSize:C=0,collapsible:z,panelSize:$}=ge(A,m,N);return O($!=null,`Panel size not found for panel "${m.id}"`),z===!0&&ue($,C)},[]),H=d.useCallback(m=>{const{layout:N,panelDataArray:A}=k.current,{collapsedSize:C=0,collapsible:z,panelSize:$}=ge(A,m,N);return O($!=null,`Panel size not found for panel "${m.id}"`),!z||ve($,C)>0},[]),R=d.useCallback(m=>{const{panelDataArray:N}=k.current;N.push(m),N.sort((A,C)=>{const z=A.order,$=C.order;return z==null&&$==null?0:z==null?-1:$==null?1:z-$}),k.current.panelDataArrayChanged=!0,y()},[y]);ye(()=>{if(k.current.panelDataArrayChanged){k.current.panelDataArrayChanged=!1;const{autoSaveId:m,onLayout:N,storage:A}=D.current,{layout:C,panelDataArray:z}=k.current;let $=null;if(m){const U=Yr(m,z,A);U&&(v.current=new Map(Object.entries(U.expandToSizes)),$=U.layout)}$==null&&($=Ur({panelDataArray:z}));const V=rn({layout:$,panelConstraints:z.map(U=>U.constraints)});nn(C,V)||(u(V),k.current.layout=V,N&&N(V),we(z,V,g.current))}}),ye(()=>{const m=k.current;return()=>{m.layout=[]}},[]);const M=d.useCallback(m=>{let N=!1;const A=j.current;return A&&window.getComputedStyle(A,null).getPropertyValue("direction")==="rtl"&&(N=!0),function(z){z.preventDefault();const $=j.current;if(!$)return()=>null;const{direction:V,dragState:U,id:le,keyboardResizeBy:ce,onLayout:W}=D.current,{layout:ie,panelDataArray:Me}=k.current,{initialLayout:Ge}=U??{},ct=Hn(le,m,$);let Z=Kr(z,m,V,U,ce,$);const Kt=V==="horizontal";Kt&&N&&(Z=-Z);const Ss=Me.map(ks=>ks.constraints),_e=$e({delta:Z,initialLayout:Ge??ie,panelConstraints:Ss,pivotIndices:ct,prevLayout:ie,trigger:zn(z)?"keyboard":"mouse-or-touch"}),Ut=!qe(ie,_e);(An(z)||Tn(z))&&T.current!=Z&&(T.current=Z,!Ut&&Z!==0?Kt?xt(m,Z<0?_n:Dn):xt(m,Z<0?$n:Ln):xt(m,0)),Ut&&(u(_e),k.current.layout=_e,W&&W(_e),we(Me,_e,g.current))}},[]),L=d.useCallback((m,N)=>{const{onLayout:A}=D.current,{layout:C,panelDataArray:z}=k.current,$=z.map(ie=>ie.constraints),{panelSize:V,pivotIndices:U}=ge(z,m,C);O(V!=null,`Panel size not found for panel "${m.id}"`);const ce=Se(z,m)===z.length-1?V-N:N-V,W=$e({delta:ce,initialLayout:C,panelConstraints:$,pivotIndices:U,prevLayout:C,trigger:"imperative-api"});qe(C,W)||(u(W),k.current.layout=W,A&&A(W),we(z,W,g.current))},[]),q=d.useCallback((m,N)=>{const{layout:A,panelDataArray:C}=k.current,{collapsedSize:z=0,collapsible:$}=N,{collapsedSize:V=0,collapsible:U,maxSize:le=100,minSize:ce=0}=m.constraints,{panelSize:W}=ge(C,m,A);W!=null&&($&&U&&ue(W,z)?ue(z,V)||L(m,V):W<ce?L(m,ce):W>le&&L(m,le))},[L]),K=d.useCallback((m,N)=>{const{direction:A}=D.current,{layout:C}=k.current;if(!j.current)return;const z=it(m,j.current);O(z,`Drag handle element not found for id "${m}"`);const $=Gn(A,N);I({dragHandleId:m,dragHandleRect:z.getBoundingClientRect(),initialCursorPosition:$,initialLayout:C})},[]),se=d.useCallback(()=>{I(null)},[]),de=d.useCallback(m=>{const{panelDataArray:N}=k.current,A=Se(N,m);A>=0&&(N.splice(A,1),delete g.current[m.id],k.current.panelDataArrayChanged=!0,y())},[y]),ae=d.useMemo(()=>({collapsePanel:w,direction:r,dragState:S,expandPanel:F,getPanelSize:E,getPanelStyle:P,groupId:x,isPanelCollapsed:_,isPanelExpanded:H,reevaluatePanelConstraints:q,registerPanel:R,registerResizeHandle:M,resizePanel:L,startDragging:K,stopDragging:se,unregisterPanel:de,panelGroupElement:j.current}),[w,S,r,F,E,P,x,_,H,q,R,M,L,K,se,de]),re={display:"flex",flexDirection:r==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return d.createElement(st.Provider,{value:ae},d.createElement(p,{...b,children:n,className:s,id:i,ref:j,style:{...re,...h},[J.group]:"",[J.groupDirection]:r,[J.groupId]:x}))}const Wn=d.forwardRef((e,n)=>d.createElement(Un,{...e,forwardedRef:n}));Un.displayName="PanelGroup";Wn.displayName="forwardRef(PanelGroup)";function Se(e,n){return e.findIndex(s=>s===n||s.id===n.id)}function ge(e,n,s){const r=Se(e,n),i=r===e.length-1?[r-1,r]:[r,r+1],l=s[r];return{...n.constraints,panelSize:l,pivotIndices:i}}function Zr({disabled:e,handleId:n,resizeHandler:s,panelGroupElement:r}){d.useEffect(()=>{if(e||s==null||r==null)return;const a=it(n,r);if(a==null)return;const i=l=>{if(!l.defaultPrevented)switch(l.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{l.preventDefault(),s(l);break}case"F6":{l.preventDefault();const o=a.getAttribute(J.groupId);O(o,`No group element found for id "${o}"`);const c=Ve(o,r),h=Fn(o,n,r);O(h!==null,`No resize element found for id "${n}"`);const p=l.shiftKey?h>0?h-1:c.length-1:h+1<c.length?h+1:0;c[p].focus();break}}};return a.addEventListener("keydown",i),()=>{a.removeEventListener("keydown",i)}},[r,e,n,s])}function Jn({children:e=null,className:n="",disabled:s=!1,hitAreaMargins:r,id:a,onBlur:i,onClick:l,onDragging:o,onFocus:c,onPointerDown:h,onPointerUp:p,style:b={},tabIndex:x=0,tagName:j="div",...S}){var I,f;const u=d.useRef(null),y=d.useRef({onClick:l,onDragging:o,onPointerDown:h,onPointerUp:p});d.useEffect(()=>{y.current.onClick=l,y.current.onDragging=o,y.current.onPointerDown=h,y.current.onPointerUp=p});const g=d.useContext(st);if(g===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:v,groupId:T,registerResizeHandle:D,startDragging:k,stopDragging:w,panelGroupElement:F}=g,E=Ot(a),[P,_]=d.useState("inactive"),[H,R]=d.useState(!1),[M,L]=d.useState(null),q=d.useRef({state:P});ye(()=>{q.current.state=P}),d.useEffect(()=>{if(s)L(null);else{const ae=D(E);L(()=>ae)}},[s,E,D]);const K=(I=r?.coarse)!==null&&I!==void 0?I:15,se=(f=r?.fine)!==null&&f!==void 0?f:5;d.useEffect(()=>{if(s||M==null)return;const ae=u.current;O(ae,"Element ref not attached");let re=!1;return Lr(E,ae,v,{coarse:K,fine:se},(N,A,C)=>{if(!A){_("inactive");return}switch(N){case"down":{_("drag"),re=!1,O(C,'Expected event to be defined for "down" action'),k(E,C);const{onDragging:z,onPointerDown:$}=y.current;z?.(!0),$?.();break}case"move":{const{state:z}=q.current;re=!0,z!=="drag"&&_("hover"),O(C,'Expected event to be defined for "move" action'),M(C);break}case"up":{_("hover"),w();const{onClick:z,onDragging:$,onPointerUp:V}=y.current;$?.(!1),V?.(),re||z?.();break}}})},[K,v,s,se,D,E,M,k,w]),Zr({disabled:s,handleId:E,resizeHandler:M,panelGroupElement:F});const de={touchAction:"none",userSelect:"none"};return d.createElement(j,{...S,children:e,className:n,id:a,onBlur:()=>{R(!1),i?.()},onFocus:()=>{R(!0),c?.()},ref:u,role:"separator",style:{...de,...b},tabIndex:x,[J.groupDirection]:v,[J.groupId]:T,[J.resizeHandle]:"",[J.resizeHandleActive]:P==="drag"?"pointer":H?"keyboard":void 0,[J.resizeHandleEnabled]:!s,[J.resizeHandleId]:E,[J.resizeHandleState]:P})}Jn.displayName="PanelResizeHandle";const ea=({className:e,...n})=>t.jsx(Wn,{className:Q("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",e),...n}),on=In,ta=({withHandle:e,className:n,...s})=>t.jsx(Jn,{className:Q("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",n),...s,children:e&&t.jsx("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:t.jsx(Rs,{className:"h-2.5 w-2.5"})})}),Vt=[{id:"ebp",name:"EBP",path:"School/Evidence Based Practice"},{id:"exphys",name:"ExPhys",path:"School/Exercise Physiology"},{id:"ms1",name:"MS1",path:"School/Movement Science 1"},{id:"neuro",name:"Neuro",path:"School/Neuroscience"},{id:"ti",name:"TI",path:"School/Therapeutic Intervention"}];function na(){return Vt.map(e=>e.path)}function ln(e,n){try{const s=localStorage.getItem(e);if(s!==null)return JSON.parse(s)}catch{}return n}function bt(e,n){try{localStorage.setItem(e,JSON.stringify(n))}catch{}}function sa(){const[e,n]=d.useState(()=>ln("brain-main-mode","edit")),[s,r]=d.useState(null),[a,i]=d.useState(""),[l,o]=d.useState(!1),[c,h]=d.useState(!1),[p,b]=d.useState(!1),[x,j]=d.useState(()=>ln("brain-sidebar-expanded",!0)),[S,I]=d.useState(!1),f=d.useCallback(R=>{n(R),bt("brain-main-mode",R)},[]),u=d.useCallback(R=>{j(R),bt("brain-sidebar-expanded",R)},[]),y=d.useCallback(()=>{j(R=>{const M=!R;return bt("brain-sidebar-expanded",M),M})},[]),{data:g}=Y({queryKey:["obsidian","status"],queryFn:G.obsidian.getStatus,refetchInterval:3e4}),{data:v}=Y({queryKey:["obsidian","config"],queryFn:G.obsidian.getConfig}),{data:T}=Y({queryKey:["obsidian","vault-index"],queryFn:()=>G.obsidian.getVaultIndex(),enabled:g?.connected===!0}),{data:D}=Y({queryKey:["anki","status"],queryFn:G.anki.getStatus,refetchInterval:3e4}),{data:k}=Y({queryKey:["brain","metrics"],queryFn:G.brain.getMetrics}),{data:w=[]}=Y({queryKey:["anki","drafts"],queryFn:G.anki.getDrafts}),F=w.filter(R=>R.status==="pending"),E=d.useCallback(async R=>{try{const M=await G.obsidian.getFile(R);M.success&&M.content!==void 0&&(r(R),i(M.content),o(!1),h(!1))}catch(M){console.error("Failed to load file:",M)}},[]),P=d.useCallback(async()=>{if(s){b(!0);try{(await G.obsidian.saveFile(s,a)).success&&o(!1)}catch(R){console.error("Failed to save file:",R)}finally{b(!1)}}},[s,a]),_=d.useCallback(R=>{i(R),o(!0)},[]),H=d.useCallback(async(R,M)=>{if(M){const q=v?.vaultName||"Treys School";window.open(`obsidian://open?vault=${encodeURIComponent(q)}&file=${encodeURIComponent(R)}`,"_blank");return}const L=T?.paths?.[R];if(L){await E(L),h(!0);return}for(const q of na())try{const K=await G.obsidian.getFile(`${q}/${R}.md`);if(K.success&&K.content!==void 0){r(`${q}/${R}.md`),i(K.content),o(!1),h(!0);return}}catch{}console.warn(`Note not found: ${R}`)},[v,T,E]);return{mainMode:e,setMainMode:f,currentFile:s,setCurrentFile:r,fileContent:a,setFileContent:_,hasChanges:l,setHasChanges:o,previewMode:c,setPreviewMode:h,isSaving:p,openFile:E,saveFile:P,sidebarExpanded:x,setSidebarExpanded:u,toggleSidebar:y,importOpen:S,setImportOpen:I,handleWikilinkClick:H,obsidianStatus:g,obsidianConfig:v,vaultIndex:T,ankiStatus:D,metrics:k,ankiDrafts:w,pendingDrafts:F}}function ra(){const{data:e=[]}=Y({queryKey:["sessions"],queryFn:G.sessions.getAll}),{data:n=[]}=Y({queryKey:["planner-queue"],queryFn:G.planner.getQueue}),s=new Date,r=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`,a=c=>{const h=typeof c=="string"?new Date(c):c;return`${h.getFullYear()}-${String(h.getMonth()+1).padStart(2,"0")}-${String(h.getDate()).padStart(2,"0")}`===r},i=e.some(c=>a(c.date)),l=e.some(c=>a(c.date)&&c.cards>0),o=n.length>0;return t.jsxs("div",{className:"brain-progress",role:"status","aria-label":"Session progress",children:[t.jsx("div",{className:Q("brain-progress__segment",i&&"brain-progress__segment--done"),title:`Study session: ${i?"done":"pending"}`}),t.jsx("div",{className:Q("brain-progress__segment",l&&"brain-progress__segment--done"),title:`Cards: ${l?"generated":"pending"}`}),t.jsx("div",{className:Q("brain-progress__segment",o&&"brain-progress__segment--done"),title:`Planner: ${o?"has tasks":"empty"}`})]})}class ke extends d.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null},this.reset=()=>{this.setState({hasError:!1,error:null})}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,s){console.error("ErrorBoundary caught error:",n,s),this.props.onError?.(n,s)}componentDidUpdate(n){this.state.hasError&&this.props.resetKeys&&this.props.resetKeys.some((r,a)=>r!==n.resetKeys?.[a])&&this.reset()}render(){return this.state.hasError?this.props.fallback?this.props.fallback:t.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center",children:[t.jsx(Dt,{className:"w-10 h-10 text-destructive mb-3"}),t.jsx("h3",{className:"font-arcade text-sm text-destructive mb-2",children:"COMPONENT ERROR"}),t.jsx("p",{className:"font-terminal text-xs text-muted-foreground mb-4 max-w-xs",children:this.state.error?.message||"Something went wrong"}),t.jsxs(B,{variant:"outline",size:"sm",onClick:this.reset,className:"rounded-none font-terminal text-xs",children:[t.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Try Again"]})]}):this.props.children}}function aa({onReset:e}){return t.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center",children:[t.jsx(Dt,{className:"w-8 h-8 text-destructive mb-2"}),t.jsx("p",{className:"font-terminal text-xs text-destructive mb-2",children:"Sidebar Error"}),t.jsxs(B,{variant:"ghost",size:"sm",onClick:e,className:"rounded-none font-terminal text-xs h-6",children:[t.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Retry"]})]})}function De({tabName:e,onReset:n}){return t.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center",children:[t.jsx(Dt,{className:"w-10 h-10 text-destructive mb-3"}),t.jsxs("h3",{className:"font-arcade text-sm text-destructive mb-2",children:[e," TAB ERROR"]}),t.jsxs("p",{className:"font-terminal text-xs text-muted-foreground mb-4",children:["Failed to load ",e.toLowerCase()," view"]}),t.jsxs(B,{variant:"outline",size:"sm",onClick:n,className:"rounded-none font-terminal text-xs",children:[t.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Reload Tab"]})]})}const ia=12,oa=16;function Yn({name:e,isFolder:n,isExpanded:s,isActive:r,depth:a,onClick:i}){return t.jsxs("button",{type:"button",onClick:i,className:`w-full flex items-center gap-2 py-2 font-terminal text-sm text-left transition-colors duration-150 focus:outline-none focus-visible:ring-1 focus-visible:ring-primary/50 focus-visible:ring-inset min-h-[36px] ${r?"bg-primary/15 text-primary border-l-2 border-primary/60":"border-l-2 border-transparent hover:bg-primary/10 text-foreground"}`,style:{paddingLeft:`${ia+a*oa}px`},children:[n?t.jsxs(t.Fragment,{children:[s?t.jsx(Ls,{className:"w-3.5 h-3.5 text-muted-foreground shrink-0","aria-hidden":"true"}):t.jsx(Os,{className:"w-3.5 h-3.5 text-muted-foreground shrink-0","aria-hidden":"true"}),t.jsx(ur,{className:"w-4 h-4 text-yellow-500 shrink-0","aria-hidden":"true"})]}):t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"w-3.5 shrink-0"}),t.jsx(cr,{className:"w-4 h-4 text-blue-400 shrink-0","aria-hidden":"true"})]}),t.jsx("span",{className:"truncate min-w-0",children:e})]})}function Qn({folderPath:e,depth:n,expandedFolders:s,toggleFolder:r,workspace:a,connected:i}){const{data:l}=Y({queryKey:["obsidian","files",e],queryFn:()=>G.obsidian.getFiles(e),enabled:i}),o=l?.files||[];return t.jsx(t.Fragment,{children:o.map(c=>{const h=typeof c=="string"?c:c.path,p=h.endsWith("/"),b=h.replace(/\/$/,"").split("/").pop()||h,x=`${e}/${b}`,j=s.has(x);return t.jsxs("div",{children:[t.jsx(Yn,{name:b,isFolder:p,isExpanded:j,isActive:a.currentFile?.endsWith(b)||!1,depth:n,onClick:()=>{p?r(x):a.openFile(x)}}),p&&j&&t.jsx(Qn,{folderPath:x,depth:n+1,expandedFolders:s,toggleFolder:r,workspace:a,connected:i})]},h)})})}function cn({workspace:e,onCollapse:n}){const[s,r]=d.useState("School"),[a,i]=d.useState(""),[l,o]=d.useState(new Set),[c,h]=d.useState(0),p=e.obsidianStatus?.connected===!0,{data:b}=Y({queryKey:["obsidian","files",s],queryFn:()=>G.obsidian.getFiles(s),enabled:p}),x=d.useCallback(g=>{r(g),o(new Set)},[]),j=d.useCallback(()=>{const g=s.split("/");g.pop(),x(g.join("/"))},[s,x]),S=d.useCallback(g=>{o(v=>{const T=new Set(v);return T.has(g)?T.delete(g):T.add(g),T})},[]),I=d.useCallback(()=>{const g=new Date().toISOString().split("T")[0],v=s?`${s}/Session-${g}.md`:`Session-${g}.md`,T=`# Study Session - ${g}

## Summary


## Concepts Covered
- 

## Notes

`;e.setCurrentFile(v),e.setFileContent(T),e.setHasChanges(!0)},[s,e]),f=d.useMemo(()=>{const g=b?.files||[];if(!a.trim())return g;const v=a.toLowerCase();return g.filter(T=>(typeof T=="string"?T:T.path).toLowerCase().includes(v))},[b,a]),u=s.includes("/"),y=d.useMemo(()=>s?s.split("/"):[],[s]);return p?t.jsxs("div",{className:"flex flex-col h-full min-h-0 overflow-hidden",children:[t.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-primary/20 shrink-0",children:[t.jsx("h2",{className:"section-header",children:"Vault"}),n&&t.jsx("button",{type:"button",onClick:n,className:"size-7 flex items-center justify-center rounded-sm hover:bg-primary/20 hover:text-primary text-muted-foreground",title:"Collapse sidebar","aria-label":"Collapse sidebar",children:t.jsx(Qt,{className:"w-4 h-4","aria-hidden":"true"})})]}),t.jsxs("div",{className:"section-block section-block-gap",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Sn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none","aria-hidden":"true"}),t.jsx(Ce,{value:a,onChange:g=>i(g.target.value),placeholder:"Search filesâ€¦",className:"h-9 pl-9 pr-3 text-sm font-terminal rounded-none border border-primary/20 bg-black/40 placeholder:text-muted-foreground/80 focus-visible:ring-1 focus-visible:ring-primary/60 focus-visible:border-primary/40","aria-label":"Search files"})]}),t.jsxs(B,{size:"sm",variant:"ghost",className:"w-full h-9 text-sm font-terminal rounded-none border border-primary/20 bg-black/30 text-foreground hover:bg-primary/10 hover:border-primary/40 hover:text-primary justify-start gap-2",onClick:I,children:[t.jsx(nt,{className:"w-4 h-4 shrink-0","aria-hidden":"true"}),"New Note"]})]}),t.jsxs("div",{className:"section-block section-block-gap",children:[t.jsx("h3",{className:"section-header",children:"Courses"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:Vt.map(g=>{const v=s===g.path;return t.jsx("button",{type:"button",onClick:()=>x(g.path),className:`min-h-[36px] px-4 py-2 font-arcade text-xs tracking-wider rounded-none border-2 transition-colors focus:outline-none focus-visible:ring-1 focus-visible:ring-primary/50 focus-visible:ring-offset-1 focus-visible:ring-offset-black ${v?"bg-primary text-primary-foreground border-primary":"border-primary/40 bg-black/50 text-primary/80 hover:bg-primary/20 hover:border-primary/60 hover:text-primary"}`,"aria-pressed":v,children:g.name},g.path)})})]}),s&&t.jsxs("div",{className:"flex items-center gap-2 px-3 py-2.5 font-arcade text-xs border-b border-primary/20 bg-black/30 shrink-0 min-h-[40px]",children:[u&&t.jsx("button",{type:"button",onClick:j,className:"size-8 flex items-center justify-center rounded-sm hover:bg-primary/20 hover:text-primary focus:outline-none focus-visible:ring-1 focus-visible:ring-primary shrink-0",title:"Go to parent folder","aria-label":"Go to parent folder",children:t.jsx(Ts,{className:"w-4 h-4","aria-hidden":"true"})}),t.jsx("nav",{"aria-label":"Folder breadcrumb",className:"flex items-center gap-1 flex-wrap text-primary/80 min-w-0",children:y.map((g,v,T)=>t.jsxs("span",{className:"flex items-center gap-1",children:[v>0&&t.jsx("span",{"aria-hidden":"true",className:"text-primary/40",children:"/"}),t.jsx("button",{type:"button",onClick:()=>x(T.slice(0,v+1).join("/")),className:"hover:text-primary focus:outline-none focus-visible:ring-1 focus-visible:ring-primary focus-visible:ring-inset rounded-sm px-1.5 py-1 min-h-[28px] flex items-center tracking-wider uppercase",children:g})]},v))})]}),t.jsxs("div",{className:"flex-1 min-h-0 flex flex-col",children:[t.jsx("div",{className:"shrink-0 px-3 py-2 border-b border-primary/20",children:t.jsx("span",{className:"section-header text-primary/90",children:"Files"})}),t.jsx(ke,{fallback:t.jsx(aa,{onReset:()=>h(g=>g+1)}),children:t.jsx(Oe,{className:"flex-1 min-h-0",children:t.jsx("div",{className:"py-2",children:f.map(g=>{const v=typeof g=="string"?g:g.path,T=v.endsWith("/"),D=v.replace(/\/$/,"").split("/").pop()||v,k=s?`${s}/${D}`:D,w=l.has(k),F=e.currentFile?.endsWith(D)||!1;return t.jsxs("div",{children:[t.jsx(Yn,{name:D,isFolder:T,isExpanded:w,isActive:F,depth:0,onClick:()=>{T?S(k):e.openFile(k)}}),T&&w&&t.jsx(Qn,{folderPath:k,depth:1,expandedFolders:l,toggleFolder:S,workspace:e,connected:p})]},v)})})})},`filetree-${c}`)]})]}):t.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[t.jsxs("div",{className:"section-block border-primary/30 flex items-center justify-between",children:[t.jsx("h2",{className:"section-header",children:"Vault"}),n&&t.jsx("button",{type:"button",onClick:n,className:"size-7 flex items-center justify-center rounded-sm hover:bg-primary/20 hover:text-primary text-muted-foreground",title:"Collapse sidebar","aria-label":"Collapse sidebar",children:t.jsx(Qt,{className:"w-4 h-4","aria-hidden":"true"})})]}),t.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-3 py-6 border border-primary/30 bg-black/30 m-3",children:[t.jsx(Nn,{className:"w-8 h-8 text-primary/80 mb-3","aria-hidden":"true"}),t.jsx("p",{className:"font-arcade text-sm text-primary/90 text-center",children:"Obsidian offline"}),t.jsx("p",{className:"font-terminal text-sm text-muted-foreground text-center mt-2",children:"Open Obsidian with Local REST API enabled"})]})]})}function la({onExpand:e,workspace:n}){return t.jsxs("div",{className:"brain-sidebar-rail","aria-label":"Sidebar rail",children:[t.jsx("button",{type:"button",onClick:e,className:"brain-sidebar-rail__btn",title:"Expand sidebar","aria-label":"Expand sidebar",children:t.jsx(jr,{className:"w-4 h-4","aria-hidden":"true"})}),t.jsx("button",{type:"button",onClick:e,className:"brain-sidebar-rail__btn",title:"Search files","aria-label":"Search files",children:t.jsx(Sn,{className:"w-4 h-4","aria-hidden":"true"})}),t.jsx("button",{type:"button",onClick:()=>{const s=new Date().toISOString().split("T")[0];n.setCurrentFile(`School/Session-${s}.md`),n.setFileContent(`# Study Session - ${s}

## Summary


## Concepts Covered
- 

## Notes

`),n.setHasChanges(!0)},className:"brain-sidebar-rail__btn",title:"New note","aria-label":"New note",children:t.jsx(nt,{className:"w-4 h-4","aria-hidden":"true"})}),t.jsx("div",{className:"w-6 h-px bg-primary/30 my-1"}),Vt.map(s=>t.jsx("button",{type:"button",onClick:e,className:"brain-sidebar-rail__course",title:s.name,"aria-label":s.name,children:s.name.charAt(0)},s.id))]})}const ca=`Generate Anki flashcards from the following study material. Output ONLY a numbered list in this exact format:

1. Front: [question]
Back: [answer]
Tags: [comma-separated tags like: Module1, Obj2, TopicName]

Rules:
- Front = the question only (no module/objective prefixes)
- Back = concise answer
- Tags = include Module#, Obj#, and topic keywords
- One card per concept
- No extra text before or after the list

Study material:
[PASTE YOUR NOTES HERE]`;function dn(e,n){if(n.length===0)return e;const s=[];for(const r of n)s.push({type:"image_url",image_url:{url:r}});return e.trim()&&s.push({type:"text",text:e}),s}function da({mode:e,setMode:n,ingestTarget:s,setIngestTarget:r,promptCopied:a,setPromptCopied:i}){const l=()=>{navigator.clipboard.writeText(ca),i(!0),setTimeout(()=>i(!1),2e3)};return t.jsxs("div",{className:"px-3 py-1 border-b border-primary/30 flex items-center justify-between gap-2 shrink-0",children:[t.jsxs("div",{className:"flex bg-black/40 border border-primary/40 rounded-none overflow-hidden mr-2",children:[t.jsxs("button",{onClick:()=>n("chat"),className:`flex items-center gap-1 px-2 py-0.5 text-xs font-arcade transition-colors ${e==="chat"?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,children:[t.jsx(kn,{className:"w-3 h-3"})," CHAT"]}),t.jsxs("button",{onClick:()=>n("ingest"),className:`flex items-center gap-1 px-2 py-0.5 text-xs font-arcade transition-colors ${e==="ingest"?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,children:[t.jsx(tr,{className:"w-3 h-3"})," INGEST"]})]}),t.jsx("p",{className:"text-xs text-muted-foreground truncate flex-1",children:e==="chat"?"Chat with Gemini Flash":"Paste notes to create cards & save sessions"}),e==="ingest"&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex bg-black/40 border border-primary/40 rounded-none overflow-hidden shrink-0",children:["anki","obsidian","both"].map(o=>t.jsxs("button",{onClick:()=>r(o),className:`flex items-center gap-1 px-2 py-0.5 text-xs font-arcade transition-colors ${s===o?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,children:[o==="anki"&&t.jsxs(t.Fragment,{children:[t.jsx(Fe,{className:"w-3 h-3"})," ANKI"]}),o==="obsidian"&&t.jsxs(t.Fragment,{children:[t.jsx(St,{className:"w-3 h-3"})," OBSIDIAN"]}),o==="both"&&t.jsx(t.Fragment,{children:"BOTH"})]},o))}),t.jsx("button",{type:"button",className:"bg-primary hover:bg-primary/80 px-2 py-0.5 rounded-none text-xs font-terminal shrink-0",onClick:l,children:a?"Copied!":"Copy Prompt"})]})]})}function ua({messages:e,loading:n,mode:s,scrollRef:r}){const a=d.useCallback(()=>{r.current&&(r.current.scrollTop=r.current.scrollHeight)},[r]);return d.useEffect(()=>{a()},[e,a]),t.jsxs("div",{ref:r,className:"flex-1 overflow-y-auto px-4 py-2 space-y-3",children:[e.length===0&&t.jsx("p",{className:"text-muted-foreground text-sm font-terminal text-center py-8",children:s==="chat"?"Ask anything. Paste screenshots with Ctrl+V.":"Paste your study notes to ingest into Brain."}),e.map((i,l)=>t.jsx("div",{className:`flex ${i.role==="user"?"justify-end":"justify-start"}`,children:t.jsxs("div",{className:`max-w-[80%] rounded-none px-3 py-2 text-sm font-terminal whitespace-pre-wrap ${i.role==="user"?"bg-primary/20 text-foreground border border-primary/30":"bg-secondary/40 text-foreground border border-secondary/60"}`,children:[i.images?.map((o,c)=>t.jsx("img",{src:o,alt:"attached",className:"max-h-32 rounded-none mb-1"},c)),i.content]})},l)),n&&t.jsx("div",{className:"flex justify-start",children:t.jsx("div",{className:"bg-secondary/40 border border-secondary/60 rounded-none px-3 py-2",children:t.jsx($t,{className:"w-4 h-4 animate-spin text-primary"})})})]})}function ma({images:e,onRemove:n}){return e.length===0?null:t.jsx("div",{className:"px-4 py-1 flex gap-2 flex-wrap shrink-0",children:e.map((s,r)=>t.jsxs("div",{className:"relative",children:[t.jsx("img",{src:s,alt:"pending",className:"h-12 rounded-none border border-primary/30"}),t.jsx("button",{onClick:()=>n(r),className:"absolute -top-1 -right-1 bg-destructive rounded-none p-0.5","aria-label":"Remove image",children:t.jsx(Nt,{className:"w-3 h-3"})})]},r))})}function fa({input:e,setInput:n,onSend:s,onImageSelect:r,onPaste:a,loading:i,mode:l}){const o=d.useRef(null),c=p=>{p.key==="Enter"&&!p.shiftKey&&(p.preventDefault(),s())},h=p=>{const b=p.target.files;b&&(r(b),p.target.value="")};return t.jsxs("div",{className:"flex items-end gap-2 px-4 py-2 border-t border-primary/30 shrink-0",children:[t.jsx("input",{ref:o,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:h}),l==="chat"&&t.jsx(B,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 shrink-0",onClick:()=>o.current?.click(),"aria-label":"Attach image",children:t.jsx(fr,{className:"w-4 h-4 text-primary"})}),t.jsx("textarea",{value:e,onChange:p=>n(p.target.value),onKeyDown:c,onPaste:a,placeholder:l==="chat"?"Ask anything... (Ctrl+V to paste images)":"Paste study notes to ingest...",rows:l==="ingest"?3:1,className:"flex-1 bg-black/60 border-2 border-muted-foreground/20 rounded-none px-3 py-1.5 text-sm font-terminal resize-none focus:outline-none focus:ring-1 focus:ring-ring"}),t.jsx(B,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 shrink-0",onClick:s,disabled:i,"aria-label":"Send message",children:t.jsx(Ks,{className:"w-4 h-4 text-primary"})})]})}function Ct(e,n,{checkForDefaultPrevented:s=!0}={}){return function(a){if(e?.(a),s===!1||!a.defaultPrevented)return n?.(a)}}var ha=wn[" useInsertionEffect ".trim().toString()]||Cs;function pa({prop:e,defaultProp:n,onChange:s=()=>{},caller:r}){const[a,i,l]=xa({defaultProp:n,onChange:s}),o=e!==void 0,c=o?e:a;{const p=d.useRef(e!==void 0);d.useEffect(()=>{const b=p.current;b!==o&&console.warn(`${r} is changing from ${b?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),p.current=o},[o,r])}const h=d.useCallback(p=>{if(o){const b=ga(p)?p(e):p;b!==e&&l.current?.(b)}else i(p)},[o,e,i,l]);return[c,h]}function xa({defaultProp:e,onChange:n}){const[s,r]=d.useState(e),a=d.useRef(s),i=d.useRef(n);return ha(()=>{i.current=n},[n]),d.useEffect(()=>{a.current!==s&&(i.current?.(s),a.current=s)},[s,a]),[s,r,i]}function ga(e){return typeof e=="function"}var Gt="Radio",[ba,Xn]=jn(Gt),[ya,va]=ba(Gt),Zn=d.forwardRef((e,n)=>{const{__scopeRadio:s,name:r,checked:a=!1,required:i,disabled:l,value:o="on",onCheck:c,form:h,...p}=e,[b,x]=d.useState(null),j=Pt(n,f=>x(f)),S=d.useRef(!1),I=b?h||!!b.closest("form"):!0;return t.jsxs(ya,{scope:s,checked:a,disabled:l,children:[t.jsx(Ze.button,{type:"button",role:"radio","aria-checked":a,"data-state":ss(a),"data-disabled":l?"":void 0,disabled:l,value:o,...p,ref:j,onClick:Ct(e.onClick,f=>{a||c?.(),I&&(S.current=f.isPropagationStopped(),S.current||f.stopPropagation())})}),I&&t.jsx(ns,{control:b,bubbles:!S.current,name:r,value:o,checked:a,required:i,disabled:l,form:h,style:{transform:"translateX(-100%)"}})]})});Zn.displayName=Gt;var es="RadioIndicator",ts=d.forwardRef((e,n)=>{const{__scopeRadio:s,forceMount:r,...a}=e,i=va(es,s);return t.jsx(Es,{present:r||i.checked,children:t.jsx(Ze.span,{"data-state":ss(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:n})})});ts.displayName=es;var wa="RadioBubbleInput",ns=d.forwardRef(({__scopeRadio:e,control:n,checked:s,bubbles:r=!0,...a},i)=>{const l=d.useRef(null),o=Pt(l,i),c=Fs(s),h=Ps(n);return d.useEffect(()=>{const p=l.current;if(!p)return;const b=window.HTMLInputElement.prototype,j=Object.getOwnPropertyDescriptor(b,"checked").set;if(c!==s&&j){const S=new Event("click",{bubbles:r});j.call(p,s),p.dispatchEvent(S)}},[c,s,r]),t.jsx(Ze.input,{type:"radio","aria-hidden":!0,defaultChecked:s,...a,tabIndex:-1,ref:o,style:{...a.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});ns.displayName=wa;function ss(e){return e?"checked":"unchecked"}var ja=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ot="RadioGroup",[Na]=jn(ot,[Cn,Xn]),rs=Cn(),as=Xn(),[Sa,ka]=Na(ot),is=d.forwardRef((e,n)=>{const{__scopeRadioGroup:s,name:r,defaultValue:a,value:i,required:l=!1,disabled:o=!1,orientation:c,dir:h,loop:p=!0,onValueChange:b,...x}=e,j=rs(s),S=Is(h),[I,f]=pa({prop:i,defaultProp:a??null,onChange:b,caller:ot});return t.jsx(Sa,{scope:s,name:r,required:l,disabled:o,value:I,onValueChange:f,children:t.jsx(Hs,{asChild:!0,...j,orientation:c,dir:S,loop:p,children:t.jsx(Ze.div,{role:"radiogroup","aria-required":l,"aria-orientation":c,"data-disabled":o?"":void 0,dir:S,...x,ref:n})})})});is.displayName=ot;var os="RadioGroupItem",ls=d.forwardRef((e,n)=>{const{__scopeRadioGroup:s,disabled:r,...a}=e,i=ka(os,s),l=i.disabled||r,o=rs(s),c=as(s),h=d.useRef(null),p=Pt(n,h),b=i.value===a.value,x=d.useRef(!1);return d.useEffect(()=>{const j=I=>{ja.includes(I.key)&&(x.current=!0)},S=()=>x.current=!1;return document.addEventListener("keydown",j),document.addEventListener("keyup",S),()=>{document.removeEventListener("keydown",j),document.removeEventListener("keyup",S)}},[]),t.jsx(Vs,{asChild:!0,...o,focusable:!l,active:b,children:t.jsx(Zn,{disabled:l,required:i.required,checked:b,...c,...a,name:i.name,ref:p,onCheck:()=>i.onValueChange(a.value),onKeyDown:Ct(j=>{j.key==="Enter"&&j.preventDefault()}),onFocus:Ct(a.onFocus,()=>{x.current&&h.current?.click()})})})});ls.displayName=os;var Ca="RadioGroupIndicator",cs=d.forwardRef((e,n)=>{const{__scopeRadioGroup:s,...r}=e,a=as(s);return t.jsx(ts,{...a,...r,ref:n})});cs.displayName=Ca;var ds=is,us=ls,Ea=cs;const ms=d.forwardRef(({className:e,...n},s)=>t.jsx(ds,{className:Q("grid gap-2",e),...n,ref:s}));ms.displayName=ds.displayName;const fs=d.forwardRef(({className:e,...n},s)=>t.jsx(us,{ref:s,className:Q("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),...n,children:t.jsx(Ea,{className:"flex items-center justify-center",children:t.jsx(Ms,{className:"h-3.5 w-3.5 fill-primary"})})}));fs.displayName=us.displayName;const Pa=/(\[\[.*?\]\])/g,Ra=/!\[\[(.*?)\]\]/g,Ia=[".png",".jpg",".jpeg",".gif",".svg",".webp",".bmp"],za=/^\[!([\w-]+)\]\s*(.*)?$/,un=Us;function yt(e,n){return e.split(Pa).map((s,r)=>{const a=s.match(/^\[\[(.*?)\]\]$/);if(a){const i=a[1].includes("|")?a[1].split("|")[1]:a[1],l=a[1].includes("|")?a[1].split("|")[0]:a[1];return t.jsx("span",{className:"text-blue-400 hover:text-blue-300 cursor-pointer underline decoration-dotted",onClick:o=>n?.(l,o.shiftKey),title:`${l} (Shift+click for Obsidian app)`,children:i},r)}return t.jsx("span",{children:s},r)})}function Aa(e){return e.replace(Ra,(n,s)=>{const r=s.toLowerCase();return Ia.some(i=>r.endsWith(i))?`![${s}](/api/obsidian/vault-file/${encodeURIComponent(s)})`:`[[${s}]]`})}function Ta(e){const n=e.split(`
`),s=[];let r=!1,a="",i="",l=[];const o=()=>{if(!r)return;const c=un[a.toLowerCase()]||un.note,h=i||a.charAt(0).toUpperCase()+a.slice(1);s.push(`<div class="callout ${c} border-l-4 rounded px-3 py-2 my-2">`),s.push(`<div class="font-bold text-xs uppercase tracking-wider mb-1">${h}</div>`),s.push(""),s.push(l.join(`
`)),s.push(""),s.push("</div>"),r=!1,l=[]};for(const c of n){if(c.startsWith("> ")){const h=c.slice(2),p=h.match(za);if(p&&!r){r=!0,a=p[1],i=p[2]||"";continue}if(r){l.push(h);continue}}else if(c===">"&&r){l.push("");continue}else o();s.push(c)}return o(),s.join(`
`)}function hs({content:e,onWikilinkClick:n}){const s=Ta(Aa(e)),r={h1:({children:a})=>t.jsx("h1",{className:"text-xl font-bold text-primary border-b border-primary/30 pb-1 mb-3 mt-4",children:a}),h2:({children:a})=>t.jsx("h2",{className:"text-lg font-bold text-primary/90 border-b border-primary/20 pb-1 mb-2 mt-3",children:a}),h3:({children:a})=>t.jsx("h3",{className:"text-base font-semibold text-primary/80 mb-2 mt-3",children:a}),h4:({children:a})=>t.jsx("h4",{className:"text-sm font-semibold text-primary/70 mb-1 mt-2",children:a}),p:({children:a})=>typeof a=="string"?t.jsx("p",{className:"mb-2 leading-relaxed",children:yt(a,n)}):t.jsx("p",{className:"mb-2 leading-relaxed",children:a}),strong:({children:a})=>t.jsx("strong",{className:"font-bold text-foreground",children:a}),em:({children:a})=>t.jsx("em",{className:"italic text-foreground/90",children:a}),ul:({children:a})=>t.jsx("ul",{className:"list-disc list-inside mb-2 space-y-0.5 ml-2",children:a}),ol:({children:a})=>t.jsx("ol",{className:"list-decimal list-inside mb-2 space-y-0.5 ml-2",children:a}),li:({children:a})=>typeof a=="string"?t.jsx("li",{className:"leading-relaxed",children:yt(a,n)}):t.jsx("li",{className:"leading-relaxed",children:a}),blockquote:({children:a})=>t.jsx("blockquote",{className:"border-l-4 border-primary/30 pl-3 my-2 text-muted-foreground italic",children:a}),code:({children:a,className:i})=>i?.startsWith("language-")?t.jsx("code",{className:"block bg-black/80 border border-secondary/40 rounded p-3 my-2 text-xs font-mono overflow-x-auto whitespace-pre",children:a}):t.jsx("code",{className:"bg-secondary/40 px-1.5 py-0.5 rounded text-xs font-mono text-primary",children:a}),pre:({children:a})=>t.jsx("pre",{className:"my-2",children:a}),hr:()=>t.jsx("hr",{className:"border-primary/20 my-4"}),a:({href:a,children:i})=>t.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:i}),table:({children:a})=>t.jsx("div",{className:"overflow-x-auto my-2",children:t.jsx("table",{className:"w-full text-xs border-collapse border border-secondary/40",children:a})}),th:({children:a})=>t.jsx("th",{className:"border border-secondary/40 bg-secondary/20 px-2 py-1 text-left font-semibold",children:a}),td:({children:a})=>typeof a=="string"?t.jsx("td",{className:"border border-secondary/40 px-2 py-1",children:yt(a,n)}):t.jsx("td",{className:"border border-secondary/40 px-2 py-1",children:a}),img:({src:a,alt:i})=>t.jsx("img",{src:a,alt:i||"",className:"max-w-full rounded border border-secondary/40 my-2",loading:"lazy"}),del:({children:a})=>t.jsx("del",{className:"line-through text-muted-foreground",children:a}),input:({checked:a,...i})=>t.jsx("input",{type:"checkbox",checked:a,readOnly:!0,className:"mr-1.5 accent-primary",...i})};return t.jsx("div",{className:"obsidian-preview prose-invert max-w-none text-sm leading-relaxed",children:t.jsx(_s,{remarkPlugins:[Ds],components:r,allowedElements:void 0,unwrapDisallowed:!1,children:s})})}function Ma({line:e,index:n}){const s=e.startsWith("+"),r=e.startsWith("-");return t.jsx("div",{className:`font-terminal text-[11px] px-2 ${s?"bg-green-900/30 text-green-400":r?"bg-red-900/30 text-red-400":"text-muted-foreground"}`,children:e})}function _a({open:e,onOpenChange:n,loading:s,error:r,rawNotes:a,organized:i,destination:l,selectedDestinationId:o,setSelectedDestinationId:c,customDestination:h,setCustomDestination:p,checklistState:b,onToggleChecklist:x,diffLines:j,onConfirm:S,onCancel:I}){const f=Object.values(b).length===0?!0:Object.values(b).every(Boolean),y=l?o==="custom"?h.trim():l.options.find(v=>v.id===o)?.path||"":"";return t.jsx(It,{open:e,onOpenChange:n,children:t.jsxs(zt,{className:"max-w-6xl w-full h-[85vh] bg-black border-2 border-primary rounded-none p-4 overflow-hidden",children:[t.jsxs(At,{className:"space-y-1",children:[t.jsxs(Tt,{className:"font-arcade text-sm text-primary flex items-center gap-2",children:[t.jsx(nt,{className:"w-4 h-4"}),"ORGANIZE + REVIEW"]}),t.jsx(Mt,{className:"font-terminal text-[11px] text-muted-foreground",children:"Review the organized notes, compare to raw, then choose where to save."})]}),r&&t.jsx("div",{className:"border border-red-500/50 bg-red-900/20 text-red-200 font-terminal text-xs p-2 rounded-none",children:r}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 h-[70vh]",children:[t.jsx("div",{className:"col-span-2 flex flex-col gap-3",children:t.jsxs(Gs,{defaultValue:"preview",className:"w-full",children:[t.jsxs(qs,{className:"grid grid-cols-3 rounded-none",children:[t.jsx(ut,{value:"preview",className:"rounded-none text-xs",children:"Preview"}),t.jsx(ut,{value:"raw",className:"rounded-none text-xs",children:"Raw"}),t.jsx(ut,{value:"diff",className:"rounded-none text-xs",children:"Diff"})]}),t.jsx(mt,{value:"preview",className:"mt-2",children:t.jsx(Oe,{className:"h-[56vh] border border-secondary/40 rounded-none bg-black/40 p-3",children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"font-arcade text-xs text-primary",children:i?.title||"Untitled"}),t.jsx(hs,{content:i?.markdown||""})]})})}),t.jsx(mt,{value:"raw",className:"mt-2",children:t.jsx(Oe,{className:"h-[56vh] border border-secondary/40 rounded-none bg-black/40 p-3",children:t.jsx("pre",{className:"whitespace-pre-wrap font-terminal text-[11px] text-foreground",children:a})})}),t.jsx(mt,{value:"diff",className:"mt-2",children:t.jsx(Oe,{className:"h-[56vh] border border-secondary/40 rounded-none bg-black/40 p-0",children:t.jsx("div",{className:"p-2",children:j.length===0?t.jsx("div",{className:"text-muted-foreground font-terminal text-xs",children:"No diff available."}):j.map((g,v)=>t.jsx(Ma,{line:g,index:v},v))})})})]})}),t.jsxs("div",{className:"col-span-1 flex flex-col gap-3",children:[t.jsxs("div",{className:"border border-secondary/50 bg-black/40 p-3 rounded-none",children:[t.jsx("div",{className:"font-arcade text-[10px] text-primary mb-2",children:"DESTINATION"}),t.jsx(ms,{value:o,onValueChange:c,className:"space-y-2",children:(l?.options||[]).map(g=>t.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[t.jsx(fs,{value:g.id,className:"mt-1"}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"font-terminal text-[11px] text-foreground flex items-center gap-1",children:[g.label,g.exists&&t.jsx(We,{variant:"outline",className:"text-[9px]",children:"existing"})]}),t.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground break-all",children:g.path||"Custom path"})]})]},g.id))}),o==="custom"&&t.jsxs("div",{className:"mt-2 space-y-1",children:[t.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground",children:"Custom path"}),t.jsx(Ce,{value:h,onChange:g=>p(g.target.value),placeholder:"School/Therapeutic Intervention/Module 01 - Title.md",className:"bg-black border-secondary/60 rounded-none text-xs font-terminal"})]})]}),t.jsxs("div",{className:"border border-secondary/50 bg-black/40 p-3 rounded-none",children:[t.jsx("div",{className:"font-arcade text-[10px] text-primary mb-2",children:"REVIEW CHECKLIST"}),t.jsx("div",{className:"space-y-2",children:(i?.checklist||[]).map(g=>t.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[t.jsx(En,{checked:!!b[g],onCheckedChange:()=>x(g)}),t.jsx("span",{className:"font-terminal text-[11px] text-foreground",children:g})]},g))})]}),(i?.suggested_links||[]).length>0&&t.jsxs("div",{className:"border border-secondary/50 bg-black/40 p-3 rounded-none",children:[t.jsx("div",{className:"font-arcade text-[10px] text-primary mb-2",children:"SUGGESTED LINKS"}),t.jsx("div",{className:"space-y-1",children:i?.suggested_links?.map(g=>t.jsxs("div",{className:"font-terminal text-[11px] text-muted-foreground",children:["[[",g,"]]"]},g))})]}),t.jsxs("div",{className:"flex gap-2 mt-auto",children:[t.jsx(B,{variant:"outline",className:"flex-1 rounded-none font-terminal text-xs",onClick:I,disabled:s,children:"Cancel"}),t.jsxs(B,{className:"flex-1 bg-primary hover:bg-primary/80 rounded-none font-terminal text-xs",onClick:S,disabled:!f||s||!y,children:[t.jsx(Bs,{className:"w-3 h-3 mr-1"}),s?"Saving...":"Confirm & Save"]})]})]})]})]})})}function Da(){const[e,n]=d.useState(!1),[s,r]=d.useState(!1),[a,i]=d.useState(null),[l,o]=d.useState(""),[c,h]=d.useState(null),[p,b]=d.useState(null),[x,j]=d.useState(""),[S,I]=d.useState(""),[f,u]=d.useState({}),[y,g]=d.useState([]),v=(E,P)=>{const _=E.split(`
`),H=P.split(`
`),R=[];let M=0,L=0;for(;M<_.length||L<H.length;){const q=_[M],K=H[L];if(M<_.length&&L<H.length&&q===K){R.push(` ${q}`),M+=1,L+=1;continue}M<_.length&&(R.push(`-${q}`),M+=1),L<H.length&&(R.push(`+${K}`),L+=1)}return R},T=d.useCallback(()=>{n(!1),r(!1),i(null),o(""),h(null),b(null),j(""),I(""),u({}),g([])},[]),D=d.useCallback(async E=>{r(!0),i(null),o(E);try{const P=await G.brain.organizePreview(E);if(!P.success||!P.organized||!P.destination)throw new Error(P.error||"Unable to organize notes.");h(P.organized),b(P.destination),j("recommended");const _=P.organized.checklist??[],H={};return _.forEach(R=>{H[R]=!1}),u(H),g(v(E,P.organized.markdown||"")),n(!0),!0}catch(P){const _=P instanceof Error?P.message:String(P);return i(_),!1}finally{r(!1)}},[]),k=d.useCallback(E=>{u(P=>({...P,[E]:!P[E]}))},[]),w=d.useCallback(()=>p?x==="custom"?S.trim():p.options.find(P=>P.id===x)?.path||"":"",[p,x,S]),F=Object.values(f).length===0?!0:Object.values(f).every(Boolean);return{open:e,setOpen:n,loading:s,error:a,rawNotes:l,organized:c,destination:p,selectedDestinationId:x,setSelectedDestinationId:j,customDestination:S,setCustomDestination:I,checklistState:f,diffLines:y,allChecklistChecked:F,reset:T,startPreview:D,toggleChecklist:k,getSelectedDestinationPath:w}}function $a(){const[e,n]=d.useState("chat"),[s,r]=d.useState([]),[a,i]=d.useState(""),[l,o]=d.useState([]),[c,h]=d.useState(!1),[p,b]=d.useState("anki"),[x,j]=d.useState(!1),S=d.useRef(null),I=et(),{toast:f}=tt(),u=Da(),y=d.useCallback(E=>{const P=new FileReader;P.onload=()=>{typeof P.result=="string"&&o(_=>[..._,P.result])},P.readAsDataURL(E)},[]),g=d.useCallback(E=>{const P=E.clipboardData?.items;if(P){for(const _ of Array.from(P))if(_.type.startsWith("image/")){E.preventDefault();const H=_.getAsFile();H&&y(H)}}},[y]),v=d.useCallback(E=>{for(const P of Array.from(E))P.type.startsWith("image/")&&y(P)},[y]),T=d.useCallback(E=>{o(P=>P.filter((_,H)=>H!==E))},[]),D=d.useCallback(async(E,P)=>{r(q=>[...q,{role:"assistant",content:""}]);const _=s.map(q=>({role:q.role,content:q.images?.length?dn(q.content,q.images):q.content})).concat([{role:"user",content:dn(E,P)}]),R=(await fetch("/api/brain/quick-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:_})})).body?.getReader(),M=new TextDecoder;if(!R)throw new Error("No response body");let L="";for(;;){const{done:q,value:K}=await R.read();if(q)break;L+=M.decode(K,{stream:!0});const se=L.split(`
`);L=se.pop()??"";for(const de of se){if(!de.startsWith("data: "))continue;const ae=de.slice(6);if(ae==="[DONE]")break;try{const re=JSON.parse(ae);if(re.error){r(m=>{const N=[...m];return N[N.length-1]={role:"assistant",content:`Error: ${re.error}`},N});return}re.content&&r(m=>{const N=[...m],A=N[N.length-1];return N[N.length-1]={...A,content:A.content+re.content},N})}catch{}}}},[s]),k=d.useCallback(async(E,P)=>{try{const R={message:E,syncToObsidian:p==="obsidian"||p==="both",mode:p==="both"?"all":p,destinationPath:P?.destinationPath,organizedMarkdown:P?.organizedMarkdown,organizedTitle:P?.organizedTitle,confirmWrite:P?.confirmWrite},M=await G.brain.chat(R);let L=M.response;const q={cardsCreated:M.cardsCreated,sessionSaved:M.sessionSaved,sessionId:M.sessionId},K=[];M.sessionSaved&&K.push(`Session saved (ID: ${M.sessionId})`),M.cardsCreated&&K.push(`${M.cardsCreated} Anki cards created`),M.obsidianSynced&&K.push("Synced to Obsidian"),M.obsidianError&&K.push(`Obsidian error: ${M.obsidianError}`),K.length>0&&(L=`${K.join(" | ")}

${L}`),r(se=>[...se,{role:"assistant",content:L,meta:q}]),I.invalidateQueries({queryKey:["anki","drafts"]}),I.invalidateQueries({queryKey:["brain","metrics"]}),I.invalidateQueries({queryKey:["sessions"]})}catch(_){const H=_ instanceof Error?_.message:String(_);r(R=>[...R,{role:"assistant",content:`Error: ${H}`}]),f({title:"Ingest failed",description:H,variant:"destructive"})}},[p,I,f]),w=d.useCallback(async()=>{const E=a.trim();if(!E&&l.length===0)return;const P={role:"user",content:E,images:[...l]};r(_=>[..._,P]),i(""),o([]),h(!0);try{e==="chat"?await D(E,P.images??[]):p==="obsidian"||p==="both"?await u.startPreview(E)||r(H=>[...H,{role:"assistant",content:"Error: Unable to prepare preview."}]):await k(E)}catch(_){const H=_ instanceof Error?_.message:String(_);r(R=>{const M=R[R.length-1];if(M?.role==="assistant"&&!M.content){const L=[...R];return L[L.length-1]={role:"assistant",content:`Error: ${H}`},L}return[...R,{role:"assistant",content:`Error: ${H}`}]})}finally{h(!1)}},[a,l,e,p,D,k,u]),F=d.useCallback(async()=>{if(!u.organized)return;const E=u.getSelectedDestinationPath();if(!E){u.setOpen(!1),f({title:"Error",description:"Select a destination path.",variant:"destructive"});return}h(!0);try{await k(u.rawNotes,{destinationPath:E,organizedMarkdown:u.organized.markdown,organizedTitle:u.organized.title,confirmWrite:!0}),u.reset()}catch(P){const _=P instanceof Error?P.message:String(P);f({title:"Save failed",description:_,variant:"destructive"})}finally{h(!1)}},[u,k,f]);return t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsx(da,{mode:e,setMode:n,ingestTarget:p,setIngestTarget:b,promptCopied:x,setPromptCopied:j}),t.jsx(ua,{messages:s,loading:c,mode:e,scrollRef:S}),t.jsx(ma,{images:l,onRemove:T}),t.jsx(fa,{input:a,setInput:i,onSend:w,onImageSelect:v,onPaste:g,loading:c,mode:e}),t.jsx(_a,{open:u.open,onOpenChange:E=>{E?u.setOpen(!0):u.reset()},loading:u.loading,error:u.error,rawNotes:u.rawNotes,organized:u.organized,destination:u.destination,selectedDestinationId:u.selectedDestinationId,setSelectedDestinationId:u.setSelectedDestinationId,customDestination:u.customDestination,setCustomDestination:u.setCustomDestination,checklistState:u.checklistState,onToggleChecklist:u.toggleChecklist,diffLines:u.diffLines,onConfirm:F,onCancel:u.reset})]})}const La="/assets/TreysStudySystemIMAGE-nejJlbV0.jpg";function Oa({workspace:e}){const[n,s]=d.useState(!1),[r,a]=d.useState(!1),i=d.useCallback(async()=>{await e.saveFile(),a(!0),setTimeout(()=>a(!1),300)},[e]);return d.useEffect(()=>{if(!n)return;const l=o=>{o.key==="Escape"&&s(!1)};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[n]),e.currentFile?t.jsxs("div",{className:Q("flex flex-col",n?"fixed inset-0 z-50 bg-black":"h-full"),children:[t.jsxs("div",{className:Q("flex items-center justify-between px-3 py-1.5 border-b bg-black/40",r?"brain-save-flash":"border-secondary/30"),children:[t.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[t.jsxs("span",{className:"font-terminal text-sm text-primary truncate",children:[e.currentFile.split("/").pop(),e.hasChanges&&t.jsx("span",{className:"text-yellow-500 ml-1",children:"*"})]}),t.jsx("button",{onClick:()=>{const l=e.obsidianConfig?.vaultName||"Treys School",o=e.currentFile.replace(/\.md$/,"");window.open(`obsidian://open?vault=${encodeURIComponent(l)}&file=${encodeURIComponent(o)}`,"_blank")},className:"text-muted-foreground hover:text-primary shrink-0",title:"Open in Obsidian",children:t.jsx(Ws,{className:"w-3 h-3"})})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(B,{size:"sm",variant:"ghost",className:"h-5 px-2 text-xs font-terminal",onClick:()=>e.setPreviewMode(!e.previewMode),children:e.previewMode?"Edit":"Preview"}),t.jsxs(B,{size:"sm",variant:"ghost",onClick:i,disabled:!e.hasChanges||e.isSaving,className:"h-5 px-2 text-xs font-terminal",children:[t.jsx(_t,{className:"w-3 h-3 mr-1"}),e.isSaving?"Saving...":"Save"]}),t.jsx(B,{size:"sm",variant:"ghost",className:"h-5 px-1.5 text-xs font-terminal",onClick:()=>s(!n),title:n?"Exit fullscreen":"Fullscreen",children:n?t.jsx(gr,{className:"w-3 h-3"}):t.jsx(pr,{className:"w-3 h-3"})})]})]}),e.previewMode?t.jsx("div",{className:"flex-1 p-3 bg-black/60 font-terminal overflow-y-auto",children:t.jsx(hs,{content:e.fileContent,onWikilinkClick:e.handleWikilinkClick})}):t.jsx("textarea",{value:e.fileContent,onChange:l=>e.setFileContent(l.target.value),className:"flex-1 w-full p-3 bg-black/60 font-terminal text-sm resize-none focus:outline-none focus:ring-1 focus:ring-primary overflow-y-auto min-h-[200px]",placeholder:"File content...",style:{height:"100%"}})]}):t.jsxs("div",{className:"brain-workspace__empty flex-1 flex flex-col items-center justify-center gap-4 relative overflow-hidden min-h-[200px]",children:[t.jsx("img",{src:La,alt:"",className:"absolute inset-0 w-full h-full object-cover opacity-[0.12] pointer-events-none select-none"}),t.jsxs("div",{className:"relative z-10 flex flex-col items-center gap-3 text-center px-4",children:[t.jsx(nt,{className:"brain-empty-icon w-10 h-10 text-primary/60","aria-hidden":"true"}),t.jsx("p",{className:"font-arcade text-xs text-primary/90 tracking-widest uppercase",children:"No file open"}),t.jsx("p",{className:"font-terminal text-sm text-muted-foreground max-w-[260px]",children:"Select a file from the vault sidebar or create a new note"})]})]})}const Fa=d.lazy(()=>Rt(()=>import("./ConceptMapEditor-DQGSQfhr.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(e=>({default:e.ConceptMapEditor}))),Ha=d.lazy(()=>Rt(()=>import("./VaultGraphView-DCyJtgl0.js"),__vite__mapDeps([25,1,2,26,9,4,21,6,10])).then(e=>({default:e.VaultGraphView}))),Va=d.lazy(()=>Rt(()=>import("./MindMapView-L7wxlOmN.js"),__vite__mapDeps([27,1,2,26,9,4,3,5,6,7,8,21])).then(e=>({default:e.MindMapView})));class Ga extends d.Component{constructor(){super(...arguments),this.state={error:null}}static getDerivedStateFromError(n){return{error:n.message}}render(){return this.state.error?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-2 p-4",children:[t.jsx("p",{className:"font-arcade text-xs text-red-400",children:"GRAPH RENDER ERROR"}),t.jsx("p",{className:"font-terminal text-xs text-muted-foreground text-center",children:this.state.error}),t.jsx("button",{className:"font-terminal text-sm text-primary underline",onClick:()=>this.setState({error:null}),children:"Try again"})]}):this.props.children}}function qa(){return t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx($t,{className:"w-6 h-6 animate-spin text-primary"})})}function Ba(){const[e,n]=d.useState("concept"),s=[{id:"concept",label:"Concept Map"},{id:"vault",label:"Vault Graph"},{id:"mindmap",label:"Mind Map"}];return t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsx("div",{className:"tab-sub-bar",role:"tablist","aria-label":"Graph view",children:s.map(r=>t.jsx("button",{role:"tab","aria-selected":e===r.id,onClick:()=>n(r.id),className:Q("tab-sub-item",e===r.id&&"active"),children:r.label},r.id))}),t.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:t.jsx(Ga,{children:t.jsxs(d.Suspense,{fallback:t.jsx(qa,{}),children:[e==="concept"&&t.jsx(Fa,{}),e==="vault"&&t.jsx(Ha,{}),e==="mindmap"&&t.jsx(Va,{})]})})})]})}function Ka(e,n){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const s=document.implementation.createHTMLDocument(),r=s.createElement("base"),a=s.createElement("a");return s.head.appendChild(r),s.body.appendChild(a),n&&(r.href=n),a.href=e,a.href}const Ua=(()=>{let e=0;const n=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${n()}${e}`)})();function pe(e){const n=[];for(let s=0,r=e.length;s<r;s++)n.push(e[s]);return n}let je=null;function ps(e={}){return je||(e.includeStyleProperties?(je=e.includeStyleProperties,je):(je=pe(window.getComputedStyle(document.documentElement)),je))}function Qe(e,n){const r=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(n);return r?parseFloat(r.replace("px","")):0}function Wa(e){const n=Qe(e,"border-left-width"),s=Qe(e,"border-right-width");return e.clientWidth+n+s}function Ja(e){const n=Qe(e,"border-top-width"),s=Qe(e,"border-bottom-width");return e.clientHeight+n+s}function xs(e,n={}){const s=n.width||Wa(e),r=n.height||Ja(e);return{width:s,height:r}}function Ya(){let e,n;try{n=process}catch{}const s=n&&n.env?n.env.devicePixelRatio:null;return s&&(e=parseInt(s,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const te=16384;function Qa(e){(e.width>te||e.height>te)&&(e.width>te&&e.height>te?e.width>e.height?(e.height*=te/e.width,e.width=te):(e.width*=te/e.height,e.height=te):e.width>te?(e.height*=te/e.width,e.width=te):(e.width*=te/e.height,e.height=te))}function Xe(e){return new Promise((n,s)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>n(r))})},r.onerror=s,r.crossOrigin="anonymous",r.decoding="async",r.src=e})}async function Xa(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(n=>`data:image/svg+xml;charset=utf-8,${n}`)}async function Za(e,n,s){const r="http://www.w3.org/2000/svg",a=document.createElementNS(r,"svg"),i=document.createElementNS(r,"foreignObject");return a.setAttribute("width",`${n}`),a.setAttribute("height",`${s}`),a.setAttribute("viewBox",`0 0 ${n} ${s}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),a.appendChild(i),i.appendChild(e),Xa(a)}const ee=(e,n)=>{if(e instanceof n)return!0;const s=Object.getPrototypeOf(e);return s===null?!1:s.constructor.name===n.name||ee(s,n)};function ei(e){const n=e.getPropertyValue("content");return`${e.cssText} content: '${n.replace(/'|"/g,"")}';`}function ti(e,n){return ps(n).map(s=>{const r=e.getPropertyValue(s),a=e.getPropertyPriority(s);return`${s}: ${r}${a?" !important":""};`}).join(" ")}function ni(e,n,s,r){const a=`.${e}:${n}`,i=s.cssText?ei(s):ti(s,r);return document.createTextNode(`${a}{${i}}`)}function mn(e,n,s,r){const a=window.getComputedStyle(e,s),i=a.getPropertyValue("content");if(i===""||i==="none")return;const l=Ua();try{n.className=`${n.className} ${l}`}catch{return}const o=document.createElement("style");o.appendChild(ni(l,s,a,r)),n.appendChild(o)}function si(e,n,s){mn(e,n,":before",s),mn(e,n,":after",s)}const fn="application/font-woff",hn="image/jpeg",ri={woff:fn,woff2:fn,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:hn,jpeg:hn,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function ai(e){const n=/\.([^./]*?)$/g.exec(e);return n?n[1]:""}function qt(e){const n=ai(e).toLowerCase();return ri[n]||""}function ii(e){return e.split(/,/)[1]}function Et(e){return e.search(/^(data:)/)!==-1}function oi(e,n){return`data:${n};base64,${e}`}async function gs(e,n,s){const r=await fetch(e,n);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const a=await r.blob();return new Promise((i,l)=>{const o=new FileReader;o.onerror=l,o.onloadend=()=>{try{i(s({res:r,result:o.result}))}catch(c){l(c)}},o.readAsDataURL(a)})}const vt={};function li(e,n,s){let r=e.replace(/\?.*/,"");return s&&(r=e),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),n?`[${n}]${r}`:r}async function Bt(e,n,s){const r=li(e,n,s.includeQueryParams);if(vt[r]!=null)return vt[r];s.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let a;try{const i=await gs(e,s.fetchRequestInit,({res:l,result:o})=>(n||(n=l.headers.get("Content-Type")||""),ii(o)));a=oi(i,n)}catch(i){a=s.imagePlaceholder||"";let l=`Failed to fetch resource: ${e}`;i&&(l=typeof i=="string"?i:i.message),l&&console.warn(l)}return vt[r]=a,a}async function ci(e){const n=e.toDataURL();return n==="data:,"?e.cloneNode(!1):Xe(n)}async function di(e,n){if(e.currentSrc){const i=document.createElement("canvas"),l=i.getContext("2d");i.width=e.clientWidth,i.height=e.clientHeight,l?.drawImage(e,0,0,i.width,i.height);const o=i.toDataURL();return Xe(o)}const s=e.poster,r=qt(s),a=await Bt(s,r,n);return Xe(a)}async function ui(e,n){var s;try{if(!((s=e?.contentDocument)===null||s===void 0)&&s.body)return await lt(e.contentDocument.body,n,!0)}catch{}return e.cloneNode(!1)}async function mi(e,n){return ee(e,HTMLCanvasElement)?ci(e):ee(e,HTMLVideoElement)?di(e,n):ee(e,HTMLIFrameElement)?ui(e,n):e.cloneNode(bs(e))}const fi=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",bs=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function hi(e,n,s){var r,a;if(bs(n))return n;let i=[];return fi(e)&&e.assignedNodes?i=pe(e.assignedNodes()):ee(e,HTMLIFrameElement)&&(!((r=e.contentDocument)===null||r===void 0)&&r.body)?i=pe(e.contentDocument.body.childNodes):i=pe(((a=e.shadowRoot)!==null&&a!==void 0?a:e).childNodes),i.length===0||ee(e,HTMLVideoElement)||await i.reduce((l,o)=>l.then(()=>lt(o,s)).then(c=>{c&&n.appendChild(c)}),Promise.resolve()),n}function pi(e,n,s){const r=n.style;if(!r)return;const a=window.getComputedStyle(e);a.cssText?(r.cssText=a.cssText,r.transformOrigin=a.transformOrigin):ps(s).forEach(i=>{let l=a.getPropertyValue(i);i==="font-size"&&l.endsWith("px")&&(l=`${Math.floor(parseFloat(l.substring(0,l.length-2)))-.1}px`),ee(e,HTMLIFrameElement)&&i==="display"&&l==="inline"&&(l="block"),i==="d"&&n.getAttribute("d")&&(l=`path(${n.getAttribute("d")})`),r.setProperty(i,l,a.getPropertyPriority(i))})}function xi(e,n){ee(e,HTMLTextAreaElement)&&(n.innerHTML=e.value),ee(e,HTMLInputElement)&&n.setAttribute("value",e.value)}function gi(e,n){if(ee(e,HTMLSelectElement)){const s=n,r=Array.from(s.children).find(a=>e.value===a.getAttribute("value"));r&&r.setAttribute("selected","")}}function bi(e,n,s){return ee(n,Element)&&(pi(e,n,s),si(e,n,s),xi(e,n),gi(e,n)),n}async function yi(e,n){const s=e.querySelectorAll?e.querySelectorAll("use"):[];if(s.length===0)return e;const r={};for(let i=0;i<s.length;i++){const o=s[i].getAttribute("xlink:href");if(o){const c=e.querySelector(o),h=document.querySelector(o);!c&&h&&!r[o]&&(r[o]=await lt(h,n,!0))}}const a=Object.values(r);if(a.length){const i="http://www.w3.org/1999/xhtml",l=document.createElementNS(i,"svg");l.setAttribute("xmlns",i),l.style.position="absolute",l.style.width="0",l.style.height="0",l.style.overflow="hidden",l.style.display="none";const o=document.createElementNS(i,"defs");l.appendChild(o);for(let c=0;c<a.length;c++)o.appendChild(a[c]);e.appendChild(l)}return e}async function lt(e,n,s){return!s&&n.filter&&!n.filter(e)?null:Promise.resolve(e).then(r=>mi(r,n)).then(r=>hi(e,r,n)).then(r=>bi(e,r,n)).then(r=>yi(r,n))}const ys=/url\((['"]?)([^'"]+?)\1\)/g,vi=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,wi=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ji(e){const n=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${n})(['"]?\\))`,"g")}function Ni(e){const n=[];return e.replace(ys,(s,r,a)=>(n.push(a),s)),n.filter(s=>!Et(s))}async function Si(e,n,s,r,a){try{const i=s?Ka(n,s):n,l=qt(n);let o;return a||(o=await Bt(i,l,r)),e.replace(ji(n),`$1${o}$3`)}catch{}return e}function ki(e,{preferredFontFormat:n}){return n?e.replace(wi,s=>{for(;;){const[r,,a]=vi.exec(s)||[];if(!a)return"";if(a===n)return`src: ${r};`}}):e}function vs(e){return e.search(ys)!==-1}async function ws(e,n,s){if(!vs(e))return e;const r=ki(e,s);return Ni(r).reduce((i,l)=>i.then(o=>Si(o,l,n,s)),Promise.resolve(r))}async function Ne(e,n,s){var r;const a=(r=n.style)===null||r===void 0?void 0:r.getPropertyValue(e);if(a){const i=await ws(a,null,s);return n.style.setProperty(e,i,n.style.getPropertyPriority(e)),!0}return!1}async function Ci(e,n){await Ne("background",e,n)||await Ne("background-image",e,n),await Ne("mask",e,n)||await Ne("-webkit-mask",e,n)||await Ne("mask-image",e,n)||await Ne("-webkit-mask-image",e,n)}async function Ei(e,n){const s=ee(e,HTMLImageElement);if(!(s&&!Et(e.src))&&!(ee(e,SVGImageElement)&&!Et(e.href.baseVal)))return;const r=s?e.src:e.href.baseVal,a=await Bt(r,qt(r),n);await new Promise((i,l)=>{e.onload=i,e.onerror=n.onImageErrorHandler?(...c)=>{try{i(n.onImageErrorHandler(...c))}catch(h){l(h)}}:l;const o=e;o.decode&&(o.decode=i),o.loading==="lazy"&&(o.loading="eager"),s?(e.srcset="",e.src=a):e.href.baseVal=a})}async function Pi(e,n){const r=pe(e.childNodes).map(a=>js(a,n));await Promise.all(r).then(()=>e)}async function js(e,n){ee(e,Element)&&(await Ci(e,n),await Ei(e,n),await Pi(e,n))}function Ri(e,n){const{style:s}=e;n.backgroundColor&&(s.backgroundColor=n.backgroundColor),n.width&&(s.width=`${n.width}px`),n.height&&(s.height=`${n.height}px`);const r=n.style;return r!=null&&Object.keys(r).forEach(a=>{s[a]=r[a]}),e}const pn={};async function xn(e){let n=pn[e];if(n!=null)return n;const r=await(await fetch(e)).text();return n={url:e,cssText:r},pn[e]=n,n}async function gn(e,n){let s=e.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,i=(s.match(/url\([^)]+\)/g)||[]).map(async l=>{let o=l.replace(r,"$1");return o.startsWith("https://")||(o=new URL(o,e.url).href),gs(o,n.fetchRequestInit,({result:c})=>(s=s.replace(l,`url(${c})`),[l,c]))});return Promise.all(i).then(()=>s)}function bn(e){if(e==null)return[];const n=[],s=/(\/\*[\s\S]*?\*\/)/gi;let r=e.replace(s,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const c=a.exec(r);if(c===null)break;n.push(c[0])}r=r.replace(a,"");const i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,l="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",o=new RegExp(l,"gi");for(;;){let c=i.exec(r);if(c===null){if(c=o.exec(r),c===null)break;i.lastIndex=o.lastIndex}else o.lastIndex=i.lastIndex;n.push(c[0])}return n}async function Ii(e,n){const s=[],r=[];return e.forEach(a=>{if("cssRules"in a)try{pe(a.cssRules||[]).forEach((i,l)=>{if(i.type===CSSRule.IMPORT_RULE){let o=l+1;const c=i.href,h=xn(c).then(p=>gn(p,n)).then(p=>bn(p).forEach(b=>{try{a.insertRule(b,b.startsWith("@import")?o+=1:a.cssRules.length)}catch(x){console.error("Error inserting rule from remote css",{rule:b,error:x})}})).catch(p=>{console.error("Error loading remote css",p.toString())});r.push(h)}})}catch(i){const l=e.find(o=>o.href==null)||document.styleSheets[0];a.href!=null&&r.push(xn(a.href).then(o=>gn(o,n)).then(o=>bn(o).forEach(c=>{l.insertRule(c,l.cssRules.length)})).catch(o=>{console.error("Error loading remote stylesheet",o)})),console.error("Error inlining remote css file",i)}}),Promise.all(r).then(()=>(e.forEach(a=>{if("cssRules"in a)try{pe(a.cssRules||[]).forEach(i=>{s.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${a.href}`,i)}}),s))}function zi(e){return e.filter(n=>n.type===CSSRule.FONT_FACE_RULE).filter(n=>vs(n.style.getPropertyValue("src")))}async function Ai(e,n){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const s=pe(e.ownerDocument.styleSheets),r=await Ii(s,n);return zi(r)}function Ns(e){return e.trim().replace(/["']/g,"")}function Ti(e){const n=new Set;function s(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(i=>{n.add(Ns(i))}),Array.from(r.children).forEach(i=>{i instanceof HTMLElement&&s(i)})}return s(e),n}async function Mi(e,n){const s=await Ai(e,n),r=Ti(e);return(await Promise.all(s.filter(i=>r.has(Ns(i.style.fontFamily))).map(i=>{const l=i.parentStyleSheet?i.parentStyleSheet.href:null;return ws(i.cssText,l,n)}))).join(`
`)}async function _i(e,n){const s=n.fontEmbedCSS!=null?n.fontEmbedCSS:n.skipFonts?null:await Mi(e,n);if(s){const r=document.createElement("style"),a=document.createTextNode(s);r.appendChild(a),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}}async function Di(e,n={}){const{width:s,height:r}=xs(e,n),a=await lt(e,n,!0);return await _i(a,n),await js(a,n),Ri(a,n),await Za(a,s,r)}async function $i(e,n={}){const{width:s,height:r}=xs(e,n),a=await Di(e,n),i=await Xe(a),l=document.createElement("canvas"),o=l.getContext("2d"),c=n.pixelRatio||Ya(),h=n.canvasWidth||s,p=n.canvasHeight||r;return l.width=h*c,l.height=p*c,n.skipAutoScale||Qa(l),l.style.width=`${h}`,l.style.height=`${p}`,n.backgroundColor&&(o.fillStyle=n.backgroundColor,o.fillRect(0,0,l.width,l.height)),o.drawImage(i,0,0,l.width,l.height),l}async function Li(e,n={}){return(await $i(e,n)).toDataURL()}const wt={title:"Untitled Comparison",columns:["Concept A","Concept B"],rows:[{feature:"Feature 1",values:["",""],isKey:!1},{feature:"Feature 2",values:["",""],isKey:!1},{feature:"Feature 3",values:["",""],isKey:!1}]};function yn(e){const n=`| Feature | ${e.columns.join(" | ")} |`,s=`|${"----|".repeat(e.columns.length+1)}`,r=e.rows.map(a=>`| ${a.isKey?`**${a.feature}**`:a.feature} | ${a.values.join(" | ")} |`);return[n,s,...r].join(`
`)}function Oi({className:e}){const[n,s]=d.useState(()=>({...wt,columns:[...wt.columns],rows:wt.rows.map(u=>({...u,values:[...u.values]}))})),r=d.useRef(null),{toast:a}=tt(),i=d.useCallback(u=>{s(y=>({...y,title:u}))},[]),l=d.useCallback((u,y)=>{s(g=>{const v=[...g.columns];return v[u]=y,{...g,columns:v}})},[]),o=d.useCallback((u,y)=>{s(g=>{const v=g.rows.map((T,D)=>D===u?{...T,feature:y}:T);return{...g,rows:v}})},[]),c=d.useCallback((u,y,g)=>{s(v=>{const T=v.rows.map((D,k)=>{if(k!==u)return D;const w=[...D.values];return w[y]=g,{...D,values:w}});return{...v,rows:T}})},[]),h=d.useCallback(u=>{s(y=>{const g=y.rows.map((v,T)=>T===u?{...v,isKey:!v.isKey}:v);return{...y,rows:g}})},[]),p=d.useCallback(()=>{s(u=>{if(u.columns.length>=4)return u;const y=[...u.columns,`Concept ${u.columns.length+1}`],g=u.rows.map(v=>({...v,values:[...v.values,""]}));return{...u,columns:y,rows:g}})},[]),b=d.useCallback(u=>{s(y=>{if(y.columns.length<=2)return y;const g=y.columns.filter((T,D)=>D!==u),v=y.rows.map(T=>({...T,values:T.values.filter((D,k)=>k!==u)}));return{...y,columns:g,rows:v}})},[]),x=d.useCallback(()=>{s(u=>({...u,rows:[...u.rows,{feature:`Feature ${u.rows.length+1}`,values:u.columns.map(()=>""),isKey:!1}]}))},[]),j=d.useCallback(u=>{s(y=>y.rows.length<=1?y:{...y,rows:y.rows.filter((g,v)=>v!==u)})},[]),S=d.useCallback(()=>{const u=yn(n);navigator.clipboard.writeText(u),a({title:"Markdown copied to clipboard"})},[n,a]),I=d.useCallback(async()=>{if(r.current)try{const u=await Li(r.current,{backgroundColor:"#000",quality:1}),y=document.createElement("a");y.download=`${n.title.replace(/[/\\?%*:|"<>]/g,"-")}.png`,y.href=u,y.click(),a({title:"PNG exported"})}catch(u){a({title:"Export failed",description:String(u),variant:"destructive"})}},[n.title,a]),f=d.useCallback(async()=>{const u=yn(n),y=n.title.replace(/[/\\?%*:|"<>]/g,"-"),g=`---
type: comparison-table
created: ${new Date().toISOString()}
---

# ${n.title}

${u}
`,v=`Comparison Tables/${y}.md`;try{await G.obsidian.saveFile(v,g),a({title:"Saved to vault",description:v})}catch(T){a({title:"Save failed",description:String(T),variant:"destructive"})}},[n,a]);return t.jsxs("div",{className:Q("flex flex-col h-full",e),children:[t.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 border-b border-secondary/30 bg-black/40 shrink-0 flex-wrap",children:[t.jsxs(B,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:p,disabled:n.columns.length>=4,title:"Add column",children:[t.jsx(rr,{className:"w-3 h-3"}),t.jsx(Jt,{className:"w-2 h-2"})]}),t.jsxs(B,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:x,title:"Add row",children:[t.jsx(Sr,{className:"w-3 h-3"}),t.jsx(Jt,{className:"w-2 h-2"})]}),t.jsx("div",{className:"w-px h-4 bg-secondary/30"}),t.jsx(B,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:S,title:"Copy markdown",children:t.jsx(ir,{className:"w-3 h-3"})}),t.jsx(B,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:I,title:"Export PNG",children:t.jsx(Pn,{className:"w-3 h-3"})}),t.jsx(B,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:f,title:"Save to vault",children:t.jsx(_t,{className:"w-3 h-3"})}),t.jsxs("span",{className:"ml-auto text-[9px] font-terminal text-muted-foreground",children:[n.columns.length,"C / ",n.rows.length,"R"]})]}),t.jsx("div",{className:"px-2 py-1 border-b border-secondary/20",children:t.jsx(Ce,{value:n.title,onChange:u=>i(u.target.value),className:"h-6 text-xs font-arcade bg-transparent border-none px-1 text-primary focus-visible:ring-0",placeholder:"Table title..."})}),t.jsx("div",{className:"flex-1 overflow-auto p-2",children:t.jsxs("div",{ref:r,className:"bg-black/80 border-2 border-primary/50",children:[t.jsxs("div",{className:"flex border-b-2 border-primary/50",children:[t.jsx("div",{className:"w-28 shrink-0 p-1 border-r border-secondary/30 bg-black/60",children:t.jsx("span",{className:"font-arcade text-[9px] text-muted-foreground",children:"FEATURE"})}),n.columns.map((u,y)=>t.jsxs("div",{className:"flex-1 min-w-[100px] p-1 border-r border-secondary/30 bg-black/60 flex items-center gap-1",children:[t.jsx(Ce,{value:u,onChange:g=>l(y,g.target.value),className:"h-5 text-[10px] font-arcade bg-transparent border-none px-0 text-primary focus-visible:ring-0 flex-1"}),n.columns.length>2&&t.jsx("button",{onClick:()=>b(y),className:"text-muted-foreground hover:text-destructive shrink-0",children:t.jsx(Ke,{className:"w-2.5 h-2.5"})})]},y))]}),n.rows.map((u,y)=>t.jsxs("div",{className:Q("flex border-b border-secondary/20",u.isKey&&"border-l-2 border-l-primary"),children:[t.jsxs("div",{className:"w-28 shrink-0 p-1 border-r border-secondary/30 flex items-center gap-1",children:[t.jsx("button",{onClick:()=>h(y),className:Q("shrink-0",u.isKey?"text-primary":"text-muted-foreground/40 hover:text-muted-foreground"),title:"Toggle key feature",children:t.jsx(Js,{className:"w-2.5 h-2.5",fill:u.isKey?"currentColor":"none"})}),t.jsx(Ce,{value:u.feature,onChange:g=>o(y,g.target.value),className:Q("h-5 text-[10px] font-terminal bg-transparent border-none px-0 focus-visible:ring-0 flex-1",u.isKey?"text-primary font-bold":"text-secondary-foreground")}),n.rows.length>1&&t.jsx("button",{onClick:()=>j(y),className:"text-muted-foreground hover:text-destructive shrink-0",children:t.jsx(Ke,{className:"w-2.5 h-2.5"})})]}),u.values.map((g,v)=>t.jsx("div",{className:"flex-1 min-w-[100px] p-1 border-r border-secondary/30",children:t.jsx(Ce,{value:g,onChange:T=>c(y,v,T.target.value),className:"h-5 text-[10px] font-terminal bg-transparent border-none px-0 text-secondary-foreground focus-visible:ring-0",placeholder:"..."})},v))]},y))]})})]})}function Fi({totalCards:e,compact:n}){const[s,r]=d.useState(new Set),[a,i]=d.useState(null),[l,o]=d.useState({front:"",back:"",deckName:""}),c=et(),{toast:h}=tt(),{data:p,isLoading:b,refetch:x}=Y({queryKey:["anki","status"],queryFn:G.anki.getStatus,refetchInterval:3e4}),{data:j}=Y({queryKey:["anki","due"],queryFn:G.anki.getDue,enabled:p?.connected===!0}),{data:S=[],refetch:I}=Y({queryKey:["anki","drafts"],queryFn:G.anki.getDrafts}),f=S.filter(w=>w.status==="pending"),u=me({mutationFn:G.anki.sync,onSuccess:w=>{c.invalidateQueries({queryKey:["anki"]}),I(),h({title:"Anki sync complete",description:w.output||"Cards synced successfully"})},onError:w=>{h({title:"Anki sync failed",description:w.message,variant:"destructive"})}}),y=me({mutationFn:w=>G.anki.approveDraft(w),onSuccess:()=>I()}),g=me({mutationFn:w=>G.anki.deleteDraft(w),onMutate:async w=>{await c.cancelQueries({queryKey:["anki","drafts"]});const F=c.getQueryData(["anki","drafts"]);return c.setQueryData(["anki","drafts"],E=>E?E.filter(P=>P.id!==w):[]),{prev:F}},onError:(w,F,E)=>{E?.prev&&c.setQueryData(["anki","drafts"],E.prev)},onSettled:()=>I()}),v=me({mutationFn:({id:w,data:F})=>G.anki.updateDraft(w,F),onSuccess:()=>{I(),i(null)}}),T=w=>{i(w.id),o({front:w.front,back:w.back,deckName:w.deckName})},D=()=>{a!==null&&v.mutate({id:a,data:l})},k=t.jsx("div",{className:n?"p-3 space-y-3":"p-4 space-y-3",children:b?t.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Checking Anki..."}):p?.connected?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-4 font-terminal text-xs",children:[t.jsx(We,{variant:"outline",className:"bg-success/20 text-success border-success",children:"Connected"}),t.jsxs("span",{className:"text-muted-foreground",children:["Cards: ",t.jsx("span",{className:"text-primary font-arcade",children:e})]}),t.jsxs("span",{className:"text-muted-foreground",children:["Due: ",t.jsx("span",{className:"text-secondary font-arcade",children:j?.dueCount||0})]}),t.jsxs("span",{className:"text-muted-foreground",children:["Reviewed: ",t.jsx("span",{className:"font-arcade",children:p.reviewedToday||0})]}),t.jsxs("span",{className:"text-muted-foreground",children:["Decks: ",t.jsx("span",{className:"font-arcade",children:p.decks?.length||0})]})]}),t.jsxs("div",{className:"pt-2 flex gap-2",children:[t.jsxs(B,{size:"sm",variant:"outline",className:"flex-1 font-terminal text-xs",onClick:()=>x(),children:[t.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Refresh"]}),t.jsxs(B,{size:"sm",className:"flex-1 font-terminal text-xs bg-secondary hover:bg-secondary/80",onClick:()=>u.mutate(),disabled:u.isPending,children:[u.isPending?t.jsx($t,{className:"w-3 h-3 mr-1 animate-spin"}):t.jsx(Ae,{className:"w-3 h-3 mr-1"}),u.isPending?"Syncing...":"Sync Cards"]})]}),u.isError&&t.jsxs("div",{className:"p-2 bg-destructive/10 border border-destructive/30 text-destructive font-terminal text-[10px]",children:[t.jsx("span",{className:"font-arcade",children:"SYNC ERROR:"})," ",u.error?.message||"Unknown error",t.jsx(B,{size:"sm",variant:"outline",className:"ml-2 h-5 px-2 text-[10px] font-terminal border-destructive/50 text-destructive",onClick:()=>u.mutate(),disabled:u.isPending,children:"Retry"})]}),f.length>0&&t.jsxs("div",{className:"pt-3 border-t border-secondary/30",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsxs("span",{className:"font-arcade text-[10px] text-warning",children:["PENDING CARDS (",f.length,")"]}),t.jsx("div",{className:"flex gap-1",children:t.jsx(B,{size:"sm",variant:"outline",className:"h-5 px-2 text-[10px] font-terminal",onClick:()=>{s.size===f.length?r(new Set):r(new Set(f.map(w=>w.id)))},children:s.size===f.length?"None":"All"})})]}),s.size>0&&t.jsxs("div",{className:"flex gap-1 mb-2",children:[t.jsxs(B,{size:"sm",className:"h-6 px-2 text-[10px] font-terminal bg-success hover:bg-success/80",onClick:()=>{s.forEach(w=>y.mutate(w)),r(new Set)},children:[t.jsx(dt,{className:"w-3 h-3 mr-1"}),"Approve (",s.size,")"]}),t.jsxs(B,{size:"sm",variant:"destructive",className:"h-6 px-2 text-[10px] font-terminal",onClick:()=>{s.forEach(w=>g.mutate(w)),r(new Set)},children:[t.jsx(Ke,{className:"w-3 h-3 mr-1"}),"Delete (",s.size,")"]})]}),t.jsx(Oe,{className:"h-[140px]",children:t.jsx("div",{className:"space-y-2",children:f.map(w=>t.jsx("div",{className:`p-2 bg-black/40 border text-xs ${s.has(w.id)?"border-primary":"border-secondary/30"}`,children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(En,{checked:s.has(w.id),onCheckedChange:F=>{const E=new Set(s);F?E.add(w.id):E.delete(w.id),r(E)},className:"mt-1 border-secondary data-[state=checked]:bg-primary"}),t.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[t.jsx("div",{className:"font-terminal text-primary truncate",children:w.front}),t.jsx("div",{className:"font-terminal text-muted-foreground mt-1 truncate",children:w.back}),t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[t.jsx(We,{variant:"outline",className:"text-[9px] border-info/50 text-info shrink-0",children:w.deckName}),t.jsx(B,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-warning/50 text-warning hover:bg-warning/20",onClick:()=>T(w),title:"Edit card",children:t.jsx(Ue,{className:"w-3 h-3"})}),t.jsx(B,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-success/50 text-success hover:bg-success/20",onClick:()=>y.mutate(w.id),title:"Approve card",children:t.jsx(dt,{className:"w-3 h-3"})}),t.jsx(B,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-destructive/50 text-destructive hover:bg-destructive/20",onClick:()=>g.mutate(w.id),title:"Delete card",children:t.jsx(Ke,{className:"w-3 h-3"})})]})]})]})},w.id))})})]})]}):t.jsxs("div",{className:"text-center space-y-2",children:[t.jsx("p",{className:"font-terminal text-xs text-destructive",children:p?.error||"Anki not connected"}),t.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Anki with AnkiConnect plugin"}),t.jsxs(B,{size:"sm",variant:"outline",className:"font-terminal text-xs",onClick:()=>x(),children:[t.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Retry"]})]})});return t.jsxs(t.Fragment,{children:[n?k:t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-3",children:[t.jsx(Fe,{className:"w-4 h-4"}),"ANKI INTEGRATION",p?.connected?t.jsx(dt,{className:"w-3 h-3 text-success ml-auto"}):t.jsx(Nt,{className:"w-3 h-3 text-destructive ml-auto"})]})}),t.jsx(Ie,{className:"p-0",children:k})]}),t.jsx(It,{open:a!==null,onOpenChange:w=>{w||i(null)},children:t.jsxs(zt,{"data-modal":"brain-edit-draft",className:"bg-black border-2 border-primary rounded-none max-w-lg translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[t.jsxs(At,{children:[t.jsxs(Tt,{className:"font-arcade text-primary flex items-center gap-2",children:[t.jsx(Ue,{className:"w-5 h-5"}),"EDIT CARD"]}),t.jsx(Mt,{className:"font-terminal text-muted-foreground",children:"Edit card content and select target deck"})]}),t.jsxs("div",{className:"space-y-4 font-terminal",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-muted-foreground",children:"Front (Question)"}),t.jsx(Wt,{value:l.front,onChange:w=>o(F=>({...F,front:w.target.value})),placeholder:"Card front...",className:"rounded-none border-secondary min-h-[80px]"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-muted-foreground",children:"Back (Answer)"}),t.jsx(Wt,{value:l.back,onChange:w=>o(F=>({...F,back:w.target.value})),placeholder:"Card back...",className:"rounded-none border-secondary min-h-[80px]"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-muted-foreground",children:"Target Deck"}),t.jsxs(Ys,{value:l.deckName,onValueChange:w=>o(F=>({...F,deckName:w})),children:[t.jsx(Qs,{className:"rounded-none border-secondary",children:t.jsx(Xs,{placeholder:"Select deck"})}),t.jsxs(Zs,{className:"rounded-none border-secondary bg-black max-h-[200px]",children:[t.jsx(xe,{value:"PT::EBP",children:"PT::EBP (Evidence Based Practice)"}),t.jsx(xe,{value:"PT::ExPhys",children:"PT::ExPhys (Exercise Physiology)"}),t.jsx(xe,{value:"PT::MS1",children:"PT::MS1 (Movement Science 1)"}),t.jsx(xe,{value:"PT::Neuro",children:"PT::Neuro (Neuroscience)"}),t.jsx(xe,{value:"PT::TI",children:"PT::TI (Therapeutic Intervention)"}),t.jsx(xe,{value:"PT::General",children:"PT::General"}),p?.decks?.filter(w=>!w.startsWith("PT::")).map(w=>t.jsx(xe,{value:w,children:w},w))]})]}),t.jsxs("p",{className:"text-[10px] text-muted-foreground mt-1",children:["Current: ",t.jsx("span",{className:"text-blue-400",children:l.deckName})]})]})]}),t.jsxs(zs,{className:"gap-2",children:[t.jsxs(B,{variant:"outline",onClick:()=>i(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[t.jsx(Nt,{className:"w-4 h-4 mr-2"}),"Cancel"]}),t.jsxs(B,{onClick:D,disabled:v.isPending,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[t.jsx(_t,{className:"w-4 h-4 mr-2"}),v.isPending?"Saving...":"Save"]})]})]})})]})}const fe=[{id:"edit",label:"EDIT",icon:Ue,hint:"Alt+1"},{id:"chat",label:"CHAT",icon:kn,hint:"Alt+2"},{id:"graph",label:"GRAPH",icon:yr,hint:"Alt+3"},{id:"table",label:"TABLE",icon:Cr,hint:"Alt+4"},{id:"anki",label:"ANKI",icon:Fe,hint:"Alt+5"}];function jt({workspace:e}){const[n,s]=d.useState({}),r=d.useCallback(o=>{s(c=>({...c,[o]:(c[o]||0)+1}))},[]);d.useEffect(()=>{const o=c=>{if(!c.altKey||c.ctrlKey||c.metaKey)return;const h=parseInt(c.key,10)-1;h>=0&&h<fe.length&&(c.preventDefault(),e.setMainMode(fe[h].id))};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[e]);const a=e.mainMode,i=fe.findIndex(o=>o.id===a),l=d.useCallback(o=>{let c=null;o.key==="ArrowLeft"?c=i<=0?fe.length-1:i-1:o.key==="ArrowRight"?c=i>=fe.length-1?0:i+1:o.key==="Home"?c=0:o.key==="End"&&(c=fe.length-1),c!==null&&(o.preventDefault(),e.setMainMode(fe[c].id))},[i,e]);return t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsxs("div",{role:"tablist","aria-label":"Main content view",className:"tab-bar",children:[fe.map(o=>{const c=o.icon,h=a===o.id,p=`brain-tab-${o.id}`,b=`brain-tabpanel-${o.id}`;return t.jsxs("button",{id:p,role:"tab","aria-selected":h,"aria-controls":b,tabIndex:h?0:-1,onClick:()=>e.setMainMode(o.id),onKeyDown:l,className:Q("tab-item",h&&"active"),title:o.hint,children:[t.jsx(c,{className:"w-3.5 h-3.5 shrink-0","aria-hidden":"true"}),o.label,o.id==="anki"&&e.pendingDrafts.length>0&&t.jsx("span",{className:"ml-1 px-1 py-0 text-xs bg-secondary text-primary-foreground font-arcade",children:e.pendingDrafts.length})]},o.id)}),t.jsxs("div",{className:"flex items-center gap-3 ml-auto pr-3 font-terminal text-xs",role:"status","aria-label":"Connection status",children:[t.jsxs("span",{className:"flex items-center gap-1","aria-label":e.obsidianStatus?.connected?"Obsidian: connected":"Obsidian: disconnected",children:[t.jsx("span",{className:Q("w-1.5 h-1.5 rounded-full",e.obsidianStatus?.connected?"bg-success":"bg-destructive"),"aria-hidden":"true"}),t.jsx("span",{className:"text-muted-foreground hidden sm:inline",children:"Obsidian"})]}),t.jsxs("span",{className:"flex items-center gap-1","aria-label":e.ankiStatus?.connected?"Anki: connected":"Anki: disconnected",children:[t.jsx("span",{className:Q("w-1.5 h-1.5 rounded-full",e.ankiStatus?.connected?"bg-success":"bg-destructive"),"aria-hidden":"true"}),t.jsx("span",{className:"text-muted-foreground hidden sm:inline",children:"Anki"})]}),e.pendingDrafts.length>0&&t.jsxs(We,{variant:"outline",className:"h-5 px-1.5 text-xs rounded-none border-secondary/50 text-secondary",children:[e.pendingDrafts.length," drafts"]})]})]}),t.jsxs("div",{className:"flex-1 min-h-0 overflow-hidden flex flex-col",children:[a==="edit"&&t.jsx("div",{id:"brain-tabpanel-edit",role:"tabpanel","aria-labelledby":"brain-tab-edit","data-tab":"edit",className:"flex-1 min-h-0 overflow-hidden flex flex-col brain-tab-enter",tabIndex:0,children:t.jsx(ke,{fallback:t.jsx(De,{tabName:"EDIT",onReset:()=>r("edit")}),children:t.jsx(Oa,{workspace:e})},`edit-${n.edit||0}`)}),a==="chat"&&t.jsx("div",{id:"brain-tabpanel-chat",role:"tabpanel","aria-labelledby":"brain-tab-chat","data-tab":"chat",className:"flex-1 min-h-0 overflow-hidden flex flex-col brain-tab-enter",tabIndex:0,children:t.jsx(ke,{fallback:t.jsx(De,{tabName:"CHAT",onReset:()=>r("chat")}),children:t.jsx($a,{})},`chat-${n.chat||0}`)}),a==="graph"&&t.jsx("div",{id:"brain-tabpanel-graph",role:"tabpanel","aria-labelledby":"brain-tab-graph","data-tab":"graph",className:"flex-1 min-h-0 overflow-hidden flex flex-col brain-tab-enter",tabIndex:0,children:t.jsx(ke,{fallback:t.jsx(De,{tabName:"GRAPH",onReset:()=>r("graph")}),children:t.jsx(Ba,{})},`graph-${n.graph||0}`)}),a==="table"&&t.jsx("div",{id:"brain-tabpanel-table",role:"tabpanel","aria-labelledby":"brain-tab-table","data-tab":"table",className:"flex-1 min-h-0 overflow-hidden flex flex-col brain-tab-enter",tabIndex:0,children:t.jsx(ke,{fallback:t.jsx(De,{tabName:"TABLE",onReset:()=>r("table")}),children:t.jsx(Oi,{})},`table-${n.table||0}`)}),a==="anki"&&t.jsx("div",{id:"brain-tabpanel-anki",role:"tabpanel","aria-labelledby":"brain-tab-anki","data-tab":"anki",className:"flex-1 min-h-0 overflow-hidden flex flex-col brain-tab-enter",tabIndex:0,children:t.jsx(ke,{fallback:t.jsx(De,{tabName:"ANKI",onReset:()=>r("anki")}),children:t.jsx(Fi,{totalCards:e.metrics?.totalCards||0,compact:!0})},`anki-${n.anki||0}`)})]})]})}function Hi(){const[e,n]=d.useState(""),[s,r]=d.useState(null),[a,i]=d.useState("auto"),[l,o]=d.useState([]),c=et(),{toast:h}=tt(),{data:p=[]}=Y({queryKey:["sessions"],queryFn:G.sessions.getAll}),x=p.map(f=>({id:f.id,date:f.date,topic:f.topic,mainTopic:f.mainTopic,mode:f.mode,createdAt:f.createdAt})).slice().sort((f,u)=>{const y=f.date||f.createdAt||"";return(u.date||u.createdAt||"").localeCompare(y)}).slice(0,20),j=me({mutationFn:()=>G.planner.generate(),onSuccess:f=>{h({title:"Planner tasks generated",description:`${f.tasks_created} review tasks created`}),c.invalidateQueries({queryKey:["planner","queue"]})},onError:f=>{h({title:"Failed to generate tasks",description:f.message,variant:"destructive"})}}),S=me({mutationFn:async()=>{if(!s)throw new Error("Select a session first");let f;try{f=JSON.parse(e)}catch{throw new Error("Invalid JSON â€” check syntax")}let u=a;if(u==="auto"){const v=Object.keys(f),T=["source_lock","plan_of_attack","frameworks_used","buckets","confusables_interleaved","anki_cards","glossary","exit_ticket_blurt","exit_ticket_muddiest","exit_ticket_next_action","retrospective_status","spaced_reviews","next_session","errors_by_type","errors_by_severity","error_patterns","spacing_algorithm","rsr_adaptive_adjustment","adaptive_multipliers"];u=v.some(D=>T.includes(D))?"enhanced":"tracker"}const y=u==="tracker"?f:void 0,g=u==="enhanced"?f:void 0;return G.brain.ingestSessionJson(s,y,g)},onSuccess:f=>{h({title:"JSON ingested",description:`${f.fields_updated} fields updated on session #${f.session_id}`}),c.invalidateQueries({queryKey:["sessions"]}),c.invalidateQueries({queryKey:["brain","metrics"]}),h({title:"Next step: Generate planner tasks?",description:"Create review tasks from weak anchors",duration:1e4,action:t.jsx(B,{size:"sm",onClick:()=>j.mutate(),disabled:j.isPending,className:"bg-primary text-black hover:bg-primary/80",children:j.isPending?"Generating...":"Generate Now"})}),n(""),o([])},onError:f=>{h({title:"Ingestion failed",description:f.message,variant:"destructive"})}});function I(){const f=[];if(s||f.push("Select a session"),!e.trim())f.push("Paste JSON first");else try{const u=JSON.parse(e);(typeof u!="object"||Array.isArray(u))&&f.push("JSON must be an object, not array"),u.schema_version&&u.schema_version!=="9.4"&&f.push(`Expected schema_version 9.4, got ${u.schema_version}`)}catch{f.push("Invalid JSON syntax")}return o(f),f.length===0}return t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 bg-primary inline-block"}),"SESSION_JSON_INGEST"]})}),t.jsxs(Ie,{className:"p-4 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"TARGET SESSION"}),t.jsxs("select",{value:s??"",onChange:f=>r(f.target.value?Number(f.target.value):null),className:"w-full bg-black border border-primary/50 text-white font-terminal text-xs p-2 rounded-none focus:border-primary outline-none",children:[t.jsx("option",{value:"",children:"-- select session --"}),x.map(f=>t.jsxs("option",{value:f.id,children:["#",f.id," | ",f.date?.slice(0,10)||"?"," | ",f.topic||f.mainTopic||"Untitled"," | ",f.mode||"?"]},f.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"JSON TYPE"}),t.jsx("div",{className:"flex gap-2",children:["auto","tracker","enhanced"].map(f=>t.jsx("button",{onClick:()=>i(f),className:`px-3 py-1 font-arcade text-xs rounded-none border ${a===f?"bg-primary text-black border-primary":"border-primary/30 text-muted-foreground hover:text-white"}`,children:f.toUpperCase()},f))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"PASTE TRACKER OR ENHANCED JSON"}),t.jsx("textarea",{value:e,onChange:f=>n(f.target.value),placeholder:'{"schema_version": "9.4", "topic": "...", "mode": "Core", ...}',rows:10,className:"w-full bg-black border border-primary/50 text-green-400 font-terminal text-xs p-2 rounded-none focus:border-primary outline-none resize-y"})]}),l.length>0&&t.jsx("div",{className:"border border-red-500/50 bg-red-500/10 p-2 font-terminal text-xs text-red-400 space-y-1",children:l.map((f,u)=>t.jsxs("div",{children:["- ",f]},u))}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>{I()&&S.mutate()},disabled:S.isPending,className:"px-4 py-2 bg-primary text-black font-arcade text-xs rounded-none hover:bg-primary/80 disabled:opacity-50",children:S.isPending?"INGESTING...":"INGEST"}),t.jsx("button",{onClick:I,className:"px-4 py-2 border border-primary/50 text-primary font-arcade text-xs rounded-none hover:bg-primary/10",children:"VALIDATE"}),t.jsx("button",{onClick:()=>{n(""),o([])},className:"px-4 py-2 border border-primary/30 text-muted-foreground font-arcade text-xs rounded-none hover:text-white",children:"CLEAR"})]})]})]})}const Vi=`You are extracting a course schedule for ingestion.

Return ONLY a valid JSON object with NO additional text, NO markdown code blocks, NO explanation.

Structure:
{
  "name": "Course Name (e.g. Anatomy & Physiology II)",
  "term": {
    "startDate": "2026-01-05",
    "endDate": "2026-04-24",
    "timezone": "America/Chicago"
  },
  "events": [
    {
      "type": "class" | "lecture" | "reading" | "topic" | "assignment" | "quiz" | "exam" | "assessment",
      "title": "string",
      "date": "YYYY-MM-DD",
      "dueDate": "YYYY-MM-DD | null",
      "startTime": "HH:MM | null",
      "endTime": "HH:MM | null",
      "daysOfWeek": ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
      "delivery": "in_person" | "virtual_sync" | "virtual_async" | "hybrid",
      "assessmentType": "EA | null",
      "moduleName": "Module 1: ... | null",
      "notes": "string | null"
    }
  ]
}

Rules:
1. Include ALL schedule items: class meetings, assignments, quizzes, exams, readings, virtual activities, and learning assessments (EA).
2. For repeating class meetings, set daysOfWeek + startTime/endTime, and include term start/end.
3. For one-off items, set date or dueDate.
4. Do NOT include a "modules" array â€” schedule only.
5. Return ONLY the JSON object, nothing else.

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,Gi=`You are extracting course module structure for ingestion.

Return ONLY a valid JSON object with NO additional text, NO markdown code blocks, NO explanation.

Structure:
{
  "modules": [
    {
      "name": "Module 1: Topic Name",
      "orderIndex": 1,
      "topics": ["Topic A", "Topic B"],
      "readings": ["Chapter 1", "Article X"],
      "assessments": ["Quiz 1", "Exam 1"]
    }
  ]
}

Rules:
1. Include ALL modules/units with their topics, readings, and assessments.
2. orderIndex should be sequential starting at 1.
3. Do NOT include dates or events â€” structure only.
4. Return ONLY the JSON object, nothing else.

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,qi=`I need you to extract learning objectives from my course material.

Return ONLY a valid JSON array with NO additional text, NO markdown code blocks, NO explanation.

Structure for each item:
{
  "loCode": "string",
  "title": "string"
}

Rules:
1. loCode: Preserve original numbering if present, or create sequential "1", "2", "3"...
2. title: Keep the objective text exactly as written
3. Return ONLY the JSON array, nothing else

Here are my learning objectives:

[PASTE YOUR LOs BELOW]`,Bi=`I need you to convert my study session notes into WRAP format.

WRAP format has 4 sections:

Section A: Obsidian Notes
- Main concepts and insights from the session
- Key points to remember

Section B: Anki Cards
- Format: "front: [question]" on one line, "back: [answer]" on next line
- Create cards for important facts and concepts

Section C: Spaced Schedule
- R1=tomorrow
- R2=3d
- R3=1w
- R4=2w

Section D: JSON Logs
\`\`\`json
{
  "merged": {
    "topic": "[main topic]",
    "mode": "Core",
    "duration_minutes": [number],
    "understanding": [1-5],
    "retention": [1-5]
  }
}
\`\`\`

Return ONLY the WRAP formatted content, NO additional text or explanation.

Here are my study notes:

[PASTE YOUR NOTES BELOW]`;function Ki(){const e=et(),[n,s]=d.useState(null),[r,a]=d.useState(null),[i,l]=d.useState("schedule"),[o,c]=d.useState(""),[h,p]=d.useState(""),[b,x]=d.useState(""),[j,S]=d.useState(""),[I,f]=d.useState(null),[u,y]=d.useState(null),[g,v]=d.useState(null),[T,D]=d.useState(null),[k,w]=d.useState(null),[F,E]=d.useState(null),{data:P=[]}=Y({queryKey:["courses"],queryFn:()=>G.courses.getActive()}),{data:_=[]}=Y({queryKey:["modules",n],queryFn:()=>n?G.modules.getByCourse(n):Promise.resolve([]),enabled:!!n}),{data:H=[]}=Y({queryKey:["learningObjectives",n],queryFn:()=>n?G.learningObjectives.getByCourse(n):Promise.resolve([]),enabled:!!n}),R=m=>{const N=m.trim();if(!N)return"";const A=N.match(/```json\s*([\s\S]*?)```/i)||N.match(/```\s*([\s\S]*?)```/i),C=A?A[1].trim():N,z=C.indexOf("["),$=C.lastIndexOf("]"),V=C.indexOf("{"),U=C.lastIndexOf("}");return z!==-1&&$!==-1&&$>z&&(V===-1||z<V)?C.slice(z,$+1).trim():V!==-1&&U!==-1&&U>V?C.slice(V,U+1).trim():C},M=m=>{navigator.clipboard.writeText(m)},L=me({mutationFn:async m=>{if(!n)throw new Error("Select a course first");const A={...JSON.parse(R(m)),modules:[]};return G.syllabus.importBulk(n,A)},onSuccess:m=>{e.invalidateQueries({queryKey:["scheduleEvents"]}),c(""),w(null),v({type:"success",message:`Imported: ${m.eventsCreated} events (${m.classMeetingsExpanded} class meetings expanded)`}),f(null)},onError:m=>{v({type:"error",message:m.message||"Failed to import schedule"})}}),q=me({mutationFn:async m=>{if(!n)throw new Error("Select a course first");const N=JSON.parse(R(m)),A=N.modules||N;return G.modules.createBulk(n,A)},onSuccess:()=>{e.invalidateQueries({queryKey:["modules"]}),p(""),E(null),D({type:"success",message:"Modules imported successfully"}),f(null)},onError:m=>{D({type:"error",message:m.message||"Failed to import modules"})}}),K=me({mutationFn:async m=>{if(!n)throw new Error("Select a course first");const N=JSON.parse(R(m));return G.learningObjectives.createBulk(n,r,N)},onSuccess:()=>{e.invalidateQueries({queryKey:["learningObjectives"]}),x(""),f(null)},onError:m=>{f(m.message||"Failed to import LOs")}}),se=m=>{const N=[];try{const A=R(m);if(!A){w({isValid:!1,errors:["No JSON found"]});return}const C=JSON.parse(A);(!C||typeof C!="object")&&N.push("JSON must be an object"),(!C.name||typeof C.name!="string")&&N.push("Missing 'name' field"),!C.term||typeof C.term!="object"?N.push("Missing 'term' object"):(C.term.startDate||N.push("term.startDate is required"),C.term.endDate||N.push("term.endDate is required")),Array.isArray(C.events)||N.push("Missing 'events' array"),N.length===0?w({isValid:!0,errors:[],preview:{courseName:C.name,eventCount:C.events.length,startDate:C.term?.startDate,endDate:C.term?.endDate}}):w({isValid:!1,errors:N})}catch(A){w({isValid:!1,errors:[`Invalid JSON: ${A.message}`]})}},de=m=>{const N=[];try{const A=R(m);if(!A){E({isValid:!1,errors:["No JSON found"]});return}const C=JSON.parse(A),z=C.modules||(Array.isArray(C)?C:null);Array.isArray(z)?z.length===0&&N.push("modules array is empty"):N.push("Missing 'modules' array"),N.length===0?E({isValid:!0,errors:[],preview:{moduleCount:z.length}}):E({isValid:!1,errors:N})}catch(A){E({isValid:!1,errors:[`Invalid JSON: ${A.message}`]})}},ae=async()=>{try{y(null);const m=await G.brain.chat(j,!1,"wrap");m.sessionSaved?(y({type:"success",message:`Session saved! ID: ${m.sessionId}, Cards: ${m.cardsCreated||0}`}),S("")):y({type:"error",message:m.sessionError||"Failed to process WRAP content"})}catch(m){y({type:"error",message:m.message||"Failed to ingest"})}},re=[{key:"schedule",label:"SCHEDULE",icon:t.jsx(Yt,{className:"w-3.5 h-3.5"})},{key:"modules",label:"MODULES",icon:t.jsx(Fe,{className:"w-3.5 h-3.5"})},{key:"objectives",label:"OBJECTIVES",icon:t.jsx(St,{className:"w-3.5 h-3.5"})}];return t.jsxs("div",{className:"space-y-6 p-4",children:[t.jsx(Hi,{}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),t.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:n||"",onChange:m=>{s(m.target.value?parseInt(m.target.value):null),a(null)},children:[t.jsx("option",{value:"",children:"-- Select Course --"}),P.map(m=>t.jsx("option",{value:m.id,children:m.name},m.id))]})]}),!n&&t.jsx("p",{className:"text-center text-muted-foreground font-terminal text-sm py-8",children:"Select a course above to begin ingestion."}),n&&t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none mb-6",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-2",children:[t.jsx($s,{className:"w-4 h-4"}),"WRAP SESSION INGESTION"]})}),t.jsxs(Ie,{className:"p-4",children:[u&&t.jsx("div",{className:`mb-4 p-3 rounded-none font-terminal text-sm ${u.type==="success"?"bg-success/20 border border-success text-success":"bg-destructive/20 border border-destructive text-destructive"}`,children:u.message}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("button",{onClick:()=>M(Bi),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),t.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Use ChatGPT to convert your notes to WRAP format, then paste or upload below:"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm mb-2 font-terminal text-muted-foreground",children:"Paste WRAP Content"}),t.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-48 font-terminal text-sm",placeholder:"Paste your WRAP session here...",value:j,onChange:m=>{S(m.target.value),y(null)}})]}),t.jsx("button",{onClick:ae,disabled:!j,className:"bg-primary hover:bg-primary/80 disabled:opacity-50 px-6 py-3 rounded-none font-arcade text-sm w-full",type:"button",children:"INGEST WRAP SESSION"})]})]})]}),n&&I&&t.jsx("div",{className:"bg-destructive/20 border border-destructive rounded-none p-3 text-destructive font-terminal",children:I}),n&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex border-b border-primary/50",children:re.map(m=>t.jsxs("button",{onClick:()=>l(m.key),className:`flex items-center gap-1.5 px-4 py-2 font-arcade text-xs border-b-2 transition-colors ${i===m.key?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-primary/70"}`,type:"button",children:[m.icon,m.label]},m.key))}),i==="schedule"&&t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-2",children:[t.jsx(Yt,{className:"w-4 h-4"}),"SCHEDULE IMPORT"]})}),t.jsxs(Ie,{className:"p-4 space-y-4",children:[t.jsx("button",{onClick:()=>M(Vi),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),t.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (schedule JSON) below:"}),t.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-40 font-terminal text-sm",placeholder:'{"name":"...","term":{...},"events":[...]}',value:o,onChange:m=>{c(m.target.value),v(null),m.target.value.trim()?se(m.target.value):w(null)}}),k&&!k.isValid&&t.jsxs("div",{className:"p-2 border border-destructive bg-destructive/20 rounded-none font-terminal text-xs text-destructive",children:[t.jsx("div",{className:"font-bold mb-1",children:"Validation Errors:"}),k.errors.map((m,N)=>t.jsxs("div",{children:["â€¢ ",m]},N))]}),k?.isValid&&k.preview&&t.jsxs("div",{className:"p-3 border border-primary bg-primary/10 rounded-none font-terminal text-xs text-primary",children:[t.jsx("div",{className:"font-bold mb-2",children:"Valid JSON Preview:"}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Course:"})," ",k.preview.courseName]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Events:"})," ",k.preview.eventCount]}),k.preview.startDate&&t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Start:"})," ",k.preview.startDate]}),k.preview.endDate&&t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"End:"})," ",k.preview.endDate]})]})]}),t.jsx("button",{onClick:()=>L.mutate(o),disabled:!k?.isValid||L.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:L.isPending?"Importing...":"Import Schedule"}),g&&t.jsx("div",{className:`p-2 border font-terminal text-xs ${g.type==="success"?"border-success text-success":"border-destructive text-destructive"}`,children:g.message})]})]}),i==="modules"&&t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-2",children:[t.jsx(Fe,{className:"w-4 h-4"}),"MODULES IMPORT"]})}),t.jsxs(Ie,{className:"p-4 space-y-4",children:[t.jsx("button",{onClick:()=>M(Gi),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),t.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (modules JSON) below:"}),t.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-40 font-terminal text-sm",placeholder:'{"modules":[{"name":"Module 1: ...","orderIndex":1,"topics":[...],"readings":[...],"assessments":[...]}]}',value:h,onChange:m=>{p(m.target.value),D(null),m.target.value.trim()?de(m.target.value):E(null)}}),F&&!F.isValid&&t.jsxs("div",{className:"p-2 border border-destructive bg-destructive/20 rounded-none font-terminal text-xs text-destructive",children:[t.jsx("div",{className:"font-bold mb-1",children:"Validation Errors:"}),F.errors.map((m,N)=>t.jsxs("div",{children:["â€¢ ",m]},N))]}),F?.isValid&&F.preview&&t.jsxs("div",{className:"p-3 border border-primary bg-primary/10 rounded-none font-terminal text-xs text-primary",children:[t.jsx("div",{className:"font-bold mb-2",children:"Valid JSON Preview:"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Modules:"})," ",F.preview.moduleCount]})]}),t.jsx("button",{onClick:()=>q.mutate(h),disabled:!F?.isValid||q.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:q.isPending?"Importing...":"Import Modules"}),T&&t.jsx("div",{className:`p-2 border font-terminal text-xs ${T.type==="success"?"border-success text-success":"border-destructive text-destructive"}`,children:T.message})]})]}),i==="objectives"&&t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-2",children:[t.jsx(St,{className:"w-4 h-4"}),"LEARNING OBJECTIVES IMPORT"]})}),t.jsxs(Ie,{className:"p-4 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs mb-1 font-terminal text-muted-foreground",children:"Target Module (optional)"}),t.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:r||"",onChange:m=>a(m.target.value?parseInt(m.target.value):null),children:[t.jsx("option",{value:"",children:"-- No Module (Course-level) --"}),_.map(m=>t.jsx("option",{value:m.id,children:m.name},m.id))]})]}),t.jsx("button",{onClick:()=>M(qi),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),t.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (JSON array) below:"}),t.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-32 font-terminal text-sm",placeholder:'[{"loCode": "1.1", "title": "Define..."}]',value:b,onChange:m=>x(m.target.value)}),t.jsx("button",{onClick:()=>K.mutate(b),disabled:!b||K.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:K.isPending?"Importing...":"Import LOs"}),H.length>0&&t.jsxs("div",{children:[t.jsxs("h4",{className:"font-terminal text-xs mb-2",children:["Current LOs (",H.length,")"]}),t.jsx("div",{className:"max-h-48 overflow-y-auto",children:H.map(m=>t.jsxs("div",{className:"text-xs py-1 border-b border-secondary/30 font-terminal",children:[t.jsx("span",{className:"text-primary",children:m.loCode}),": ",m.title,t.jsx("span",{className:`ml-2 text-[10px] px-1 rounded-none ${m.status==="solid"?"bg-success":m.status==="in_progress"?"bg-warning":m.status==="need_review"?"bg-urgent":"bg-secondary"}`,children:m.status})]},m.id))})]})]})]})]})]})}function Ui({workspace:e}){return t.jsx(It,{open:e.importOpen,onOpenChange:e.setImportOpen,children:t.jsxs(zt,{"data-modal":"brain-import",className:"max-w-2xl bg-black border-2 border-primary rounded-none",children:[t.jsxs(At,{children:[t.jsxs(Tt,{className:"font-arcade text-sm text-primary flex items-center gap-2",children:[t.jsx(Pn,{className:"w-4 h-4"}),"IMPORT / INGEST"]}),t.jsx(Mt,{className:"font-terminal text-xs text-muted-foreground",children:"Import study materials, JSON session data, or documents into the system."})]}),t.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:t.jsx(Ki,{})})]})})}const Wi=["vault","main"];function vn(){if(typeof window>"u")return"main";const n=new URLSearchParams(window.location.search).get("tab");return Wi.includes(n)?n:"main"}function Ji(e){if(typeof window>"u")return;const n=new URLSearchParams(window.location.search);n.set("tab",e);const s=`${window.location.pathname}?${n.toString()}`;window.history.replaceState({},"",s)}function Yi(){const e=sa(),[n,s]=d.useState("main"),[r,a]=d.useState(!1),i=d.useRef(!1);d.useEffect(()=>{s(vn())},[]),d.useEffect(()=>{if(i.current)return;i.current=!0;const o=requestAnimationFrame(()=>{requestAnimationFrame(()=>a(!0))});return()=>cancelAnimationFrame(o)},[]);const l=d.useCallback(o=>{s(o),Ji(o)},[]);return d.useEffect(()=>{const o=()=>{s(vn())};return window.addEventListener("popstate",o),()=>window.removeEventListener("popstate",o)},[]),d.useEffect(()=>{const o=c=>{c.ctrlKey&&c.key==="i"&&(c.preventDefault(),e.setImportOpen(!0))};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[e]),t.jsx(As,{children:t.jsxs("div",{className:`brain-workspace fixed inset-x-0 top-[68px] bottom-[48px] flex flex-col min-w-0 overflow-hidden z-30 ${r?"brain-workspace--ready":""}`,"data-active-tab":e.mainMode,children:[t.jsx(ra,{}),t.jsx("div",{className:"hidden lg:flex flex-1 min-h-0",children:e.sidebarExpanded?t.jsxs(ea,{direction:"horizontal",autoSaveId:"brain-workspace-v2",className:"h-full",children:[t.jsx(on,{defaultSize:20,minSize:12,maxSize:35,children:t.jsx("div",{className:"brain-workspace__sidebar-wrap brain-sidebar-expand h-full border-r border-primary/30 bg-black/40",children:t.jsx(cn,{workspace:e,onCollapse:e.toggleSidebar})})}),t.jsx(ta,{withHandle:!0,className:"hover:bg-primary/10 transition-colors data-[resize-handle-active]:bg-primary/20"}),t.jsx(on,{defaultSize:80,minSize:50,children:t.jsx("div",{className:"brain-workspace__main-wrap brain-workspace__canvas h-full min-h-0 overflow-hidden",children:t.jsx(jt,{workspace:e})})})]}):t.jsxs("div",{className:"flex flex-1 min-h-0",children:[t.jsx(la,{onExpand:e.toggleSidebar,workspace:e}),t.jsx("div",{className:"brain-workspace__main-wrap brain-workspace__canvas flex-1 min-h-0 overflow-hidden",children:t.jsx(jt,{workspace:e})})]})}),t.jsxs("div",{className:"flex flex-col flex-1 min-h-0 lg:hidden",children:[t.jsxs("div",{className:"brain-workspace__canvas flex-1 min-h-0 overflow-auto",children:[n==="vault"&&t.jsx(cn,{workspace:e}),n==="main"&&t.jsx(jt,{workspace:e})]}),t.jsxs("nav",{className:"flex items-center border-t-2 border-primary/50 bg-black/80 shrink-0","aria-label":"Mobile navigation",children:[t.jsxs("button",{onClick:()=>l("vault"),className:`flex-1 flex flex-col items-center gap-0.5 py-3 text-xs font-terminal transition-colors ${n==="vault"?"text-primary":"text-muted-foreground"}`,"aria-current":n==="vault"?"page":void 0,"aria-label":"Vault",children:[t.jsx(Nn,{className:"w-5 h-5","aria-hidden":"true"}),"Vault"]}),t.jsxs("button",{onClick:()=>l("main"),className:`flex-1 flex flex-col items-center gap-0.5 py-3 text-xs font-terminal transition-colors ${n==="main"?"text-primary":"text-muted-foreground"}`,"aria-current":n==="main"?"page":void 0,"aria-label":"Content",children:[t.jsx(Ue,{className:"w-5 h-5","aria-hidden":"true"}),"Content"]})]})]}),t.jsx(Ui,{workspace:e})]})})}const go=Object.freeze(Object.defineProperty({__proto__:null,default:Yi},Symbol.toStringTag,{value:"Module"}));export{Pn as D,gr as M,pr as a,go as b,Li as t};

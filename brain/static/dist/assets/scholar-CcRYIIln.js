import{c as T,r as m,j as e,b as C,u as re}from"./index-DwbVdR7f.js";import{v as ve,u as w,a as V,B as M,L as Se,A as z,g as Y,S as k,k as G,h as v}from"./layout-DrIfue0o.js";import{C as h,a as p,b as f,c as N}from"./card-CxhrHFCR.js";import{R as P,B as u,S as we}from"./badge-B5bss45D.js";import{S as Ee,a as ke,b as Re,c as Ce,d as q}from"./select-BrSTwNMo.js";import{T as Pe,a as Te,b as Ae,c as R,M as Ie,L as W}from"./tabs-Bs_ml1JK.js";import{P as Oe}from"./play-CGHNH-w3.js";import{C as ae}from"./clock-DRPrF_gj.js";import{S as J}from"./search-DxLRM_pt.js";import{C as De,B as Me}from"./circle-check-Bf_dMYLq.js";import{C as D}from"./circle-alert-DEC1Z3lC.js";import{F as Le}from"./file-text-DwkZv8yZ.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Fe=T("circle-check-big",qe);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ue=T("circle-question-mark",_e);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],te=T("circle-x",$e);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Be=T("history",Ve);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],X=T("lightbulb",He);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Z=T("trending-up",Ke);function Qe(r,t=[]){let o=[];function a(d,x){const i=m.createContext(x);i.displayName=d+"Context";const l=o.length;o=[...o,x];const g=y=>{const{scope:S,children:A,...E}=y,_=S?.[r]?.[l]||i,I=m.useMemo(()=>E,Object.values(E));return e.jsx(_.Provider,{value:I,children:A})};g.displayName=d+"Provider";function j(y,S){const A=S?.[r]?.[l]||i,E=m.useContext(A);if(E)return E;if(x!==void 0)return x;throw new Error(`\`${y}\` must be used within \`${d}\``)}return[g,j]}const n=()=>{const d=o.map(x=>m.createContext(x));return function(i){const l=i?.[r]||d;return m.useMemo(()=>({[`__scope${r}`]:{...i,[r]:l}}),[i,l])}};return n.scopeName=r,[a,ze(n,...t)]}function ze(...r){const t=r[0];if(r.length===1)return t;const o=()=>{const a=r.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(d){const x=a.reduce((i,{useScope:l,scopeName:g})=>{const y=l(d)[`__scope${g}`];return{...i,...y}},{});return m.useMemo(()=>({[`__scope${t.scopeName}`]:x}),[x])}};return o.scopeName=t.scopeName,o}var Ye=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ne=Ye.reduce((r,t)=>{const o=ve(`Primitive.${t}`),a=m.forwardRef((n,d)=>{const{asChild:x,...i}=n,l=x?o:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...i,ref:d})});return a.displayName=`Primitive.${t}`,{...r,[t]:a}},{}),B="Progress",H=100,[Ge]=Qe(B),[We,Je]=Ge(B),ce=m.forwardRef((r,t)=>{const{__scopeProgress:o,value:a=null,max:n,getValueLabel:d=Xe,...x}=r;(n||n===0)&&!ee(n)&&console.error(Ze(`${n}`,"Progress"));const i=ee(n)?n:H;a!==null&&!se(a,i)&&console.error(es(`${a}`,"Progress"));const l=se(a,i)?a:null,g=F(l)?d(l,i):void 0;return e.jsx(We,{scope:o,value:l,max:i,children:e.jsx(ne.div,{"aria-valuemax":i,"aria-valuemin":0,"aria-valuenow":F(l)?l:void 0,"aria-valuetext":g,role:"progressbar","data-state":oe(l,i),"data-value":l??void 0,"data-max":i,...x,ref:t})})});ce.displayName=B;var le="ProgressIndicator",ie=m.forwardRef((r,t)=>{const{__scopeProgress:o,...a}=r,n=Je(le,o);return e.jsx(ne.div,{"data-state":oe(n.value,n.max),"data-value":n.value??void 0,"data-max":n.max,...a,ref:t})});ie.displayName=le;function Xe(r,t){return`${Math.round(r/t*100)}%`}function oe(r,t){return r==null?"indeterminate":r===t?"complete":"loading"}function F(r){return typeof r=="number"}function ee(r){return F(r)&&!isNaN(r)&&r>0}function se(r,t){return F(r)&&!isNaN(r)&&r<=t&&r>=0}function Ze(r,t){return`Invalid prop \`max\` of value \`${r}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${H}\`.`}function es(r,t){return`Invalid prop \`value\` of value \`${r}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${H} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var de=ce,ss=ie;const xe=m.forwardRef(({className:r,indicatorClassName:t,value:o,...a},n)=>e.jsx(de,{ref:n,className:C("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",r),...a,children:e.jsx(ss,{className:C("h-full w-full flex-1 bg-primary transition-all",t),style:{transform:`translateX(-${100-(o||0)}%)`}})}));xe.displayName=de.displayName;function rs(){const r=re(),[t,o]=m.useState(!1),{data:a,isLoading:n}=w({queryKey:["scholarStatus"],queryFn:async()=>{const l=await fetch("/api/scholar");if(!l.ok)throw new Error("Failed to fetch Scholar status");return l.json()},refetchInterval:t?2e3:!1}),d=V({mutationFn:async()=>{const l=await fetch("/api/scholar/run",{method:"POST",headers:{"Content-Type":"application/json"}});if(!l.ok)throw new Error("Failed to start Scholar run");return l.json()},onSuccess:()=>{o(!0),r.invalidateQueries({queryKey:["scholarStatus"]})}});m.useEffect(()=>{a?.running?o(!0):t&&!a?.running&&(o(!1),r.invalidateQueries({queryKey:["scholarStatus"]}))},[a?.running,t,r]);const x=()=>n?e.jsx(P,{className:"w-4 h-4 animate-spin"}):a?.running?e.jsx(P,{className:"w-4 h-4 animate-spin text-primary"}):a?.status==="complete"?e.jsx(Fe,{className:"w-4 h-4 text-green-400"}):a?.status==="error"?e.jsx(te,{className:"w-4 h-4 text-red-400"}):e.jsx(ae,{className:"w-4 h-4 text-muted-foreground"}),i=()=>a?.running?e.jsx(u,{className:"bg-primary/20 text-primary border-primary/50",children:"Running"}):a?.status==="complete"?e.jsx(u,{className:"bg-green-500/20 text-green-400 border-green-500/50",children:"Complete"}):a?.status==="error"?e.jsx(u,{className:"bg-red-500/20 text-red-400 border-red-500/50",children:"Error"}):e.jsx(u,{variant:"outline",className:"text-muted-foreground",children:"Idle"});return e.jsxs(h,{className:"brain-card rounded-none",children:[e.jsx(p,{className:"border-b border-secondary/50 p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[x(),e.jsx(f,{className:"font-arcade text-sm text-primary",children:"SCHOLAR ORCHESTRATOR"})]}),i()]})}),e.jsxs(N,{className:"p-3 space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[a?.running&&e.jsxs(e.Fragment,{children:[a.current_step&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground",children:"Current Step:"}),e.jsx("div",{className:"font-terminal text-xs text-secondary",children:a.current_step})]}),a.progress!==void 0&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-[10px] text-muted-foreground",children:"Progress:"}),e.jsxs("span",{className:"font-terminal text-[10px] text-primary",children:[Math.round(a.progress),"%"]})]}),e.jsx(xe,{value:a.progress,className:"h-2 bg-black border border-secondary/40"})]})]}),!a?.running&&a?.last_run&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-terminal text-[10px] text-muted-foreground",children:"Last Run:"}),e.jsx("div",{className:"font-terminal text-xs text-secondary",children:new Date(a.last_run).toLocaleString()})]}),a?.errors&&a.errors.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-terminal text-[10px] text-red-400",children:"Errors:"}),e.jsx("div",{className:"space-y-1 p-2 bg-red-900/20 border border-red-500/50 rounded-none",children:a.errors.map((l,g)=>e.jsxs("div",{className:"font-terminal text-[10px] text-red-400",children:["• ",l]},g))})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{onClick:()=>d.mutate(),disabled:a?.running||d.isPending,className:"flex-1 bg-primary hover:bg-primary/80 rounded-none font-terminal text-xs",children:[e.jsx(Oe,{className:"w-3 h-3 mr-1"}),d.isPending?"Starting...":"Run Scholar"]}),e.jsx(M,{onClick:()=>r.invalidateQueries({queryKey:["scholarStatus"]}),variant:"outline",className:"rounded-none font-terminal text-xs",disabled:n,children:e.jsx(P,{className:`w-3 h-3 ${n?"animate-spin":""}`})})]}),e.jsx("div",{className:"pt-2 border-t border-secondary/30",children:e.jsx("p",{className:"font-terminal text-[9px] text-muted-foreground",children:"Runs Scholar orchestrator loop: analyzes SOP, generates questions, creates proposals"})})]})]})}function ps(){const r=re(),[t,o]=m.useState("summary"),[a,n]=m.useState([]),[d,x]=m.useState(""),[i,l]=m.useState(!1),g=m.useRef(null),{data:j=[]}=w({queryKey:["sessions"],queryFn:v.sessions.getAll}),{data:y=[]}=w({queryKey:["courses"],queryFn:v.courses.getAll}),{data:S=[]}=w({queryKey:["proposals"],queryFn:v.proposals.getAll}),{data:A=[]}=w({queryKey:["scholar-questions"],queryFn:v.scholar.getQuestions}),{data:E=[]}=w({queryKey:["scholar-findings"],queryFn:v.scholar.getFindings}),{data:_=[]}=w({queryKey:["scholar-tutor-audit"],queryFn:v.scholar.getTutorAudit}),{data:I}=w({queryKey:["scholar-clusters"],queryFn:v.scholar.getClusters}),U=V({mutationFn:v.scholar.runClustering,onSuccess:()=>{r.invalidateQueries({queryKey:["scholar-clusters"]})}}),me=V({mutationFn:({id:s,data:c})=>v.proposals.update(s,c),onSuccess:()=>{r.invalidateQueries({queryKey:["proposals"]})}});m.useEffect(()=>{g.current?.scrollIntoView({behavior:"smooth"})},[a]);const ue=j.slice(0,20),he=j.reduce((s,c)=>s+(c.minutes||0),0),pe=j.length>0?Math.round(he/j.length):0,fe=j.filter(s=>{const c=new Date(s.date),b=new Date;return b.setDate(b.getDate()-7),c>=b}).length,L=y.filter(s=>(s.totalSessions||0)<3),O=j.filter(s=>s.confusions&&s.confusions.length>0).flatMap(s=>s.confusions||[]),$=j.filter(s=>s.issues&&s.issues.length>0).flatMap(s=>s.issues||[]),K=async()=>{if(!d.trim())return;const s=d.trim();n(c=>[...c,{role:"user",content:s}]),x(""),l(!0);try{const c=await v.scholar.chat(s);n(b=>[...b,{role:"assistant",content:c.response}])}catch{n(b=>[...b,{role:"assistant",content:"Error processing your question. Please try again."}])}finally{l(!1)}},Ne=A,je=_,ge=E,Q=s=>{switch(s){case"APPROVED":return"bg-primary/20 text-primary border-primary";case"REJECTED":return"bg-secondary/40 text-muted-foreground border-secondary";case"IMPLEMENTED":return"bg-white/20 text-white border-white";default:return"bg-secondary/20 text-secondary-foreground border-secondary"}},be=s=>{switch(s){case"HIGH":return"text-primary border-primary";case"MED":return"text-white border-white";default:return"text-muted-foreground border-muted-foreground"}};return e.jsx(Se,{children:e.jsxs("div",{className:"h-[calc(100vh-140px)] flex flex-col gap-6",children:[e.jsxs("div",{className:"space-y-4 shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{className:"w-6 h-6 text-primary"}),e.jsx("h1",{className:"font-arcade text-lg text-primary",children:"SCHOLAR"}),e.jsx(u,{variant:"outline",className:"rounded-none text-[10px] font-terminal border-primary/50",children:"READ ONLY ADVISORY"})]}),e.jsxs(M,{variant:"outline",size:"sm",className:"rounded-none font-arcade text-xs border-secondary",onClick:()=>r.invalidateQueries(),"data-testid":"button-refresh-data",children:[e.jsx(P,{className:"w-3 h-3 mr-2"})," REFRESH DATA"]})]}),e.jsx(rs,{})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs(Pe,{value:t,onValueChange:o,className:"h-full flex flex-col",children:[e.jsx(Te,{className:"bg-black/60 border border-secondary rounded-none p-1 shrink-0 w-full justify-start overflow-x-auto",children:[{id:"summary",label:"SUMMARY",icon:Z},{id:"analysis",label:"ANALYSIS",icon:J},{id:"proposals",label:"PROPOSALS",icon:X}].map(s=>e.jsxs(Ae,{value:s.id,className:"rounded-none font-arcade text-[10px] data-[state=active]:bg-primary data-[state=active]:text-black px-3","data-testid":`tab-${s.id}`,children:[e.jsx(s.icon,{className:"w-3 h-3 mr-1"}),s.label]},s.id))}),e.jsx(R,{value:"summary",className:"flex-1 overflow-hidden mt-6",children:e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6 h-full",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4 overflow-auto pr-2",children:[e.jsxs(h,{className:"bg-black/40 border-2 border-primary/50 rounded-none",children:[e.jsx(p,{className:"p-4 border-b border-primary/30",children:e.jsxs(f,{className:"font-arcade text-sm text-primary flex items-center gap-3",children:[e.jsx(Z,{className:"w-4 h-4"})," STUDY HEALTH OVERVIEW"]})}),e.jsx(N,{className:"p-6 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-3 gap-6 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-arcade text-2xl text-primary",children:j.length}),e.jsx("div",{className:"font-terminal text-xs text-muted-foreground",children:"TOTAL SESSIONS"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-arcade text-2xl text-white",children:fe}),e.jsx("div",{className:"font-terminal text-xs text-muted-foreground",children:"THIS WEEK"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-arcade text-2xl text-secondary",children:[pe,"m"]}),e.jsx("div",{className:"font-terminal text-xs text-muted-foreground",children:"AVG/SESSION"})]})]})})]}),e.jsxs(h,{className:"bg-black/40 border-2 border-white/30 rounded-none",children:[e.jsx(p,{className:"p-3 border-b border-white/20",children:e.jsxs(f,{className:"font-arcade text-xs text-white flex items-center gap-2",children:[e.jsx(De,{className:"w-4 h-4"})," WHAT APPEARS TO BE WORKING"]})}),e.jsxs(N,{className:"p-6",children:[e.jsx("ul",{className:"space-y-3 font-terminal text-sm",children:y.filter(s=>(s.totalSessions||0)>=3).length>0?e.jsxs(e.Fragment,{children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Y,{className:"w-4 h-4 text-primary shrink-0 mt-0.5"}),e.jsxs("span",{children:[y.filter(s=>(s.totalSessions||0)>=3).length," courses have consistent study activity"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Y,{className:"w-4 h-4 text-primary shrink-0 mt-0.5"}),e.jsx("span",{children:"Round-robin rotation ensuring balanced coverage"})]})]}):e.jsx("li",{className:"text-muted-foreground",children:"Insufficient data - need more sessions to identify patterns"})}),e.jsx("div",{className:"mt-3 pt-3 border-t border-secondary/30",children:e.jsxs(u,{variant:"outline",className:"rounded-none text-[9px] border-secondary",children:["CONFIDENCE: ",j.length>10?"MEDIUM":"LOW"," (based on ",j.length," sessions)"]})})]})]}),e.jsxs(h,{className:"bg-black/40 border-2 border-destructive/50 rounded-none",children:[e.jsx(p,{className:"p-3 border-b border-destructive/30",children:e.jsxs(f,{className:"font-arcade text-xs text-destructive flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"})," POTENTIAL CONCERNS"]})}),e.jsx(N,{className:"p-6",children:e.jsxs("ul",{className:"space-y-3 font-terminal text-sm",children:[L.length>0&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-destructive shrink-0 mt-0.5"}),e.jsxs("span",{children:[L.length," courses with low activity: ",L.map(s=>s.name).join(", ")]})]}),O.length>0&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-destructive shrink-0 mt-0.5"}),e.jsxs("span",{children:[O.length," unresolved confusions logged"]})]}),$.length>0&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-destructive shrink-0 mt-0.5"}),e.jsxs("span",{children:[$.length," session issues flagged"]})]}),L.length===0&&O.length===0&&$.length===0&&e.jsx("li",{className:"text-muted-foreground",children:"No significant concerns identified"})]})})]})]}),e.jsxs(h,{className:"bg-black/40 border-2 border-secondary rounded-none flex flex-col h-full",children:[e.jsx(p,{className:"p-3 border-b border-secondary shrink-0",children:e.jsxs(f,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4"})," ASK SCHOLAR"]})}),e.jsxs(N,{className:"p-0 flex-1 flex flex-col overflow-hidden",children:[e.jsx(k,{className:"flex-1 p-3",children:e.jsxs("div",{className:"space-y-3",children:[a.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(z,{className:"w-8 h-8 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Ask questions about your study data, patterns, or get recommendations."})]}),a.map((s,c)=>e.jsx("div",{className:C("p-2 rounded-sm font-terminal text-xs",s.role==="user"?"bg-primary/20 text-primary ml-8":"bg-secondary/20 text-white mr-8"),children:s.content},c)),i&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground font-terminal text-xs",children:[e.jsx(P,{className:"w-3 h-3 animate-spin"}),"Analyzing Brain data..."]}),e.jsx("div",{ref:g})]})}),e.jsx("div",{className:"p-2 border-t border-secondary shrink-0",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(G,{value:d,onChange:s=>x(s.target.value),onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),K())},placeholder:"Ask about your study patterns...",className:"rounded-none bg-black border-secondary text-xs min-h-[60px] resize-none","data-testid":"input-scholar-chat"}),e.jsx(M,{size:"icon",className:"rounded-none bg-primary text-black h-[60px] w-10",onClick:K,disabled:i,"data-testid":"button-send-chat",children:e.jsx(we,{className:"w-4 h-4"})})]})})]})]})]})}),e.jsx(R,{value:"audit",className:"flex-1 overflow-auto mt-4",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsxs(h,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(p,{className:"p-3 border-b border-secondary",children:e.jsxs(f,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"})," TUTOR BEHAVIOR AUDIT"]})}),e.jsxs(N,{className:"p-4 space-y-4",children:[e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mb-4",children:"Post-session analysis of Tutor interactions. No live Tutor access."}),[{q:"Was the Tutor source-aligned?",status:"pending"},{q:"Was cognitive load appropriate?",status:"concern"},{q:"Were confusions resolved or deferred?",status:"ok"},{q:"Did explanations correlate with outcomes?",status:"pending"}].map((s,c)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-black/40 border border-secondary/50",children:[e.jsx("span",{className:"font-terminal text-xs",children:s.q}),e.jsx(u,{variant:"outline",className:C("rounded-none text-[9px]",s.status==="ok"?"border-primary text-primary":s.status==="concern"?"border-destructive text-destructive":"border-secondary text-secondary-foreground"),children:s.status.toUpperCase()})]},c))]})]}),e.jsxs(h,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(p,{className:"p-3 border-b border-secondary",children:e.jsxs(f,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"})," RECURRENT ISSUES"]})}),e.jsx(N,{className:"p-4",children:e.jsx("div",{className:"space-y-3",children:je.map((s,c)=>e.jsxs("div",{className:"p-3 bg-black/40 border border-secondary/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-terminal text-sm",children:s.issue??"Unknown issue"}),e.jsxs(u,{variant:"outline",className:"rounded-none text-[9px] border-primary text-primary",children:["x",s.frequency??0]})]}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:(s.courses||[]).map((b,ye)=>e.jsx(u,{variant:"secondary",className:"rounded-none text-[8px]",children:b},ye))})]},c))})})]})]})}),e.jsx(R,{value:"pipeline",className:"flex-1 overflow-auto mt-4",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsxs(h,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(p,{className:"p-3 border-b border-secondary",children:e.jsxs(f,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"})," QUESTION RESOLUTION PIPELINE"]})}),e.jsxs(N,{className:"p-4",children:[e.jsxs("div",{className:"space-y-2 font-terminal text-xs text-muted-foreground mb-4",children:[e.jsx("p",{children:"1. Generate question from identified issue"}),e.jsx("p",{children:"2. Attempt answer using Brain data"}),e.jsx("p",{children:"3. If insufficient, research learning science"}),e.jsx("p",{children:"4. If still unresolved, escalate to user"})]}),e.jsx("div",{className:"space-y-3",children:[{stage:"Identified",count:5},{stage:"Brain Analysis",count:3},{stage:"Research",count:1},{stage:"User Escalation",count:2}].map((s,c)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-primary/60"}),e.jsx("span",{className:"font-terminal text-sm flex-1",children:s.stage}),e.jsx(u,{variant:"outline",className:"rounded-none",children:s.count})]},c))})]})]}),e.jsxs(h,{className:"bg-black/40 border-2 border-primary/50 rounded-none",children:[e.jsx(p,{className:"p-3 border-b border-primary/30",children:e.jsxs(f,{className:"font-arcade text-xs text-primary flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"})," OPEN QUESTIONS (YOUR INPUT NEEDED)"]})}),e.jsx(N,{className:"p-4",children:e.jsx(k,{className:"h-[400px]",children:e.jsx("div",{className:"space-y-4",children:Ne.map(s=>e.jsxs("div",{className:"p-3 bg-primary/5 border border-primary/30",children:[e.jsx("p",{className:"font-terminal text-sm mb-3",children:s.question}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-muted-foreground shrink-0",children:"Context:"}),e.jsx("span",{children:s.context})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-muted-foreground shrink-0",children:"Data Gap:"}),e.jsx("span",{children:s.dataInsufficient})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-muted-foreground shrink-0",children:"Research:"}),e.jsx("span",{children:s.researchAttempted})]})]}),e.jsx("div",{className:"mt-3 pt-2 border-t border-primary/20",children:e.jsx(G,{placeholder:"Your response...",className:"rounded-none bg-black border-secondary text-xs min-h-[60px]","data-testid":`input-question-response-${s.id}`})})]},s.id))})})})]})]})}),e.jsx(R,{value:"evidence",className:"flex-1 overflow-auto mt-4",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsxs(h,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(p,{className:"p-3 border-b border-secondary",children:e.jsxs(f,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(Le,{className:"w-4 h-4"})," OBSERVED DATA (from Brain)"]})}),e.jsx(N,{className:"p-4",children:e.jsx(k,{className:"h-[400px]",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-black/40 border border-secondary/50",children:[e.jsx("div",{className:"font-arcade text-xs text-primary mb-2",children:"SESSION DISTRIBUTION"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 font-terminal text-xs",children:y.map(s=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:s.name}),e.jsxs("span",{className:"text-muted-foreground",children:[s.totalSessions||0," sessions"]})]},s.id))})]}),e.jsxs("div",{className:"p-3 bg-black/40 border border-secondary/50",children:[e.jsx("div",{className:"font-arcade text-xs text-primary mb-2",children:"CONFUSION LOG"}),e.jsx("div",{className:"space-y-1 font-terminal text-xs",children:O.length>0?O.slice(0,5).map((s,c)=>e.jsxs("div",{className:"text-muted-foreground",children:["• ",s]},c)):e.jsx("div",{className:"text-muted-foreground",children:"No confusions logged"})})]}),e.jsxs("div",{className:"p-3 bg-black/40 border border-secondary/50",children:[e.jsx("div",{className:"font-arcade text-xs text-primary mb-2",children:"RECENT SESSIONS"}),e.jsx("div",{className:"space-y-1 font-terminal text-xs",children:ue.slice(0,5).map((s,c)=>e.jsxs("div",{className:"flex justify-between text-muted-foreground",children:[e.jsx("span",{children:s.topic||"Untitled"}),e.jsxs("span",{children:[s.minutes||0,"m"]})]},c))})]})]})})})]}),e.jsxs(h,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(p,{className:"p-3 border-b border-secondary",children:e.jsxs(f,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(Me,{className:"w-4 h-4"})," RESEARCH INTERPRETATION"]})}),e.jsxs(N,{className:"p-4",children:[e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mb-4",children:"Learning science findings relevant to your study patterns."}),e.jsx(k,{className:"h-[350px]",children:e.jsx("div",{className:"space-y-4",children:ge.map((s,c)=>e.jsxs("div",{className:"p-3 bg-black/40 border border-secondary/50",children:[e.jsx("div",{className:"font-arcade text-xs text-primary mb-2",children:s.topic??s.title}),e.jsx("p",{className:"font-terminal text-xs mb-2",children:s.summary??s.content}),e.jsx("div",{className:"flex justify-between text-[10px] text-muted-foreground",children:e.jsxs("span",{children:["Source: ",s.source]})}),e.jsx("div",{className:"mt-2 pt-2 border-t border-secondary/30",children:e.jsxs("span",{className:"text-[10px] text-primary",children:["Relevance: ",s.relevance??"n/a"]})})]},c))})})]})]})]})}),e.jsx(R,{value:"proposals",className:"flex-1 overflow-auto mt-4",children:e.jsxs(h,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsxs(p,{className:"p-3 border-b border-secondary",children:[e.jsxs(f,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(X,{className:"w-4 h-4"})," IMPROVEMENT PROPOSALS"]}),e.jsx("p",{className:"font-terminal text-[10px] text-muted-foreground mt-1",children:"No auto-implementation. All changes require user approval."})]}),e.jsx(N,{className:"p-4",children:e.jsx(k,{className:"h-[500px]",children:e.jsx("div",{className:"space-y-4",children:S.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"font-arcade text-xs text-primary mb-2",children:"NO PROPOSALS YET"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Proposals are generated by the Scholar workflow after analyzing Brain session data. Run a Scholar analysis from the dashboard or via the Scholar CLI to create proposals."})]}):S.filter(s=>s.status!=="REJECTED").map(s=>e.jsxs("div",{className:"p-4 bg-black/40 border border-secondary/50",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-xs text-muted-foreground",children:s.proposalId}),e.jsx("h4",{className:"font-terminal text-sm mt-1",children:s.summary})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(u,{variant:"outline",className:C("rounded-none text-[9px]",be(s.priority||"MED")),children:s.priority||"MED"})})]}),s.targetSystem&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"Target: "}),e.jsx(u,{variant:"secondary",className:"rounded-none text-[9px]",children:s.targetSystem})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-secondary/30",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{variant:"outline",className:"rounded-none text-[9px] border-secondary",children:"Confidence: MED"}),e.jsx(u,{variant:"outline",className:"rounded-none text-[9px] border-secondary",children:"Risk: LOW"})]}),e.jsxs(Ee,{value:s.status||"DRAFT",onValueChange:c=>me.mutate({id:s.id,data:{status:c}}),children:[e.jsx(ke,{className:C("rounded-none w-28 h-7 text-[10px]",Q(s.status||"DRAFT")),"data-testid":`select-proposal-status-${s.id}`,children:e.jsx(Re,{})}),e.jsxs(Ce,{className:"rounded-none bg-black border-primary",children:[e.jsx(q,{value:"DRAFT",children:"PROPOSED"}),e.jsx(q,{value:"APPROVED",children:"APPROVED"}),e.jsx(q,{value:"REJECTED",children:"REJECTED"}),e.jsx(q,{value:"IMPLEMENTED",children:"IMPLEMENTED"})]})]})]})]},s.id))})})})]})}),e.jsx(R,{value:"clusters",className:"flex-1 overflow-auto mt-4",children:e.jsxs(h,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsxs(p,{className:"p-3 border-b border-secondary flex flex-row items-center justify-between",children:[e.jsxs(f,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"})," TOPIC CLUSTERS"]}),e.jsx(M,{variant:"outline",size:"sm",className:"rounded-none font-arcade text-[10px] border-primary text-primary",onClick:()=>U.mutate(),disabled:U.isPending,"data-testid":"button-run-clustering",children:U.isPending?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-3 h-3 mr-1 animate-spin"})," CLUSTERING..."]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"w-3 h-3 mr-1"})," RUN CLUSTERING"]})})]}),e.jsx(N,{className:"p-4",children:e.jsx(k,{className:"h-[500px]",children:e.jsx("div",{className:"space-y-4",children:!I?.clusters||I.clusters.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"font-arcade text-xs text-primary mb-2",children:"NO CLUSTERS YET"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Click RUN CLUSTERING to group digests and proposals by shared topic keywords. Requires at least 2 digests or proposals with titles to find clusters."})]}):I.clusters.map(s=>e.jsxs("div",{className:"p-4 bg-black/40 border border-secondary/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-arcade text-xs text-primary uppercase",children:s.cluster_id}),e.jsxs(u,{variant:"outline",className:"rounded-none text-[9px] border-secondary",children:[s.count," items"]})]}),e.jsx("div",{className:"space-y-2",children:s.items.map((c,b)=>e.jsxs("div",{className:"flex items-center gap-2 font-terminal text-xs",children:[e.jsx(u,{variant:"secondary",className:"rounded-none text-[8px] shrink-0",children:c.source==="digest"?"DIG":"PROP"}),e.jsx("span",{className:"truncate",children:c.title||"Untitled"})]},b))})]},s.cluster_id))})})})]})}),e.jsx(R,{value:"history",className:"flex-1 overflow-auto mt-4",children:e.jsxs(h,{className:"bg-black/40 border-2 border-secondary rounded-none",children:[e.jsx(p,{className:"p-3 border-b border-secondary",children:e.jsxs(f,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(Be,{className:"w-4 h-4"})," PROPOSAL HISTORY (READ ONLY)"]})}),e.jsx(N,{className:"p-4",children:e.jsx(k,{className:"h-[500px]",children:e.jsx("div",{className:"space-y-2",children:S.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"font-arcade text-xs text-primary mb-2",children:"NO HISTORY YET"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Proposal history will appear here once Scholar generates its first analysis."})]}):S.map(s=>e.jsxs("div",{className:"flex items-center p-3 bg-black/40 border border-secondary/50 font-terminal text-sm","data-testid":`history-proposal-${s.id}`,children:[e.jsx("div",{className:"w-20 font-mono text-xs text-muted-foreground",children:s.proposalId}),e.jsx("div",{className:"flex-1 truncate",children:s.summary}),e.jsxs("div",{className:"flex gap-2 items-center shrink-0",children:[e.jsx(u,{variant:"outline",className:C("rounded-none text-[9px]",Q(s.status||"DRAFT")),children:s.status||"DRAFT"}),e.jsxs("span",{className:"text-[10px] text-muted-foreground",children:[e.jsx(ae,{className:"w-3 h-3 inline mr-1"}),s.createdAt?new Date(s.createdAt).toLocaleDateString():"N/A"]})]})]},s.id))})})})]})})]})})]})})}export{ps as default};

import{c as V,d as M,e as J,r as m,j as t,m as I}from"./index-BNBpHzuq.js";import{u as H,S as B,B as z,o as $,L as G}from"./index-CQ2PnOVl.js";import{C as P}from"./card-CKJRX68-.js";import{B as S}from"./badge-BInTbt2L.js";import{C as Z}from"./checkbox-Bixqu8bU.js";import{L as Y}from"./loader-circle-qNIwqQsp.js";import{a as W,D as tt,M as et,r as at,F as K,b as Q}from"./index-BS50I3s4.js";import{R as rt,S as st}from"./send-bgNR18QL.js";import{Z as ot}from"./zap-elSknalK.js";import{M as nt}from"./message-square-Cqgb0xhU.js";import{C as it}from"./clock-CjmOTT77.js";import{B as dt}from"./book-open-aCRuNfCY.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],X=V("credit-card",lt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],ut=V("square",ct),mt=[{value:"Core",label:"CORE",desc:"Teach First — new material"},{value:"Sprint",label:"SPRINT",desc:"Test-First — find gaps"},{value:"Drill",label:"DRILL",desc:"Deep Practice — lock concepts"},{value:"Teaching Sprint",label:"TEACH",desc:"Quick focused lesson"},{value:"Diagnostic Sprint",label:"DIAG",desc:"Assess knowledge"}],ft="C:\\Users\\treyt\\Desktop\\Treys School";function pt({courseId:i,setCourseId:a,selectedFolders:e,setSelectedFolders:d,mode:b,setMode:l,topic:f,setTopic:p,onStartSession:n,isStarting:o,hasActiveSession:x}){const c=M(),{toast:y}=J(),[s,h]=m.useState(!1),[w,D]=m.useState(ft),{data:v,isLoading:N}=H({queryKey:["tutor-content-sources"],queryFn:()=>$.tutor.getContentSources()}),k=r=>{d(e.includes(r)?e.filter(E=>E!==r):[...e,r])},C=v?.folders.filter(r=>!i||r.course_id===i||i===void 0&&r.course_id===null),F=async()=>{if(w.trim()){h(!0);try{const r=await $.tutor.syncVault({vault_path:w});y({title:"Vault synced",description:`${r.processed} files processed, ${r.embedded} newly embedded`}),c.invalidateQueries({queryKey:["tutor-content-sources"]})}catch(r){y({title:"Sync failed",description:r instanceof Error?r.message:"Unknown error",variant:"destructive"})}finally{h(!1)}}};return t.jsxs("div",{className:"flex flex-col h-full gap-3 p-3",children:[t.jsx("div",{className:"font-arcade text-xs text-primary tracking-wider",children:"CONTENT FILTER"}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("div",{className:"text-[10px] font-terminal text-muted-foreground uppercase tracking-wider",children:"Phase: First Pass"}),t.jsx("div",{className:"grid grid-cols-1 gap-1",children:mt.map(r=>t.jsxs("button",{onClick:()=>l(r.value),className:`text-left px-2 py-1.5 border-2 text-xs font-terminal transition-colors ${b===r.value?"border-primary bg-primary/20 text-primary":"border-muted-foreground/30 hover:border-primary/50 text-muted-foreground"}`,children:[t.jsx("span",{className:"font-arcade text-[10px]",children:r.label}),t.jsx("span",{className:"ml-2 text-[10px] opacity-70",children:r.desc})]},r.value))})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("label",{className:"text-[10px] font-terminal text-muted-foreground uppercase tracking-wider",children:"Topic"}),t.jsx("input",{value:f,onChange:r=>p(r.target.value),placeholder:"e.g. Hip Flexors",className:"w-full bg-black/60 border-2 border-muted-foreground/30 px-2 py-1.5 text-xs font-terminal text-foreground placeholder:text-muted-foreground/50 focus:border-primary focus:outline-none"})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("label",{className:"text-[10px] font-terminal text-muted-foreground uppercase tracking-wider",children:"Course"}),N?t.jsx(Y,{className:"w-4 h-4 animate-spin text-muted-foreground"}):t.jsxs("div",{className:"space-y-1",children:[t.jsxs("button",{onClick:()=>a(void 0),className:`w-full text-left px-2 py-1 text-xs font-terminal border-2 ${i?"border-transparent text-muted-foreground hover:text-foreground":"border-primary text-primary"}`,children:["All Courses",t.jsx(S,{variant:"outline",className:"ml-2 text-[10px] rounded-none",children:v?.total_docs??0})]}),v?.courses.map(r=>t.jsxs("button",{onClick:()=>a(r.id??void 0),className:`w-full text-left px-2 py-1 text-xs font-terminal border-2 ${i===r.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"}`,children:[r.name,t.jsx(S,{variant:"outline",className:"ml-2 text-[10px] rounded-none",children:r.doc_count})]},r.id??"system"))]})]}),C&&C.length>0&&t.jsxs("div",{className:"space-y-1 flex-1 min-h-0",children:[t.jsxs("label",{className:"text-[10px] font-terminal text-muted-foreground uppercase tracking-wider flex items-center gap-1",children:[t.jsx(W,{className:"w-3 h-3"}),"Folders"]}),t.jsx(B,{className:"flex-1 max-h-32",children:t.jsx("div",{className:"space-y-1",children:C.map(r=>t.jsxs("label",{className:"flex items-center gap-2 px-2 py-1 text-xs font-terminal text-muted-foreground hover:text-foreground cursor-pointer",children:[t.jsx(Z,{checked:e.includes(r.folder_path),onCheckedChange:()=>k(r.folder_path)}),t.jsx("span",{className:"truncate flex-1",children:r.folder_path}),t.jsx(S,{variant:"outline",className:"text-[10px] rounded-none",children:r.doc_count})]},r.folder_path))})})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("label",{className:"text-[10px] font-terminal text-muted-foreground uppercase tracking-wider",children:"Vault Sync"}),t.jsx("input",{value:w,onChange:r=>D(r.target.value),placeholder:"Path to Obsidian vault",className:"w-full bg-black/60 border-2 border-muted-foreground/30 px-2 py-1 text-[10px] font-terminal text-foreground placeholder:text-muted-foreground/50 focus:border-primary focus:outline-none"}),t.jsxs(z,{onClick:F,disabled:s||!w.trim(),variant:"outline",className:"w-full rounded-none border-2 border-muted-foreground/30 font-arcade text-[10px] h-7",children:[s?t.jsx(Y,{className:"w-3 h-3 animate-spin mr-1"}):t.jsx(rt,{className:"w-3 h-3 mr-1"}),"SYNC VAULT"]})]}),t.jsxs(z,{onClick:n,disabled:o||x,className:"w-full rounded-none border-2 border-primary font-arcade text-xs",children:[o?t.jsx(Y,{className:"w-4 h-4 animate-spin mr-2"}):t.jsx(ot,{className:"w-4 h-4 mr-2"}),x?"SESSION ACTIVE":"START SESSION"]}),t.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-terminal text-muted-foreground",children:[t.jsx(tt,{className:"w-3 h-3"}),v?.total_docs??0," docs indexed"]})]})}function xt({sessionId:i,onArtifactCreated:a,onSessionEnd:e}){const[d,b]=m.useState([]),[l,f]=m.useState(""),[p,n]=m.useState(!1),o=m.useRef(null),x=m.useRef(null);m.useEffect(()=>{o.current&&(o.current.scrollTop=o.current.scrollHeight)},[d]),m.useEffect(()=>{x.current?.focus()},[i]);const c=m.useCallback(async()=>{if(!l.trim()||!i||p)return;const s=l.trim();f("");const h=/^\/(note|save)\b/i.test(s),w=/^\/(card|flashcard)\b/i.test(s),D=/^\/(map|diagram)\b/i.test(s);b(v=>[...v,{role:"user",content:s}]),b(v=>[...v,{role:"assistant",content:"",isStreaming:!0}]),n(!0);try{const N=(await fetch(`/api/tutor/session/${i}/turn`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:s})})).body?.getReader(),k=new TextDecoder;if(!N)throw new Error("No response body");let C="",F="",r=[];for(;;){const{done:E,value:u}=await N.read();if(E)break;C+=k.decode(u,{stream:!0});const g=C.split(`
`);C=g.pop()??"";for(const O of g){if(!O.startsWith("data: "))continue;const _=O.slice(6);if(_==="[DONE]")break;try{const A=JSON.parse(_);if(A.type==="error"){b(L=>{const T=[...L];return T[T.length-1]={role:"assistant",content:`Error: ${A.content}`},T}),n(!1);return}A.type==="token"&&A.content&&(F+=A.content,b(L=>{const T=[...L],q=T[T.length-1];return T[T.length-1]={...q,content:q.content+A.content,isStreaming:!0},T})),A.type==="done"&&(r=A.citations??[])}catch{}}}b(E=>{const u=[...E];return u[u.length-1]={role:"assistant",content:F,citations:r,isStreaming:!1},u}),(h||w||D)&&a({type:h?"note":w?"card":"map",content:F,title:s.replace(/^\/(note|card|flashcard|map|diagram|save)\s*/i,"").trim()})}catch(v){b(N=>{const k=[...N];return k[k.length-1]={role:"assistant",content:`Connection error: ${v instanceof Error?v.message:"Unknown"}`},k})}finally{n(!1)}},[l,i,p,a]),y=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),c())};return i?t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsxs("div",{ref:o,className:"flex-1 overflow-y-auto p-3 space-y-3",children:[d.length===0&&t.jsxs("div",{className:"text-center py-8 space-y-2",children:[t.jsx("div",{className:"font-arcade text-xs text-primary",children:"SESSION STARTED"}),t.jsx("div",{className:"font-terminal text-xs text-muted-foreground",children:"Ask a question to begin learning. Use /note, /card, or /map for artifacts."})]}),d.map((s,h)=>t.jsx("div",{className:`flex ${s.role==="user"?"justify-end":"justify-start"}`,children:t.jsxs("div",{className:`max-w-[85%] px-3 py-2 text-xs font-terminal ${s.role==="user"?"bg-primary/20 border-2 border-primary/50 text-foreground":"bg-black/40 border-2 border-muted-foreground/20 text-foreground"}`,children:[s.role==="assistant"?t.jsxs("div",{className:"prose prose-invert prose-xs max-w-none [&_p]:my-1 [&_li]:my-0.5 [&_h1]:text-sm [&_h2]:text-xs [&_h3]:text-xs [&_code]:text-[10px] [&_pre]:text-[10px]",children:[t.jsx(et,{remarkPlugins:[at],children:s.content||(s.isStreaming?"...":"")}),s.isStreaming&&t.jsx("span",{className:"inline-block w-2 h-3 bg-primary animate-pulse ml-0.5"})]}):t.jsx("div",{children:s.content}),s.citations&&s.citations.length>0&&t.jsx("div",{className:"flex flex-wrap gap-1 mt-2 pt-2 border-t border-muted-foreground/20",children:s.citations.map(w=>t.jsxs(S,{variant:"outline",className:"text-[10px] rounded-none",children:["[",w.index,"] ",w.source]},w.index))})]})},h))]}),t.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 border-t border-muted-foreground/20",children:[t.jsx("span",{className:"text-[10px] font-terminal text-muted-foreground/50",children:"Commands:"}),t.jsxs(S,{variant:"outline",className:"text-[10px] rounded-none cursor-pointer hover:bg-primary/10",onClick:()=>f("/note "),children:[t.jsx(K,{className:"w-2.5 h-2.5 mr-1"}),"/note"]}),t.jsxs(S,{variant:"outline",className:"text-[10px] rounded-none cursor-pointer hover:bg-primary/10",onClick:()=>f("/card "),children:[t.jsx(X,{className:"w-2.5 h-2.5 mr-1"}),"/card"]}),t.jsxs(S,{variant:"outline",className:"text-[10px] rounded-none cursor-pointer hover:bg-primary/10",onClick:()=>f("/map "),children:[t.jsx(Q,{className:"w-2.5 h-2.5 mr-1"}),"/map"]}),t.jsx("div",{className:"flex-1"}),t.jsxs(z,{variant:"ghost",size:"sm",onClick:e,className:"text-[10px] font-terminal text-destructive hover:text-destructive h-5 px-2",children:[t.jsx(ut,{className:"w-2.5 h-2.5 mr-1"}),"END"]})]}),t.jsxs("div",{className:"flex items-center gap-2 p-3 border-t-2 border-muted-foreground/30",children:[t.jsx("input",{ref:x,value:l,onChange:s=>f(s.target.value),onKeyDown:y,placeholder:"Ask a question...",disabled:p,className:"flex-1 bg-black/60 border-2 border-muted-foreground/30 px-3 py-2 text-xs font-terminal text-foreground placeholder:text-muted-foreground/50 focus:border-primary focus:outline-none disabled:opacity-50"}),t.jsx(z,{onClick:c,disabled:!l.trim()||p,className:"rounded-none border-2 border-primary h-9 w-9 p-0",children:p?t.jsx(Y,{className:"w-4 h-4 animate-spin"}):t.jsx(st,{className:"w-4 h-4"})})]})]}):t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsxs("div",{className:"text-center space-y-2",children:[t.jsx("div",{className:"font-arcade text-sm text-muted-foreground",children:"NO ACTIVE SESSION"}),t.jsx("div",{className:"font-terminal text-xs text-muted-foreground/70",children:"Configure content filter and start a session"})]})})}const ht={note:K,card:X,map:Q},gt={note:"text-blue-400",card:"text-yellow-400",map:"text-green-400"};function bt({sessionId:i,artifacts:a,turnCount:e,mode:d,topic:b,startedAt:l,recentSessions:f,onResumeSession:p}){return t.jsxs("div",{className:"flex flex-col h-full gap-3 p-3",children:[t.jsx("div",{className:"font-arcade text-xs text-primary tracking-wider",children:"ARTIFACTS"}),i?t.jsxs("div",{className:"space-y-1 pb-2 border-b border-muted-foreground/20",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(S,{variant:"outline",className:"text-[10px] rounded-none",children:d}),t.jsx(S,{variant:"outline",className:"text-[10px] rounded-none text-primary",children:"FIRST PASS"})]}),b&&t.jsx("div",{className:"text-xs font-terminal text-foreground truncate",children:b}),t.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-terminal text-muted-foreground",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(nt,{className:"w-3 h-3"}),e," turns"]}),l&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(it,{className:"w-3 h-3"}),new Date(l).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})]}):t.jsx("div",{className:"text-xs font-terminal text-muted-foreground/50 py-4 text-center",children:"No active session"}),a.length>0?t.jsx(B,{className:"flex-1",children:t.jsx("div",{className:"space-y-2",children:a.map((n,o)=>{const x=ht[n.type],c=gt[n.type];return t.jsxs("div",{className:"border-2 border-muted-foreground/20 p-2 hover:border-primary/30 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx(x,{className:`w-3.5 h-3.5 ${c}`}),t.jsx("span",{className:"text-[10px] font-terminal text-foreground truncate flex-1",children:n.title||`${n.type} #${o+1}`})]}),n.content&&t.jsx("div",{className:"text-[10px] font-terminal text-muted-foreground mt-1 line-clamp-2",children:n.content.slice(0,100)})]},o)})})}):i?t.jsx("div",{className:"flex-1 flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-1",children:[t.jsx(dt,{className:"w-6 h-6 text-muted-foreground/30 mx-auto"}),t.jsx("div",{className:"text-[10px] font-terminal text-muted-foreground/50",children:"No artifacts yet"}),t.jsx("div",{className:"text-[10px] font-terminal text-muted-foreground/30",children:"Use /note, /card, or /map"})]})}):null,f.length>0&&t.jsxs("div",{className:"space-y-1 pt-2 border-t border-muted-foreground/20",children:[t.jsx("div",{className:"text-[10px] font-terminal text-muted-foreground uppercase tracking-wider",children:"Recent Sessions"}),t.jsx("div",{className:"space-y-1",children:f.slice(0,5).map(n=>t.jsxs("button",{onClick:()=>p(n.session_id),className:"w-full text-left px-2 py-1.5 border-2 border-transparent hover:border-muted-foreground/30 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx(S,{variant:"outline",className:`text-[10px] rounded-none ${n.status==="active"?"text-green-400 border-green-400/50":"text-muted-foreground"}`,children:n.status==="active"?"LIVE":"DONE"}),t.jsx("span",{className:"text-[10px] font-terminal text-foreground truncate flex-1",children:n.topic||n.mode})]}),t.jsxs("div",{className:"text-[10px] font-terminal text-muted-foreground/50 mt-0.5",children:[n.turn_count," turns ·"," ",new Date(n.started_at).toLocaleDateString()]})]},n.session_id))})]})]})}function yt(i){if(typeof document>"u")return;let a=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style");e.type="text/css",a.appendChild(e),e.styleSheet?e.styleSheet.cssText=i:e.appendChild(document.createTextNode(i))}Array(12).fill(0);let U=1;class vt{constructor(){this.subscribe=a=>(this.subscribers.push(a),()=>{const e=this.subscribers.indexOf(a);this.subscribers.splice(e,1)}),this.publish=a=>{this.subscribers.forEach(e=>e(a))},this.addToast=a=>{this.publish(a),this.toasts=[...this.toasts,a]},this.create=a=>{var e;const{message:d,...b}=a,l=typeof a?.id=="number"||((e=a.id)==null?void 0:e.length)>0?a.id:U++,f=this.toasts.find(n=>n.id===l),p=a.dismissible===void 0?!0:a.dismissible;return this.dismissedToasts.has(l)&&this.dismissedToasts.delete(l),f?this.toasts=this.toasts.map(n=>n.id===l?(this.publish({...n,...a,id:l,title:d}),{...n,...a,id:l,dismissible:p,title:d}):n):this.addToast({title:d,...b,dismissible:p,id:l}),l},this.dismiss=a=>(a?(this.dismissedToasts.add(a),requestAnimationFrame(()=>this.subscribers.forEach(e=>e({id:a,dismiss:!0})))):this.toasts.forEach(e=>{this.subscribers.forEach(d=>d({id:e.id,dismiss:!0}))}),a),this.message=(a,e)=>this.create({...e,message:a}),this.error=(a,e)=>this.create({...e,message:a,type:"error"}),this.success=(a,e)=>this.create({...e,type:"success",message:a}),this.info=(a,e)=>this.create({...e,type:"info",message:a}),this.warning=(a,e)=>this.create({...e,type:"warning",message:a}),this.loading=(a,e)=>this.create({...e,type:"loading",message:a}),this.promise=(a,e)=>{if(!e)return;let d;e.loading!==void 0&&(d=this.create({...e,promise:a,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));const b=Promise.resolve(a instanceof Function?a():a);let l=d!==void 0,f;const p=b.then(async o=>{if(f=["resolve",o],I.isValidElement(o))l=!1,this.create({id:d,type:"default",message:o});else if(jt(o)&&!o.ok){l=!1;const c=typeof e.error=="function"?await e.error(`HTTP error! status: ${o.status}`):e.error,y=typeof e.description=="function"?await e.description(`HTTP error! status: ${o.status}`):e.description,h=typeof c=="object"&&!I.isValidElement(c)?c:{message:c};this.create({id:d,type:"error",description:y,...h})}else if(o instanceof Error){l=!1;const c=typeof e.error=="function"?await e.error(o):e.error,y=typeof e.description=="function"?await e.description(o):e.description,h=typeof c=="object"&&!I.isValidElement(c)?c:{message:c};this.create({id:d,type:"error",description:y,...h})}else if(e.success!==void 0){l=!1;const c=typeof e.success=="function"?await e.success(o):e.success,y=typeof e.description=="function"?await e.description(o):e.description,h=typeof c=="object"&&!I.isValidElement(c)?c:{message:c};this.create({id:d,type:"success",description:y,...h})}}).catch(async o=>{if(f=["reject",o],e.error!==void 0){l=!1;const x=typeof e.error=="function"?await e.error(o):e.error,c=typeof e.description=="function"?await e.description(o):e.description,s=typeof x=="object"&&!I.isValidElement(x)?x:{message:x};this.create({id:d,type:"error",description:c,...s})}}).finally(()=>{l&&(this.dismiss(d),d=void 0),e.finally==null||e.finally.call(e)}),n=()=>new Promise((o,x)=>p.then(()=>f[0]==="reject"?x(f[1]):o(f[1])).catch(x));return typeof d!="string"&&typeof d!="number"?{unwrap:n}:Object.assign(d,{unwrap:n})},this.custom=(a,e)=>{const d=e?.id||U++;return this.create({jsx:a(d),id:d,...e}),d},this.getActiveToasts=()=>this.toasts.filter(a=>!this.dismissedToasts.has(a.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const j=new vt,wt=(i,a)=>{const e=a?.id||U++;return j.addToast({title:i,...a,id:e}),e},jt=i=>i&&typeof i=="object"&&"ok"in i&&typeof i.ok=="boolean"&&"status"in i&&typeof i.status=="number",Nt=wt,St=()=>j.toasts,kt=()=>j.getActiveToasts(),R=Object.assign(Nt,{success:j.success,info:j.info,warning:j.warning,error:j.error,custom:j.custom,message:j.message,promise:j.promise,dismiss:j.dismiss,loading:j.loading},{getHistory:St,getToasts:kt});yt("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function zt(){const i=M(),[a,e]=m.useState(null),[d,b]=m.useState(!1),[l,f]=m.useState(),[p,n]=m.useState([]),[o,x]=m.useState("Core"),[c,y]=m.useState(""),[s,h]=m.useState([]),[w,D]=m.useState(0),[v,N]=m.useState(null),{data:k=[]}=H({queryKey:["tutor-sessions"],queryFn:()=>$.tutor.listSessions({limit:10})}),C=m.useCallback(async()=>{b(!0);try{const u=await $.tutor.createSession({course_id:l,phase:"first_pass",mode:o,topic:c||void 0,content_filter:p.length>0?{folders:p}:void 0});e(u.session_id),N(u.started_at),h([]),D(0),R.success("Tutor session started"),i.invalidateQueries({queryKey:["tutor-sessions"]})}catch(u){R.error(`Failed to start session: ${u instanceof Error?u.message:"Unknown"}`)}finally{b(!1)}},[l,o,c,p,i]),F=m.useCallback(async()=>{if(a)try{await $.tutor.endSession(a),R.success("Session ended"),e(null),h([]),D(0),N(null),i.invalidateQueries({queryKey:["tutor-sessions"]})}catch(u){R.error(`Failed to end session: ${u instanceof Error?u.message:"Unknown"}`)}},[a,i]),r=m.useCallback(async u=>{if(a)try{const g=await $.tutor.createArtifact(a,{type:u.type,content:u.content,title:u.title}),O={type:u.type,title:u.title||`${u.type} #${s.length+1}`,content:u.content.slice(0,200),createdAt:new Date().toISOString(),cardId:g.card_id};h(_=>[..._,O]),R.success(`${u.type.charAt(0).toUpperCase()+u.type.slice(1)} created`)}catch(g){R.error(`Failed to create artifact: ${g instanceof Error?g.message:"Unknown"}`)}},[a,s.length]),E=m.useCallback(async u=>{try{const g=await $.tutor.getSession(u);if(e(g.session_id),D(g.turn_count),N(g.started_at),x(g.mode),y(g.topic||""),f(g.course_id??void 0),g.artifacts_json)try{const O=JSON.parse(g.artifacts_json);Array.isArray(O)&&h(O.map(_=>({type:_.type,title:_.title,content:"",createdAt:_.created_at})))}catch{h([])}R.success("Session resumed")}catch(g){R.error(`Failed to resume session: ${g instanceof Error?g.message:"Unknown"}`)}},[]);return t.jsx(G,{children:t.jsxs("div",{className:"h-[calc(100vh-140px)] flex gap-2",children:[t.jsx(P,{className:"w-56 shrink-0 bg-black/40 border-2 border-primary rounded-none overflow-y-auto",children:t.jsx(pt,{courseId:l,setCourseId:f,selectedFolders:p,setSelectedFolders:n,mode:o,setMode:x,topic:c,setTopic:y,onStartSession:C,isStarting:d,hasActiveSession:!!a})}),t.jsx(P,{className:"flex-1 bg-black/60 border-2 border-primary rounded-none flex flex-col min-w-0",children:t.jsx(xt,{sessionId:a,onArtifactCreated:r,onSessionEnd:F})}),t.jsx(P,{className:"w-56 shrink-0 bg-black/40 border-2 border-secondary rounded-none overflow-y-auto",children:t.jsx(bt,{sessionId:a,artifacts:s,turnCount:w,mode:o,topic:c,startedAt:v,onCreateArtifact:r,recentSessions:k,onResumeSession:E})})]})})}export{zt as default};

import{c as he,r as c,j as e,b as _,R as Ps,d as Rs,e as D,f as Fs,P as Ve,g as Ms,u as He,X as de}from"./index-ld7PmwUf.js";import{h as Ls,i as _s,j as qs,u as G,a as V,g as N,L as zs,k as Bs,B as j,T as se,S as be,P as me,C as xe,f as Gs,l as ye,D as Pe,c as Re,d as Fe,e as Me,m as Le,I as _e,n as Z,o as qe}from"./layout-DfoTkRnP.js";import{C as A,a as T,b as P,c as O}from"./card-1J0Czkow.js";import{e as $s,B as te,S as ze,a as Be,b as Ge,c as $e,d as L}from"./select-CtjoCycW.js";import{c as Je,R as Us,T as Ks,C as Ws,a as ve}from"./index-HtckqVyn.js";import{T as Ue,A as Ys,a as Vs,b as Hs,c as Js,d as Qs,e as Xs,f as Zs,g as et}from"./alert-dialog-C1AXx8Js.js";import{B as st}from"./book-open-To7xIeq4.js";import{F as tt,a as Ke}from"./folder-hPOmlutb.js";import{F as at}from"./file-text-BYVgDVBF.js";import{R as We}from"./refresh-cw-fZetrxur.js";import{i as nt,f as rt}from"./format-D7m0hUtg.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],lt=he("chart-column",ot);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],it=he("database",ct);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],mt=he("file",dt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Ye=he("layers",xt),Qe=c.forwardRef(({className:t,...n},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:_("w-full caption-bottom text-sm",t),...n})}));Qe.displayName="Table";const Xe=c.forwardRef(({className:t,...n},a)=>e.jsx("thead",{ref:a,className:_("[&_tr]:border-b",t),...n}));Xe.displayName="TableHeader";const Ze=c.forwardRef(({className:t,...n},a)=>e.jsx("tbody",{ref:a,className:_("[&_tr:last-child]:border-0",t),...n}));Ze.displayName="TableBody";const ut=c.forwardRef(({className:t,...n},a)=>e.jsx("tfoot",{ref:a,className:_("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...n}));ut.displayName="TableFooter";const Se=c.forwardRef(({className:t,...n},a)=>e.jsx("tr",{ref:a,className:_("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...n}));Se.displayName="TableRow";const W=c.forwardRef(({className:t,...n},a)=>e.jsx("th",{ref:a,className:_("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...n}));W.displayName="TableHead";const Y=c.forwardRef(({className:t,...n},a)=>e.jsx("td",{ref:a,className:_("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...n}));Y.displayName="TableCell";const ht=c.forwardRef(({className:t,...n},a)=>e.jsx("caption",{ref:a,className:_("mt-4 text-sm text-muted-foreground",t),...n}));ht.displayName="TableCaption";function pt(t,n,{checkForDefaultPrevented:a=!0}={}){return function(d){if(t?.(d),a===!1||!d.defaultPrevented)return n?.(d)}}var ft=Ps[" useInsertionEffect ".trim().toString()]||Rs;function es({prop:t,defaultProp:n,onChange:a=()=>{},caller:i}){const[d,l,f]=Nt({defaultProp:n,onChange:a}),x=t!==void 0,y=x?t:d;{const m=c.useRef(t!==void 0);c.useEffect(()=>{const p=m.current;p!==x&&console.warn(`${i} is changing from ${p?"controlled":"uncontrolled"} to ${x?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),m.current=x},[x,i])}const S=c.useCallback(m=>{if(x){const p=jt(m)?m(t):m;p!==t&&f.current?.(p)}else l(m)},[x,t,l,f]);return[y,S]}function Nt({defaultProp:t,onChange:n}){const[a,i]=c.useState(t),d=c.useRef(a),l=c.useRef(n);return ft(()=>{l.current=n},[n]),c.useEffect(()=>{d.current!==a&&(l.current?.(a),d.current=a)},[a,d]),[a,i,l]}function jt(t){return typeof t=="function"}var q="Accordion",gt=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[ke,bt,yt]=$s(q),[pe]=Fs(q,[yt,Je]),Ae=Je(),ss=D.forwardRef((t,n)=>{const{type:a,...i}=t,d=i,l=i;return e.jsx(ke.Provider,{scope:t.__scopeAccordion,children:a==="multiple"?e.jsx(wt,{...l,ref:n}):e.jsx(Ct,{...d,ref:n})})});ss.displayName=q;var[ts,vt]=pe(q),[as,St]=pe(q,{collapsible:!1}),Ct=D.forwardRef((t,n)=>{const{value:a,defaultValue:i,onValueChange:d=()=>{},collapsible:l=!1,...f}=t,[x,y]=es({prop:a,defaultProp:i??"",onChange:d,caller:q});return e.jsx(ts,{scope:t.__scopeAccordion,value:D.useMemo(()=>x?[x]:[],[x]),onItemOpen:y,onItemClose:D.useCallback(()=>l&&y(""),[l,y]),children:e.jsx(as,{scope:t.__scopeAccordion,collapsible:l,children:e.jsx(ns,{...f,ref:n})})})}),wt=D.forwardRef((t,n)=>{const{value:a,defaultValue:i,onValueChange:d=()=>{},...l}=t,[f,x]=es({prop:a,defaultProp:i??[],onChange:d,caller:q}),y=D.useCallback(m=>x((p=[])=>[...p,m]),[x]),S=D.useCallback(m=>x((p=[])=>p.filter(E=>E!==m)),[x]);return e.jsx(ts,{scope:t.__scopeAccordion,value:f,onItemOpen:y,onItemClose:S,children:e.jsx(as,{scope:t.__scopeAccordion,collapsible:!0,children:e.jsx(ns,{...l,ref:n})})})}),[kt,fe]=pe(q),ns=D.forwardRef((t,n)=>{const{__scopeAccordion:a,disabled:i,dir:d,orientation:l="vertical",...f}=t,x=D.useRef(null),y=Ms(x,n),S=bt(a),p=_s(d)==="ltr",E=pt(t.onKeyDown,g=>{if(!gt.includes(g.key))return;const R=g.target,I=S().filter(H=>!H.ref.current?.disabled),u=I.findIndex(H=>H.ref.current===R),C=I.length;if(u===-1)return;g.preventDefault();let h=u;const $=0,k=C-1,F=()=>{h=u+1,h>k&&(h=$)},U=()=>{h=u-1,h<$&&(h=k)};switch(g.key){case"Home":h=$;break;case"End":h=k;break;case"ArrowRight":l==="horizontal"&&(p?F():U());break;case"ArrowDown":l==="vertical"&&F();break;case"ArrowLeft":l==="horizontal"&&(p?U():F());break;case"ArrowUp":l==="vertical"&&U();break}const z=h%C;I[z].ref.current?.focus()});return e.jsx(kt,{scope:a,disabled:i,direction:d,orientation:l,children:e.jsx(ke.Slot,{scope:a,children:e.jsx(Ve.div,{...f,"data-orientation":l,ref:y,onKeyDown:i?void 0:E})})})}),ue="AccordionItem",[At,Oe]=pe(ue),rs=D.forwardRef((t,n)=>{const{__scopeAccordion:a,value:i,...d}=t,l=fe(ue,a),f=vt(ue,a),x=Ae(a),y=Ls(),S=i&&f.value.includes(i)||!1,m=l.disabled||t.disabled;return e.jsx(At,{scope:a,open:S,disabled:m,triggerId:y,children:e.jsx(Us,{"data-orientation":l.orientation,"data-state":ms(S),...x,...d,ref:n,disabled:m,open:S,onOpenChange:p=>{p?f.onItemOpen(i):f.onItemClose(i)}})})});rs.displayName=ue;var os="AccordionHeader",ls=D.forwardRef((t,n)=>{const{__scopeAccordion:a,...i}=t,d=fe(q,a),l=Oe(os,a);return e.jsx(Ve.h3,{"data-orientation":d.orientation,"data-state":ms(l.open),"data-disabled":l.disabled?"":void 0,...i,ref:n})});ls.displayName=os;var Ce="AccordionTrigger",cs=D.forwardRef((t,n)=>{const{__scopeAccordion:a,...i}=t,d=fe(q,a),l=Oe(Ce,a),f=St(Ce,a),x=Ae(a);return e.jsx(ke.ItemSlot,{scope:a,children:e.jsx(Ks,{"aria-disabled":l.open&&!f.collapsible||void 0,"data-orientation":d.orientation,id:l.triggerId,...x,...i,ref:n})})});cs.displayName=Ce;var is="AccordionContent",ds=D.forwardRef((t,n)=>{const{__scopeAccordion:a,...i}=t,d=fe(q,a),l=Oe(is,a),f=Ae(a);return e.jsx(Ws,{role:"region","aria-labelledby":l.triggerId,"data-orientation":d.orientation,...f,...i,ref:n,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});ds.displayName=is;function ms(t){return t?"open":"closed"}var Ot=ss,Dt=rs,Et=ls,xs=cs,us=ds;const we=Ot,ae=c.forwardRef(({className:t,...n},a)=>e.jsx(Dt,{ref:a,className:_("border-b",t),...n}));ae.displayName="AccordionItem";const ne=c.forwardRef(({className:t,children:n,...a},i)=>e.jsx(Et,{className:"flex",children:e.jsxs(xs,{ref:i,className:_("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",t),...a,children:[n,e.jsx(qs,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})}));ne.displayName=xs.displayName;const re=c.forwardRef(({className:t,children:n,...a},i)=>e.jsx(us,{ref:i,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...a,children:e.jsx("div",{className:_("pb-4 pt-0",t),children:n})}));re.displayName=us.displayName;const It=`I need you to extract schedule events from my course syllabus.

Return ONLY a valid JSON array with NO additional text, NO markdown code blocks, NO explanation.

Structure for each item:
{
  "type": "chapter" | "quiz" | "assignment" | "exam",
  "title": "string",
  "dueDate": "YYYY-MM-DD",
  "notes": "optional string or null"
}

Rules:
1. type must be EXACTLY one of: "chapter", "quiz", "assignment", "exam"
2. dueDate must be ISO format (YYYY-MM-DD) - if no date given, use null
3. Return ONLY the JSON array, nothing else

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,Tt=`I need you to extract learning objectives from my course material.

Return ONLY a valid JSON array with NO additional text, NO markdown code blocks, NO explanation.

Structure for each item:
{
  "loCode": "string",
  "title": "string"
}

Rules:
1. loCode: Preserve original numbering if present, or create sequential "1", "2", "3"...
2. title: Keep the objective text exactly as written
3. Return ONLY the JSON array, nothing else

Here are my learning objectives:

[PASTE YOUR LOs BELOW]`,Pt=`I need you to convert my study session notes into WRAP format.

WRAP format has 4 sections:

Section A: Obsidian Notes
- Main concepts and insights from the session
- Key points to remember

Section B: Anki Cards
- Format: "front: [question]" on one line, "back: [answer]" on next line
- Create cards for important facts and concepts

Section C: Spaced Schedule
- R1=tomorrow
- R2=3d
- R3=1w
- R4=2w

Section D: JSON Logs
\`\`\`json
{
  "merged": {
    "topic": "[main topic]",
    "mode": "Core",
    "duration_minutes": [number],
    "understanding": [1-5],
    "retention": [1-5]
  }
}
\`\`\`

Return ONLY the WRAP formatted content, NO additional text or explanation.

Here are my study notes:

[PASTE YOUR NOTES BELOW]`;function Rt(){const t=He(),[n,a]=c.useState(null),[i,d]=c.useState(null),[l,f]=c.useState(""),[x,y]=c.useState(""),[S,m]=c.useState(null),[p,E]=c.useState(""),[g,R]=c.useState(null),[I,u]=c.useState(null),{data:C=[]}=G({queryKey:["courses"],queryFn:()=>N.courses.getActive()}),{data:h=[]}=G({queryKey:["modules",n],queryFn:()=>n?N.modules.getByCourse(n):Promise.resolve([]),enabled:!!n}),{data:$=[]}=G({queryKey:["learningObjectives",n],queryFn:()=>n?N.learningObjectives.getByCourse(n):Promise.resolve([]),enabled:!!n}),k=V({mutationFn:async o=>{if(!n)throw new Error("Select a course first");const w=JSON.parse(o);return N.scheduleEvents.createBulk(n,w)},onSuccess:()=>{t.invalidateQueries({queryKey:["scheduleEvents"]}),f(""),m(null)},onError:o=>{m(o.message||"Failed to import schedule")}}),F=V({mutationFn:async o=>{if(!n)throw new Error("Select a course first");const w=JSON.parse(o);return N.learningObjectives.createBulk(n,i,w)},onSuccess:()=>{t.invalidateQueries({queryKey:["learningObjectives"]}),y(""),m(null)},onError:o=>{m(o.message||"Failed to import LOs")}}),U=V({mutationFn:({id:o,data:w})=>N.modules.update(o,w),onSuccess:()=>{t.invalidateQueries({queryKey:["modules"]})}}),z=o=>{navigator.clipboard.writeText(o)},H=async()=>{try{u(null);const o=g?await g.text():p,w=g?.name||"pasted_wrap.md",B=await N.brain.ingest(o,w);B.sessionSaved?(u({type:"success",message:`âœ“ Session saved! ID: ${B.sessionId}, Cards: ${B.cardsCreated||0}`}),E(""),R(null)):u({type:"error",message:B.errors?.join(", ")||B.message})}catch(o){u({type:"error",message:o.message||"Failed to ingest"})}};return e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"border-2 border-primary rounded-none p-4 bg-primary/5",children:[e.jsx("h2",{className:"text-xl font-arcade text-primary mb-4",children:"WRAP SESSION INGESTION"}),I&&e.jsx("div",{className:`mb-4 p-3 rounded-none font-terminal text-sm ${I.type==="success"?"bg-green-900/30 border border-green-500 text-green-400":"bg-red-900/30 border border-red-500 text-red-400"}`,children:I.message}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:()=>z(Pt),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Use ChatGPT to convert your notes to WRAP format, then paste or upload below:"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-2 font-terminal text-muted-foreground",children:"Upload WRAP File (.md, .txt)"}),e.jsx("input",{type:"file",accept:".md,.txt",onChange:o=>{R(o.target.files?.[0]||null),E(""),u(null)},className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal text-sm"}),g&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 font-terminal",children:["Selected: ",g.name]})]}),e.jsx("div",{className:"text-center font-terminal text-xs text-muted-foreground",children:"- OR -"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-2 font-terminal text-muted-foreground",children:"Paste WRAP Content"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-48 font-terminal text-sm",placeholder:"Paste your WRAP session here...",value:p,onChange:o=>{E(o.target.value),R(null),u(null)}})]}),e.jsx("button",{onClick:H,disabled:!p&&!g,className:"bg-primary hover:bg-primary/80 disabled:opacity-50 px-6 py-3 rounded-none font-arcade text-sm w-full",type:"button",children:"INGEST WRAP SESSION"})]})]}),e.jsx("h2",{className:"text-xl font-arcade text-primary",children:"MATERIAL INGESTION"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),e.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:n||"",onChange:o=>{a(o.target.value?parseInt(o.target.value):null),d(null)},children:[e.jsx("option",{value:"",children:"-- Select Course --"}),C.map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))]})]}),S&&e.jsx("div",{className:"bg-destructive/20 border border-destructive rounded-none p-3 text-destructive font-terminal",children:S}),n&&e.jsxs(we,{type:"multiple",className:"border border-secondary/40 rounded-none divide-y divide-secondary/40",children:[e.jsxs(ae,{value:"schedule",className:"border-secondary/40",children:[e.jsx(ne,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"SCHEDULE IMPORT"}),e.jsxs(re,{className:"px-3",children:[e.jsx("button",{onClick:()=>z(It),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Paste the ChatGPT response (JSON array) below:"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-32 font-terminal text-sm",placeholder:'[{"type": "exam", "title": "...", "dueDate": "2026-01-20", "notes": null}]',value:l,onChange:o=>f(o.target.value)}),e.jsx("button",{onClick:()=>k.mutate(l),disabled:!l||k.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none mt-2 font-terminal text-xs",type:"button",children:k.isPending?"Importing...":"Import Schedule"})]})]}),e.jsxs(ae,{value:"modules",className:"border-secondary/40",children:[e.jsx(ne,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"MODULES"}),e.jsx(re,{className:"px-3",children:h.length===0?e.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"No modules yet. Add modules manually or import."}):e.jsxs("table",{className:"w-full text-sm font-terminal",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-secondary/50",children:[e.jsx("th",{className:"text-left p-2",children:"Module"}),e.jsx("th",{className:"text-center p-2",children:"Files"}),e.jsx("th",{className:"text-center p-2",children:"NotebookLM"}),e.jsx("th",{className:"text-center p-2",children:"Status"})]})}),e.jsx("tbody",{children:h.map(o=>e.jsxs("tr",{className:"border-b border-secondary/30",children:[e.jsx("td",{className:"p-2",children:o.name}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"checkbox",checked:o.filesDownloaded,onChange:w=>U.mutate({id:o.id,data:{filesDownloaded:w.target.checked}})})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"checkbox",checked:o.notebooklmLoaded,onChange:w=>U.mutate({id:o.id,data:{notebooklmLoaded:w.target.checked}})})}),e.jsx("td",{className:"text-center p-2",children:o.filesDownloaded&&o.notebooklmLoaded?e.jsx("span",{className:"text-green-400",children:"Ready"}):e.jsx("span",{className:"text-yellow-400",children:"Pending"})})]},o.id))})]})})]}),e.jsxs(ae,{value:"learning-objectives",className:"border-secondary/40",children:[e.jsx(ne,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"LEARNING OBJECTIVES IMPORT"}),e.jsxs(re,{className:"px-3",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-xs mb-1 font-terminal text-muted-foreground",children:"Target Module (optional)"}),e.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:i||"",onChange:o=>d(o.target.value?parseInt(o.target.value):null),children:[e.jsx("option",{value:"",children:"-- No Module (Course-level) --"}),h.map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))]})]}),e.jsx("button",{onClick:()=>z(Tt),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Paste the ChatGPT response (JSON array) below:"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-32 font-terminal text-sm",placeholder:'[{"loCode": "1.1", "title": "Define..."}]',value:x,onChange:o=>y(o.target.value)}),e.jsx("button",{onClick:()=>F.mutate(x),disabled:!x||F.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none mt-2 font-terminal text-xs",type:"button",children:F.isPending?"Importing...":"Import LOs"}),$.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"font-terminal text-xs mb-2",children:["Current LOs (",$.length,")"]}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:$.map(o=>e.jsxs("div",{className:"text-xs py-1 border-b border-secondary/30 font-terminal",children:[e.jsx("span",{className:"text-primary",children:o.loCode}),": ",o.title,e.jsx("span",{className:`ml-2 text-[10px] px-1 rounded ${o.status==="solid"?"bg-green-600":o.status==="in_progress"?"bg-yellow-600":o.status==="need_review"?"bg-orange-600":"bg-gray-600"}`,children:o.status})]},o.id))})]})]})]})]})]})}const Ft=(t,n="MM/dd")=>{if(!t)return"-";try{const a=t instanceof Date?t:new Date(t);return nt(a)?rt(a,n):"-"}catch{return"-"}},ce=t=>{if(Array.isArray(t))return t.filter(n=>typeof n=="string");if(typeof t=="string"){const n=t.trim();if(!n)return[];try{const a=JSON.parse(n);if(Array.isArray(a))return a.filter(i=>typeof i=="string")}catch{}return n.split(",").map(a=>a.trim()).filter(Boolean)}return[]};function Vt(){const[t,n]=c.useState(new Set),[a,i]=c.useState(null),[d,l]=c.useState(!1),[f,x]=c.useState([]),[y,S]=c.useState(!1),[m,p]=c.useState(new Set),[E,g]=c.useState(null),[R,I]=c.useState({front:"",back:"",deckName:""}),[u,C]=c.useState({mode:"",minutes:"",cards:"",confusions:"",weakAnchors:"",concepts:"",issues:"",notes:""}),[h,$]=c.useState("School"),[k,F]=c.useState(null),[U,z]=c.useState(""),[H,o]=c.useState(!1),[w,B]=c.useState(!1),hs=[{name:"EBP",path:"School/Evidence Based Practice"},{name:"ExPhys",path:"School/Exercise Physiology"},{name:"MS1",path:"School/Movement Science 1"},{name:"Neuro",path:"School/Neuroscience"},{name:"TI",path:"School/Theraputic Intervention"}],{data:J=[],isLoading:ps}=G({queryKey:["sessions"],queryFn:N.sessions.getAll}),{data:v,isLoading:De}=G({queryKey:["brain","metrics"],queryFn:N.brain.getMetrics}),oe=He(),Ne=V({mutationFn:s=>N.sessions.deleteMany(s),onSuccess:()=>{oe.invalidateQueries({queryKey:["sessions"]}),oe.invalidateQueries({queryKey:["brain","metrics"]}),n(new Set)}}),fs=V({mutationFn:({id:s,updates:r})=>N.sessions.update(s,r),onSuccess:()=>{oe.invalidateQueries({queryKey:["sessions"]}),oe.invalidateQueries({queryKey:["brain","metrics"]}),i(null)}}),Ns=s=>{n(r=>{const b=new Set(r);return b.has(s)?b.delete(s):b.add(s),b})},js=()=>{t.size===J.length?n(new Set):n(new Set(J.map(s=>s.id)))},gs=()=>{t.size!==0&&(x(Array.from(t)),l(!0))},bs=s=>{x([s]),l(!0)},ys=()=>{Ne.mutate(f),l(!1),x([])};c.useEffect(()=>{if(a!==null){const s=J.find(r=>r.id===a);s&&C({mode:s.mode||"",minutes:s.minutes?.toString()||"",cards:s.cards?.toString()||"",confusions:ce(s.confusions).join(", "),weakAnchors:ce(s.weakAnchors).join(", "),concepts:ce(s.concepts).join(", "),issues:ce(s.issues).join(", "),notes:s.notes||""})}},[a,J]);const vs=()=>{if(a===null)return;const s=M=>M?M.split(",").map(ee=>ee.trim()).filter(Boolean):[],r=M=>M.length?JSON.stringify(M):null,b={mode:u.mode||"study",minutes:parseInt(u.minutes)||0,cards:parseInt(u.cards)||0,confusions:r(s(u.confusions)),weakAnchors:r(s(u.weakAnchors)),concepts:r(s(u.concepts)),issues:r(s(u.issues)),notes:u.notes||null};fs.mutate({id:a,updates:b})},{data:Q}=G({queryKey:["obsidian","status"],queryFn:N.obsidian.getStatus,refetchInterval:3e4}),{data:Ss,refetch:Mt}=G({queryKey:["obsidian","files",h],queryFn:()=>N.obsidian.getFiles(h),enabled:Q?.connected===!0}),Cs=async s=>{try{const r=await N.obsidian.getFile(s);r.success&&r.content!==void 0&&(F(s),z(r.content),B(!1))}catch(r){console.error("Failed to load file:",r)}},ws=async()=>{if(k){o(!0);try{(await N.obsidian.saveFile(k,U)).success&&B(!1)}catch(s){console.error("Failed to save file:",s)}finally{o(!1)}}},le=s=>{$(s),F(null),z("")},ks=()=>{const s=new Date().toISOString().split("T")[0],r=h?`${h}/Session-${s}.md`:`Session-${s}.md`,b=`# Study Session - ${s}

## Summary


## Concepts Covered
- 

## Strengths
- 

## Areas to Review
- 

## Notes

`;F(r),z(b),B(!0)},{data:K,isLoading:As,refetch:Ee}=G({queryKey:["anki","status"],queryFn:N.anki.getStatus,refetchInterval:3e4}),{data:Os}=G({queryKey:["anki","due"],queryFn:N.anki.getDue,enabled:K?.connected===!0}),{data:Ds=[],refetch:ie}=G({queryKey:["anki","drafts"],queryFn:N.anki.getDrafts}),X=Ds.filter(s=>s.status==="pending"),Es=(v?.issuesLog||[]).reduce((s,r)=>s+r.count,0),je=V({mutationFn:N.anki.sync,onSuccess:()=>{oe.invalidateQueries({queryKey:["anki"]}),ie()}}),Ie=V({mutationFn:s=>N.anki.approveDraft(s),onSuccess:()=>{ie()}}),Te=V({mutationFn:s=>N.anki.deleteDraft(s),onSuccess:()=>{ie()}}),ge=V({mutationFn:({id:s,data:r})=>N.anki.updateDraft(s,r),onSuccess:()=>{ie(),g(null)}}),Is=s=>{g(s.id),I({front:s.front,back:s.back,deckName:s.deckName})},Ts=()=>{E!==null&&ge.mutate({id:E,data:R})};return e.jsxs(zs,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h1",{className:"font-arcade text-xl text-primary flex items-center gap-2",children:[e.jsx(Bs,{className:"w-6 h-6"}),"BRAIN ANALYTICS"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4",children:[e.jsxs(A,{className:"brain-card-strong rounded-none",children:[e.jsx(T,{className:"p-3 border-b border-[#3a0a0a]",children:e.jsx(P,{className:"font-arcade text-[10px] text-muted-foreground",children:"TOTAL SESSIONS"})}),e.jsxs(O,{className:"p-4",children:[e.jsx("div",{className:"font-arcade text-2xl text-primary","data-testid":"text-total-sessions",children:v?.totalSessions||0}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mt-1",children:"Logged sessions"})]})]}),e.jsxs(A,{className:"brain-card-strong rounded-none",children:[e.jsx(T,{className:"p-3 border-b border-[#3a0a0a]",children:e.jsx(P,{className:"font-arcade text-[10px] text-muted-foreground",children:"STUDY MINUTES"})}),e.jsxs(O,{className:"p-4",children:[e.jsx("div",{className:"font-arcade text-2xl text-primary","data-testid":"text-total-minutes",children:v?.totalMinutes||0}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mt-1",children:"Total tracked time"})]})]}),e.jsxs(A,{className:"brain-card-strong rounded-none",children:[e.jsx(T,{className:"p-3 border-b border-[#3a0a0a]",children:e.jsx(P,{className:"font-arcade text-[10px] text-muted-foreground",children:"CARDS REVIEWED"})}),e.jsxs(O,{className:"p-4",children:[e.jsx("div",{className:"font-arcade text-2xl text-primary","data-testid":"text-total-cards",children:v?.totalCards||0}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mt-1",children:"Anki totals"})]})]}),e.jsxs(A,{className:"brain-card-strong rounded-none",children:[e.jsx(T,{className:"p-3 border-b border-[#3a0a0a]",children:e.jsx(P,{className:"font-arcade text-[10px] text-muted-foreground",children:"ISSUES LOGGED"})}),e.jsxs(O,{className:"p-4",children:[e.jsx("div",{className:"font-arcade text-2xl text-orange-400",children:Es}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mt-1",children:"Failures + blockers"})]})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6 mb-6 items-start",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"SESSION EVIDENCE"}),e.jsxs(A,{className:"brain-card rounded-none",children:[e.jsx(T,{className:"border-b border-secondary/60 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(P,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(it,{className:"w-4 h-4"}),"SESSION EVIDENCE TABLE"]}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mt-1",children:"Raw WRAP data. All metrics derive from these fields."})]}),t.size>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-terminal text-xs text-muted-foreground",children:[t.size," selected"]}),e.jsxs(j,{size:"sm",variant:"destructive",className:"font-terminal text-xs rounded-none",onClick:gs,disabled:Ne.isPending,children:[e.jsx(se,{className:"w-3 h-3 mr-1"}),Ne.isPending?"Deleting...":"Delete"]})]})]})}),e.jsx(O,{className:"p-0",children:ps?e.jsx("div",{className:"p-8 text-center font-terminal text-muted-foreground",children:"LOADING..."}):J.length===0?e.jsx("div",{className:"p-8 text-center font-terminal text-muted-foreground",children:"NO SESSIONS YET"}):e.jsx(be,{className:"h-[360px] xl:h-[420px]",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Qe,{className:"min-w-[620px]",children:[e.jsx(Xe,{children:e.jsxs(Se,{className:"border-secondary/60 hover:bg-transparent",children:[e.jsx(W,{className:"w-10 px-2 py-2",children:e.jsx(ve,{checked:t.size===J.length&&J.length>0,onCheckedChange:js,className:"border-primary data-[state=checked]:bg-primary"})}),e.jsx(W,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"DATE"}),e.jsx(W,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"COURSE"}),e.jsx(W,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"MODE"}),e.jsx(W,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"MIN"}),e.jsx(W,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"CARDS"}),e.jsx(W,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"CONFUSIONS"}),e.jsx(W,{className:"font-arcade text-[10px] text-primary w-10 px-2 py-2",children:"ACTIONS"})]})}),e.jsx(Ze,{children:J.map(s=>e.jsxs(Se,{className:"border-secondary/50 hover:bg-primary/10 font-terminal text-xs","data-testid":`row-session-${s.id}`,children:[e.jsx(Y,{className:"px-2 py-2",children:e.jsx(ve,{checked:t.has(s.id),onCheckedChange:()=>Ns(s.id),className:"border-secondary data-[state=checked]:bg-primary"})}),e.jsx(Y,{className:"text-muted-foreground px-2 py-2",children:Ft(s.date)}),e.jsx(Y,{className:"font-bold px-2 py-2",children:s.topic||"-"}),e.jsx(Y,{className:"px-2 py-2",children:e.jsx(te,{variant:"outline",className:"rounded-none border-secondary font-normal text-[10px]",children:s.mode})}),e.jsx(Y,{className:"px-2 py-2",children:s.minutes||0}),e.jsx(Y,{className:"px-2 py-2",children:s.cards||0}),e.jsx(Y,{className:"max-w-[150px] truncate text-[10px] text-muted-foreground px-2 py-2",children:ce(s.confusions).join(", ")||"-"}),e.jsx(Y,{className:"px-2 py-2",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(j,{size:"icon",variant:"ghost",className:"h-6 w-6 rounded-none hover:bg-primary/20",onClick:()=>i(s.id),title:"Edit session",children:e.jsx(me,{className:"w-3 h-3"})}),e.jsx(j,{size:"icon",variant:"ghost",className:"h-6 w-6 rounded-none hover:bg-destructive/20 text-destructive",onClick:()=>bs(s.id),title:"Delete session",children:e.jsx(se,{className:"w-3 h-3"})})]})})]},s.id))})]})})})})]})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"DERIVED METRICS"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs(A,{className:"brain-card rounded-none",children:[e.jsx(T,{className:"border-b border-secondary p-3",children:e.jsxs(P,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(lt,{className:"w-3 h-3"}),"SESSIONS PER COURSE"]})}),e.jsx(O,{className:"p-3 max-h-[200px] overflow-y-auto",children:De?e.jsx("div",{className:"text-center font-terminal text-xs text-muted-foreground",children:"LOADING..."}):(v?.sessionsPerCourse||[]).length===0?e.jsx("div",{className:"text-center font-terminal text-xs text-muted-foreground py-4",children:"NO DATA"}):e.jsx("div",{className:"space-y-2",children:v?.sessionsPerCourse.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between font-terminal text-xs",children:[e.jsx("span",{className:"truncate max-w-[120px]",children:s.course}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-primary",children:[s.count," sess"]}),e.jsxs("span",{className:"text-muted-foreground",children:[s.minutes," min"]})]})]},r))})})]}),e.jsxs(A,{className:"brain-card rounded-none",children:[e.jsx(T,{className:"border-b border-secondary p-3",children:e.jsxs(P,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(Ye,{className:"w-3 h-3"}),"MODE DISTRIBUTION"]})}),e.jsx(O,{className:"p-3 max-h-[200px] overflow-y-auto",children:De?e.jsx("div",{className:"text-center font-terminal text-xs text-muted-foreground",children:"LOADING..."}):(v?.modeDistribution||[]).length===0?e.jsx("div",{className:"text-center font-terminal text-xs text-muted-foreground py-4",children:"NO DATA"}):e.jsx("div",{className:"space-y-2",children:v?.modeDistribution.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between font-terminal text-xs",children:[e.jsx(te,{variant:"outline",className:"rounded-none border-secondary",children:s.mode}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-primary",children:[s.count," sess"]}),e.jsxs("span",{className:"text-muted-foreground",children:[s.minutes," min"]})]})]},r))})})]}),e.jsxs(A,{className:"brain-card rounded-none",children:[e.jsx(T,{className:"border-b border-secondary p-3",children:e.jsxs(P,{className:"font-arcade text-xs flex items-center gap-2 text-orange-400",children:[e.jsx(Ue,{className:"w-3 h-3"}),"REPEATED CONFUSIONS"]})}),e.jsx(O,{className:"p-3 max-h-[200px] overflow-y-auto",children:(v?.recentConfusions||[]).length===0?e.jsx("div",{className:"text-center font-terminal text-xs text-muted-foreground py-4",children:"NO CONFUSIONS LOGGED"}):e.jsx("div",{className:"space-y-1",children:v?.recentConfusions.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between font-terminal text-xs",children:[e.jsx("span",{className:"truncate max-w-[150px] text-orange-300",children:s.text}),e.jsxs("span",{className:"text-muted-foreground",children:["x",s.count]})]},r))})})]}),e.jsxs(A,{className:"brain-card rounded-none",children:[e.jsx(T,{className:"border-b border-secondary p-3",children:e.jsxs(P,{className:"font-arcade text-xs flex items-center gap-2",children:[e.jsx(st,{className:"w-3 h-3"}),"CONCEPT FREQUENCY"]})}),e.jsx(O,{className:"p-3 max-h-[200px] overflow-y-auto",children:(v?.conceptFrequency||[]).length===0?e.jsx("div",{className:"text-center font-terminal text-xs text-muted-foreground py-4",children:"NO CONCEPTS LOGGED"}):e.jsx("div",{className:"flex flex-wrap gap-1",children:v?.conceptFrequency.slice(0,15).map((s,r)=>e.jsxs(te,{variant:"outline",className:"rounded-none border-secondary font-terminal text-xs",children:[s.concept," (",s.count,")"]},r))})})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"ISSUES LOG"}),e.jsxs(A,{className:"brain-card rounded-none",children:[e.jsxs(T,{className:"border-b border-secondary p-4",children:[e.jsxs(P,{className:"font-arcade text-sm flex items-center gap-2 text-red-400",children:[e.jsx(Ue,{className:"w-4 h-4"}),"ISSUES AND FAILURES LOG"]}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mt-1",children:"Aggregated session issues: interruptions, source-lock failures, workflow problems"})]}),e.jsx(O,{className:"p-4",children:(v?.issuesLog||[]).length===0?e.jsx("div",{className:"text-center font-terminal text-muted-foreground py-8",children:"NO ISSUES LOGGED"}):e.jsx("div",{className:"space-y-2",children:v?.issuesLog.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 border border-red-500/30 bg-red-500/5 font-terminal text-sm",children:[e.jsx("span",{className:"text-red-300",children:s.issue}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:s.course}),e.jsxs(te,{variant:"outline",className:"rounded-none border-red-500/50 text-red-400",children:["x",s.count]})]})]},r))})})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"SYSTEM STATUS"}),e.jsx(A,{className:"brain-card rounded-none",children:e.jsx(O,{className:"p-3",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3 font-terminal text-xs",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${Q?.connected?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-muted-foreground",children:"Obsidian"}),e.jsx("span",{className:"text-primary",children:Q?.connected?"Online":"Offline"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${K?.connected?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-muted-foreground",children:"Anki"}),e.jsx("span",{className:"text-primary",children:K?.connected?"Connected":"Offline"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-muted-foreground",children:[e.jsxs("span",{children:["Cards: ",e.jsx("span",{className:"text-primary",children:v?.totalCards||0})]}),e.jsxs("span",{children:["Drafts: ",e.jsx("span",{className:"text-primary",children:X.length})]})]})]})})})]}),e.jsx(we,{type:"single",collapsible:!0,className:"border border-secondary/40 rounded-none",children:e.jsxs(ae,{value:"ingestion",className:"border-secondary/40",children:[e.jsx(ne,{className:"font-arcade text-sm text-primary px-4 hover:no-underline",children:"DATA INGESTION TOOLS"}),e.jsx(re,{className:"px-2",children:e.jsx("div",{className:"pt-2",children:e.jsx(Rt,{})})})]})}),e.jsx(we,{type:"single",collapsible:!0,className:"border border-secondary/40 rounded-none",children:e.jsxs(ae,{value:"integrations",className:"border-secondary/40",children:[e.jsx(ne,{className:"font-arcade text-sm text-primary px-4 hover:no-underline",children:"INTEGRATIONS"}),e.jsx(re,{className:"px-2",children:e.jsxs("div",{className:"space-y-4 pt-2 min-w-0",children:[e.jsxs(A,{className:"brain-card rounded-none",children:[e.jsxs(T,{className:"border-b border-secondary/50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(P,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(tt,{className:"w-4 h-4"}),"OBSIDIAN VAULT",Q?.connected?e.jsx(xe,{className:"w-3 h-3 text-green-500"}):e.jsx(de,{className:"w-3 h-3 text-red-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(j,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:ks,disabled:!Q?.connected,children:[e.jsx(at,{className:"w-3 h-3 mr-1"}),"New Note"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y,onChange:s=>S(s.target.checked),disabled:!Q?.connected,className:"w-4 h-4 accent-primary"}),e.jsx("span",{className:"font-terminal text-xs",children:"Auto-Sync"})]})]})]}),e.jsx("div",{className:"flex items-center gap-1 mt-2 flex-wrap",children:hs.map(s=>e.jsx(j,{size:"sm",variant:h===s.path?"default":"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:()=>le(s.path),children:s.name},s.path))}),h&&e.jsxs("div",{className:"flex items-center gap-1 mt-2 font-terminal text-xs text-muted-foreground",children:[e.jsx("button",{onClick:()=>le(""),className:"hover:text-primary",children:"vault"}),h.split("/").map((s,r,b)=>e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Gs,{className:"w-3 h-3"}),e.jsx("button",{onClick:()=>le(b.slice(0,r+1).join("/")),className:"hover:text-primary",children:s})]},r))]})]}),e.jsx(O,{className:"p-0",children:Q?.connected?e.jsxs("div",{className:"grid md:grid-cols-2 h-[240px] md:h-[300px]",children:[e.jsx("div",{className:"border-r border-secondary/30",children:e.jsx(be,{className:"h-[240px] md:h-[300px]",children:e.jsxs("div",{className:"p-2 space-y-1",children:[h&&e.jsxs("button",{onClick:()=>{const s=h.split("/");s.pop(),le(s.join("/"))},className:"w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs text-muted-foreground",children:[e.jsx(Ke,{className:"w-3 h-3"}),".."]}),Ss?.files?.map(s=>{const r=typeof s=="string"?s:s.path,b=r.endsWith("/"),M=r.replace(/\/$/,"").split("/").pop()||r;return e.jsxs("button",{onClick:()=>{if(b){const ee=M.replace(/\/$/,"");le(h?`${h}/${ee}`:ee)}else{const ee=h?`${h}/${M}`:M;Cs(ee)}},className:`w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs ${k?.endsWith(M)?"bg-primary/20 text-primary":""}`,children:[b?e.jsx(Ke,{className:"w-3 h-3 text-yellow-500"}):e.jsx(mt,{className:"w-3 h-3 text-blue-400"}),M]},r)})]})})}),e.jsx("div",{className:"flex flex-col h-[240px] md:h-[300px]",children:k?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-secondary/30",children:[e.jsxs("span",{className:"font-terminal text-xs text-primary truncate",children:[k.split("/").pop(),w&&e.jsx("span",{className:"text-yellow-500 ml-1",children:"*"})]}),e.jsxs(j,{size:"sm",variant:"ghost",onClick:ws,disabled:!w||H,className:"h-6 px-2",children:[e.jsx(ye,{className:"w-3 h-3 mr-1"}),H?"Saving...":"Save"]})]}),e.jsx("textarea",{value:U,onChange:s=>{z(s.target.value),B(!0)},className:"flex-1 w-full p-3 bg-black/60 font-terminal text-sm resize-none focus:outline-none focus:ring-1 focus:ring-primary",placeholder:"File content..."})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center font-terminal text-xs text-muted-foreground",children:"Select a file to edit"})})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("p",{className:"font-terminal text-xs text-red-400 mb-2",children:"Obsidian Offline"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Obsidian with Local REST API plugin enabled"})]})})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs(A,{className:"brain-card rounded-none",children:[e.jsx(T,{className:"border-b border-secondary/50 p-3",children:e.jsxs(P,{className:"font-arcade text-xs flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ye,{className:"w-3 h-3"}),"ANKI INTEGRATION",K?.connected?e.jsx(xe,{className:"w-3 h-3 text-green-500 ml-auto"}):e.jsx(de,{className:"w-3 h-3 text-red-500 ml-auto"})]})}),e.jsx(O,{className:"p-4 space-y-3",children:As?e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Checking Anki..."}):K?.connected?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Status:"}),e.jsx(te,{variant:"outline",className:"bg-green-500/20 text-green-400 border-green-500",children:"Connected"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Cards Created:"}),e.jsx("span",{className:"font-arcade text-xs text-primary",children:v?.totalCards||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Due Today:"}),e.jsx("span",{className:"font-arcade text-xs text-secondary",children:Os?.dueCount||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Reviewed Today:"}),e.jsx("span",{className:"font-arcade text-xs text-muted-foreground",children:K.reviewedToday||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Decks:"}),e.jsx("span",{className:"font-arcade text-xs text-muted-foreground",children:K.decks?.length||0})]}),e.jsxs("div",{className:"pt-2 flex gap-2",children:[e.jsxs(j,{size:"sm",variant:"outline",className:"flex-1 font-terminal text-xs",onClick:()=>Ee(),children:[e.jsx(We,{className:"w-3 h-3 mr-1"}),"Refresh"]}),e.jsx(j,{size:"sm",className:"flex-1 font-terminal text-xs bg-secondary hover:bg-secondary/80",onClick:()=>je.mutate(),disabled:je.isPending,children:je.isPending?"Syncing...":"Sync Cards"})]}),X.length>0&&e.jsxs("div",{className:"pt-3 border-t border-secondary/30",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-arcade text-[10px] text-yellow-400",children:["PENDING CARDS (",X.length,")"]}),e.jsx("div",{className:"flex gap-1",children:e.jsx(j,{size:"sm",variant:"outline",className:"h-5 px-2 text-[10px] font-terminal",onClick:()=>{m.size===X.length?p(new Set):p(new Set(X.map(s=>s.id)))},children:m.size===X.length?"None":"All"})})]}),m.size>0&&e.jsxs("div",{className:"flex gap-1 mb-2",children:[e.jsxs(j,{size:"sm",className:"h-6 px-2 text-[10px] font-terminal bg-green-600 hover:bg-green-700",onClick:()=>{m.forEach(s=>Ie.mutate(s)),p(new Set)},children:[e.jsx(xe,{className:"w-3 h-3 mr-1"}),"Approve (",m.size,")"]}),e.jsxs(j,{size:"sm",variant:"destructive",className:"h-6 px-2 text-[10px] font-terminal",onClick:()=>{m.forEach(s=>Te.mutate(s)),p(new Set)},children:[e.jsx(se,{className:"w-3 h-3 mr-1"}),"Delete (",m.size,")"]})]}),e.jsx(be,{className:"h-[200px]",children:e.jsx("div",{className:"space-y-2",children:X.map(s=>e.jsx("div",{className:`p-2 bg-black/40 border text-xs ${m.has(s.id)?"border-primary":"border-secondary/30"}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ve,{checked:m.has(s.id),onCheckedChange:r=>{const b=new Set(m);r?b.add(s.id):b.delete(s.id),p(b)},className:"mt-1 border-secondary data-[state=checked]:bg-primary"}),e.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[e.jsx("div",{className:"font-terminal text-primary truncate",children:s.front}),e.jsx("div",{className:"font-terminal text-muted-foreground mt-1 truncate",children:s.back}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(te,{variant:"outline",className:"text-[9px] border-blue-500/50 text-blue-400 shrink-0",children:s.deckName}),e.jsx(j,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-yellow-500/50 text-yellow-400 hover:bg-yellow-500/20",onClick:()=>Is(s),title:"Edit card",children:e.jsx(me,{className:"w-3 h-3"})}),e.jsx(j,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-green-500/50 text-green-400 hover:bg-green-500/20",onClick:()=>Ie.mutate(s.id),title:"Approve card",children:e.jsx(xe,{className:"w-3 h-3"})}),e.jsx(j,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-red-500/50 text-red-400 hover:bg-red-500/20",onClick:()=>Te.mutate(s.id),title:"Delete card",children:e.jsx(se,{className:"w-3 h-3"})})]})]})]})},s.id))})})]})]}):e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"font-terminal text-xs text-red-400",children:K?.error||"Anki not connected"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Anki with AnkiConnect plugin"}),e.jsxs(j,{size:"sm",variant:"outline",className:"font-terminal text-xs",onClick:()=>Ee(),children:[e.jsx(We,{className:"w-3 h-3 mr-1"}),"Retry"]})]})})]})})]})})]})})]})]}),e.jsx(Pe,{open:a!==null,onOpenChange:()=>i(null),children:e.jsxs(Re,{className:"bg-black border-2 border-primary rounded-none max-w-2xl",children:[e.jsxs(Fe,{children:[e.jsxs(Me,{className:"font-arcade text-primary flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5"}),"EDIT SESSION #",a]}),e.jsx(Le,{className:"font-terminal text-muted-foreground",children:"Update WRAP methodology fields for this study session"})]}),e.jsxs("div",{className:"space-y-4 font-terminal",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Mode"}),e.jsxs(ze,{value:u.mode,onValueChange:s=>C(r=>({...r,mode:s})),children:[e.jsx(Be,{className:"rounded-none border-secondary",children:e.jsx(Ge,{placeholder:"Select mode"})}),e.jsxs($e,{className:"rounded-none border-secondary bg-black",children:[e.jsx(L,{value:"Core",children:"Core"}),e.jsx(L,{value:"Sprint",children:"Sprint"}),e.jsx(L,{value:"Drill",children:"Drill"}),e.jsx(L,{value:"study",children:"Study"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Minutes"}),e.jsx(_e,{type:"number",value:u.minutes,onChange:s=>C(r=>({...r,minutes:s.target.value})),className:"rounded-none border-secondary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Cards"}),e.jsx(_e,{type:"number",value:u.cards,onChange:s=>C(r=>({...r,cards:s.target.value})),className:"rounded-none border-secondary"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Confusions (comma-separated)"}),e.jsx(Z,{value:u.confusions,onChange:s=>C(r=>({...r,confusions:s.target.value})),placeholder:"e.g., muscle insertion points, nerve pathways",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Weak Anchors (comma-separated)"}),e.jsx(Z,{value:u.weakAnchors,onChange:s=>C(r=>({...r,weakAnchors:s.target.value})),placeholder:"e.g., brachial plexus diagram, ROM measurements",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Concepts (comma-separated)"}),e.jsx(Z,{value:u.concepts,onChange:s=>C(r=>({...r,concepts:s.target.value})),placeholder:"e.g., upper extremity anatomy, peripheral nerves",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Issues (comma-separated)"}),e.jsx(Z,{value:u.issues,onChange:s=>C(r=>({...r,issues:s.target.value})),placeholder:"e.g., interrupted by phone, lost focus after 30 min",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Notes"}),e.jsx(Z,{value:u.notes,onChange:s=>C(r=>({...r,notes:s.target.value})),placeholder:"Free-form observations about the session",className:"rounded-none border-secondary min-h-[80px]"})]})]}),e.jsxs(qe,{className:"gap-2",children:[e.jsxs(j,{variant:"outline",onClick:()=>i(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(j,{onClick:vs,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})}),e.jsx(Ys,{open:d,onOpenChange:l,children:e.jsxs(Vs,{className:"bg-black border-2 border-destructive rounded-none",children:[e.jsxs(Hs,{children:[e.jsxs(Js,{className:"font-arcade text-destructive flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"CONFIRM DELETE"]}),e.jsxs(Qs,{className:"font-terminal text-muted-foreground",children:["Are you sure you want to delete ",f.length," session",f.length!==1?"s":"","? This action cannot be undone."]})]}),e.jsxs(Xs,{className:"gap-2",children:[e.jsx(Zs,{className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:"Cancel"}),e.jsxs(et,{onClick:ys,className:"font-terminal rounded-none bg-destructive hover:bg-destructive/80 text-destructive-foreground",children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})}),e.jsx(Pe,{open:E!==null,onOpenChange:()=>g(null),children:e.jsxs(Re,{className:"bg-black border-2 border-primary rounded-none max-w-lg",style:{top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:[e.jsxs(Fe,{children:[e.jsxs(Me,{className:"font-arcade text-primary flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5"}),"EDIT CARD"]}),e.jsx(Le,{className:"font-terminal text-muted-foreground",children:"Edit card content and select target deck"})]}),e.jsxs("div",{className:"space-y-4 font-terminal",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Front (Question)"}),e.jsx(Z,{value:R.front,onChange:s=>I(r=>({...r,front:s.target.value})),placeholder:"Card front...",className:"rounded-none border-secondary min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Back (Answer)"}),e.jsx(Z,{value:R.back,onChange:s=>I(r=>({...r,back:s.target.value})),placeholder:"Card back...",className:"rounded-none border-secondary min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Target Deck"}),e.jsxs(ze,{value:R.deckName,onValueChange:s=>I(r=>({...r,deckName:s})),children:[e.jsx(Be,{className:"rounded-none border-secondary",children:e.jsx(Ge,{placeholder:"Select deck"})}),e.jsxs($e,{className:"rounded-none border-secondary bg-black max-h-[200px]",children:[e.jsx(L,{value:"PT::EBP",children:"PT::EBP (Evidence Based Practice)"}),e.jsx(L,{value:"PT::ExPhys",children:"PT::ExPhys (Exercise Physiology)"}),e.jsx(L,{value:"PT::MS1",children:"PT::MS1 (Movement Science 1)"}),e.jsx(L,{value:"PT::Neuro",children:"PT::Neuro (Neuroscience)"}),e.jsx(L,{value:"PT::TI",children:"PT::TI (Therapeutic Intervention)"}),e.jsx(L,{value:"PT::General",children:"PT::General"}),K?.decks?.filter(s=>!s.startsWith("PT::")).map(s=>e.jsx(L,{value:s,children:s},s))]})]}),e.jsxs("p",{className:"text-[10px] text-muted-foreground mt-1",children:["Current: ",e.jsx("span",{className:"text-blue-400",children:R.deckName})]})]})]}),e.jsxs(qe,{className:"gap-2",children:[e.jsxs(j,{variant:"outline",onClick:()=>g(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(j,{onClick:Ts,disabled:ge.isPending,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),ge.isPending?"Saving...":"Save"]})]})]})})]})}export{Vt as default};

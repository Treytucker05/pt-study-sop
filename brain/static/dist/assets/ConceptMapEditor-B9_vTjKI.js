import{c as He,r as k,e as Up,j as C,b as Ie,Q as dy,T as ly,n as Wp,k as fy,U as Tt}from"./index-BID7ab5p.js";import{c as hy,l as py,g as gy,e as vy,T as my}from"./tldraw-Y1H4hpp7.js";import{p as Yp,I as yy,B as ue,s as Kp,t as by,m as xy}from"./layout-4DYjI_zh.js";import{D as Zp,t as _y,A as wy,M as Ey,a as Cy}from"./brain-CaobnYHi.js";import{c as Sy,i as Pu,a as Ou,b as Ny,d as ju,s as zt,p as Xp,z as Qp,e as Ry,f as Jp,g as gr,t as qy}from"./zoom-DwwqPMg_.js";import{P as eg}from"./plus-LiqvGh76.js";import{F as Iy}from"./file-text-BCrkJyS5.js";import"./select-BvJ7WKNL.js";import"./index-BxPEUxV4.js";import"./tabs-CVz8BX56.js";import"./badge-CcTFf_YK.js";import"./circle-check-v319zo1o.js";import"./triangle-alert-B3dG20RP.js";import"./star-sSoEkJAo.js";import"./search-Bbic561a.js";import"./index-CHuef4uV.js";import"./message-square-DiM1-pB7.js";import"./loader-circle-CqU1emy_.js";import"./send-CAZcypFw.js";import"./checkbox-DnyadyCs.js";import"./external-link-Bxh1F3uD.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const My=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],Ay=He("arrow-left-right",My);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ky=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],Ty=He("arrow-up-down",ky);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Py=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 15h10",key:"jfw4w8"}],["path",{d:"m9 18 3-3-3-3",key:"112psh"}]],Oy=He("file-input",Py);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jy=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m8 11 4 4 4-4",key:"1dohi6"}],["path",{d:"M8 5H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-4",key:"1ywtjm"}]],tg=He("import",jy);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dy=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Ly=He("layout-grid",Dy);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const By=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Fy=He("palette",By);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hy=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]],zy=He("redo-2",Hy);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $y=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],Vy=He("undo-2",$y);function Gy({className:e,initialSnapshot:t,initialTitle:r="Untitled",onImportMermaid:i}){const n=k.useMemo(()=>hy(),[]),o=k.useRef(null),[a,s]=k.useState(r),[c,u]=k.useState(!1),[d,l]=k.useState(!1),[f,h]=k.useState(""),m=k.useRef(!1),{toast:v}=Up();k.useEffect(()=>{if(t){m.current=!0;try{py(n,t),u(!1)}catch(S){console.error("Failed to load tldraw snapshot:",S)}finally{m.current=!1}}},[t,n]),k.useEffect(()=>n.listen(()=>{m.current||u(!0)}),[n]);const g=k.useCallback(async()=>{const S=gy(n),N=`Concept Maps/${((a||"Untitled").trim()||"Untitled").replace(/[/\\?%*:|"<>]/g,"-")}.tldraw.json`;try{await Yp.obsidian.saveFile(N,JSON.stringify(S,null,2)),u(!1),v({title:"Freehand map saved",description:N})}catch(q){v({title:"Save failed",description:String(q),variant:"destructive"})}},[n,a,v]),y=k.useCallback(S=>{o.current=S,S.user.updateUserPreferences({colorScheme:"dark"})},[]),b=n.getCanUndo(),p=n.getCanRedo(),x=k.useCallback(()=>n.undo(),[n]),E=k.useCallback(()=>n.redo(),[n]),_=k.useCallback(async()=>{const S=o.current;if(!S){v({title:"Export failed",description:"Editor not ready",variant:"destructive"});return}const R=Array.from(S.getCurrentPageShapeIds());if(R.length===0){v({title:"Nothing to export",description:"Add shapes to the canvas first",variant:"destructive"});return}try{const M=await vy({editor:S,ids:R,format:"png",opts:{scale:1,background:!0}}),N=URL.createObjectURL(M),q=document.createElement("a");q.href=N,q.download=`${(a||"concept-map").replace(/[/\\?%*:|"<>]/g,"-")}.png`,q.click(),URL.revokeObjectURL(N),v({title:"PNG exported"})}catch(M){v({title:"Export failed",description:String(M),variant:"destructive"})}},[a,v]),w=k.useCallback(()=>{const S=f.trim();S&&i&&(i(S),l(!1),h(""))},[f,i]);return C.jsxs("div",{className:Ie("flex flex-col h-full",e),children:[C.jsxs("div",{className:"section-block section-block-gap shrink-0 flex-row flex-wrap gap-2 items-center border-primary/20",children:[C.jsx(yy,{value:a,onChange:S=>s(S.target.value),placeholder:"Map title...",className:"h-9 min-w-[180px] text-sm font-terminal bg-black/40 border-primary/20 rounded-none flex-1 max-w-[240px]"}),C.jsxs("div",{className:"flex items-center gap-1",children:[C.jsx(ue,{size:"sm",variant:"ghost",className:"h-9 px-2 rounded-none font-terminal text-xs border border-transparent",onClick:x,disabled:!b,title:"Undo",children:C.jsx(Vy,{className:"w-3.5 h-3.5"})}),C.jsx(ue,{size:"sm",variant:"ghost",className:"h-9 px-2 rounded-none font-terminal text-xs",onClick:E,disabled:!p,title:"Redo",children:C.jsx(zy,{className:"w-3.5 h-3.5"})})]}),C.jsx("div",{className:"w-px h-5 bg-primary/20"}),C.jsxs(ue,{size:"sm",variant:"ghost",className:"h-9 px-2 rounded-none font-terminal text-xs",onClick:_,title:"Export PNG",children:[C.jsx(Zp,{className:"w-3.5 h-3.5 mr-1"}),"PNG"]}),C.jsxs(ue,{size:"sm",variant:"ghost",className:"h-9 px-2 rounded-none font-terminal text-xs",onClick:g,title:"Save to vault",children:[C.jsx(Kp,{className:"w-3.5 h-3.5 mr-1"}),"Save"]}),i&&C.jsxs(ue,{size:"sm",variant:"ghost",className:"h-9 px-2 rounded-none font-terminal text-xs",onClick:()=>l(!0),title:"Import Mermaid (switch to Structured)",children:[C.jsx(Oy,{className:"w-3.5 h-3.5 mr-1"}),"Import Mermaid"]}),C.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-terminal text-muted-foreground ml-auto",children:[C.jsx("span",{className:Ie("w-2 h-2 rounded-full shrink-0",c?"bg-red-500":"bg-green-500")}),c?"Unsaved":"Saved"]})]}),d&&C.jsxs("div",{className:"shrink-0 px-3 py-2 border-b border-primary/20 bg-black/40 flex flex-col gap-2",children:[C.jsx("p",{className:"font-arcade text-[10px] text-primary",children:"PASTE MERMAID â†’ SWITCH TO STRUCTURED"}),C.jsx("textarea",{value:f,onChange:S=>h(S.target.value),placeholder:`graph TD
  A[Topic] --> B[Subtopic]`,className:"min-h-[60px] w-full px-2 py-1.5 font-mono text-xs bg-black/60 border border-primary/30 rounded-none text-foreground placeholder:text-muted-foreground resize-y",rows:3}),C.jsxs("div",{className:"flex gap-2",children:[C.jsx(ue,{size:"sm",className:"rounded-none font-terminal text-xs",onClick:w,disabled:!f.trim(),children:"Import & switch"}),C.jsx(ue,{size:"sm",variant:"outline",className:"rounded-none font-terminal text-xs border-primary/30",onClick:()=>{l(!1),h("")},children:"Cancel"})]})]}),C.jsx("div",{className:"flex-1 min-h-0 bg-black/80 border border-primary/20",children:C.jsx(my,{store:n,onMount:y,inferDarkMode:!1})})]})}function ce(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,i;r<e.length;r++)(i=ce(e[r]))!==""&&(t+=(t&&" ")+i);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}function Uy(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,i=t.slice(),n;return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function Wy(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Yy(e,t){var r=t?t.length:0,i=e?Math.min(r,e.length):0,n=new Array(i),o=new Array(r),a;for(a=0;a<i;++a)n[a]=gt(e[a],t[a]);for(;a<r;++a)o[a]=t[a];return function(s){for(a=0;a<i;++a)o[a]=n[a](s);return o}}function Ky(e,t){var r=new Date;return e=+e,t=+t,function(i){return r.setTime(e*(1-i)+t*i),r}}function Zy(e,t){var r={},i={},n;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(n in t)n in e?r[n]=gt(e[n],t[n]):i[n]=t[n];return function(o){for(n in r)i[n]=r[n](o);return i}}function gt(e,t){var r=typeof t,i;return t==null||r==="boolean"?Sy(t):(r==="number"?Pu:r==="string"?(i=ju(t))?(t=i,Ou):Ny:t instanceof ju?Ou:t instanceof Date?Ky:Wy(t)?Uy:Array.isArray(t)?Yy:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Zy:Pu)(e,t)}const Ee={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:r,targetHandle:i})=>`Couldn't create edge for ${e} handle id: "${e==="source"?r:i}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},mt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],rg=["Enter"," ","Escape"],ng={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:r})=>`Moved selected node ${e}. New position, x: ${t}, y: ${r}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var tt;(function(e){e.Strict="strict",e.Loose="loose"})(tt||(tt={}));var Ve;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ve||(Ve={}));var yt;(function(e){e.Partial="partial",e.Full="full"})(yt||(yt={}));const ig={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var Le;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Le||(Le={}));var rt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(rt||(rt={}));var K;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(K||(K={}));const Du={[K.Left]:K.Right,[K.Right]:K.Left,[K.Top]:K.Bottom,[K.Bottom]:K.Top};function og(e){return e===null?null:e?"valid":"invalid"}const ag=e=>"id"in e&&"source"in e&&"target"in e,Xy=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Xs=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),wt=(e,t=[0,0])=>{const{width:r,height:i}=Me(e),n=e.origin??t,o=r*n[0],a=i*n[1];return{x:e.position.x-o,y:e.position.y-a}},Qy=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((i,n)=>{const o=typeof n=="string";let a=!t.nodeLookup&&!o?n:void 0;t.nodeLookup&&(a=o?t.nodeLookup.get(n):Xs(n)?n:t.nodeLookup.get(n.id));const s=a?Lt(a,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return $t(i,s)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Vt(r)},Et=(e,t={})=>{let r={x:1/0,y:1/0,x2:-1/0,y2:-1/0},i=!1;return e.forEach(n=>{(t.filter===void 0||t.filter(n))&&(r=$t(r,Lt(n)),i=!0)}),i?Vt(r):{x:0,y:0,width:0,height:0}},Qs=(e,t,[r,i,n]=[0,0,1],o=!1,a=!1)=>{const s={...St(t,[r,i,n]),width:t.width/n,height:t.height/n},c=[];for(const u of e.values()){const{measured:d,selectable:l=!0,hidden:f=!1}=u;if(a&&!l||f)continue;const h=d.width??u.width??u.initialWidth??null,m=d.height??u.height??u.initialHeight??null,v=bt(s,it(u)),g=(h??0)*(m??0),y=o&&v>0;(!u.internals.handleBounds||y||v>=g||u.dragging)&&c.push(u)}return c},Jy=(e,t)=>{const r=new Set;return e.forEach(i=>{r.add(i.id)}),t.filter(i=>r.has(i.source)||r.has(i.target))};function eb(e,t){const r=new Map,i=t?.nodes?new Set(t.nodes.map(n=>n.id)):null;return e.forEach(n=>{n.measured.width&&n.measured.height&&(t?.includeHiddenNodes||!n.hidden)&&(!i||i.has(n.id))&&r.set(n.id,n)}),r}async function tb({nodes:e,width:t,height:r,panZoom:i,minZoom:n,maxZoom:o},a){if(e.size===0)return Promise.resolve(!0);const s=eb(e,a),c=Et(s),u=Js(c,t,r,a?.minZoom??n,a?.maxZoom??o,a?.padding??.1);return await i.setViewport(u,{duration:a?.duration,ease:a?.ease,interpolate:a?.interpolate}),Promise.resolve(!0)}function sg({nodeId:e,nextPosition:t,nodeLookup:r,nodeOrigin:i=[0,0],nodeExtent:n,onError:o}){const a=r.get(e),s=a.parentId?r.get(a.parentId):void 0,{x:c,y:u}=s?s.internals.positionAbsolute:{x:0,y:0},d=a.origin??i;let l=a.extent||n;if(a.extent==="parent"&&!a.expandParent)if(!s)o?.("005",Ee.error005());else{const h=s.measured.width,m=s.measured.height;h&&m&&(l=[[c,u],[c+h,u+m]])}else s&&ot(a.extent)&&(l=[[a.extent[0][0]+c,a.extent[0][1]+u],[a.extent[1][0]+c,a.extent[1][1]+u]]);const f=ot(l)?Ge(t,l,a.measured):t;return(a.measured.width===void 0||a.measured.height===void 0)&&o?.("015",Ee.error015()),{position:{x:f.x-c+(a.measured.width??0)*d[0],y:f.y-u+(a.measured.height??0)*d[1]},positionAbsolute:f}}async function rb({nodesToRemove:e=[],edgesToRemove:t=[],nodes:r,edges:i,onBeforeDelete:n}){const o=new Set(e.map(f=>f.id)),a=[];for(const f of r){if(f.deletable===!1)continue;const h=o.has(f.id),m=!h&&f.parentId&&a.find(v=>v.id===f.parentId);(h||m)&&a.push(f)}const s=new Set(t.map(f=>f.id)),c=i.filter(f=>f.deletable!==!1),d=Jy(a,c);for(const f of c)s.has(f.id)&&!d.find(m=>m.id===f.id)&&d.push(f);if(!n)return{edges:d,nodes:a};const l=await n({nodes:a,edges:d});return typeof l=="boolean"?l?{edges:d,nodes:a}:{edges:[],nodes:[]}:l}const nt=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),Ge=(e={x:0,y:0},t,r)=>({x:nt(e.x,t[0][0],t[1][0]-(r?.width??0)),y:nt(e.y,t[0][1],t[1][1]-(r?.height??0))});function ug(e,t,r){const{width:i,height:n}=Me(r),{x:o,y:a}=r.internals.positionAbsolute;return Ge(e,[[o,a],[o+i,a+n]],t)}const Lu=(e,t,r)=>e<t?nt(Math.abs(e-t),1,t)/t:e>r?-nt(Math.abs(e-r),1,t)/t:0,cg=(e,t,r=15,i=40)=>{const n=Lu(e.x,i,t.width-i)*r,o=Lu(e.y,i,t.height-i)*r;return[n,o]},$t=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Vs=({x:e,y:t,width:r,height:i})=>({x:e,y:t,x2:e+r,y2:t+i}),Vt=({x:e,y:t,x2:r,y2:i})=>({x:e,y:t,width:r-e,height:i-t}),it=(e,t=[0,0])=>{const{x:r,y:i}=Xs(e)?e.internals.positionAbsolute:wt(e,t);return{x:r,y:i,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},Lt=(e,t=[0,0])=>{const{x:r,y:i}=Xs(e)?e.internals.positionAbsolute:wt(e,t);return{x:r,y:i,x2:r+(e.measured?.width??e.width??e.initialWidth??0),y2:i+(e.measured?.height??e.height??e.initialHeight??0)}},dg=(e,t)=>Vt($t(Vs(e),Vs(t))),bt=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),i=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*i)},Bu=e=>me(e.width)&&me(e.height)&&me(e.x)&&me(e.y),me=e=>!isNaN(e)&&isFinite(e),nb=(e,t)=>{},Ct=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),St=({x:e,y:t},[r,i,n],o=!1,a=[1,1])=>{const s={x:(e-r)/n,y:(t-i)/n};return o?Ct(s,a):s},Bt=({x:e,y:t},[r,i,n])=>({x:e*n+r,y:t*n+i});function Qe(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const r=parseFloat(e);if(!Number.isNaN(r))return Math.floor(r)}if(typeof e=="string"&&e.endsWith("%")){const r=parseFloat(e);if(!Number.isNaN(r))return Math.floor(t*r*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function ib(e,t,r){if(typeof e=="string"||typeof e=="number"){const i=Qe(e,r),n=Qe(e,t);return{top:i,right:n,bottom:i,left:n,x:n*2,y:i*2}}if(typeof e=="object"){const i=Qe(e.top??e.y??0,r),n=Qe(e.bottom??e.y??0,r),o=Qe(e.left??e.x??0,t),a=Qe(e.right??e.x??0,t);return{top:i,right:a,bottom:n,left:o,x:o+a,y:i+n}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function ob(e,t,r,i,n,o){const{x:a,y:s}=Bt(e,[t,r,i]),{x:c,y:u}=Bt({x:e.x+e.width,y:e.y+e.height},[t,r,i]),d=n-c,l=o-u;return{left:Math.floor(a),top:Math.floor(s),right:Math.floor(d),bottom:Math.floor(l)}}const Js=(e,t,r,i,n,o)=>{const a=ib(o,t,r),s=(t-a.x)/e.width,c=(r-a.y)/e.height,u=Math.min(s,c),d=nt(u,i,n),l=e.x+e.width/2,f=e.y+e.height/2,h=t/2-l*d,m=r/2-f*d,v=ob(e,h,m,d,t,r),g={left:Math.min(v.left-a.left,0),top:Math.min(v.top-a.top,0),right:Math.min(v.right-a.right,0),bottom:Math.min(v.bottom-a.bottom,0)};return{x:h-g.left+g.right,y:m-g.top+g.bottom,zoom:d}},xt=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function ot(e){return e!=null&&e!=="parent"}function Me(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function lg(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function fg(e,t={width:0,height:0},r,i,n){const o={...e},a=i.get(r);if(a){const s=a.origin||n;o.x+=a.internals.positionAbsolute.x-(t.width??0)*s[0],o.y+=a.internals.positionAbsolute.y-(t.height??0)*s[1]}return o}function Fu(e,t){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}function ab(){let e,t;return{promise:new Promise((i,n)=>{e=i,t=n}),resolve:e,reject:t}}function sb(e){return{...ng,...e||{}}}function vt(e,{snapGrid:t=[0,0],snapToGrid:r=!1,transform:i,containerBounds:n}){const{x:o,y:a}=ye(e),s=St({x:o-(n?.left??0),y:a-(n?.top??0)},i),{x:c,y:u}=r?Ct(s,t):s;return{xSnapped:c,ySnapped:u,...s}}const eu=e=>({width:e.offsetWidth,height:e.offsetHeight}),hg=e=>e?.getRootNode?.()||window?.document,ub=["INPUT","SELECT","TEXTAREA"];function pg(e){const t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:ub.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const gg=e=>"clientX"in e,ye=(e,t)=>{const r=gg(e),i=r?e.clientX:e.touches?.[0].clientX,n=r?e.clientY:e.touches?.[0].clientY;return{x:i-(t?.left??0),y:n-(t?.top??0)}},Hu=(e,t,r,i,n)=>{const o=t.querySelectorAll(`.${e}`);return!o||!o.length?null:Array.from(o).map(a=>{const s=a.getBoundingClientRect();return{id:a.getAttribute("data-handleid"),type:e,nodeId:n,position:a.getAttribute("data-handlepos"),x:(s.left-r.left)/i,y:(s.top-r.top)/i,...eu(a)}})};function vg({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:n,sourceControlY:o,targetControlX:a,targetControlY:s}){const c=e*.125+n*.375+a*.375+r*.125,u=t*.125+o*.375+s*.375+i*.125,d=Math.abs(c-e),l=Math.abs(u-t);return[c,u,d,l]}function Pt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function zu({pos:e,x1:t,y1:r,x2:i,y2:n,c:o}){switch(e){case K.Left:return[t-Pt(t-i,o),r];case K.Right:return[t+Pt(i-t,o),r];case K.Top:return[t,r-Pt(r-n,o)];case K.Bottom:return[t,r+Pt(n-r,o)]}}function mg({sourceX:e,sourceY:t,sourcePosition:r=K.Bottom,targetX:i,targetY:n,targetPosition:o=K.Top,curvature:a=.25}){const[s,c]=zu({pos:r,x1:e,y1:t,x2:i,y2:n,c:a}),[u,d]=zu({pos:o,x1:i,y1:n,x2:e,y2:t,c:a}),[l,f,h,m]=vg({sourceX:e,sourceY:t,targetX:i,targetY:n,sourceControlX:s,sourceControlY:c,targetControlX:u,targetControlY:d});return[`M${e},${t} C${s},${c} ${u},${d} ${i},${n}`,l,f,h,m]}function yg({sourceX:e,sourceY:t,targetX:r,targetY:i}){const n=Math.abs(r-e)/2,o=r<e?r+n:r-n,a=Math.abs(i-t)/2,s=i<t?i+a:i-a;return[o,s,n,a]}function cb({sourceNode:e,targetNode:t,selected:r=!1,zIndex:i=0,elevateOnSelect:n=!1,zIndexMode:o="basic"}){if(o==="manual")return i;const a=n&&r?i+1e3:i,s=Math.max(e.parentId||n&&e.selected?e.internals.z:0,t.parentId||n&&t.selected?t.internals.z:0);return a+s}function db({sourceNode:e,targetNode:t,width:r,height:i,transform:n}){const o=$t(Lt(e),Lt(t));o.x===o.x2&&(o.x2+=1),o.y===o.y2&&(o.y2+=1);const a={x:-n[0]/n[2],y:-n[1]/n[2],width:r/n[2],height:i/n[2]};return bt(a,Vt(o))>0}const lb=({source:e,sourceHandle:t,target:r,targetHandle:i})=>`xy-edge__${e}${t||""}-${r}${i||""}`,fb=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),bg=(e,t,r={})=>{if(!e.source||!e.target)return t;const i=r.getEdgeId||lb;let n;return ag(e)?n={...e}:n={...e,id:i(e)},fb(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function xg({sourceX:e,sourceY:t,targetX:r,targetY:i}){const[n,o,a,s]=yg({sourceX:e,sourceY:t,targetX:r,targetY:i});return[`M ${e},${t}L ${r},${i}`,n,o,a,s]}const $u={[K.Left]:{x:-1,y:0},[K.Right]:{x:1,y:0},[K.Top]:{x:0,y:-1},[K.Bottom]:{x:0,y:1}},hb=({source:e,sourcePosition:t=K.Bottom,target:r})=>t===K.Left||t===K.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},Vu=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function pb({source:e,sourcePosition:t=K.Bottom,target:r,targetPosition:i=K.Top,center:n,offset:o,stepPosition:a}){const s=$u[t],c=$u[i],u={x:e.x+s.x*o,y:e.y+s.y*o},d={x:r.x+c.x*o,y:r.y+c.y*o},l=hb({source:u,sourcePosition:t,target:d}),f=l.x!==0?"x":"y",h=l[f];let m=[],v,g;const y={x:0,y:0},b={x:0,y:0},[,,p,x]=yg({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(s[f]*c[f]===-1){f==="x"?(v=n.x??u.x+(d.x-u.x)*a,g=n.y??(u.y+d.y)/2):(v=n.x??(u.x+d.x)/2,g=n.y??u.y+(d.y-u.y)*a);const _=[{x:v,y:u.y},{x:v,y:d.y}],w=[{x:u.x,y:g},{x:d.x,y:g}];s[f]===h?m=f==="x"?_:w:m=f==="x"?w:_}else{const _=[{x:u.x,y:d.y}],w=[{x:d.x,y:u.y}];if(f==="x"?m=s.x===h?w:_:m=s.y===h?_:w,t===i){const q=Math.abs(e[f]-r[f]);if(q<=o){const P=Math.min(o-1,o-q);s[f]===h?y[f]=(u[f]>e[f]?-1:1)*P:b[f]=(d[f]>r[f]?-1:1)*P}}if(t!==i){const q=f==="x"?"y":"x",P=s[f]===c[q],D=u[q]>d[q],O=u[q]<d[q];(s[f]===1&&(!P&&D||P&&O)||s[f]!==1&&(!P&&O||P&&D))&&(m=f==="x"?_:w)}const S={x:u.x+y.x,y:u.y+y.y},R={x:d.x+b.x,y:d.y+b.y},M=Math.max(Math.abs(S.x-m[0].x),Math.abs(R.x-m[0].x)),N=Math.max(Math.abs(S.y-m[0].y),Math.abs(R.y-m[0].y));M>=N?(v=(S.x+R.x)/2,g=m[0].y):(v=m[0].x,g=(S.y+R.y)/2)}return[[e,{x:u.x+y.x,y:u.y+y.y},...m,{x:d.x+b.x,y:d.y+b.y},r],v,g,p,x]}function gb(e,t,r,i){const n=Math.min(Vu(e,t)/2,Vu(t,r)/2,i),{x:o,y:a}=t;if(e.x===o&&o===r.x||e.y===a&&a===r.y)return`L${o} ${a}`;if(e.y===a){const u=e.x<r.x?-1:1,d=e.y<r.y?1:-1;return`L ${o+n*u},${a}Q ${o},${a} ${o},${a+n*d}`}const s=e.x<r.x?1:-1,c=e.y<r.y?-1:1;return`L ${o},${a+n*c}Q ${o},${a} ${o+n*s},${a}`}function Gs({sourceX:e,sourceY:t,sourcePosition:r=K.Bottom,targetX:i,targetY:n,targetPosition:o=K.Top,borderRadius:a=5,centerX:s,centerY:c,offset:u=20,stepPosition:d=.5}){const[l,f,h,m,v]=pb({source:{x:e,y:t},sourcePosition:r,target:{x:i,y:n},targetPosition:o,center:{x:s,y:c},offset:u,stepPosition:d});return[l.reduce((y,b,p)=>{let x="";return p>0&&p<l.length-1?x=gb(l[p-1],b,l[p+1],a):x=`${p===0?"M":"L"}${b.x} ${b.y}`,y+=x,y},""),f,h,m,v]}function Gu(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function vb(e){const{sourceNode:t,targetNode:r}=e;if(!Gu(t)||!Gu(r))return null;const i=t.internals.handleBounds||Uu(t.handles),n=r.internals.handleBounds||Uu(r.handles),o=Wu(i?.source??[],e.sourceHandle),a=Wu(e.connectionMode===tt.Strict?n?.target??[]:(n?.target??[]).concat(n?.source??[]),e.targetHandle);if(!o||!a)return e.onError?.("008",Ee.error008(o?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const s=o?.position||K.Bottom,c=a?.position||K.Top,u=Ue(t,o,s),d=Ue(r,a,c);return{sourceX:u.x,sourceY:u.y,targetX:d.x,targetY:d.y,sourcePosition:s,targetPosition:c}}function Uu(e){if(!e)return null;const t=[],r=[];for(const i of e)i.width=i.width??1,i.height=i.height??1,i.type==="source"?t.push(i):i.type==="target"&&r.push(i);return{source:t,target:r}}function Ue(e,t,r=K.Left,i=!1){const n=(t?.x??0)+e.internals.positionAbsolute.x,o=(t?.y??0)+e.internals.positionAbsolute.y,{width:a,height:s}=t??Me(e);if(i)return{x:n+a/2,y:o+s/2};switch(t?.position??r){case K.Top:return{x:n+a/2,y:o};case K.Right:return{x:n+a,y:o+s/2};case K.Bottom:return{x:n+a/2,y:o+s};case K.Left:return{x:n,y:o+s/2}}}function Wu(e,t){return e&&(t?e.find(r=>r.id===t):e[0])||null}function Us(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(i=>`${i}=${e[i]}`).join("&")}`:""}function mb(e,{id:t,defaultColor:r,defaultMarkerStart:i,defaultMarkerEnd:n}){const o=new Set;return e.reduce((a,s)=>([s.markerStart||i,s.markerEnd||n].forEach(c=>{if(c&&typeof c=="object"){const u=Us(c,t);o.has(u)||(a.push({id:u,color:c.color||r,...c}),o.add(u))}}),a),[]).sort((a,s)=>a.id.localeCompare(s.id))}const _g=1e3,yb=10,tu={nodeOrigin:[0,0],nodeExtent:mt,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},bb={...tu,checkEquality:!0};function ru(e,t){const r={...e};for(const i in t)t[i]!==void 0&&(r[i]=t[i]);return r}function xb(e,t,r){const i=ru(tu,r);for(const n of e.values())if(n.parentId)iu(n,e,t,i);else{const o=wt(n,i.nodeOrigin),a=ot(n.extent)?n.extent:i.nodeExtent,s=Ge(o,a,Me(n));n.internals.positionAbsolute=s}}function _b(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;const r=[],i=[];for(const n of e.handles){const o={id:n.id,width:n.width??1,height:n.height??1,nodeId:e.id,x:n.x,y:n.y,position:n.position,type:n.type};n.type==="source"?r.push(o):n.type==="target"&&i.push(o)}return{source:r,target:i}}function nu(e){return e==="manual"}function Ws(e,t,r,i={}){const n=ru(bb,i),o={i:0},a=new Map(t),s=n?.elevateNodesOnSelect&&!nu(n.zIndexMode)?_g:0;let c=e.length>0;t.clear(),r.clear();for(const u of e){let d=a.get(u.id);if(n.checkEquality&&u===d?.internals.userNode)t.set(u.id,d);else{const l=wt(u,n.nodeOrigin),f=ot(u.extent)?u.extent:n.nodeExtent,h=Ge(l,f,Me(u));d={...n.defaults,...u,measured:{width:u.measured?.width,height:u.measured?.height},internals:{positionAbsolute:h,handleBounds:_b(u,d),z:wg(u,s,n.zIndexMode),userNode:u}},t.set(u.id,d)}(d.measured===void 0||d.measured.width===void 0||d.measured.height===void 0)&&!d.hidden&&(c=!1),u.parentId&&iu(d,t,r,i,o)}return c}function wb(e,t){if(!e.parentId)return;const r=t.get(e.parentId);r?r.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function iu(e,t,r,i,n){const{elevateNodesOnSelect:o,nodeOrigin:a,nodeExtent:s,zIndexMode:c}=ru(tu,i),u=e.parentId,d=t.get(u);if(!d){console.warn(`Parent node ${u} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}wb(e,r),n&&!d.parentId&&d.internals.rootParentIndex===void 0&&c==="auto"&&(d.internals.rootParentIndex=++n.i,d.internals.z=d.internals.z+n.i*yb),n&&d.internals.rootParentIndex!==void 0&&(n.i=d.internals.rootParentIndex);const l=o&&!nu(c)?_g:0,{x:f,y:h,z:m}=Eb(e,d,a,s,l,c),{positionAbsolute:v}=e.internals,g=f!==v.x||h!==v.y;(g||m!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:g?{x:f,y:h}:v,z:m}})}function wg(e,t,r){const i=me(e.zIndex)?e.zIndex:0;return nu(r)?i:i+(e.selected?t:0)}function Eb(e,t,r,i,n,o){const{x:a,y:s}=t.internals.positionAbsolute,c=Me(e),u=wt(e,r),d=ot(e.extent)?Ge(u,e.extent,c):u;let l=Ge({x:a+d.x,y:s+d.y},i,c);e.extent==="parent"&&(l=ug(l,c,t));const f=wg(e,n,o),h=t.internals.z??0;return{x:l.x,y:l.y,z:h>=f?h+1:f}}function ou(e,t,r,i=[0,0]){const n=[],o=new Map;for(const a of e){const s=t.get(a.parentId);if(!s)continue;const c=o.get(a.parentId)?.expandedRect??it(s),u=dg(c,a.rect);o.set(a.parentId,{expandedRect:u,parent:s})}return o.size>0&&o.forEach(({expandedRect:a,parent:s},c)=>{const u=s.internals.positionAbsolute,d=Me(s),l=s.origin??i,f=a.x<u.x?Math.round(Math.abs(u.x-a.x)):0,h=a.y<u.y?Math.round(Math.abs(u.y-a.y)):0,m=Math.max(d.width,Math.round(a.width)),v=Math.max(d.height,Math.round(a.height)),g=(m-d.width)*l[0],y=(v-d.height)*l[1];(f>0||h>0||g||y)&&(n.push({id:c,type:"position",position:{x:s.position.x-f+g,y:s.position.y-h+y}}),r.get(c)?.forEach(b=>{e.some(p=>p.id===b.id)||n.push({id:b.id,type:"position",position:{x:b.position.x+f,y:b.position.y+h}})})),(d.width<a.width||d.height<a.height||f||h)&&n.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:m+(f?l[0]*f-g:0),height:v+(h?l[1]*h-y:0)}})}),n}function Cb(e,t,r,i,n,o,a){const s=i?.querySelector(".xyflow__viewport");let c=!1;if(!s)return{changes:[],updatedInternals:c};const u=[],d=window.getComputedStyle(s),{m22:l}=new window.DOMMatrixReadOnly(d.transform),f=[];for(const h of e.values()){const m=t.get(h.id);if(!m)continue;if(m.hidden){t.set(m.id,{...m,internals:{...m.internals,handleBounds:void 0}}),c=!0;continue}const v=eu(h.nodeElement),g=m.measured.width!==v.width||m.measured.height!==v.height;if(!!(v.width&&v.height&&(g||!m.internals.handleBounds||h.force))){const b=h.nodeElement.getBoundingClientRect(),p=ot(m.extent)?m.extent:o;let{positionAbsolute:x}=m.internals;m.parentId&&m.extent==="parent"?x=ug(x,v,t.get(m.parentId)):p&&(x=Ge(x,p,v));const E={...m,measured:v,internals:{...m.internals,positionAbsolute:x,handleBounds:{source:Hu("source",h.nodeElement,b,l,m.id),target:Hu("target",h.nodeElement,b,l,m.id)}}};t.set(m.id,E),m.parentId&&iu(E,t,r,{nodeOrigin:n,zIndexMode:a}),c=!0,g&&(u.push({id:m.id,type:"dimensions",dimensions:v}),m.expandParent&&m.parentId&&f.push({id:m.id,parentId:m.parentId,rect:it(E,n)}))}}if(f.length>0){const h=ou(f,t,r,n);u.push(...h)}return{changes:u,updatedInternals:c}}async function Sb({delta:e,panZoom:t,transform:r,translateExtent:i,width:n,height:o}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const a=await t.setViewportConstrained({x:r[0]+e.x,y:r[1]+e.y,zoom:r[2]},[[0,0],[n,o]],i),s=!!a&&(a.x!==r[0]||a.y!==r[1]||a.k!==r[2]);return Promise.resolve(s)}function Yu(e,t,r,i,n,o){let a=n;const s=i.get(a)||new Map;i.set(a,s.set(r,t)),a=`${n}-${e}`;const c=i.get(a)||new Map;if(i.set(a,c.set(r,t)),o){a=`${n}-${e}-${o}`;const u=i.get(a)||new Map;i.set(a,u.set(r,t))}}function Eg(e,t,r){e.clear(),t.clear();for(const i of r){const{source:n,target:o,sourceHandle:a=null,targetHandle:s=null}=i,c={edgeId:i.id,source:n,target:o,sourceHandle:a,targetHandle:s},u=`${n}-${a}--${o}-${s}`,d=`${o}-${s}--${n}-${a}`;Yu("source",c,d,e,n,a),Yu("target",c,u,e,o,s),t.set(i.id,i)}}function Cg(e,t){if(!e.parentId)return!1;const r=t.get(e.parentId);return r?r.selected?!0:Cg(r,t):!1}function Ku(e,t,r){let i=e;do{if(i?.matches?.(t))return!0;if(i===r)return!1;i=i?.parentElement}while(i);return!1}function Nb(e,t,r,i){const n=new Map;for(const[o,a]of e)if((a.selected||a.id===i)&&(!a.parentId||!Cg(a,e))&&(a.draggable||t&&typeof a.draggable>"u")){const s=e.get(o);s&&n.set(o,{id:o,position:s.position||{x:0,y:0},distance:{x:r.x-s.internals.positionAbsolute.x,y:r.y-s.internals.positionAbsolute.y},extent:s.extent,parentId:s.parentId,origin:s.origin,expandParent:s.expandParent,internals:{positionAbsolute:s.internals.positionAbsolute||{x:0,y:0}},measured:{width:s.measured.width??0,height:s.measured.height??0}})}return n}function vr({nodeId:e,dragItems:t,nodeLookup:r,dragging:i=!0}){const n=[];for(const[a,s]of t){const c=r.get(a)?.internals.userNode;c&&n.push({...c,position:s.position,dragging:i})}if(!e)return[n[0],n];const o=r.get(e)?.internals.userNode;return[o?{...o,position:t.get(e)?.position||o.position,dragging:i}:n[0],n]}function Rb({dragItems:e,snapGrid:t,x:r,y:i}){const n=e.values().next().value;if(!n)return null;const o={x:r-n.distance.x,y:i-n.distance.y},a=Ct(o,t);return{x:a.x-o.x,y:a.y-o.y}}function qb({onNodeMouseDown:e,getStoreItems:t,onDragStart:r,onDrag:i,onDragStop:n}){let o={x:null,y:null},a=0,s=new Map,c=!1,u={x:0,y:0},d=null,l=!1,f=null,h=!1,m=!1,v=null;function g({noDragClassName:b,handleSelector:p,domNode:x,isSelectable:E,nodeId:_,nodeClickDistance:w=0}){f=zt(x);function S({x:q,y:P}){const{nodeLookup:D,nodeExtent:O,snapGrid:H,snapToGrid:z,nodeOrigin:L,onNodeDrag:F,onSelectionDrag:U,onError:G,updateNodePositions:$}=t();o={x:q,y:P};let W=!1;const A=s.size>1,I=A&&O?Vs(Et(s)):null,T=A&&z?Rb({dragItems:s,snapGrid:H,x:q,y:P}):null;for(const[j,B]of s){if(!D.has(j))continue;let V={x:q-B.distance.x,y:P-B.distance.y};z&&(V=T?{x:Math.round(V.x+T.x),y:Math.round(V.y+T.y)}:Ct(V,H));let Z=null;if(A&&O&&!B.extent&&I){const{positionAbsolute:Y}=B.internals,te=Y.x-I.x+O[0][0],X=Y.x+B.measured.width-I.x2+O[1][0],ne=Y.y-I.y+O[0][1],ee=Y.y+B.measured.height-I.y2+O[1][1];Z=[[te,ne],[X,ee]]}const{position:J,positionAbsolute:Q}=sg({nodeId:j,nextPosition:V,nodeLookup:D,nodeExtent:Z||O,nodeOrigin:L,onError:G});W=W||B.position.x!==J.x||B.position.y!==J.y,B.position=J,B.internals.positionAbsolute=Q}if(m=m||W,!!W&&($(s,!0),v&&(i||F||!_&&U))){const[j,B]=vr({nodeId:_,dragItems:s,nodeLookup:D});i?.(v,s,j,B),F?.(v,j,B),_||U?.(v,B)}}async function R(){if(!d)return;const{transform:q,panBy:P,autoPanSpeed:D,autoPanOnNodeDrag:O}=t();if(!O){c=!1,cancelAnimationFrame(a);return}const[H,z]=cg(u,d,D);(H!==0||z!==0)&&(o.x=(o.x??0)-H/q[2],o.y=(o.y??0)-z/q[2],await P({x:H,y:z})&&S(o)),a=requestAnimationFrame(R)}function M(q){const{nodeLookup:P,multiSelectionActive:D,nodesDraggable:O,transform:H,snapGrid:z,snapToGrid:L,selectNodesOnDrag:F,onNodeDragStart:U,onSelectionDragStart:G,unselectNodesAndEdges:$}=t();l=!0,(!F||!E)&&!D&&_&&(P.get(_)?.selected||$()),E&&F&&_&&e?.(_);const W=vt(q.sourceEvent,{transform:H,snapGrid:z,snapToGrid:L,containerBounds:d});if(o=W,s=Nb(P,O,W,_),s.size>0&&(r||U||!_&&G)){const[A,I]=vr({nodeId:_,dragItems:s,nodeLookup:P});r?.(q.sourceEvent,s,A,I),U?.(q.sourceEvent,A,I),_||G?.(q.sourceEvent,I)}}const N=Jp().clickDistance(w).on("start",q=>{const{domNode:P,nodeDragThreshold:D,transform:O,snapGrid:H,snapToGrid:z}=t();d=P?.getBoundingClientRect()||null,h=!1,m=!1,v=q.sourceEvent,D===0&&M(q),o=vt(q.sourceEvent,{transform:O,snapGrid:H,snapToGrid:z,containerBounds:d}),u=ye(q.sourceEvent,d)}).on("drag",q=>{const{autoPanOnNodeDrag:P,transform:D,snapGrid:O,snapToGrid:H,nodeDragThreshold:z,nodeLookup:L}=t(),F=vt(q.sourceEvent,{transform:D,snapGrid:O,snapToGrid:H,containerBounds:d});if(v=q.sourceEvent,(q.sourceEvent.type==="touchmove"&&q.sourceEvent.touches.length>1||_&&!L.has(_))&&(h=!0),!h){if(!c&&P&&l&&(c=!0,R()),!l){const U=ye(q.sourceEvent,d),G=U.x-u.x,$=U.y-u.y;Math.sqrt(G*G+$*$)>z&&M(q)}(o.x!==F.xSnapped||o.y!==F.ySnapped)&&s&&l&&(u=ye(q.sourceEvent,d),S(F))}}).on("end",q=>{if(!(!l||h)&&(c=!1,l=!1,cancelAnimationFrame(a),s.size>0)){const{nodeLookup:P,updateNodePositions:D,onNodeDragStop:O,onSelectionDragStop:H}=t();if(m&&(D(s,!1),m=!1),n||O||!_&&H){const[z,L]=vr({nodeId:_,dragItems:s,nodeLookup:P,dragging:!1});n?.(q.sourceEvent,s,z,L),O?.(q.sourceEvent,z,L),_||H?.(q.sourceEvent,L)}}}).filter(q=>{const P=q.target;return!q.button&&(!b||!Ku(P,`.${b}`,x))&&(!p||Ku(P,p,x))});f.call(N)}function y(){f?.on(".drag",null)}return{update:g,destroy:y}}function Ib(e,t,r){const i=[],n={x:e.x-r,y:e.y-r,width:r*2,height:r*2};for(const o of t.values())bt(n,it(o))>0&&i.push(o);return i}const Mb=250;function Ab(e,t,r,i){let n=[],o=1/0;const a=Ib(e,r,t+Mb);for(const s of a){const c=[...s.internals.handleBounds?.source??[],...s.internals.handleBounds?.target??[]];for(const u of c){if(i.nodeId===u.nodeId&&i.type===u.type&&i.id===u.id)continue;const{x:d,y:l}=Ue(s,u,u.position,!0),f=Math.sqrt(Math.pow(d-e.x,2)+Math.pow(l-e.y,2));f>t||(f<o?(n=[{...u,x:d,y:l}],o=f):f===o&&n.push({...u,x:d,y:l}))}}if(!n.length)return null;if(n.length>1){const s=i.type==="source"?"target":"source";return n.find(c=>c.type===s)??n[0]}return n[0]}function Sg(e,t,r,i,n,o=!1){const a=i.get(e);if(!a)return null;const s=n==="strict"?a.internals.handleBounds?.[t]:[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]],c=(r?s?.find(u=>u.id===r):s?.[0])??null;return c&&o?{...c,...Ue(a,c,c.position,!0)}:c}function Ng(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function kb(e,t){let r=null;return t?r=!0:e&&!t&&(r=!1),r}const Rg=()=>!0;function Tb(e,{connectionMode:t,connectionRadius:r,handleId:i,nodeId:n,edgeUpdaterType:o,isTarget:a,domNode:s,nodeLookup:c,lib:u,autoPanOnConnect:d,flowId:l,panBy:f,cancelConnection:h,onConnectStart:m,onConnect:v,onConnectEnd:g,isValidConnection:y=Rg,onReconnectEnd:b,updateConnection:p,getTransform:x,getFromHandle:E,autoPanSpeed:_,dragThreshold:w=1,handleDomNode:S}){const R=hg(e.target);let M=0,N;const{x:q,y:P}=ye(e),D=Ng(o,S),O=s?.getBoundingClientRect();let H=!1;if(!O||!D)return;const z=Sg(n,D,i,c,t);if(!z)return;let L=ye(e,O),F=!1,U=null,G=!1,$=null;function W(){if(!d||!O)return;const[J,Q]=cg(L,O,_);f({x:J,y:Q}),M=requestAnimationFrame(W)}const A={...z,nodeId:n,type:D,position:z.position},I=c.get(n);let j={inProgress:!0,isValid:null,from:Ue(I,A,K.Left,!0),fromHandle:A,fromPosition:A.position,fromNode:I,to:L,toHandle:null,toPosition:Du[A.position],toNode:null,pointer:L};function B(){H=!0,p(j),m?.(e,{nodeId:n,handleId:i,handleType:D})}w===0&&B();function V(J){if(!H){const{x:ee,y:fe}=ye(J),le=ee-q,Se=fe-P;if(!(le*le+Se*Se>w*w))return;B()}if(!E()||!A){Z(J);return}const Q=x();L=ye(J,O),N=Ab(St(L,Q,!1,[1,1]),r,c,A),F||(W(),F=!0);const Y=qg(J,{handle:N,connectionMode:t,fromNodeId:n,fromHandleId:i,fromType:a?"target":"source",isValidConnection:y,doc:R,lib:u,flowId:l,nodeLookup:c});$=Y.handleDomNode,U=Y.connection,G=kb(!!N,Y.isValid);const te=c.get(n),X=te?Ue(te,A,K.Left,!0):j.from,ne={...j,from:X,isValid:G,to:Y.toHandle&&G?Bt({x:Y.toHandle.x,y:Y.toHandle.y},Q):L,toHandle:Y.toHandle,toPosition:G&&Y.toHandle?Y.toHandle.position:Du[A.position],toNode:Y.toHandle?c.get(Y.toHandle.nodeId):null,pointer:L};p(ne),j=ne}function Z(J){if(!("touches"in J&&J.touches.length>0)){if(H){(N||$)&&U&&G&&v?.(U);const{inProgress:Q,...Y}=j,te={...Y,toPosition:j.toHandle?j.toPosition:null};g?.(J,te),o&&b?.(J,te)}h(),cancelAnimationFrame(M),F=!1,G=!1,U=null,$=null,R.removeEventListener("mousemove",V),R.removeEventListener("mouseup",Z),R.removeEventListener("touchmove",V),R.removeEventListener("touchend",Z)}}R.addEventListener("mousemove",V),R.addEventListener("mouseup",Z),R.addEventListener("touchmove",V),R.addEventListener("touchend",Z)}function qg(e,{handle:t,connectionMode:r,fromNodeId:i,fromHandleId:n,fromType:o,doc:a,lib:s,flowId:c,isValidConnection:u=Rg,nodeLookup:d}){const l=o==="target",f=t?a.querySelector(`.${s}-flow__handle[data-id="${c}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:h,y:m}=ye(e),v=a.elementFromPoint(h,m),g=v?.classList.contains(`${s}-flow__handle`)?v:f,y={handleDomNode:g,isValid:!1,connection:null,toHandle:null};if(g){const b=Ng(void 0,g),p=g.getAttribute("data-nodeid"),x=g.getAttribute("data-handleid"),E=g.classList.contains("connectable"),_=g.classList.contains("connectableend");if(!p||!b)return y;const w={source:l?p:i,sourceHandle:l?x:n,target:l?i:p,targetHandle:l?n:x};y.connection=w;const R=E&&_&&(r===tt.Strict?l&&b==="source"||!l&&b==="target":p!==i||x!==n);y.isValid=R&&u(w),y.toHandle=Sg(p,b,x,d,r,!0)}return y}const Ys={onPointerDown:Tb,isValid:qg};function Pb({domNode:e,panZoom:t,getTransform:r,getViewScale:i}){const n=zt(e);function o({translateExtent:s,width:c,height:u,zoomStep:d=1,pannable:l=!0,zoomable:f=!0,inversePan:h=!1}){const m=p=>{if(p.sourceEvent.type!=="wheel"||!t)return;const x=r(),E=p.sourceEvent.ctrlKey&&xt()?10:1,_=-p.sourceEvent.deltaY*(p.sourceEvent.deltaMode===1?.05:p.sourceEvent.deltaMode?1:.002)*d,w=x[2]*Math.pow(2,_*E);t.scaleTo(w)};let v=[0,0];const g=p=>{(p.sourceEvent.type==="mousedown"||p.sourceEvent.type==="touchstart")&&(v=[p.sourceEvent.clientX??p.sourceEvent.touches[0].clientX,p.sourceEvent.clientY??p.sourceEvent.touches[0].clientY])},y=p=>{const x=r();if(p.sourceEvent.type!=="mousemove"&&p.sourceEvent.type!=="touchmove"||!t)return;const E=[p.sourceEvent.clientX??p.sourceEvent.touches[0].clientX,p.sourceEvent.clientY??p.sourceEvent.touches[0].clientY],_=[E[0]-v[0],E[1]-v[1]];v=E;const w=i()*Math.max(x[2],Math.log(x[2]))*(h?-1:1),S={x:x[0]-_[0]*w,y:x[1]-_[1]*w},R=[[0,0],[c,u]];t.setViewportConstrained({x:S.x,y:S.y,zoom:x[2]},R,s)},b=Qp().on("start",g).on("zoom",l?y:null).on("zoom.wheel",f?m:null);n.call(b,{})}function a(){n.on("zoom",null)}return{update:o,destroy:a,pointer:Xp}}const Gt=e=>({x:e.x,y:e.y,zoom:e.k}),mr=({x:e,y:t,zoom:r})=>Ry.translate(e,t).scale(r),Je=(e,t)=>e.target.closest(`.${t}`),Ig=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Ob=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,yr=(e,t=0,r=Ob,i=()=>{})=>{const n=typeof t=="number"&&t>0;return n||i(),n?e.transition().duration(t).ease(r).on("end",i):e},Mg=e=>{const t=e.ctrlKey&&xt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function jb({zoomPanValues:e,noWheelClassName:t,d3Selection:r,d3Zoom:i,panOnScrollMode:n,panOnScrollSpeed:o,zoomOnPinch:a,onPanZoomStart:s,onPanZoom:c,onPanZoomEnd:u}){return d=>{if(Je(d,t))return d.ctrlKey&&d.preventDefault(),!1;d.preventDefault(),d.stopImmediatePropagation();const l=r.property("__zoom").k||1;if(d.ctrlKey&&a){const g=Xp(d),y=Mg(d),b=l*Math.pow(2,y);i.scaleTo(r,b,g,d);return}const f=d.deltaMode===1?20:1;let h=n===Ve.Vertical?0:d.deltaX*f,m=n===Ve.Horizontal?0:d.deltaY*f;!xt()&&d.shiftKey&&n!==Ve.Vertical&&(h=d.deltaY*f,m=0),i.translateBy(r,-(h/l)*o,-(m/l)*o,{internal:!0});const v=Gt(r.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(c?.(d,v),e.panScrollTimeout=setTimeout(()=>{u?.(d,v),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,s?.(d,v))}}function Db({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:r}){return function(i,n){const o=i.type==="wheel",a=!t&&o&&!i.ctrlKey,s=Je(i,e);if(i.ctrlKey&&o&&s&&i.preventDefault(),a||s)return null;i.preventDefault(),r.call(this,i,n)}}function Lb({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:r}){return i=>{if(i.sourceEvent?.internal)return;const n=Gt(i.transform);e.mouseButton=i.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=n,i.sourceEvent?.type==="mousedown"&&t(!0),r&&r?.(i.sourceEvent,n)}}function Bb({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:r,onTransformChange:i,onPanZoom:n}){return o=>{e.usedRightMouseButton=!!(r&&Ig(t,e.mouseButton??0)),o.sourceEvent?.sync||i([o.transform.x,o.transform.y,o.transform.k]),n&&!o.sourceEvent?.internal&&n?.(o.sourceEvent,Gt(o.transform))}}function Fb({zoomPanValues:e,panOnDrag:t,panOnScroll:r,onDraggingChange:i,onPanZoomEnd:n,onPaneContextMenu:o}){return a=>{if(!a.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,o&&Ig(t,e.mouseButton??0)&&!e.usedRightMouseButton&&a.sourceEvent&&o(a.sourceEvent),e.usedRightMouseButton=!1,i(!1),n)){const s=Gt(a.transform);e.prevViewport=s,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{n?.(a.sourceEvent,s)},r?150:0)}}}function Hb({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:r,panOnDrag:i,panOnScroll:n,zoomOnDoubleClick:o,userSelectionActive:a,noWheelClassName:s,noPanClassName:c,lib:u,connectionInProgress:d}){return l=>{const f=e||t,h=r&&l.ctrlKey,m=l.type==="wheel";if(l.button===1&&l.type==="mousedown"&&(Je(l,`${u}-flow__node`)||Je(l,`${u}-flow__edge`)))return!0;if(!i&&!f&&!n&&!o&&!r||a||d&&!m||Je(l,s)&&m||Je(l,c)&&(!m||n&&m&&!e)||!r&&l.ctrlKey&&m)return!1;if(!r&&l.type==="touchstart"&&l.touches?.length>1)return l.preventDefault(),!1;if(!f&&!n&&!h&&m||!i&&(l.type==="mousedown"||l.type==="touchstart")||Array.isArray(i)&&!i.includes(l.button)&&l.type==="mousedown")return!1;const v=Array.isArray(i)&&i.includes(l.button)||!l.button||l.button<=1;return(!l.ctrlKey||m)&&v}}function zb({domNode:e,minZoom:t,maxZoom:r,translateExtent:i,viewport:n,onPanZoom:o,onPanZoomStart:a,onPanZoomEnd:s,onDraggingChange:c}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),l=Qp().scaleExtent([t,r]).translateExtent(i),f=zt(e).call(l);b({x:n.x,y:n.y,zoom:nt(n.zoom,t,r)},[[0,0],[d.width,d.height]],i);const h=f.on("wheel.zoom"),m=f.on("dblclick.zoom");l.wheelDelta(Mg);function v(N,q){return f?new Promise(P=>{l?.interpolate(q?.interpolate==="linear"?gt:gr).transform(yr(f,q?.duration,q?.ease,()=>P(!0)),N)}):Promise.resolve(!1)}function g({noWheelClassName:N,noPanClassName:q,onPaneContextMenu:P,userSelectionActive:D,panOnScroll:O,panOnDrag:H,panOnScrollMode:z,panOnScrollSpeed:L,preventScrolling:F,zoomOnPinch:U,zoomOnScroll:G,zoomOnDoubleClick:$,zoomActivationKeyPressed:W,lib:A,onTransformChange:I,connectionInProgress:T,paneClickDistance:j,selectionOnDrag:B}){D&&!u.isZoomingOrPanning&&y();const V=O&&!W&&!D;l.clickDistance(B?1/0:!me(j)||j<0?0:j);const Z=V?jb({zoomPanValues:u,noWheelClassName:N,d3Selection:f,d3Zoom:l,panOnScrollMode:z,panOnScrollSpeed:L,zoomOnPinch:U,onPanZoomStart:a,onPanZoom:o,onPanZoomEnd:s}):Db({noWheelClassName:N,preventScrolling:F,d3ZoomHandler:h});if(f.on("wheel.zoom",Z,{passive:!1}),!D){const Q=Lb({zoomPanValues:u,onDraggingChange:c,onPanZoomStart:a});l.on("start",Q);const Y=Bb({zoomPanValues:u,panOnDrag:H,onPaneContextMenu:!!P,onPanZoom:o,onTransformChange:I});l.on("zoom",Y);const te=Fb({zoomPanValues:u,panOnDrag:H,panOnScroll:O,onPaneContextMenu:P,onPanZoomEnd:s,onDraggingChange:c});l.on("end",te)}const J=Hb({zoomActivationKeyPressed:W,panOnDrag:H,zoomOnScroll:G,panOnScroll:O,zoomOnDoubleClick:$,zoomOnPinch:U,userSelectionActive:D,noPanClassName:q,noWheelClassName:N,lib:A,connectionInProgress:T});l.filter(J),$?f.on("dblclick.zoom",m):f.on("dblclick.zoom",null)}function y(){l.on("zoom",null)}async function b(N,q,P){const D=mr(N),O=l?.constrain()(D,q,P);return O&&await v(O),new Promise(H=>H(O))}async function p(N,q){const P=mr(N);return await v(P,q),new Promise(D=>D(P))}function x(N){if(f){const q=mr(N),P=f.property("__zoom");(P.k!==N.zoom||P.x!==N.x||P.y!==N.y)&&l?.transform(f,q,null,{sync:!0})}}function E(){const N=f?qy(f.node()):{x:0,y:0,k:1};return{x:N.x,y:N.y,zoom:N.k}}function _(N,q){return f?new Promise(P=>{l?.interpolate(q?.interpolate==="linear"?gt:gr).scaleTo(yr(f,q?.duration,q?.ease,()=>P(!0)),N)}):Promise.resolve(!1)}function w(N,q){return f?new Promise(P=>{l?.interpolate(q?.interpolate==="linear"?gt:gr).scaleBy(yr(f,q?.duration,q?.ease,()=>P(!0)),N)}):Promise.resolve(!1)}function S(N){l?.scaleExtent(N)}function R(N){l?.translateExtent(N)}function M(N){const q=!me(N)||N<0?0:N;l?.clickDistance(q)}return{update:g,destroy:y,setViewport:p,setViewportConstrained:b,getViewport:E,scaleTo:_,scaleBy:w,setScaleExtent:S,setTranslateExtent:R,syncViewport:x,setClickDistance:M}}var at;(function(e){e.Line="line",e.Handle="handle"})(at||(at={}));function $b({width:e,prevWidth:t,height:r,prevHeight:i,affectsX:n,affectsY:o}){const a=e-t,s=r-i,c=[a>0?1:a<0?-1:0,s>0?1:s<0?-1:0];return a&&n&&(c[0]=c[0]*-1),s&&o&&(c[1]=c[1]*-1),c}function Zu(e){const t=e.includes("right")||e.includes("left"),r=e.includes("bottom")||e.includes("top"),i=e.includes("left"),n=e.includes("top");return{isHorizontal:t,isVertical:r,affectsX:i,affectsY:n}}function je(e,t){return Math.max(0,t-e)}function De(e,t){return Math.max(0,e-t)}function Ot(e,t,r){return Math.max(0,t-e,e-r)}function Xu(e,t){return e?!t:t}function Vb(e,t,r,i,n,o,a,s){let{affectsX:c,affectsY:u}=t;const{isHorizontal:d,isVertical:l}=t,f=d&&l,{xSnapped:h,ySnapped:m}=r,{minWidth:v,maxWidth:g,minHeight:y,maxHeight:b}=i,{x:p,y:x,width:E,height:_,aspectRatio:w}=e;let S=Math.floor(d?h-e.pointerX:0),R=Math.floor(l?m-e.pointerY:0);const M=E+(c?-S:S),N=_+(u?-R:R),q=-o[0]*E,P=-o[1]*_;let D=Ot(M,v,g),O=Ot(N,y,b);if(a){let L=0,F=0;c&&S<0?L=je(p+S+q,a[0][0]):!c&&S>0&&(L=De(p+M+q,a[1][0])),u&&R<0?F=je(x+R+P,a[0][1]):!u&&R>0&&(F=De(x+N+P,a[1][1])),D=Math.max(D,L),O=Math.max(O,F)}if(s){let L=0,F=0;c&&S>0?L=De(p+S,s[0][0]):!c&&S<0&&(L=je(p+M,s[1][0])),u&&R>0?F=De(x+R,s[0][1]):!u&&R<0&&(F=je(x+N,s[1][1])),D=Math.max(D,L),O=Math.max(O,F)}if(n){if(d){const L=Ot(M/w,y,b)*w;if(D=Math.max(D,L),a){let F=0;!c&&!u||c&&!u&&f?F=De(x+P+M/w,a[1][1])*w:F=je(x+P+(c?S:-S)/w,a[0][1])*w,D=Math.max(D,F)}if(s){let F=0;!c&&!u||c&&!u&&f?F=je(x+M/w,s[1][1])*w:F=De(x+(c?S:-S)/w,s[0][1])*w,D=Math.max(D,F)}}if(l){const L=Ot(N*w,v,g)/w;if(O=Math.max(O,L),a){let F=0;!c&&!u||u&&!c&&f?F=De(p+N*w+q,a[1][0])/w:F=je(p+(u?R:-R)*w+q,a[0][0])/w,O=Math.max(O,F)}if(s){let F=0;!c&&!u||u&&!c&&f?F=je(p+N*w,s[1][0])/w:F=De(p+(u?R:-R)*w,s[0][0])/w,O=Math.max(O,F)}}}R=R+(R<0?O:-O),S=S+(S<0?D:-D),n&&(f?M>N*w?R=(Xu(c,u)?-S:S)/w:S=(Xu(c,u)?-R:R)*w:d?(R=S/w,u=c):(S=R*w,c=u));const H=c?p+S:p,z=u?x+R:x;return{width:E+(c?-S:S),height:_+(u?-R:R),x:o[0]*S*(c?-1:1)+H,y:o[1]*R*(u?-1:1)+z}}const Ag={width:0,height:0,x:0,y:0},Gb={...Ag,pointerX:0,pointerY:0,aspectRatio:1};function Ub(e){return[[0,0],[e.measured.width,e.measured.height]]}function Wb(e,t,r){const i=t.position.x+e.position.x,n=t.position.y+e.position.y,o=e.measured.width??0,a=e.measured.height??0,s=r[0]*o,c=r[1]*a;return[[i-s,n-c],[i+o-s,n+a-c]]}function Yb({domNode:e,nodeId:t,getStoreItems:r,onChange:i,onEnd:n}){const o=zt(e);let a={controlDirection:Zu("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function s({controlPosition:u,boundaries:d,keepAspectRatio:l,resizeDirection:f,onResizeStart:h,onResize:m,onResizeEnd:v,shouldResize:g}){let y={...Ag},b={...Gb};a={boundaries:d,resizeDirection:f,keepAspectRatio:l,controlDirection:Zu(u)};let p,x=null,E=[],_,w,S,R=!1;const M=Jp().on("start",N=>{const{nodeLookup:q,transform:P,snapGrid:D,snapToGrid:O,nodeOrigin:H,paneDomNode:z}=r();if(p=q.get(t),!p)return;x=z?.getBoundingClientRect()??null;const{xSnapped:L,ySnapped:F}=vt(N.sourceEvent,{transform:P,snapGrid:D,snapToGrid:O,containerBounds:x});y={width:p.measured.width??0,height:p.measured.height??0,x:p.position.x??0,y:p.position.y??0},b={...y,pointerX:L,pointerY:F,aspectRatio:y.width/y.height},_=void 0,p.parentId&&(p.extent==="parent"||p.expandParent)&&(_=q.get(p.parentId),w=_&&p.extent==="parent"?Ub(_):void 0),E=[],S=void 0;for(const[U,G]of q)if(G.parentId===t&&(E.push({id:U,position:{...G.position},extent:G.extent}),G.extent==="parent"||G.expandParent)){const $=Wb(G,p,G.origin??H);S?S=[[Math.min($[0][0],S[0][0]),Math.min($[0][1],S[0][1])],[Math.max($[1][0],S[1][0]),Math.max($[1][1],S[1][1])]]:S=$}h?.(N,{...y})}).on("drag",N=>{const{transform:q,snapGrid:P,snapToGrid:D,nodeOrigin:O}=r(),H=vt(N.sourceEvent,{transform:q,snapGrid:P,snapToGrid:D,containerBounds:x}),z=[];if(!p)return;const{x:L,y:F,width:U,height:G}=y,$={},W=p.origin??O,{width:A,height:I,x:T,y:j}=Vb(b,a.controlDirection,H,a.boundaries,a.keepAspectRatio,W,w,S),B=A!==U,V=I!==G,Z=T!==L&&B,J=j!==F&&V;if(!Z&&!J&&!B&&!V)return;if((Z||J||W[0]===1||W[1]===1)&&($.x=Z?T:y.x,$.y=J?j:y.y,y.x=$.x,y.y=$.y,E.length>0)){const X=T-L,ne=j-F;for(const ee of E)ee.position={x:ee.position.x-X+W[0]*(A-U),y:ee.position.y-ne+W[1]*(I-G)},z.push(ee)}if((B||V)&&($.width=B&&(!a.resizeDirection||a.resizeDirection==="horizontal")?A:y.width,$.height=V&&(!a.resizeDirection||a.resizeDirection==="vertical")?I:y.height,y.width=$.width,y.height=$.height),_&&p.expandParent){const X=W[0]*($.width??0);$.x&&$.x<X&&(y.x=X,b.x=b.x-($.x-X));const ne=W[1]*($.height??0);$.y&&$.y<ne&&(y.y=ne,b.y=b.y-($.y-ne))}const Q=$b({width:y.width,prevWidth:U,height:y.height,prevHeight:G,affectsX:a.controlDirection.affectsX,affectsY:a.controlDirection.affectsY}),Y={...y,direction:Q};g?.(N,Y)!==!1&&(R=!0,m?.(N,Y),i($,z))}).on("end",N=>{R&&(v?.(N,{...y}),n?.({...y}),R=!1)});o.call(M)}function c(){o.on(".drag",null)}return{update:s,destroy:c}}var br={exports:{}},xr={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qu;function Kb(){if(Qu)return xr;Qu=1;var e=dy(),t=ly();function r(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var i=typeof Object.is=="function"?Object.is:r,n=t.useSyncExternalStore,o=e.useRef,a=e.useEffect,s=e.useMemo,c=e.useDebugValue;return xr.useSyncExternalStoreWithSelector=function(u,d,l,f,h){var m=o(null);if(m.current===null){var v={hasValue:!1,value:null};m.current=v}else v=m.current;m=s(function(){function y(_){if(!b){if(b=!0,p=_,_=f(_),h!==void 0&&v.hasValue){var w=v.value;if(h(w,_))return x=w}return x=_}if(w=x,i(p,_))return w;var S=f(_);return h!==void 0&&h(w,S)?(p=_,w):(p=_,x=S)}var b=!1,p,x,E=l===void 0?null:l;return[function(){return y(d())},E===null?void 0:function(){return y(E())}]},[d,l,f,h]);var g=n(u,m[0],m[1]);return a(function(){v.hasValue=!0,v.value=g},[g]),c(g),g},xr}var Ju;function Zb(){return Ju||(Ju=1,br.exports=Kb()),br.exports}var Xb=Zb();const Qb=Wp(Xb),Jb={},ec=e=>{let t;const r=new Set,i=(d,l)=>{const f=typeof d=="function"?d(t):d;if(!Object.is(f,t)){const h=t;t=l??(typeof f!="object"||f===null)?f:Object.assign({},t,f),r.forEach(m=>m(t,h))}},n=()=>t,c={setState:i,getState:n,getInitialState:()=>u,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(Jb?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(i,n,c);return c},ex=e=>e?ec(e):ec,{useDebugValue:tx}=fy,{useSyncExternalStoreWithSelector:rx}=Qb,nx=e=>e;function kg(e,t=nx,r){const i=rx(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return tx(i),i}const tc=(e,t)=>{const r=ex(e),i=(n,o=t)=>kg(r,n,o);return Object.assign(i,r),i},ix=(e,t)=>e?tc(e,t):tc;function ie(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[i,n]of e)if(!Object.is(n,t.get(i)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const i of e)if(!t.has(i))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const i of r)if(!Object.prototype.hasOwnProperty.call(t,i)||!Object.is(e[i],t[i]))return!1;return!0}const Ut=k.createContext(null),ox=Ut.Provider,Tg=Ee.error001();function re(e,t){const r=k.useContext(Ut);if(r===null)throw new Error(Tg);return kg(r,e,t)}function oe(){const e=k.useContext(Ut);if(e===null)throw new Error(Tg);return k.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const rc={display:"none"},ax={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Pg="react-flow__node-desc",Og="react-flow__edge-desc",sx="react-flow__aria-live",ux=e=>e.ariaLiveMessage,cx=e=>e.ariaLabelConfig;function dx({rfId:e}){const t=re(ux);return C.jsx("div",{id:`${sx}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:ax,children:t})}function lx({rfId:e,disableKeyboardA11y:t}){const r=re(cx);return C.jsxs(C.Fragment,{children:[C.jsx("div",{id:`${Pg}-${e}`,style:rc,children:t?r["node.a11yDescription.default"]:r["node.a11yDescription.keyboardDisabled"]}),C.jsx("div",{id:`${Og}-${e}`,style:rc,children:r["edge.a11yDescription.default"]}),!t&&C.jsx(dx,{rfId:e})]})}const Wt=k.forwardRef(({position:e="top-left",children:t,className:r,style:i,...n},o)=>{const a=`${e}`.split("-");return C.jsx("div",{className:ce(["react-flow__panel",r,...a]),style:i,ref:o,...n,children:t})});Wt.displayName="Panel";function fx({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:C.jsx(Wt,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:C.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const hx=e=>{const t=[],r=[];for(const[,i]of e.nodeLookup)i.selected&&t.push(i.internals.userNode);for(const[,i]of e.edgeLookup)i.selected&&r.push(i);return{selectedNodes:t,selectedEdges:r}},jt=e=>e.id;function px(e,t){return ie(e.selectedNodes.map(jt),t.selectedNodes.map(jt))&&ie(e.selectedEdges.map(jt),t.selectedEdges.map(jt))}function gx({onSelectionChange:e}){const t=oe(),{selectedNodes:r,selectedEdges:i}=re(hx,px);return k.useEffect(()=>{const n={nodes:r,edges:i};e?.(n),t.getState().onSelectionChangeHandlers.forEach(o=>o(n))},[r,i,e]),null}const vx=e=>!!e.onSelectionChangeHandlers;function mx({onSelectionChange:e}){const t=re(vx);return e||t?C.jsx(gx,{onSelectionChange:e}):null}const jg=[0,0],yx={x:0,y:0,zoom:1},bx=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],nc=[...bx,"rfId"],xx=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),ic={translateExtent:mt,nodeOrigin:jg,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function _x(e){const{setNodes:t,setEdges:r,setMinZoom:i,setMaxZoom:n,setTranslateExtent:o,setNodeExtent:a,reset:s,setDefaultNodesAndEdges:c}=re(xx,ie),u=oe();k.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{d.current=ic,s()}),[]);const d=k.useRef(ic);return k.useEffect(()=>{for(const l of nc){const f=e[l],h=d.current[l];f!==h&&(typeof e[l]>"u"||(l==="nodes"?t(f):l==="edges"?r(f):l==="minZoom"?i(f):l==="maxZoom"?n(f):l==="translateExtent"?o(f):l==="nodeExtent"?a(f):l==="ariaLabelConfig"?u.setState({ariaLabelConfig:sb(f)}):l==="fitView"?u.setState({fitViewQueued:f}):l==="fitViewOptions"?u.setState({fitViewOptions:f}):u.setState({[l]:f})))}d.current=e},nc.map(l=>e[l])),null}function oc(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function wx(e){const[t,r]=k.useState(e==="system"?null:e);return k.useEffect(()=>{if(e!=="system"){r(e);return}const i=oc(),n=()=>r(i?.matches?"dark":"light");return n(),i?.addEventListener("change",n),()=>{i?.removeEventListener("change",n)}},[e]),t!==null?t:oc()?.matches?"dark":"light"}const ac=typeof document<"u"?document:null;function _t(e=null,t={target:ac,actInsideInputWithModifier:!0}){const[r,i]=k.useState(!1),n=k.useRef(!1),o=k.useRef(new Set([])),[a,s]=k.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(l=>typeof l=="string").map(l=>l.replace("+",`
`).replace(`

`,`
+`).split(`
`)),d=u.reduce((l,f)=>l.concat(...f),[]);return[u,d]}return[[],[]]},[e]);return k.useEffect(()=>{const c=t?.target??ac,u=t?.actInsideInputWithModifier??!0;if(e!==null){const d=h=>{if(n.current=h.ctrlKey||h.metaKey||h.shiftKey||h.altKey,(!n.current||n.current&&!u)&&pg(h))return!1;const v=uc(h.code,s);if(o.current.add(h[v]),sc(a,o.current,!1)){const g=h.composedPath?.()?.[0]||h.target,y=g?.nodeName==="BUTTON"||g?.nodeName==="A";t.preventDefault!==!1&&(n.current||!y)&&h.preventDefault(),i(!0)}},l=h=>{const m=uc(h.code,s);sc(a,o.current,!0)?(i(!1),o.current.clear()):o.current.delete(h[m]),h.key==="Meta"&&o.current.clear(),n.current=!1},f=()=>{o.current.clear(),i(!1)};return c?.addEventListener("keydown",d),c?.addEventListener("keyup",l),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{c?.removeEventListener("keydown",d),c?.removeEventListener("keyup",l),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[e,i]),r}function sc(e,t,r){return e.filter(i=>r||i.length===t.size).some(i=>i.every(n=>t.has(n)))}function uc(e,t){return t.includes(e)?"code":"key"}const Ex=()=>{const e=oe();return k.useMemo(()=>({zoomIn:t=>{const{panZoom:r}=e.getState();return r?r.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:r}=e.getState();return r?r.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,r)=>{const{panZoom:i}=e.getState();return i?i.scaleTo(t,{duration:r?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,r)=>{const{transform:[i,n,o],panZoom:a}=e.getState();return a?(await a.setViewport({x:t.x??i,y:t.y??n,zoom:t.zoom??o},r),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,r,i]=e.getState().transform;return{x:t,y:r,zoom:i}},setCenter:async(t,r,i)=>e.getState().setCenter(t,r,i),fitBounds:async(t,r)=>{const{width:i,height:n,minZoom:o,maxZoom:a,panZoom:s}=e.getState(),c=Js(t,i,n,o,a,r?.padding??.1);return s?(await s.setViewport(c,{duration:r?.duration,ease:r?.ease,interpolate:r?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,r={})=>{const{transform:i,snapGrid:n,snapToGrid:o,domNode:a}=e.getState();if(!a)return t;const{x:s,y:c}=a.getBoundingClientRect(),u={x:t.x-s,y:t.y-c},d=r.snapGrid??n,l=r.snapToGrid??o;return St(u,i,l,d)},flowToScreenPosition:t=>{const{transform:r,domNode:i}=e.getState();if(!i)return t;const{x:n,y:o}=i.getBoundingClientRect(),a=Bt(t,r);return{x:a.x+n,y:a.y+o}}}),[])};function Dg(e,t){const r=[],i=new Map,n=[];for(const o of e)if(o.type==="add"){n.push(o);continue}else if(o.type==="remove"||o.type==="replace")i.set(o.id,[o]);else{const a=i.get(o.id);a?a.push(o):i.set(o.id,[o])}for(const o of t){const a=i.get(o.id);if(!a){r.push(o);continue}if(a[0].type==="remove")continue;if(a[0].type==="replace"){r.push({...a[0].item});continue}const s={...o};for(const c of a)Cx(c,s);r.push(s)}return n.length&&n.forEach(o=>{o.index!==void 0?r.splice(o.index,0,{...o.item}):r.push({...o.item})}),r}function Cx(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Lg(e,t){return Dg(e,t)}function Bg(e,t){return Dg(e,t)}function $e(e,t){return{id:e,type:"select",selected:t}}function et(e,t=new Set,r=!1){const i=[];for(const[n,o]of e){const a=t.has(n);!(o.selected===void 0&&!a)&&o.selected!==a&&(r&&(o.selected=a),i.push($e(o.id,a)))}return i}function cc({items:e=[],lookup:t}){const r=[],i=new Map(e.map(n=>[n.id,n]));for(const[n,o]of e.entries()){const a=t.get(o.id),s=a?.internals?.userNode??a;s!==void 0&&s!==o&&r.push({id:o.id,item:o,type:"replace"}),s===void 0&&r.push({item:o,type:"add",index:n})}for(const[n]of t)i.get(n)===void 0&&r.push({id:n,type:"remove"});return r}function dc(e){return{id:e.id,type:"remove"}}const lc=e=>Xy(e),Sx=e=>ag(e);function Fg(e){return k.forwardRef(e)}const Nx=typeof window<"u"?k.useLayoutEffect:k.useEffect;function fc(e){const[t,r]=k.useState(BigInt(0)),[i]=k.useState(()=>Rx(()=>r(n=>n+BigInt(1))));return Nx(()=>{const n=i.get();n.length&&(e(n),i.reset())},[t]),i}function Rx(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:r=>{t.push(r),e()}}}const Hg=k.createContext(null);function qx({children:e}){const t=oe(),r=k.useCallback(s=>{const{nodes:c=[],setNodes:u,hasDefaultNodes:d,onNodesChange:l,nodeLookup:f,fitViewQueued:h,onNodesChangeMiddlewareMap:m}=t.getState();let v=c;for(const y of s)v=typeof y=="function"?y(v):y;let g=cc({items:v,lookup:f});for(const y of m.values())g=y(g);d&&u(v),g.length>0?l?.(g):h&&window.requestAnimationFrame(()=>{const{fitViewQueued:y,nodes:b,setNodes:p}=t.getState();y&&p(b)})},[]),i=fc(r),n=k.useCallback(s=>{const{edges:c=[],setEdges:u,hasDefaultEdges:d,onEdgesChange:l,edgeLookup:f}=t.getState();let h=c;for(const m of s)h=typeof m=="function"?m(h):m;d?u(h):l&&l(cc({items:h,lookup:f}))},[]),o=fc(n),a=k.useMemo(()=>({nodeQueue:i,edgeQueue:o}),[]);return C.jsx(Hg.Provider,{value:a,children:e})}function Ix(){const e=k.useContext(Hg);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const Mx=e=>!!e.panZoom;function au(){const e=Ex(),t=oe(),r=Ix(),i=re(Mx),n=k.useMemo(()=>{const o=l=>t.getState().nodeLookup.get(l),a=l=>{r.nodeQueue.push(l)},s=l=>{r.edgeQueue.push(l)},c=l=>{const{nodeLookup:f,nodeOrigin:h}=t.getState(),m=lc(l)?l:f.get(l.id),v=m.parentId?fg(m.position,m.measured,m.parentId,f,h):m.position,g={...m,position:v,width:m.measured?.width??m.width,height:m.measured?.height??m.height};return it(g)},u=(l,f,h={replace:!1})=>{a(m=>m.map(v=>{if(v.id===l){const g=typeof f=="function"?f(v):f;return h.replace&&lc(g)?g:{...v,...g}}return v}))},d=(l,f,h={replace:!1})=>{s(m=>m.map(v=>{if(v.id===l){const g=typeof f=="function"?f(v):f;return h.replace&&Sx(g)?g:{...v,...g}}return v}))};return{getNodes:()=>t.getState().nodes.map(l=>({...l})),getNode:l=>o(l)?.internals.userNode,getInternalNode:o,getEdges:()=>{const{edges:l=[]}=t.getState();return l.map(f=>({...f}))},getEdge:l=>t.getState().edgeLookup.get(l),setNodes:a,setEdges:s,addNodes:l=>{const f=Array.isArray(l)?l:[l];r.nodeQueue.push(h=>[...h,...f])},addEdges:l=>{const f=Array.isArray(l)?l:[l];r.edgeQueue.push(h=>[...h,...f])},toObject:()=>{const{nodes:l=[],edges:f=[],transform:h}=t.getState(),[m,v,g]=h;return{nodes:l.map(y=>({...y})),edges:f.map(y=>({...y})),viewport:{x:m,y:v,zoom:g}}},deleteElements:async({nodes:l=[],edges:f=[]})=>{const{nodes:h,edges:m,onNodesDelete:v,onEdgesDelete:g,triggerNodeChanges:y,triggerEdgeChanges:b,onDelete:p,onBeforeDelete:x}=t.getState(),{nodes:E,edges:_}=await rb({nodesToRemove:l,edgesToRemove:f,nodes:h,edges:m,onBeforeDelete:x}),w=_.length>0,S=E.length>0;if(w){const R=_.map(dc);g?.(_),b(R)}if(S){const R=E.map(dc);v?.(E),y(R)}return(S||w)&&p?.({nodes:E,edges:_}),{deletedNodes:E,deletedEdges:_}},getIntersectingNodes:(l,f=!0,h)=>{const m=Bu(l),v=m?l:c(l),g=h!==void 0;return v?(h||t.getState().nodes).filter(y=>{const b=t.getState().nodeLookup.get(y.id);if(b&&!m&&(y.id===l.id||!b.internals.positionAbsolute))return!1;const p=it(g?y:b),x=bt(p,v);return f&&x>0||x>=p.width*p.height||x>=v.width*v.height}):[]},isNodeIntersecting:(l,f,h=!0)=>{const v=Bu(l)?l:c(l);if(!v)return!1;const g=bt(v,f);return h&&g>0||g>=f.width*f.height||g>=v.width*v.height},updateNode:u,updateNodeData:(l,f,h={replace:!1})=>{u(l,m=>{const v=typeof f=="function"?f(m):f;return h.replace?{...m,data:v}:{...m,data:{...m.data,...v}}},h)},updateEdge:d,updateEdgeData:(l,f,h={replace:!1})=>{d(l,m=>{const v=typeof f=="function"?f(m):f;return h.replace?{...m,data:v}:{...m,data:{...m.data,...v}}},h)},getNodesBounds:l=>{const{nodeLookup:f,nodeOrigin:h}=t.getState();return Qy(l,{nodeLookup:f,nodeOrigin:h})},getHandleConnections:({type:l,id:f,nodeId:h})=>Array.from(t.getState().connectionLookup.get(`${h}-${l}${f?`-${f}`:""}`)?.values()??[]),getNodeConnections:({type:l,handleId:f,nodeId:h})=>Array.from(t.getState().connectionLookup.get(`${h}${l?f?`-${l}-${f}`:`-${l}`:""}`)?.values()??[]),fitView:async l=>{const f=t.getState().fitViewResolver??ab();return t.setState({fitViewQueued:!0,fitViewOptions:l,fitViewResolver:f}),r.nodeQueue.push(h=>[...h]),f.promise}}},[]);return k.useMemo(()=>({...n,...e,viewportInitialized:i}),[i])}const hc=e=>e.selected,Ax=typeof window<"u"?window:void 0;function kx({deleteKeyCode:e,multiSelectionKeyCode:t}){const r=oe(),{deleteElements:i}=au(),n=_t(e,{actInsideInputWithModifier:!1}),o=_t(t,{target:Ax});k.useEffect(()=>{if(n){const{edges:a,nodes:s}=r.getState();i({nodes:s.filter(hc),edges:a.filter(hc)}),r.setState({nodesSelectionActive:!1})}},[n]),k.useEffect(()=>{r.setState({multiSelectionActive:o})},[o])}function Tx(e){const t=oe();k.useEffect(()=>{const r=()=>{if(!e.current||!(e.current.checkVisibility?.()??!0))return!1;const i=eu(e.current);(i.height===0||i.width===0)&&t.getState().onError?.("004",Ee.error004()),t.setState({width:i.width||500,height:i.height||500})};if(e.current){r(),window.addEventListener("resize",r);const i=new ResizeObserver(()=>r());return i.observe(e.current),()=>{window.removeEventListener("resize",r),i&&e.current&&i.unobserve(e.current)}}},[])}const Yt={position:"absolute",width:"100%",height:"100%",top:0,left:0},Px=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function Ox({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:r=!0,panOnScroll:i=!1,panOnScrollSpeed:n=.5,panOnScrollMode:o=Ve.Free,zoomOnDoubleClick:a=!0,panOnDrag:s=!0,defaultViewport:c,translateExtent:u,minZoom:d,maxZoom:l,zoomActivationKeyCode:f,preventScrolling:h=!0,children:m,noWheelClassName:v,noPanClassName:g,onViewportChange:y,isControlledViewport:b,paneClickDistance:p,selectionOnDrag:x}){const E=oe(),_=k.useRef(null),{userSelectionActive:w,lib:S,connectionInProgress:R}=re(Px,ie),M=_t(f),N=k.useRef();Tx(_);const q=k.useCallback(P=>{y?.({x:P[0],y:P[1],zoom:P[2]}),b||E.setState({transform:P})},[y,b]);return k.useEffect(()=>{if(_.current){N.current=zb({domNode:_.current,minZoom:d,maxZoom:l,translateExtent:u,viewport:c,onDraggingChange:H=>E.setState({paneDragging:H}),onPanZoomStart:(H,z)=>{const{onViewportChangeStart:L,onMoveStart:F}=E.getState();F?.(H,z),L?.(z)},onPanZoom:(H,z)=>{const{onViewportChange:L,onMove:F}=E.getState();F?.(H,z),L?.(z)},onPanZoomEnd:(H,z)=>{const{onViewportChangeEnd:L,onMoveEnd:F}=E.getState();F?.(H,z),L?.(z)}});const{x:P,y:D,zoom:O}=N.current.getViewport();return E.setState({panZoom:N.current,transform:[P,D,O],domNode:_.current.closest(".react-flow")}),()=>{N.current?.destroy()}}},[]),k.useEffect(()=>{N.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:r,panOnScroll:i,panOnScrollSpeed:n,panOnScrollMode:o,zoomOnDoubleClick:a,panOnDrag:s,zoomActivationKeyPressed:M,preventScrolling:h,noPanClassName:g,userSelectionActive:w,noWheelClassName:v,lib:S,onTransformChange:q,connectionInProgress:R,selectionOnDrag:x,paneClickDistance:p})},[e,t,r,i,n,o,a,s,M,h,g,w,v,S,q,R,x,p]),C.jsx("div",{className:"react-flow__renderer",ref:_,style:Yt,children:m})}const jx=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Dx(){const{userSelectionActive:e,userSelectionRect:t}=re(jx,ie);return e&&t?C.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const _r=(e,t)=>r=>{r.target===t.current&&e?.(r)},Lx=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function Bx({isSelecting:e,selectionKeyPressed:t,selectionMode:r=yt.Full,panOnDrag:i,paneClickDistance:n,selectionOnDrag:o,onSelectionStart:a,onSelectionEnd:s,onPaneClick:c,onPaneContextMenu:u,onPaneScroll:d,onPaneMouseEnter:l,onPaneMouseMove:f,onPaneMouseLeave:h,children:m}){const v=oe(),{userSelectionActive:g,elementsSelectable:y,dragging:b,connectionInProgress:p}=re(Lx,ie),x=y&&(e||g),E=k.useRef(null),_=k.useRef(),w=k.useRef(new Set),S=k.useRef(new Set),R=k.useRef(!1),M=L=>{if(R.current||p){R.current=!1;return}c?.(L),v.getState().resetSelectedElements(),v.setState({nodesSelectionActive:!1})},N=L=>{if(Array.isArray(i)&&i?.includes(2)){L.preventDefault();return}u?.(L)},q=d?L=>d(L):void 0,P=L=>{R.current&&(L.stopPropagation(),R.current=!1)},D=L=>{const{domNode:F}=v.getState();if(_.current=F?.getBoundingClientRect(),!_.current)return;const U=L.target===E.current;if(!U&&!!L.target.closest(".nokey")||!e||!(o&&U||t)||L.button!==0||!L.isPrimary)return;L.target?.setPointerCapture?.(L.pointerId),R.current=!1;const{x:W,y:A}=ye(L.nativeEvent,_.current);v.setState({userSelectionRect:{width:0,height:0,startX:W,startY:A,x:W,y:A}}),U||(L.stopPropagation(),L.preventDefault())},O=L=>{const{userSelectionRect:F,transform:U,nodeLookup:G,edgeLookup:$,connectionLookup:W,triggerNodeChanges:A,triggerEdgeChanges:I,defaultEdgeOptions:T,resetSelectedElements:j}=v.getState();if(!_.current||!F)return;const{x:B,y:V}=ye(L.nativeEvent,_.current),{startX:Z,startY:J}=F;if(!R.current){const ne=t?0:n;if(Math.hypot(B-Z,V-J)<=ne)return;j(),a?.(L)}R.current=!0;const Q={startX:Z,startY:J,x:B<Z?B:Z,y:V<J?V:J,width:Math.abs(B-Z),height:Math.abs(V-J)},Y=w.current,te=S.current;w.current=new Set(Qs(G,Q,U,r===yt.Partial,!0).map(ne=>ne.id)),S.current=new Set;const X=T?.selectable??!0;for(const ne of w.current){const ee=W.get(ne);if(ee)for(const{edgeId:fe}of ee.values()){const le=$.get(fe);le&&(le.selectable??X)&&S.current.add(fe)}}if(!Fu(Y,w.current)){const ne=et(G,w.current,!0);A(ne)}if(!Fu(te,S.current)){const ne=et($,S.current);I(ne)}v.setState({userSelectionRect:Q,userSelectionActive:!0,nodesSelectionActive:!1})},H=L=>{L.button===0&&(L.target?.releasePointerCapture?.(L.pointerId),!g&&L.target===E.current&&v.getState().userSelectionRect&&M?.(L),v.setState({userSelectionActive:!1,userSelectionRect:null}),R.current&&(s?.(L),v.setState({nodesSelectionActive:w.current.size>0})))},z=i===!0||Array.isArray(i)&&i.includes(0);return C.jsxs("div",{className:ce(["react-flow__pane",{draggable:z,dragging:b,selection:e}]),onClick:x?void 0:_r(M,E),onContextMenu:_r(N,E),onWheel:_r(q,E),onPointerEnter:x?void 0:l,onPointerMove:x?O:f,onPointerUp:x?H:void 0,onPointerDownCapture:x?D:void 0,onClickCapture:x?P:void 0,onPointerLeave:h,ref:E,style:Yt,children:[m,C.jsx(Dx,{})]})}function Ks({id:e,store:t,unselect:r=!1,nodeRef:i}){const{addSelectedNodes:n,unselectNodesAndEdges:o,multiSelectionActive:a,nodeLookup:s,onError:c}=t.getState(),u=s.get(e);if(!u){c?.("012",Ee.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(r||u.selected&&a)&&(o({nodes:[u],edges:[]}),requestAnimationFrame(()=>i?.current?.blur())):n([e])}function zg({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:i,nodeId:n,isSelectable:o,nodeClickDistance:a}){const s=oe(),[c,u]=k.useState(!1),d=k.useRef();return k.useEffect(()=>{d.current=qb({getStoreItems:()=>s.getState(),onNodeMouseDown:l=>{Ks({id:l,store:s,nodeRef:e})},onDragStart:()=>{u(!0)},onDragStop:()=>{u(!1)}})},[]),k.useEffect(()=>{if(t)d.current?.destroy();else if(e.current)return d.current?.update({noDragClassName:r,handleSelector:i,domNode:e.current,isSelectable:o,nodeId:n,nodeClickDistance:a}),()=>{d.current?.destroy()}},[r,i,t,o,e,n]),c}const Fx=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function $g(){const e=oe();return k.useCallback(r=>{const{nodeExtent:i,snapToGrid:n,snapGrid:o,nodesDraggable:a,onError:s,updateNodePositions:c,nodeLookup:u,nodeOrigin:d}=e.getState(),l=new Map,f=Fx(a),h=n?o[0]:5,m=n?o[1]:5,v=r.direction.x*h*r.factor,g=r.direction.y*m*r.factor;for(const[,y]of u){if(!f(y))continue;let b={x:y.internals.positionAbsolute.x+v,y:y.internals.positionAbsolute.y+g};n&&(b=Ct(b,o));const{position:p,positionAbsolute:x}=sg({nodeId:y.id,nextPosition:b,nodeLookup:u,nodeExtent:i,nodeOrigin:d,onError:s});y.position=p,y.internals.positionAbsolute=x,l.set(y.id,y)}c(l)},[])}const su=k.createContext(null),Hx=su.Provider;su.Consumer;const Vg=()=>k.useContext(su),zx=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),$x=(e,t,r)=>i=>{const{connectionClickStartHandle:n,connectionMode:o,connection:a}=i,{fromHandle:s,toHandle:c,isValid:u}=a,d=c?.nodeId===e&&c?.id===t&&c?.type===r;return{connectingFrom:s?.nodeId===e&&s?.id===t&&s?.type===r,connectingTo:d,clickConnecting:n?.nodeId===e&&n?.id===t&&n?.type===r,isPossibleEndHandle:o===tt.Strict?s?.type!==r:e!==s?.nodeId||t!==s?.id,connectionInProcess:!!s,clickConnectionInProcess:!!n,valid:d&&u}};function Vx({type:e="source",position:t=K.Top,isValidConnection:r,isConnectable:i=!0,isConnectableStart:n=!0,isConnectableEnd:o=!0,id:a,onConnect:s,children:c,className:u,onMouseDown:d,onTouchStart:l,...f},h){const m=a||null,v=e==="target",g=oe(),y=Vg(),{connectOnClick:b,noPanClassName:p,rfId:x}=re(zx,ie),{connectingFrom:E,connectingTo:_,clickConnecting:w,isPossibleEndHandle:S,connectionInProcess:R,clickConnectionInProcess:M,valid:N}=re($x(y,m,e),ie);y||g.getState().onError?.("010",Ee.error010());const q=O=>{const{defaultEdgeOptions:H,onConnect:z,hasDefaultEdges:L}=g.getState(),F={...H,...O};if(L){const{edges:U,setEdges:G}=g.getState();G(bg(F,U))}z?.(F),s?.(F)},P=O=>{if(!y)return;const H=gg(O.nativeEvent);if(n&&(H&&O.button===0||!H)){const z=g.getState();Ys.onPointerDown(O.nativeEvent,{handleDomNode:O.currentTarget,autoPanOnConnect:z.autoPanOnConnect,connectionMode:z.connectionMode,connectionRadius:z.connectionRadius,domNode:z.domNode,nodeLookup:z.nodeLookup,lib:z.lib,isTarget:v,handleId:m,nodeId:y,flowId:z.rfId,panBy:z.panBy,cancelConnection:z.cancelConnection,onConnectStart:z.onConnectStart,onConnectEnd:z.onConnectEnd,updateConnection:z.updateConnection,onConnect:q,isValidConnection:r||z.isValidConnection,getTransform:()=>g.getState().transform,getFromHandle:()=>g.getState().connection.fromHandle,autoPanSpeed:z.autoPanSpeed,dragThreshold:z.connectionDragThreshold})}H?d?.(O):l?.(O)},D=O=>{const{onClickConnectStart:H,onClickConnectEnd:z,connectionClickStartHandle:L,connectionMode:F,isValidConnection:U,lib:G,rfId:$,nodeLookup:W,connection:A}=g.getState();if(!y||!L&&!n)return;if(!L){H?.(O.nativeEvent,{nodeId:y,handleId:m,handleType:e}),g.setState({connectionClickStartHandle:{nodeId:y,type:e,id:m}});return}const I=hg(O.target),T=r||U,{connection:j,isValid:B}=Ys.isValid(O.nativeEvent,{handle:{nodeId:y,id:m,type:e},connectionMode:F,fromNodeId:L.nodeId,fromHandleId:L.id||null,fromType:L.type,isValidConnection:T,flowId:$,doc:I,lib:G,nodeLookup:W});B&&j&&q(j);const V=structuredClone(A);delete V.inProgress,V.toPosition=V.toHandle?V.toHandle.position:null,z?.(O,V),g.setState({connectionClickStartHandle:null})};return C.jsx("div",{"data-handleid":m,"data-nodeid":y,"data-handlepos":t,"data-id":`${x}-${y}-${m}-${e}`,className:ce(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",p,u,{source:!v,target:v,connectable:i,connectablestart:n,connectableend:o,clickconnecting:w,connectingfrom:E,connectingto:_,valid:N,connectionindicator:i&&(!R||S)&&(R||M?o:n)}]),onMouseDown:P,onTouchStart:P,onClick:b?D:void 0,ref:h,...f,children:c})}const Be=k.memo(Fg(Vx));function Gx({data:e,isConnectable:t,sourcePosition:r=K.Bottom}){return C.jsxs(C.Fragment,{children:[e?.label,C.jsx(Be,{type:"source",position:r,isConnectable:t})]})}function Ux({data:e,isConnectable:t,targetPosition:r=K.Top,sourcePosition:i=K.Bottom}){return C.jsxs(C.Fragment,{children:[C.jsx(Be,{type:"target",position:r,isConnectable:t}),e?.label,C.jsx(Be,{type:"source",position:i,isConnectable:t})]})}function Wx(){return null}function Yx({data:e,isConnectable:t,targetPosition:r=K.Top}){return C.jsxs(C.Fragment,{children:[C.jsx(Be,{type:"target",position:r,isConnectable:t}),e?.label]})}const Ft={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},pc={input:Gx,default:Ux,output:Yx,group:Wx};function Kx(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}const Zx=e=>{const{width:t,height:r,x:i,y:n}=Et(e.nodeLookup,{filter:o=>!!o.selected});return{width:me(t)?t:null,height:me(r)?r:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${i}px,${n}px)`}};function Xx({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const i=oe(),{width:n,height:o,transformString:a,userSelectionActive:s}=re(Zx,ie),c=$g(),u=k.useRef(null);if(k.useEffect(()=>{r||u.current?.focus({preventScroll:!0})},[r]),zg({nodeRef:u}),s||!n||!o)return null;const d=e?f=>{const h=i.getState().nodes.filter(m=>m.selected);e(f,h)}:void 0,l=f=>{Object.prototype.hasOwnProperty.call(Ft,f.key)&&(f.preventDefault(),c({direction:Ft[f.key],factor:f.shiftKey?4:1}))};return C.jsx("div",{className:ce(["react-flow__nodesselection","react-flow__container",t]),style:{transform:a},children:C.jsx("div",{ref:u,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:r?void 0:-1,onKeyDown:r?void 0:l,style:{width:n,height:o}})})}const gc=typeof window<"u"?window:void 0,Qx=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Gg({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:i,onPaneMouseLeave:n,onPaneContextMenu:o,onPaneScroll:a,paneClickDistance:s,deleteKeyCode:c,selectionKeyCode:u,selectionOnDrag:d,selectionMode:l,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:m,panActivationKeyCode:v,zoomActivationKeyCode:g,elementsSelectable:y,zoomOnScroll:b,zoomOnPinch:p,panOnScroll:x,panOnScrollSpeed:E,panOnScrollMode:_,zoomOnDoubleClick:w,panOnDrag:S,defaultViewport:R,translateExtent:M,minZoom:N,maxZoom:q,preventScrolling:P,onSelectionContextMenu:D,noWheelClassName:O,noPanClassName:H,disableKeyboardA11y:z,onViewportChange:L,isControlledViewport:F}){const{nodesSelectionActive:U,userSelectionActive:G}=re(Qx,ie),$=_t(u,{target:gc}),W=_t(v,{target:gc}),A=W||S,I=W||x,T=d&&A!==!0,j=$||G||T;return kx({deleteKeyCode:c,multiSelectionKeyCode:m}),C.jsx(Ox,{onPaneContextMenu:o,elementsSelectable:y,zoomOnScroll:b,zoomOnPinch:p,panOnScroll:I,panOnScrollSpeed:E,panOnScrollMode:_,zoomOnDoubleClick:w,panOnDrag:!$&&A,defaultViewport:R,translateExtent:M,minZoom:N,maxZoom:q,zoomActivationKeyCode:g,preventScrolling:P,noWheelClassName:O,noPanClassName:H,onViewportChange:L,isControlledViewport:F,paneClickDistance:s,selectionOnDrag:T,children:C.jsxs(Bx,{onSelectionStart:f,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:i,onPaneMouseLeave:n,onPaneContextMenu:o,onPaneScroll:a,panOnDrag:A,isSelecting:!!j,selectionMode:l,selectionKeyPressed:$,paneClickDistance:s,selectionOnDrag:T,children:[e,U&&C.jsx(Xx,{onSelectionContextMenu:D,noPanClassName:H,disableKeyboardA11y:z})]})})}Gg.displayName="FlowRenderer";const Jx=k.memo(Gg),e_=e=>t=>e?Qs(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(r=>r.id):Array.from(t.nodeLookup.keys());function t_(e){return re(k.useCallback(e_(e),[e]),ie)}const r_=e=>e.updateNodeInternals;function n_(){const e=re(r_),[t]=k.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(r=>{const i=new Map;r.forEach(n=>{const o=n.target.getAttribute("data-id");i.set(o,{id:o,nodeElement:n.target,force:!0})}),e(i)}));return k.useEffect(()=>()=>{t?.disconnect()},[t]),t}function i_({node:e,nodeType:t,hasDimensions:r,resizeObserver:i}){const n=oe(),o=k.useRef(null),a=k.useRef(null),s=k.useRef(e.sourcePosition),c=k.useRef(e.targetPosition),u=k.useRef(t),d=r&&!!e.internals.handleBounds;return k.useEffect(()=>{o.current&&!e.hidden&&(!d||a.current!==o.current)&&(a.current&&i?.unobserve(a.current),i?.observe(o.current),a.current=o.current)},[d,e.hidden]),k.useEffect(()=>()=>{a.current&&(i?.unobserve(a.current),a.current=null)},[]),k.useEffect(()=>{if(o.current){const l=u.current!==t,f=s.current!==e.sourcePosition,h=c.current!==e.targetPosition;(l||f||h)&&(u.current=t,s.current=e.sourcePosition,c.current=e.targetPosition,n.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:o.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),o}function o_({id:e,onClick:t,onMouseEnter:r,onMouseMove:i,onMouseLeave:n,onContextMenu:o,onDoubleClick:a,nodesDraggable:s,elementsSelectable:c,nodesConnectable:u,nodesFocusable:d,resizeObserver:l,noDragClassName:f,noPanClassName:h,disableKeyboardA11y:m,rfId:v,nodeTypes:g,nodeClickDistance:y,onError:b}){const{node:p,internals:x,isParent:E}=re(B=>{const V=B.nodeLookup.get(e),Z=B.parentLookup.has(e);return{node:V,internals:V.internals,isParent:Z}},ie);let _=p.type||"default",w=g?.[_]||pc[_];w===void 0&&(b?.("003",Ee.error003(_)),_="default",w=g?.default||pc.default);const S=!!(p.draggable||s&&typeof p.draggable>"u"),R=!!(p.selectable||c&&typeof p.selectable>"u"),M=!!(p.connectable||u&&typeof p.connectable>"u"),N=!!(p.focusable||d&&typeof p.focusable>"u"),q=oe(),P=lg(p),D=i_({node:p,nodeType:_,hasDimensions:P,resizeObserver:l}),O=zg({nodeRef:D,disabled:p.hidden||!S,noDragClassName:f,handleSelector:p.dragHandle,nodeId:e,isSelectable:R,nodeClickDistance:y}),H=$g();if(p.hidden)return null;const z=Me(p),L=Kx(p),F=R||S||t||r||i||n,U=r?B=>r(B,{...x.userNode}):void 0,G=i?B=>i(B,{...x.userNode}):void 0,$=n?B=>n(B,{...x.userNode}):void 0,W=o?B=>o(B,{...x.userNode}):void 0,A=a?B=>a(B,{...x.userNode}):void 0,I=B=>{const{selectNodesOnDrag:V,nodeDragThreshold:Z}=q.getState();R&&(!V||!S||Z>0)&&Ks({id:e,store:q,nodeRef:D}),t&&t(B,{...x.userNode})},T=B=>{if(!(pg(B.nativeEvent)||m)){if(rg.includes(B.key)&&R){const V=B.key==="Escape";Ks({id:e,store:q,unselect:V,nodeRef:D})}else if(S&&p.selected&&Object.prototype.hasOwnProperty.call(Ft,B.key)){B.preventDefault();const{ariaLabelConfig:V}=q.getState();q.setState({ariaLiveMessage:V["node.a11yDescription.ariaLiveMessage"]({direction:B.key.replace("Arrow","").toLowerCase(),x:~~x.positionAbsolute.x,y:~~x.positionAbsolute.y})}),H({direction:Ft[B.key],factor:B.shiftKey?4:1})}}},j=()=>{if(m||!D.current?.matches(":focus-visible"))return;const{transform:B,width:V,height:Z,autoPanOnNodeFocus:J,setCenter:Q}=q.getState();if(!J)return;Qs(new Map([[e,p]]),{x:0,y:0,width:V,height:Z},B,!0).length>0||Q(p.position.x+z.width/2,p.position.y+z.height/2,{zoom:B[2]})};return C.jsx("div",{className:ce(["react-flow__node",`react-flow__node-${_}`,{[h]:S},p.className,{selected:p.selected,selectable:R,parent:E,draggable:S,dragging:O}]),ref:D,style:{zIndex:x.z,transform:`translate(${x.positionAbsolute.x}px,${x.positionAbsolute.y}px)`,pointerEvents:F?"all":"none",visibility:P?"visible":"hidden",...p.style,...L},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:U,onMouseMove:G,onMouseLeave:$,onContextMenu:W,onClick:I,onDoubleClick:A,onKeyDown:N?T:void 0,tabIndex:N?0:void 0,onFocus:N?j:void 0,role:p.ariaRole??(N?"group":void 0),"aria-roledescription":"node","aria-describedby":m?void 0:`${Pg}-${v}`,"aria-label":p.ariaLabel,...p.domAttributes,children:C.jsx(Hx,{value:e,children:C.jsx(w,{id:e,data:p.data,type:_,positionAbsoluteX:x.positionAbsolute.x,positionAbsoluteY:x.positionAbsolute.y,selected:p.selected??!1,selectable:R,draggable:S,deletable:p.deletable??!0,isConnectable:M,sourcePosition:p.sourcePosition,targetPosition:p.targetPosition,dragging:O,dragHandle:p.dragHandle,zIndex:x.z,parentId:p.parentId,...z})})})}var a_=k.memo(o_);const s_=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Ug(e){const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:i,elementsSelectable:n,onError:o}=re(s_,ie),a=t_(e.onlyRenderVisibleElements),s=n_();return C.jsx("div",{className:"react-flow__nodes",style:Yt,children:a.map(c=>C.jsx(a_,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:s,nodesDraggable:t,nodesConnectable:r,nodesFocusable:i,elementsSelectable:n,nodeClickDistance:e.nodeClickDistance,onError:o},c))})}Ug.displayName="NodeRenderer";const u_=k.memo(Ug);function c_(e){return re(k.useCallback(r=>{if(!e)return r.edges.map(n=>n.id);const i=[];if(r.width&&r.height)for(const n of r.edges){const o=r.nodeLookup.get(n.source),a=r.nodeLookup.get(n.target);o&&a&&db({sourceNode:o,targetNode:a,width:r.width,height:r.height,transform:r.transform})&&i.push(n.id)}return i},[e]),ie)}const d_=({color:e="none",strokeWidth:t=1})=>{const r={strokeWidth:t,...e&&{stroke:e}};return C.jsx("polyline",{className:"arrow",style:r,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},l_=({color:e="none",strokeWidth:t=1})=>{const r={strokeWidth:t,...e&&{stroke:e,fill:e}};return C.jsx("polyline",{className:"arrowclosed",style:r,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},vc={[rt.Arrow]:d_,[rt.ArrowClosed]:l_};function f_(e){const t=oe();return k.useMemo(()=>Object.prototype.hasOwnProperty.call(vc,e)?vc[e]:(t.getState().onError?.("009",Ee.error009(e)),null),[e])}const h_=({id:e,type:t,color:r,width:i=12.5,height:n=12.5,markerUnits:o="strokeWidth",strokeWidth:a,orient:s="auto-start-reverse"})=>{const c=f_(t);return c?C.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${i}`,markerHeight:`${n}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:s,refX:"0",refY:"0",children:C.jsx(c,{color:r,strokeWidth:a})}):null},Wg=({defaultColor:e,rfId:t})=>{const r=re(o=>o.edges),i=re(o=>o.defaultEdgeOptions),n=k.useMemo(()=>mb(r,{id:t,defaultColor:e,defaultMarkerStart:i?.markerStart,defaultMarkerEnd:i?.markerEnd}),[r,i,t,e]);return n.length?C.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:C.jsx("defs",{children:n.map(o=>C.jsx(h_,{id:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient},o.id))})}):null};Wg.displayName="MarkerDefinitions";var p_=k.memo(Wg);function Yg({x:e,y:t,label:r,labelStyle:i,labelShowBg:n=!0,labelBgStyle:o,labelBgPadding:a=[2,4],labelBgBorderRadius:s=2,children:c,className:u,...d}){const[l,f]=k.useState({x:1,y:0,width:0,height:0}),h=ce(["react-flow__edge-textwrapper",u]),m=k.useRef(null);return k.useEffect(()=>{if(m.current){const v=m.current.getBBox();f({x:v.x,y:v.y,width:v.width,height:v.height})}},[r]),r?C.jsxs("g",{transform:`translate(${e-l.width/2} ${t-l.height/2})`,className:h,visibility:l.width?"visible":"hidden",...d,children:[n&&C.jsx("rect",{width:l.width+2*a[0],x:-a[0],y:-a[1],height:l.height+2*a[1],className:"react-flow__edge-textbg",style:o,rx:s,ry:s}),C.jsx("text",{className:"react-flow__edge-text",y:l.height/2,dy:"0.3em",ref:m,style:i,children:r}),c]}):null}Yg.displayName="EdgeText";const g_=k.memo(Yg);function Kt({path:e,labelX:t,labelY:r,label:i,labelStyle:n,labelShowBg:o,labelBgStyle:a,labelBgPadding:s,labelBgBorderRadius:c,interactionWidth:u=20,...d}){return C.jsxs(C.Fragment,{children:[C.jsx("path",{...d,d:e,fill:"none",className:ce(["react-flow__edge-path",d.className])}),u?C.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:u,className:"react-flow__edge-interaction"}):null,i&&me(t)&&me(r)?C.jsx(g_,{x:t,y:r,label:i,labelStyle:n,labelShowBg:o,labelBgStyle:a,labelBgPadding:s,labelBgBorderRadius:c}):null]})}function mc({pos:e,x1:t,y1:r,x2:i,y2:n}){return e===K.Left||e===K.Right?[.5*(t+i),r]:[t,.5*(r+n)]}function Kg({sourceX:e,sourceY:t,sourcePosition:r=K.Bottom,targetX:i,targetY:n,targetPosition:o=K.Top}){const[a,s]=mc({pos:r,x1:e,y1:t,x2:i,y2:n}),[c,u]=mc({pos:o,x1:i,y1:n,x2:e,y2:t}),[d,l,f,h]=vg({sourceX:e,sourceY:t,targetX:i,targetY:n,sourceControlX:a,sourceControlY:s,targetControlX:c,targetControlY:u});return[`M${e},${t} C${a},${s} ${c},${u} ${i},${n}`,d,l,f,h]}function Zg(e){return k.memo(({id:t,sourceX:r,sourceY:i,targetX:n,targetY:o,sourcePosition:a,targetPosition:s,label:c,labelStyle:u,labelShowBg:d,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:h,style:m,markerEnd:v,markerStart:g,interactionWidth:y})=>{const[b,p,x]=Kg({sourceX:r,sourceY:i,sourcePosition:a,targetX:n,targetY:o,targetPosition:s}),E=e.isInternal?void 0:t;return C.jsx(Kt,{id:E,path:b,labelX:p,labelY:x,label:c,labelStyle:u,labelShowBg:d,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:h,style:m,markerEnd:v,markerStart:g,interactionWidth:y})})}const v_=Zg({isInternal:!1}),Xg=Zg({isInternal:!0});v_.displayName="SimpleBezierEdge";Xg.displayName="SimpleBezierEdgeInternal";function Qg(e){return k.memo(({id:t,sourceX:r,sourceY:i,targetX:n,targetY:o,label:a,labelStyle:s,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:l,style:f,sourcePosition:h=K.Bottom,targetPosition:m=K.Top,markerEnd:v,markerStart:g,pathOptions:y,interactionWidth:b})=>{const[p,x,E]=Gs({sourceX:r,sourceY:i,sourcePosition:h,targetX:n,targetY:o,targetPosition:m,borderRadius:y?.borderRadius,offset:y?.offset,stepPosition:y?.stepPosition}),_=e.isInternal?void 0:t;return C.jsx(Kt,{id:_,path:p,labelX:x,labelY:E,label:a,labelStyle:s,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:l,style:f,markerEnd:v,markerStart:g,interactionWidth:b})})}const Jg=Qg({isInternal:!1}),ev=Qg({isInternal:!0});Jg.displayName="SmoothStepEdge";ev.displayName="SmoothStepEdgeInternal";function tv(e){return k.memo(({id:t,...r})=>{const i=e.isInternal?void 0:t;return C.jsx(Jg,{...r,id:i,pathOptions:k.useMemo(()=>({borderRadius:0,offset:r.pathOptions?.offset}),[r.pathOptions?.offset])})})}const m_=tv({isInternal:!1}),rv=tv({isInternal:!0});m_.displayName="StepEdge";rv.displayName="StepEdgeInternal";function nv(e){return k.memo(({id:t,sourceX:r,sourceY:i,targetX:n,targetY:o,label:a,labelStyle:s,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:l,style:f,markerEnd:h,markerStart:m,interactionWidth:v})=>{const[g,y,b]=xg({sourceX:r,sourceY:i,targetX:n,targetY:o}),p=e.isInternal?void 0:t;return C.jsx(Kt,{id:p,path:g,labelX:y,labelY:b,label:a,labelStyle:s,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:l,style:f,markerEnd:h,markerStart:m,interactionWidth:v})})}const y_=nv({isInternal:!1}),iv=nv({isInternal:!0});y_.displayName="StraightEdge";iv.displayName="StraightEdgeInternal";function ov(e){return k.memo(({id:t,sourceX:r,sourceY:i,targetX:n,targetY:o,sourcePosition:a=K.Bottom,targetPosition:s=K.Top,label:c,labelStyle:u,labelShowBg:d,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:h,style:m,markerEnd:v,markerStart:g,pathOptions:y,interactionWidth:b})=>{const[p,x,E]=mg({sourceX:r,sourceY:i,sourcePosition:a,targetX:n,targetY:o,targetPosition:s,curvature:y?.curvature}),_=e.isInternal?void 0:t;return C.jsx(Kt,{id:_,path:p,labelX:x,labelY:E,label:c,labelStyle:u,labelShowBg:d,labelBgStyle:l,labelBgPadding:f,labelBgBorderRadius:h,style:m,markerEnd:v,markerStart:g,interactionWidth:b})})}const b_=ov({isInternal:!1}),av=ov({isInternal:!0});b_.displayName="BezierEdge";av.displayName="BezierEdgeInternal";const yc={default:av,straight:iv,step:rv,smoothstep:ev,simplebezier:Xg},bc={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},x_=(e,t,r)=>r===K.Left?e-t:r===K.Right?e+t:e,__=(e,t,r)=>r===K.Top?e-t:r===K.Bottom?e+t:e,xc="react-flow__edgeupdater";function _c({position:e,centerX:t,centerY:r,radius:i=10,onMouseDown:n,onMouseEnter:o,onMouseOut:a,type:s}){return C.jsx("circle",{onMouseDown:n,onMouseEnter:o,onMouseOut:a,className:ce([xc,`${xc}-${s}`]),cx:x_(t,i,e),cy:__(r,i,e),r:i,stroke:"transparent",fill:"transparent"})}function w_({isReconnectable:e,reconnectRadius:t,edge:r,sourceX:i,sourceY:n,targetX:o,targetY:a,sourcePosition:s,targetPosition:c,onReconnect:u,onReconnectStart:d,onReconnectEnd:l,setReconnecting:f,setUpdateHover:h}){const m=oe(),v=(x,E)=>{if(x.button!==0)return;const{autoPanOnConnect:_,domNode:w,isValidConnection:S,connectionMode:R,connectionRadius:M,lib:N,onConnectStart:q,onConnectEnd:P,cancelConnection:D,nodeLookup:O,rfId:H,panBy:z,updateConnection:L}=m.getState(),F=E.type==="target",U=(W,A)=>{f(!1),l?.(W,r,E.type,A)},G=W=>u?.(r,W),$=(W,A)=>{f(!0),d?.(x,r,E.type),q?.(W,A)};Ys.onPointerDown(x.nativeEvent,{autoPanOnConnect:_,connectionMode:R,connectionRadius:M,domNode:w,handleId:E.id,nodeId:E.nodeId,nodeLookup:O,isTarget:F,edgeUpdaterType:E.type,lib:N,flowId:H,cancelConnection:D,panBy:z,isValidConnection:S,onConnect:G,onConnectStart:$,onConnectEnd:P,onReconnectEnd:U,updateConnection:L,getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle,dragThreshold:m.getState().connectionDragThreshold,handleDomNode:x.currentTarget})},g=x=>v(x,{nodeId:r.target,id:r.targetHandle??null,type:"target"}),y=x=>v(x,{nodeId:r.source,id:r.sourceHandle??null,type:"source"}),b=()=>h(!0),p=()=>h(!1);return C.jsxs(C.Fragment,{children:[(e===!0||e==="source")&&C.jsx(_c,{position:s,centerX:i,centerY:n,radius:t,onMouseDown:g,onMouseEnter:b,onMouseOut:p,type:"source"}),(e===!0||e==="target")&&C.jsx(_c,{position:c,centerX:o,centerY:a,radius:t,onMouseDown:y,onMouseEnter:b,onMouseOut:p,type:"target"})]})}function E_({id:e,edgesFocusable:t,edgesReconnectable:r,elementsSelectable:i,onClick:n,onDoubleClick:o,onContextMenu:a,onMouseEnter:s,onMouseMove:c,onMouseLeave:u,reconnectRadius:d,onReconnect:l,onReconnectStart:f,onReconnectEnd:h,rfId:m,edgeTypes:v,noPanClassName:g,onError:y,disableKeyboardA11y:b}){let p=re(Q=>Q.edgeLookup.get(e));const x=re(Q=>Q.defaultEdgeOptions);p=x?{...x,...p}:p;let E=p.type||"default",_=v?.[E]||yc[E];_===void 0&&(y?.("011",Ee.error011(E)),E="default",_=v?.default||yc.default);const w=!!(p.focusable||t&&typeof p.focusable>"u"),S=typeof l<"u"&&(p.reconnectable||r&&typeof p.reconnectable>"u"),R=!!(p.selectable||i&&typeof p.selectable>"u"),M=k.useRef(null),[N,q]=k.useState(!1),[P,D]=k.useState(!1),O=oe(),{zIndex:H,sourceX:z,sourceY:L,targetX:F,targetY:U,sourcePosition:G,targetPosition:$}=re(k.useCallback(Q=>{const Y=Q.nodeLookup.get(p.source),te=Q.nodeLookup.get(p.target);if(!Y||!te)return{zIndex:p.zIndex,...bc};const X=vb({id:e,sourceNode:Y,targetNode:te,sourceHandle:p.sourceHandle||null,targetHandle:p.targetHandle||null,connectionMode:Q.connectionMode,onError:y});return{zIndex:cb({selected:p.selected,zIndex:p.zIndex,sourceNode:Y,targetNode:te,elevateOnSelect:Q.elevateEdgesOnSelect,zIndexMode:Q.zIndexMode}),...X||bc}},[p.source,p.target,p.sourceHandle,p.targetHandle,p.selected,p.zIndex]),ie),W=k.useMemo(()=>p.markerStart?`url('#${Us(p.markerStart,m)}')`:void 0,[p.markerStart,m]),A=k.useMemo(()=>p.markerEnd?`url('#${Us(p.markerEnd,m)}')`:void 0,[p.markerEnd,m]);if(p.hidden||z===null||L===null||F===null||U===null)return null;const I=Q=>{const{addSelectedEdges:Y,unselectNodesAndEdges:te,multiSelectionActive:X}=O.getState();R&&(O.setState({nodesSelectionActive:!1}),p.selected&&X?(te({nodes:[],edges:[p]}),M.current?.blur()):Y([e])),n&&n(Q,p)},T=o?Q=>{o(Q,{...p})}:void 0,j=a?Q=>{a(Q,{...p})}:void 0,B=s?Q=>{s(Q,{...p})}:void 0,V=c?Q=>{c(Q,{...p})}:void 0,Z=u?Q=>{u(Q,{...p})}:void 0,J=Q=>{if(!b&&rg.includes(Q.key)&&R){const{unselectNodesAndEdges:Y,addSelectedEdges:te}=O.getState();Q.key==="Escape"?(M.current?.blur(),Y({edges:[p]})):te([e])}};return C.jsx("svg",{style:{zIndex:H},children:C.jsxs("g",{className:ce(["react-flow__edge",`react-flow__edge-${E}`,p.className,g,{selected:p.selected,animated:p.animated,inactive:!R&&!n,updating:N,selectable:R}]),onClick:I,onDoubleClick:T,onContextMenu:j,onMouseEnter:B,onMouseMove:V,onMouseLeave:Z,onKeyDown:w?J:void 0,tabIndex:w?0:void 0,role:p.ariaRole??(w?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":p.ariaLabel===null?void 0:p.ariaLabel||`Edge from ${p.source} to ${p.target}`,"aria-describedby":w?`${Og}-${m}`:void 0,ref:M,...p.domAttributes,children:[!P&&C.jsx(_,{id:e,source:p.source,target:p.target,type:p.type,selected:p.selected,animated:p.animated,selectable:R,deletable:p.deletable??!0,label:p.label,labelStyle:p.labelStyle,labelShowBg:p.labelShowBg,labelBgStyle:p.labelBgStyle,labelBgPadding:p.labelBgPadding,labelBgBorderRadius:p.labelBgBorderRadius,sourceX:z,sourceY:L,targetX:F,targetY:U,sourcePosition:G,targetPosition:$,data:p.data,style:p.style,sourceHandleId:p.sourceHandle,targetHandleId:p.targetHandle,markerStart:W,markerEnd:A,pathOptions:"pathOptions"in p?p.pathOptions:void 0,interactionWidth:p.interactionWidth}),S&&C.jsx(w_,{edge:p,isReconnectable:S,reconnectRadius:d,onReconnect:l,onReconnectStart:f,onReconnectEnd:h,sourceX:z,sourceY:L,targetX:F,targetY:U,sourcePosition:G,targetPosition:$,setUpdateHover:q,setReconnecting:D})]})})}var C_=k.memo(E_);const S_=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function sv({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:r,edgeTypes:i,noPanClassName:n,onReconnect:o,onEdgeContextMenu:a,onEdgeMouseEnter:s,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:d,reconnectRadius:l,onEdgeDoubleClick:f,onReconnectStart:h,onReconnectEnd:m,disableKeyboardA11y:v}){const{edgesFocusable:g,edgesReconnectable:y,elementsSelectable:b,onError:p}=re(S_,ie),x=c_(t);return C.jsxs("div",{className:"react-flow__edges",children:[C.jsx(p_,{defaultColor:e,rfId:r}),x.map(E=>C.jsx(C_,{id:E,edgesFocusable:g,edgesReconnectable:y,elementsSelectable:b,noPanClassName:n,onReconnect:o,onContextMenu:a,onMouseEnter:s,onMouseMove:c,onMouseLeave:u,onClick:d,reconnectRadius:l,onDoubleClick:f,onReconnectStart:h,onReconnectEnd:m,rfId:r,onError:p,edgeTypes:i,disableKeyboardA11y:v},E))]})}sv.displayName="EdgeRenderer";const N_=k.memo(sv),R_=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function q_({children:e}){const t=re(R_);return C.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function I_(e){const t=au(),r=k.useRef(!1);k.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const M_=e=>e.panZoom?.syncViewport;function A_(e){const t=re(M_),r=oe();return k.useEffect(()=>{e&&(t?.(e),r.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function k_(e){return e.connection.inProgress?{...e.connection,to:St(e.connection.to,e.transform)}:{...e.connection}}function T_(e){return k_}function P_(e){const t=T_();return re(t,ie)}const O_=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function j_({containerStyle:e,style:t,type:r,component:i}){const{nodesConnectable:n,width:o,height:a,isValid:s,inProgress:c}=re(O_,ie);return!(o&&n&&c)?null:C.jsx("svg",{style:e,width:o,height:a,className:"react-flow__connectionline react-flow__container",children:C.jsx("g",{className:ce(["react-flow__connection",og(s)]),children:C.jsx(uv,{style:t,type:r,CustomComponent:i,isValid:s})})})}const uv=({style:e,type:t=Le.Bezier,CustomComponent:r,isValid:i})=>{const{inProgress:n,from:o,fromNode:a,fromHandle:s,fromPosition:c,to:u,toNode:d,toHandle:l,toPosition:f,pointer:h}=P_();if(!n)return;if(r)return C.jsx(r,{connectionLineType:t,connectionLineStyle:e,fromNode:a,fromHandle:s,fromX:o.x,fromY:o.y,toX:u.x,toY:u.y,fromPosition:c,toPosition:f,connectionStatus:og(i),toNode:d,toHandle:l,pointer:h});let m="";const v={sourceX:o.x,sourceY:o.y,sourcePosition:c,targetX:u.x,targetY:u.y,targetPosition:f};switch(t){case Le.Bezier:[m]=mg(v);break;case Le.SimpleBezier:[m]=Kg(v);break;case Le.Step:[m]=Gs({...v,borderRadius:0});break;case Le.SmoothStep:[m]=Gs(v);break;default:[m]=xg(v)}return C.jsx("path",{d:m,fill:"none",className:"react-flow__connection-path",style:e})};uv.displayName="ConnectionLine";const D_={};function wc(e=D_){k.useRef(e),oe(),k.useEffect(()=>{},[e])}function L_(){oe(),k.useRef(!1),k.useEffect(()=>{},[])}function cv({nodeTypes:e,edgeTypes:t,onInit:r,onNodeClick:i,onEdgeClick:n,onNodeDoubleClick:o,onEdgeDoubleClick:a,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:d,onSelectionContextMenu:l,onSelectionStart:f,onSelectionEnd:h,connectionLineType:m,connectionLineStyle:v,connectionLineComponent:g,connectionLineContainerStyle:y,selectionKeyCode:b,selectionOnDrag:p,selectionMode:x,multiSelectionKeyCode:E,panActivationKeyCode:_,zoomActivationKeyCode:w,deleteKeyCode:S,onlyRenderVisibleElements:R,elementsSelectable:M,defaultViewport:N,translateExtent:q,minZoom:P,maxZoom:D,preventScrolling:O,defaultMarkerColor:H,zoomOnScroll:z,zoomOnPinch:L,panOnScroll:F,panOnScrollSpeed:U,panOnScrollMode:G,zoomOnDoubleClick:$,panOnDrag:W,onPaneClick:A,onPaneMouseEnter:I,onPaneMouseMove:T,onPaneMouseLeave:j,onPaneScroll:B,onPaneContextMenu:V,paneClickDistance:Z,nodeClickDistance:J,onEdgeContextMenu:Q,onEdgeMouseEnter:Y,onEdgeMouseMove:te,onEdgeMouseLeave:X,reconnectRadius:ne,onReconnect:ee,onReconnectStart:fe,onReconnectEnd:le,noDragClassName:Se,noWheelClassName:_e,noPanClassName:he,disableKeyboardA11y:se,nodeExtent:Te,rfId:Ne,viewport:Pe,onViewportChange:Oe}){return wc(e),wc(t),L_(),I_(r),A_(Pe),C.jsx(Jx,{onPaneClick:A,onPaneMouseEnter:I,onPaneMouseMove:T,onPaneMouseLeave:j,onPaneContextMenu:V,onPaneScroll:B,paneClickDistance:Z,deleteKeyCode:S,selectionKeyCode:b,selectionOnDrag:p,selectionMode:x,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:E,panActivationKeyCode:_,zoomActivationKeyCode:w,elementsSelectable:M,zoomOnScroll:z,zoomOnPinch:L,zoomOnDoubleClick:$,panOnScroll:F,panOnScrollSpeed:U,panOnScrollMode:G,panOnDrag:W,defaultViewport:N,translateExtent:q,minZoom:P,maxZoom:D,onSelectionContextMenu:l,preventScrolling:O,noDragClassName:Se,noWheelClassName:_e,noPanClassName:he,disableKeyboardA11y:se,onViewportChange:Oe,isControlledViewport:!!Pe,children:C.jsxs(q_,{children:[C.jsx(N_,{edgeTypes:t,onEdgeClick:n,onEdgeDoubleClick:a,onReconnect:ee,onReconnectStart:fe,onReconnectEnd:le,onlyRenderVisibleElements:R,onEdgeContextMenu:Q,onEdgeMouseEnter:Y,onEdgeMouseMove:te,onEdgeMouseLeave:X,reconnectRadius:ne,defaultMarkerColor:H,noPanClassName:he,disableKeyboardA11y:se,rfId:Ne}),C.jsx(j_,{style:v,type:m,component:g,containerStyle:y}),C.jsx("div",{className:"react-flow__edgelabel-renderer"}),C.jsx(u_,{nodeTypes:e,onNodeClick:i,onNodeDoubleClick:o,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:d,nodeClickDistance:J,onlyRenderVisibleElements:R,noPanClassName:he,noDragClassName:Se,disableKeyboardA11y:se,nodeExtent:Te,rfId:Ne}),C.jsx("div",{className:"react-flow__viewport-portal"})]})})}cv.displayName="GraphView";const B_=k.memo(cv),Ec=({nodes:e,edges:t,defaultNodes:r,defaultEdges:i,width:n,height:o,fitView:a,fitViewOptions:s,minZoom:c=.5,maxZoom:u=2,nodeOrigin:d,nodeExtent:l,zIndexMode:f="basic"}={})=>{const h=new Map,m=new Map,v=new Map,g=new Map,y=i??t??[],b=r??e??[],p=d??[0,0],x=l??mt;Eg(v,g,y);const E=Ws(b,h,m,{nodeOrigin:p,nodeExtent:x,zIndexMode:f});let _=[0,0,1];if(a&&n&&o){const w=Et(h,{filter:N=>!!((N.width||N.initialWidth)&&(N.height||N.initialHeight))}),{x:S,y:R,zoom:M}=Js(w,n,o,c,u,s?.padding??.1);_=[S,R,M]}return{rfId:"1",width:n??0,height:o??0,transform:_,nodes:b,nodesInitialized:E,nodeLookup:h,parentLookup:m,edges:y,edgeLookup:g,connectionLookup:v,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:r!==void 0,hasDefaultEdges:i!==void 0,panZoom:null,minZoom:c,maxZoom:u,translateExtent:mt,nodeExtent:x,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:tt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:p,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:a??!1,fitViewOptions:s,fitViewResolver:null,connection:{...ig},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:nb,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:ng,zIndexMode:f,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},F_=({nodes:e,edges:t,defaultNodes:r,defaultEdges:i,width:n,height:o,fitView:a,fitViewOptions:s,minZoom:c,maxZoom:u,nodeOrigin:d,nodeExtent:l,zIndexMode:f})=>ix((h,m)=>{async function v(){const{nodeLookup:g,panZoom:y,fitViewOptions:b,fitViewResolver:p,width:x,height:E,minZoom:_,maxZoom:w}=m();y&&(await tb({nodes:g,width:x,height:E,panZoom:y,minZoom:_,maxZoom:w},b),p?.resolve(!0),h({fitViewResolver:null}))}return{...Ec({nodes:e,edges:t,width:n,height:o,fitView:a,fitViewOptions:s,minZoom:c,maxZoom:u,nodeOrigin:d,nodeExtent:l,defaultNodes:r,defaultEdges:i,zIndexMode:f}),setNodes:g=>{const{nodeLookup:y,parentLookup:b,nodeOrigin:p,elevateNodesOnSelect:x,fitViewQueued:E,zIndexMode:_}=m(),w=Ws(g,y,b,{nodeOrigin:p,nodeExtent:l,elevateNodesOnSelect:x,checkEquality:!0,zIndexMode:_});E&&w?(v(),h({nodes:g,nodesInitialized:w,fitViewQueued:!1,fitViewOptions:void 0})):h({nodes:g,nodesInitialized:w})},setEdges:g=>{const{connectionLookup:y,edgeLookup:b}=m();Eg(y,b,g),h({edges:g})},setDefaultNodesAndEdges:(g,y)=>{if(g){const{setNodes:b}=m();b(g),h({hasDefaultNodes:!0})}if(y){const{setEdges:b}=m();b(y),h({hasDefaultEdges:!0})}},updateNodeInternals:g=>{const{triggerNodeChanges:y,nodeLookup:b,parentLookup:p,domNode:x,nodeOrigin:E,nodeExtent:_,debug:w,fitViewQueued:S,zIndexMode:R}=m(),{changes:M,updatedInternals:N}=Cb(g,b,p,x,E,_,R);N&&(xb(b,p,{nodeOrigin:E,nodeExtent:_,zIndexMode:R}),S?(v(),h({fitViewQueued:!1,fitViewOptions:void 0})):h({}),M?.length>0&&(w&&console.log("React Flow: trigger node changes",M),y?.(M)))},updateNodePositions:(g,y=!1)=>{const b=[];let p=[];const{nodeLookup:x,triggerNodeChanges:E,connection:_,updateConnection:w,onNodesChangeMiddlewareMap:S}=m();for(const[R,M]of g){const N=x.get(R),q=!!(N?.expandParent&&N?.parentId&&M?.position),P={id:R,type:"position",position:q?{x:Math.max(0,M.position.x),y:Math.max(0,M.position.y)}:M.position,dragging:y};if(N&&_.inProgress&&_.fromNode.id===N.id){const D=Ue(N,_.fromHandle,K.Left,!0);w({..._,from:D})}q&&N.parentId&&b.push({id:R,parentId:N.parentId,rect:{...M.internals.positionAbsolute,width:M.measured.width??0,height:M.measured.height??0}}),p.push(P)}if(b.length>0){const{parentLookup:R,nodeOrigin:M}=m(),N=ou(b,x,R,M);p.push(...N)}for(const R of S.values())p=R(p);E(p)},triggerNodeChanges:g=>{const{onNodesChange:y,setNodes:b,nodes:p,hasDefaultNodes:x,debug:E}=m();if(g?.length){if(x){const _=Lg(g,p);b(_)}E&&console.log("React Flow: trigger node changes",g),y?.(g)}},triggerEdgeChanges:g=>{const{onEdgesChange:y,setEdges:b,edges:p,hasDefaultEdges:x,debug:E}=m();if(g?.length){if(x){const _=Bg(g,p);b(_)}E&&console.log("React Flow: trigger edge changes",g),y?.(g)}},addSelectedNodes:g=>{const{multiSelectionActive:y,edgeLookup:b,nodeLookup:p,triggerNodeChanges:x,triggerEdgeChanges:E}=m();if(y){const _=g.map(w=>$e(w,!0));x(_);return}x(et(p,new Set([...g]),!0)),E(et(b))},addSelectedEdges:g=>{const{multiSelectionActive:y,edgeLookup:b,nodeLookup:p,triggerNodeChanges:x,triggerEdgeChanges:E}=m();if(y){const _=g.map(w=>$e(w,!0));E(_);return}E(et(b,new Set([...g]))),x(et(p,new Set,!0))},unselectNodesAndEdges:({nodes:g,edges:y}={})=>{const{edges:b,nodes:p,nodeLookup:x,triggerNodeChanges:E,triggerEdgeChanges:_}=m(),w=g||p,S=y||b,R=w.map(N=>{const q=x.get(N.id);return q&&(q.selected=!1),$e(N.id,!1)}),M=S.map(N=>$e(N.id,!1));E(R),_(M)},setMinZoom:g=>{const{panZoom:y,maxZoom:b}=m();y?.setScaleExtent([g,b]),h({minZoom:g})},setMaxZoom:g=>{const{panZoom:y,minZoom:b}=m();y?.setScaleExtent([b,g]),h({maxZoom:g})},setTranslateExtent:g=>{m().panZoom?.setTranslateExtent(g),h({translateExtent:g})},resetSelectedElements:()=>{const{edges:g,nodes:y,triggerNodeChanges:b,triggerEdgeChanges:p,elementsSelectable:x}=m();if(!x)return;const E=y.reduce((w,S)=>S.selected?[...w,$e(S.id,!1)]:w,[]),_=g.reduce((w,S)=>S.selected?[...w,$e(S.id,!1)]:w,[]);b(E),p(_)},setNodeExtent:g=>{const{nodes:y,nodeLookup:b,parentLookup:p,nodeOrigin:x,elevateNodesOnSelect:E,nodeExtent:_,zIndexMode:w}=m();g[0][0]===_[0][0]&&g[0][1]===_[0][1]&&g[1][0]===_[1][0]&&g[1][1]===_[1][1]||(Ws(y,b,p,{nodeOrigin:x,nodeExtent:g,elevateNodesOnSelect:E,checkEquality:!1,zIndexMode:w}),h({nodeExtent:g}))},panBy:g=>{const{transform:y,width:b,height:p,panZoom:x,translateExtent:E}=m();return Sb({delta:g,panZoom:x,transform:y,translateExtent:E,width:b,height:p})},setCenter:async(g,y,b)=>{const{width:p,height:x,maxZoom:E,panZoom:_}=m();if(!_)return Promise.resolve(!1);const w=typeof b?.zoom<"u"?b.zoom:E;return await _.setViewport({x:p/2-g*w,y:x/2-y*w,zoom:w},{duration:b?.duration,ease:b?.ease,interpolate:b?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{h({connection:{...ig}})},updateConnection:g=>{h({connection:g})},reset:()=>h({...Ec()})}},Object.is);function H_({initialNodes:e,initialEdges:t,defaultNodes:r,defaultEdges:i,initialWidth:n,initialHeight:o,initialMinZoom:a,initialMaxZoom:s,initialFitViewOptions:c,fitView:u,nodeOrigin:d,nodeExtent:l,zIndexMode:f,children:h}){const[m]=k.useState(()=>F_({nodes:e,edges:t,defaultNodes:r,defaultEdges:i,width:n,height:o,fitView:u,minZoom:a,maxZoom:s,fitViewOptions:c,nodeOrigin:d,nodeExtent:l,zIndexMode:f}));return C.jsx(ox,{value:m,children:C.jsx(qx,{children:h})})}function z_({children:e,nodes:t,edges:r,defaultNodes:i,defaultEdges:n,width:o,height:a,fitView:s,fitViewOptions:c,minZoom:u,maxZoom:d,nodeOrigin:l,nodeExtent:f,zIndexMode:h}){return k.useContext(Ut)?C.jsx(C.Fragment,{children:e}):C.jsx(H_,{initialNodes:t,initialEdges:r,defaultNodes:i,defaultEdges:n,initialWidth:o,initialHeight:a,fitView:s,initialFitViewOptions:c,initialMinZoom:u,initialMaxZoom:d,nodeOrigin:l,nodeExtent:f,zIndexMode:h,children:e})}const $_={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function V_({nodes:e,edges:t,defaultNodes:r,defaultEdges:i,className:n,nodeTypes:o,edgeTypes:a,onNodeClick:s,onEdgeClick:c,onInit:u,onMove:d,onMoveStart:l,onMoveEnd:f,onConnect:h,onConnectStart:m,onConnectEnd:v,onClickConnectStart:g,onClickConnectEnd:y,onNodeMouseEnter:b,onNodeMouseMove:p,onNodeMouseLeave:x,onNodeContextMenu:E,onNodeDoubleClick:_,onNodeDragStart:w,onNodeDrag:S,onNodeDragStop:R,onNodesDelete:M,onEdgesDelete:N,onDelete:q,onSelectionChange:P,onSelectionDragStart:D,onSelectionDrag:O,onSelectionDragStop:H,onSelectionContextMenu:z,onSelectionStart:L,onSelectionEnd:F,onBeforeDelete:U,connectionMode:G,connectionLineType:$=Le.Bezier,connectionLineStyle:W,connectionLineComponent:A,connectionLineContainerStyle:I,deleteKeyCode:T="Backspace",selectionKeyCode:j="Shift",selectionOnDrag:B=!1,selectionMode:V=yt.Full,panActivationKeyCode:Z="Space",multiSelectionKeyCode:J=xt()?"Meta":"Control",zoomActivationKeyCode:Q=xt()?"Meta":"Control",snapToGrid:Y,snapGrid:te,onlyRenderVisibleElements:X=!1,selectNodesOnDrag:ne,nodesDraggable:ee,autoPanOnNodeFocus:fe,nodesConnectable:le,nodesFocusable:Se,nodeOrigin:_e=jg,edgesFocusable:he,edgesReconnectable:se,elementsSelectable:Te=!0,defaultViewport:Ne=yx,minZoom:Pe=.5,maxZoom:Oe=2,translateExtent:Re=mt,preventScrolling:At=!0,nodeExtent:Xe,defaultMarkerColor:hr="#b1b1b7",zoomOnScroll:kt=!0,zoomOnPinch:we=!0,panOnScroll:qe=!1,panOnScrollSpeed:fm=.5,panOnScrollMode:hm=Ve.Free,zoomOnDoubleClick:pm=!0,panOnDrag:gm=!0,onPaneClick:vm,onPaneMouseEnter:mm,onPaneMouseMove:ym,onPaneMouseLeave:bm,onPaneScroll:xm,onPaneContextMenu:_m,paneClickDistance:wm=1,nodeClickDistance:Em=0,children:Cm,onReconnect:Sm,onReconnectStart:Nm,onReconnectEnd:Rm,onEdgeContextMenu:qm,onEdgeDoubleClick:Im,onEdgeMouseEnter:Mm,onEdgeMouseMove:Am,onEdgeMouseLeave:km,reconnectRadius:Tm=10,onNodesChange:Pm,onEdgesChange:Om,noDragClassName:jm="nodrag",noWheelClassName:Dm="nowheel",noPanClassName:Nu="nopan",fitView:Ru,fitViewOptions:qu,connectOnClick:Lm,attributionPosition:Bm,proOptions:Fm,defaultEdgeOptions:Hm,elevateNodesOnSelect:zm=!0,elevateEdgesOnSelect:$m=!1,disableKeyboardA11y:Iu=!1,autoPanOnConnect:Vm,autoPanOnNodeDrag:Gm,autoPanSpeed:Um,connectionRadius:Wm,isValidConnection:Ym,onError:Km,style:Zm,id:Mu,nodeDragThreshold:Xm,connectionDragThreshold:Qm,viewport:Jm,onViewportChange:ey,width:ty,height:ry,colorMode:ny="light",debug:iy,onScroll:Au,ariaLabelConfig:oy,zIndexMode:ku="basic",...ay},sy){const pr=Mu||"1",uy=wx(ny),cy=k.useCallback(Tu=>{Tu.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Au?.(Tu)},[Au]);return C.jsx("div",{"data-testid":"rf__wrapper",...ay,onScroll:cy,style:{...Zm,...$_},ref:sy,className:ce(["react-flow",n,uy]),id:Mu,role:"application",children:C.jsxs(z_,{nodes:e,edges:t,width:ty,height:ry,fitView:Ru,fitViewOptions:qu,minZoom:Pe,maxZoom:Oe,nodeOrigin:_e,nodeExtent:Xe,zIndexMode:ku,children:[C.jsx(B_,{onInit:u,onNodeClick:s,onEdgeClick:c,onNodeMouseEnter:b,onNodeMouseMove:p,onNodeMouseLeave:x,onNodeContextMenu:E,onNodeDoubleClick:_,nodeTypes:o,edgeTypes:a,connectionLineType:$,connectionLineStyle:W,connectionLineComponent:A,connectionLineContainerStyle:I,selectionKeyCode:j,selectionOnDrag:B,selectionMode:V,deleteKeyCode:T,multiSelectionKeyCode:J,panActivationKeyCode:Z,zoomActivationKeyCode:Q,onlyRenderVisibleElements:X,defaultViewport:Ne,translateExtent:Re,minZoom:Pe,maxZoom:Oe,preventScrolling:At,zoomOnScroll:kt,zoomOnPinch:we,zoomOnDoubleClick:pm,panOnScroll:qe,panOnScrollSpeed:fm,panOnScrollMode:hm,panOnDrag:gm,onPaneClick:vm,onPaneMouseEnter:mm,onPaneMouseMove:ym,onPaneMouseLeave:bm,onPaneScroll:xm,onPaneContextMenu:_m,paneClickDistance:wm,nodeClickDistance:Em,onSelectionContextMenu:z,onSelectionStart:L,onSelectionEnd:F,onReconnect:Sm,onReconnectStart:Nm,onReconnectEnd:Rm,onEdgeContextMenu:qm,onEdgeDoubleClick:Im,onEdgeMouseEnter:Mm,onEdgeMouseMove:Am,onEdgeMouseLeave:km,reconnectRadius:Tm,defaultMarkerColor:hr,noDragClassName:jm,noWheelClassName:Dm,noPanClassName:Nu,rfId:pr,disableKeyboardA11y:Iu,nodeExtent:Xe,viewport:Jm,onViewportChange:ey}),C.jsx(_x,{nodes:e,edges:t,defaultNodes:r,defaultEdges:i,onConnect:h,onConnectStart:m,onConnectEnd:v,onClickConnectStart:g,onClickConnectEnd:y,nodesDraggable:ee,autoPanOnNodeFocus:fe,nodesConnectable:le,nodesFocusable:Se,edgesFocusable:he,edgesReconnectable:se,elementsSelectable:Te,elevateNodesOnSelect:zm,elevateEdgesOnSelect:$m,minZoom:Pe,maxZoom:Oe,nodeExtent:Xe,onNodesChange:Pm,onEdgesChange:Om,snapToGrid:Y,snapGrid:te,connectionMode:G,translateExtent:Re,connectOnClick:Lm,defaultEdgeOptions:Hm,fitView:Ru,fitViewOptions:qu,onNodesDelete:M,onEdgesDelete:N,onDelete:q,onNodeDragStart:w,onNodeDrag:S,onNodeDragStop:R,onSelectionDrag:O,onSelectionDragStart:D,onSelectionDragStop:H,onMove:d,onMoveStart:l,onMoveEnd:f,noPanClassName:Nu,nodeOrigin:_e,rfId:pr,autoPanOnConnect:Vm,autoPanOnNodeDrag:Gm,autoPanSpeed:Um,onError:Km,connectionRadius:Wm,isValidConnection:Ym,selectNodesOnDrag:ne,nodeDragThreshold:Xm,connectionDragThreshold:Qm,onBeforeDelete:U,debug:iy,ariaLabelConfig:oy,zIndexMode:ku}),C.jsx(mx,{onSelectionChange:P}),Cm,C.jsx(fx,{proOptions:Fm,position:Bm}),C.jsx(lx,{rfId:pr,disableKeyboardA11y:Iu})]})})}var G_=Fg(V_);function U_(e){const[t,r]=k.useState(e),i=k.useCallback(n=>r(o=>Lg(n,o)),[]);return[t,r,i]}function W_(e){const[t,r]=k.useState(e),i=k.useCallback(n=>r(o=>Bg(n,o)),[]);return[t,r,i]}function Y_({dimensions:e,lineWidth:t,variant:r,className:i}){return C.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ce(["react-flow__background-pattern",r,i])})}function K_({radius:e,className:t}){return C.jsx("circle",{cx:e,cy:e,r:e,className:ce(["react-flow__background-pattern","dots",t])})}var Fe;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Fe||(Fe={}));const Z_={[Fe.Dots]:1,[Fe.Lines]:1,[Fe.Cross]:6},X_=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function dv({id:e,variant:t=Fe.Dots,gap:r=20,size:i,lineWidth:n=1,offset:o=0,color:a,bgColor:s,style:c,className:u,patternClassName:d}){const l=k.useRef(null),{transform:f,patternId:h}=re(X_,ie),m=i||Z_[t],v=t===Fe.Dots,g=t===Fe.Cross,y=Array.isArray(r)?r:[r,r],b=[y[0]*f[2]||1,y[1]*f[2]||1],p=m*f[2],x=Array.isArray(o)?o:[o,o],E=g?[p,p]:b,_=[x[0]*f[2]||1+E[0]/2,x[1]*f[2]||1+E[1]/2],w=`${h}${e||""}`;return C.jsxs("svg",{className:ce(["react-flow__background",u]),style:{...c,...Yt,"--xy-background-color-props":s,"--xy-background-pattern-color-props":a},ref:l,"data-testid":"rf__background",children:[C.jsx("pattern",{id:w,x:f[0]%b[0],y:f[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${_[0]},-${_[1]})`,children:v?C.jsx(K_,{radius:p/2,className:d}):C.jsx(Y_,{dimensions:E,lineWidth:n,variant:t,className:d})}),C.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${w})`})]})}dv.displayName="Background";const Q_=k.memo(dv);function J_(){return C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:C.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function e0(){return C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:C.jsx("path",{d:"M0 0h32v4.2H0z"})})}function t0(){return C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:C.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function r0(){return C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:C.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function n0(){return C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:C.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Dt({children:e,className:t,...r}){return C.jsx("button",{type:"button",className:ce(["react-flow__controls-button",t]),...r,children:e})}const i0=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function lv({style:e,showZoom:t=!0,showFitView:r=!0,showInteractive:i=!0,fitViewOptions:n,onZoomIn:o,onZoomOut:a,onFitView:s,onInteractiveChange:c,className:u,children:d,position:l="bottom-left",orientation:f="vertical","aria-label":h}){const m=oe(),{isInteractive:v,minZoomReached:g,maxZoomReached:y,ariaLabelConfig:b}=re(i0,ie),{zoomIn:p,zoomOut:x,fitView:E}=au(),_=()=>{p(),o?.()},w=()=>{x(),a?.()},S=()=>{E(n),s?.()},R=()=>{m.setState({nodesDraggable:!v,nodesConnectable:!v,elementsSelectable:!v}),c?.(!v)},M=f==="horizontal"?"horizontal":"vertical";return C.jsxs(Wt,{className:ce(["react-flow__controls",M,u]),position:l,style:e,"data-testid":"rf__controls","aria-label":h??b["controls.ariaLabel"],children:[t&&C.jsxs(C.Fragment,{children:[C.jsx(Dt,{onClick:_,className:"react-flow__controls-zoomin",title:b["controls.zoomIn.ariaLabel"],"aria-label":b["controls.zoomIn.ariaLabel"],disabled:y,children:C.jsx(J_,{})}),C.jsx(Dt,{onClick:w,className:"react-flow__controls-zoomout",title:b["controls.zoomOut.ariaLabel"],"aria-label":b["controls.zoomOut.ariaLabel"],disabled:g,children:C.jsx(e0,{})})]}),r&&C.jsx(Dt,{className:"react-flow__controls-fitview",onClick:S,title:b["controls.fitView.ariaLabel"],"aria-label":b["controls.fitView.ariaLabel"],children:C.jsx(t0,{})}),i&&C.jsx(Dt,{className:"react-flow__controls-interactive",onClick:R,title:b["controls.interactive.ariaLabel"],"aria-label":b["controls.interactive.ariaLabel"],children:v?C.jsx(n0,{}):C.jsx(r0,{})}),d]})}lv.displayName="Controls";const o0=k.memo(lv);function a0({id:e,x:t,y:r,width:i,height:n,style:o,color:a,strokeColor:s,strokeWidth:c,className:u,borderRadius:d,shapeRendering:l,selected:f,onClick:h}){const{background:m,backgroundColor:v}=o||{},g=a||m||v;return C.jsx("rect",{className:ce(["react-flow__minimap-node",{selected:f},u]),x:t,y:r,rx:d,ry:d,width:i,height:n,style:{fill:g,stroke:s,strokeWidth:c},shapeRendering:l,onClick:h?y=>h(y,e):void 0})}const s0=k.memo(a0),u0=e=>e.nodes.map(t=>t.id),wr=e=>e instanceof Function?e:()=>e;function c0({nodeStrokeColor:e,nodeColor:t,nodeClassName:r="",nodeBorderRadius:i=5,nodeStrokeWidth:n,nodeComponent:o=s0,onClick:a}){const s=re(u0,ie),c=wr(t),u=wr(e),d=wr(r),l=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return C.jsx(C.Fragment,{children:s.map(f=>C.jsx(l0,{id:f,nodeColorFunc:c,nodeStrokeColorFunc:u,nodeClassNameFunc:d,nodeBorderRadius:i,nodeStrokeWidth:n,NodeComponent:o,onClick:a,shapeRendering:l},f))})}function d0({id:e,nodeColorFunc:t,nodeStrokeColorFunc:r,nodeClassNameFunc:i,nodeBorderRadius:n,nodeStrokeWidth:o,shapeRendering:a,NodeComponent:s,onClick:c}){const{node:u,x:d,y:l,width:f,height:h}=re(m=>{const{internals:v}=m.nodeLookup.get(e),g=v.userNode,{x:y,y:b}=v.positionAbsolute,{width:p,height:x}=Me(g);return{node:g,x:y,y:b,width:p,height:x}},ie);return!u||u.hidden||!lg(u)?null:C.jsx(s,{x:d,y:l,width:f,height:h,style:u.style,selected:!!u.selected,className:i(u),color:t(u),borderRadius:n,strokeColor:r(u),strokeWidth:o,shapeRendering:a,onClick:c,id:u.id})}const l0=k.memo(d0);var f0=k.memo(c0);const h0=200,p0=150,g0=e=>!e.hidden,v0=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?dg(Et(e.nodeLookup,{filter:g0}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},m0="react-flow__minimap-desc";function fv({style:e,className:t,nodeStrokeColor:r,nodeColor:i,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:a,nodeComponent:s,bgColor:c,maskColor:u,maskStrokeColor:d,maskStrokeWidth:l,position:f="bottom-right",onClick:h,onNodeClick:m,pannable:v=!1,zoomable:g=!1,ariaLabel:y,inversePan:b,zoomStep:p=1,offsetScale:x=5}){const E=oe(),_=k.useRef(null),{boundingRect:w,viewBB:S,rfId:R,panZoom:M,translateExtent:N,flowWidth:q,flowHeight:P,ariaLabelConfig:D}=re(v0,ie),O=e?.width??h0,H=e?.height??p0,z=w.width/O,L=w.height/H,F=Math.max(z,L),U=F*O,G=F*H,$=x*F,W=w.x-(U-w.width)/2-$,A=w.y-(G-w.height)/2-$,I=U+$*2,T=G+$*2,j=`${m0}-${R}`,B=k.useRef(0),V=k.useRef();B.current=F,k.useEffect(()=>{if(_.current&&M)return V.current=Pb({domNode:_.current,panZoom:M,getTransform:()=>E.getState().transform,getViewScale:()=>B.current}),()=>{V.current?.destroy()}},[M]),k.useEffect(()=>{V.current?.update({translateExtent:N,width:q,height:P,inversePan:b,pannable:v,zoomStep:p,zoomable:g})},[v,g,b,p,N,q,P]);const Z=h?Y=>{const[te,X]=V.current?.pointer(Y)||[0,0];h(Y,{x:te,y:X})}:void 0,J=m?k.useCallback((Y,te)=>{const X=E.getState().nodeLookup.get(te).internals.userNode;m(Y,X)},[]):void 0,Q=y??D["minimap.ariaLabel"];return C.jsx(Wt,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-width-props":typeof l=="number"?l*F:void 0,"--xy-minimap-node-background-color-props":typeof i=="string"?i:void 0,"--xy-minimap-node-stroke-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-width-props":typeof a=="number"?a:void 0},className:ce(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:C.jsxs("svg",{width:O,height:H,viewBox:`${W} ${A} ${I} ${T}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":j,ref:_,onClick:Z,children:[Q&&C.jsx("title",{id:j,children:Q}),C.jsx(f0,{onClick:J,nodeColor:i,nodeStrokeColor:r,nodeBorderRadius:o,nodeClassName:n,nodeStrokeWidth:a,nodeComponent:s}),C.jsx("path",{className:"react-flow__minimap-mask",d:`M${W-$},${A-$}h${I+$*2}v${T+$*2}h${-I-$*2}z
        M${S.x},${S.y}h${S.width}v${S.height}h${-S.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}fv.displayName="MiniMap";const y0=k.memo(fv),b0=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,x0={[at.Line]:"right",[at.Handle]:"bottom-right"};function _0({nodeId:e,position:t,variant:r=at.Handle,className:i,style:n=void 0,children:o,color:a,minWidth:s=10,minHeight:c=10,maxWidth:u=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:l=!1,resizeDirection:f,autoScale:h=!0,shouldResize:m,onResizeStart:v,onResize:g,onResizeEnd:y}){const b=Vg(),p=typeof e=="string"?e:b,x=oe(),E=k.useRef(null),_=r===at.Handle,w=re(k.useCallback(b0(_&&h),[_,h]),ie),S=k.useRef(null),R=t??x0[r];k.useEffect(()=>{if(!(!E.current||!p))return S.current||(S.current=Yb({domNode:E.current,nodeId:p,getStoreItems:()=>{const{nodeLookup:N,transform:q,snapGrid:P,snapToGrid:D,nodeOrigin:O,domNode:H}=x.getState();return{nodeLookup:N,transform:q,snapGrid:P,snapToGrid:D,nodeOrigin:O,paneDomNode:H}},onChange:(N,q)=>{const{triggerNodeChanges:P,nodeLookup:D,parentLookup:O,nodeOrigin:H}=x.getState(),z=[],L={x:N.x,y:N.y},F=D.get(p);if(F&&F.expandParent&&F.parentId){const U=F.origin??H,G=N.width??F.measured.width??0,$=N.height??F.measured.height??0,W={id:F.id,parentId:F.parentId,rect:{width:G,height:$,...fg({x:N.x??F.position.x,y:N.y??F.position.y},{width:G,height:$},F.parentId,D,U)}},A=ou([W],D,O,H);z.push(...A),L.x=N.x?Math.max(U[0]*G,N.x):void 0,L.y=N.y?Math.max(U[1]*$,N.y):void 0}if(L.x!==void 0&&L.y!==void 0){const U={id:p,type:"position",position:{...L}};z.push(U)}if(N.width!==void 0&&N.height!==void 0){const G={id:p,type:"dimensions",resizing:!0,setAttributes:f?f==="horizontal"?"width":"height":!0,dimensions:{width:N.width,height:N.height}};z.push(G)}for(const U of q){const G={...U,type:"position"};z.push(G)}P(z)},onEnd:({width:N,height:q})=>{const P={id:p,type:"dimensions",resizing:!1,dimensions:{width:N,height:q}};x.getState().triggerNodeChanges([P])}})),S.current.update({controlPosition:R,boundaries:{minWidth:s,minHeight:c,maxWidth:u,maxHeight:d},keepAspectRatio:l,resizeDirection:f,onResizeStart:v,onResize:g,onResizeEnd:y,shouldResize:m}),()=>{S.current?.destroy()}},[R,s,c,u,d,l,v,g,y,m]);const M=R.split("-");return C.jsx("div",{className:ce(["react-flow__resize-control","nodrag",...M,r,i]),ref:E,style:{...n,scale:w,...a&&{[_?"backgroundColor":"borderColor"]:a}},children:o})}k.memo(_0);function uu(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Er,Cc;function w0(){if(Cc)return Er;Cc=1;function e(){this.__data__=[],this.size=0}return Er=e,Er}var Cr,Sc;function st(){if(Sc)return Cr;Sc=1;function e(t,r){return t===r||t!==t&&r!==r}return Cr=e,Cr}var Sr,Nc;function Zt(){if(Nc)return Sr;Nc=1;var e=st();function t(r,i){for(var n=r.length;n--;)if(e(r[n][0],i))return n;return-1}return Sr=t,Sr}var Nr,Rc;function E0(){if(Rc)return Nr;Rc=1;var e=Zt(),t=Array.prototype,r=t.splice;function i(n){var o=this.__data__,a=e(o,n);if(a<0)return!1;var s=o.length-1;return a==s?o.pop():r.call(o,a,1),--this.size,!0}return Nr=i,Nr}var Rr,qc;function C0(){if(qc)return Rr;qc=1;var e=Zt();function t(r){var i=this.__data__,n=e(i,r);return n<0?void 0:i[n][1]}return Rr=t,Rr}var qr,Ic;function S0(){if(Ic)return qr;Ic=1;var e=Zt();function t(r){return e(this.__data__,r)>-1}return qr=t,qr}var Ir,Mc;function N0(){if(Mc)return Ir;Mc=1;var e=Zt();function t(r,i){var n=this.__data__,o=e(n,r);return o<0?(++this.size,n.push([r,i])):n[o][1]=i,this}return Ir=t,Ir}var Mr,Ac;function Xt(){if(Ac)return Mr;Ac=1;var e=w0(),t=E0(),r=C0(),i=S0(),n=N0();function o(a){var s=-1,c=a==null?0:a.length;for(this.clear();++s<c;){var u=a[s];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=i,o.prototype.set=n,Mr=o,Mr}var Ar,kc;function R0(){if(kc)return Ar;kc=1;var e=Xt();function t(){this.__data__=new e,this.size=0}return Ar=t,Ar}var kr,Tc;function q0(){if(Tc)return kr;Tc=1;function e(t){var r=this.__data__,i=r.delete(t);return this.size=r.size,i}return kr=e,kr}var Tr,Pc;function I0(){if(Pc)return Tr;Pc=1;function e(t){return this.__data__.get(t)}return Tr=e,Tr}var Pr,Oc;function M0(){if(Oc)return Pr;Oc=1;function e(t){return this.__data__.has(t)}return Pr=e,Pr}var Or,jc;function hv(){if(jc)return Or;jc=1;var e=typeof Tt=="object"&&Tt&&Tt.Object===Object&&Tt;return Or=e,Or}var jr,Dc;function xe(){if(Dc)return jr;Dc=1;var e=hv(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return jr=r,jr}var Dr,Lc;function ut(){if(Lc)return Dr;Lc=1;var e=xe(),t=e.Symbol;return Dr=t,Dr}var Lr,Bc;function A0(){if(Bc)return Lr;Bc=1;var e=ut(),t=Object.prototype,r=t.hasOwnProperty,i=t.toString,n=e?e.toStringTag:void 0;function o(a){var s=r.call(a,n),c=a[n];try{a[n]=void 0;var u=!0}catch{}var d=i.call(a);return u&&(s?a[n]=c:delete a[n]),d}return Lr=o,Lr}var Br,Fc;function k0(){if(Fc)return Br;Fc=1;var e=Object.prototype,t=e.toString;function r(i){return t.call(i)}return Br=r,Br}var Fr,Hc;function We(){if(Hc)return Fr;Hc=1;var e=ut(),t=A0(),r=k0(),i="[object Null]",n="[object Undefined]",o=e?e.toStringTag:void 0;function a(s){return s==null?s===void 0?n:i:o&&o in Object(s)?t(s):r(s)}return Fr=a,Fr}var Hr,zc;function ge(){if(zc)return Hr;zc=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Hr=e,Hr}var zr,$c;function Nt(){if($c)return zr;$c=1;var e=We(),t=ge(),r="[object AsyncFunction]",i="[object Function]",n="[object GeneratorFunction]",o="[object Proxy]";function a(s){if(!t(s))return!1;var c=e(s);return c==i||c==n||c==r||c==o}return zr=a,zr}var $r,Vc;function T0(){if(Vc)return $r;Vc=1;var e=xe(),t=e["__core-js_shared__"];return $r=t,$r}var Vr,Gc;function P0(){if(Gc)return Vr;Gc=1;var e=T0(),t=(function(){var i=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""})();function r(i){return!!t&&t in i}return Vr=r,Vr}var Gr,Uc;function pv(){if(Uc)return Gr;Uc=1;var e=Function.prototype,t=e.toString;function r(i){if(i!=null){try{return t.call(i)}catch{}try{return i+""}catch{}}return""}return Gr=r,Gr}var Ur,Wc;function O0(){if(Wc)return Ur;Wc=1;var e=Nt(),t=P0(),r=ge(),i=pv(),n=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,a=Function.prototype,s=Object.prototype,c=a.toString,u=s.hasOwnProperty,d=RegExp("^"+c.call(u).replace(n,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function l(f){if(!r(f)||t(f))return!1;var h=e(f)?d:o;return h.test(i(f))}return Ur=l,Ur}var Wr,Yc;function j0(){if(Yc)return Wr;Yc=1;function e(t,r){return t?.[r]}return Wr=e,Wr}var Yr,Kc;function Ye(){if(Kc)return Yr;Kc=1;var e=O0(),t=j0();function r(i,n){var o=t(i,n);return e(o)?o:void 0}return Yr=r,Yr}var Kr,Zc;function cu(){if(Zc)return Kr;Zc=1;var e=Ye(),t=xe(),r=e(t,"Map");return Kr=r,Kr}var Zr,Xc;function Qt(){if(Xc)return Zr;Xc=1;var e=Ye(),t=e(Object,"create");return Zr=t,Zr}var Xr,Qc;function D0(){if(Qc)return Xr;Qc=1;var e=Qt();function t(){this.__data__=e?e(null):{},this.size=0}return Xr=t,Xr}var Qr,Jc;function L0(){if(Jc)return Qr;Jc=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return Qr=e,Qr}var Jr,ed;function B0(){if(ed)return Jr;ed=1;var e=Qt(),t="__lodash_hash_undefined__",r=Object.prototype,i=r.hasOwnProperty;function n(o){var a=this.__data__;if(e){var s=a[o];return s===t?void 0:s}return i.call(a,o)?a[o]:void 0}return Jr=n,Jr}var en,td;function F0(){if(td)return en;td=1;var e=Qt(),t=Object.prototype,r=t.hasOwnProperty;function i(n){var o=this.__data__;return e?o[n]!==void 0:r.call(o,n)}return en=i,en}var tn,rd;function H0(){if(rd)return tn;rd=1;var e=Qt(),t="__lodash_hash_undefined__";function r(i,n){var o=this.__data__;return this.size+=this.has(i)?0:1,o[i]=e&&n===void 0?t:n,this}return tn=r,tn}var rn,nd;function z0(){if(nd)return rn;nd=1;var e=D0(),t=L0(),r=B0(),i=F0(),n=H0();function o(a){var s=-1,c=a==null?0:a.length;for(this.clear();++s<c;){var u=a[s];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=i,o.prototype.set=n,rn=o,rn}var nn,id;function $0(){if(id)return nn;id=1;var e=z0(),t=Xt(),r=cu();function i(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return nn=i,nn}var on,od;function V0(){if(od)return on;od=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return on=e,on}var an,ad;function Jt(){if(ad)return an;ad=1;var e=V0();function t(r,i){var n=r.__data__;return e(i)?n[typeof i=="string"?"string":"hash"]:n.map}return an=t,an}var sn,sd;function G0(){if(sd)return sn;sd=1;var e=Jt();function t(r){var i=e(this,r).delete(r);return this.size-=i?1:0,i}return sn=t,sn}var un,ud;function U0(){if(ud)return un;ud=1;var e=Jt();function t(r){return e(this,r).get(r)}return un=t,un}var cn,cd;function W0(){if(cd)return cn;cd=1;var e=Jt();function t(r){return e(this,r).has(r)}return cn=t,cn}var dn,dd;function Y0(){if(dd)return dn;dd=1;var e=Jt();function t(r,i){var n=e(this,r),o=n.size;return n.set(r,i),this.size+=n.size==o?0:1,this}return dn=t,dn}var ln,ld;function du(){if(ld)return ln;ld=1;var e=$0(),t=G0(),r=U0(),i=W0(),n=Y0();function o(a){var s=-1,c=a==null?0:a.length;for(this.clear();++s<c;){var u=a[s];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=i,o.prototype.set=n,ln=o,ln}var fn,fd;function K0(){if(fd)return fn;fd=1;var e=Xt(),t=cu(),r=du(),i=200;function n(o,a){var s=this.__data__;if(s instanceof e){var c=s.__data__;if(!t||c.length<i-1)return c.push([o,a]),this.size=++s.size,this;s=this.__data__=new r(c)}return s.set(o,a),this.size=s.size,this}return fn=n,fn}var hn,hd;function er(){if(hd)return hn;hd=1;var e=Xt(),t=R0(),r=q0(),i=I0(),n=M0(),o=K0();function a(s){var c=this.__data__=new e(s);this.size=c.size}return a.prototype.clear=t,a.prototype.delete=r,a.prototype.get=i,a.prototype.has=n,a.prototype.set=o,hn=a,hn}var pn,pd;function lu(){if(pd)return pn;pd=1;function e(t,r){for(var i=-1,n=t==null?0:t.length;++i<n&&r(t[i],i,t)!==!1;);return t}return pn=e,pn}var gn,gd;function gv(){if(gd)return gn;gd=1;var e=Ye(),t=(function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}})();return gn=t,gn}var vn,vd;function tr(){if(vd)return vn;vd=1;var e=gv();function t(r,i,n){i=="__proto__"&&e?e(r,i,{configurable:!0,enumerable:!0,value:n,writable:!0}):r[i]=n}return vn=t,vn}var mn,md;function rr(){if(md)return mn;md=1;var e=tr(),t=st(),r=Object.prototype,i=r.hasOwnProperty;function n(o,a,s){var c=o[a];(!(i.call(o,a)&&t(c,s))||s===void 0&&!(a in o))&&e(o,a,s)}return mn=n,mn}var yn,yd;function Rt(){if(yd)return yn;yd=1;var e=rr(),t=tr();function r(i,n,o,a){var s=!o;o||(o={});for(var c=-1,u=n.length;++c<u;){var d=n[c],l=a?a(o[d],i[d],d,o,i):void 0;l===void 0&&(l=i[d]),s?t(o,d,l):e(o,d,l)}return o}return yn=r,yn}var bn,bd;function Z0(){if(bd)return bn;bd=1;function e(t,r){for(var i=-1,n=Array(t);++i<t;)n[i]=r(i);return n}return bn=e,bn}var xn,xd;function Ce(){if(xd)return xn;xd=1;function e(t){return t!=null&&typeof t=="object"}return xn=e,xn}var _n,_d;function X0(){if(_d)return _n;_d=1;var e=We(),t=Ce(),r="[object Arguments]";function i(n){return t(n)&&e(n)==r}return _n=i,_n}var wn,wd;function qt(){if(wd)return wn;wd=1;var e=X0(),t=Ce(),r=Object.prototype,i=r.hasOwnProperty,n=r.propertyIsEnumerable,o=e((function(){return arguments})())?e:function(a){return t(a)&&i.call(a,"callee")&&!n.call(a,"callee")};return wn=o,wn}var En,Ed;function de(){if(Ed)return En;Ed=1;var e=Array.isArray;return En=e,En}var ft={exports:{}},Cn,Cd;function Q0(){if(Cd)return Cn;Cd=1;function e(){return!1}return Cn=e,Cn}ft.exports;var Sd;function ct(){return Sd||(Sd=1,(function(e,t){var r=xe(),i=Q0(),n=t&&!t.nodeType&&t,o=n&&!0&&e&&!e.nodeType&&e,a=o&&o.exports===n,s=a?r.Buffer:void 0,c=s?s.isBuffer:void 0,u=c||i;e.exports=u})(ft,ft.exports)),ft.exports}var Sn,Nd;function nr(){if(Nd)return Sn;Nd=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(i,n){var o=typeof i;return n=n??e,!!n&&(o=="number"||o!="symbol"&&t.test(i))&&i>-1&&i%1==0&&i<n}return Sn=r,Sn}var Nn,Rd;function fu(){if(Rd)return Nn;Rd=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return Nn=t,Nn}var Rn,qd;function J0(){if(qd)return Rn;qd=1;var e=We(),t=fu(),r=Ce(),i="[object Arguments]",n="[object Array]",o="[object Boolean]",a="[object Date]",s="[object Error]",c="[object Function]",u="[object Map]",d="[object Number]",l="[object Object]",f="[object RegExp]",h="[object Set]",m="[object String]",v="[object WeakMap]",g="[object ArrayBuffer]",y="[object DataView]",b="[object Float32Array]",p="[object Float64Array]",x="[object Int8Array]",E="[object Int16Array]",_="[object Int32Array]",w="[object Uint8Array]",S="[object Uint8ClampedArray]",R="[object Uint16Array]",M="[object Uint32Array]",N={};N[b]=N[p]=N[x]=N[E]=N[_]=N[w]=N[S]=N[R]=N[M]=!0,N[i]=N[n]=N[g]=N[o]=N[y]=N[a]=N[s]=N[c]=N[u]=N[d]=N[l]=N[f]=N[h]=N[m]=N[v]=!1;function q(P){return r(P)&&t(P.length)&&!!N[e(P)]}return Rn=q,Rn}var qn,Id;function ir(){if(Id)return qn;Id=1;function e(t){return function(r){return t(r)}}return qn=e,qn}var ht={exports:{}};ht.exports;var Md;function hu(){return Md||(Md=1,(function(e,t){var r=hv(),i=t&&!t.nodeType&&t,n=i&&!0&&e&&!e.nodeType&&e,o=n&&n.exports===i,a=o&&r.process,s=(function(){try{var c=n&&n.require&&n.require("util").types;return c||a&&a.binding&&a.binding("util")}catch{}})();e.exports=s})(ht,ht.exports)),ht.exports}var In,Ad;function It(){if(Ad)return In;Ad=1;var e=J0(),t=ir(),r=hu(),i=r&&r.isTypedArray,n=i?t(i):e;return In=n,In}var Mn,kd;function vv(){if(kd)return Mn;kd=1;var e=Z0(),t=qt(),r=de(),i=ct(),n=nr(),o=It(),a=Object.prototype,s=a.hasOwnProperty;function c(u,d){var l=r(u),f=!l&&t(u),h=!l&&!f&&i(u),m=!l&&!f&&!h&&o(u),v=l||f||h||m,g=v?e(u.length,String):[],y=g.length;for(var b in u)(d||s.call(u,b))&&!(v&&(b=="length"||h&&(b=="offset"||b=="parent")||m&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||n(b,y)))&&g.push(b);return g}return Mn=c,Mn}var An,Td;function or(){if(Td)return An;Td=1;var e=Object.prototype;function t(r){var i=r&&r.constructor,n=typeof i=="function"&&i.prototype||e;return r===n}return An=t,An}var kn,Pd;function mv(){if(Pd)return kn;Pd=1;function e(t,r){return function(i){return t(r(i))}}return kn=e,kn}var Tn,Od;function ew(){if(Od)return Tn;Od=1;var e=mv(),t=e(Object.keys,Object);return Tn=t,Tn}var Pn,jd;function pu(){if(jd)return Pn;jd=1;var e=or(),t=ew(),r=Object.prototype,i=r.hasOwnProperty;function n(o){if(!e(o))return t(o);var a=[];for(var s in Object(o))i.call(o,s)&&s!="constructor"&&a.push(s);return a}return Pn=n,Pn}var On,Dd;function Ae(){if(Dd)return On;Dd=1;var e=Nt(),t=fu();function r(i){return i!=null&&t(i.length)&&!e(i)}return On=r,On}var jn,Ld;function ze(){if(Ld)return jn;Ld=1;var e=vv(),t=pu(),r=Ae();function i(n){return r(n)?e(n):t(n)}return jn=i,jn}var Dn,Bd;function tw(){if(Bd)return Dn;Bd=1;var e=Rt(),t=ze();function r(i,n){return i&&e(n,t(n),i)}return Dn=r,Dn}var Ln,Fd;function rw(){if(Fd)return Ln;Fd=1;function e(t){var r=[];if(t!=null)for(var i in Object(t))r.push(i);return r}return Ln=e,Ln}var Bn,Hd;function nw(){if(Hd)return Bn;Hd=1;var e=ge(),t=or(),r=rw(),i=Object.prototype,n=i.hasOwnProperty;function o(a){if(!e(a))return r(a);var s=t(a),c=[];for(var u in a)u=="constructor"&&(s||!n.call(a,u))||c.push(u);return c}return Bn=o,Bn}var Fn,zd;function Ke(){if(zd)return Fn;zd=1;var e=vv(),t=nw(),r=Ae();function i(n){return r(n)?e(n,!0):t(n)}return Fn=i,Fn}var Hn,$d;function iw(){if($d)return Hn;$d=1;var e=Rt(),t=Ke();function r(i,n){return i&&e(n,t(n),i)}return Hn=r,Hn}var pt={exports:{}};pt.exports;var Vd;function yv(){return Vd||(Vd=1,(function(e,t){var r=xe(),i=t&&!t.nodeType&&t,n=i&&!0&&e&&!e.nodeType&&e,o=n&&n.exports===i,a=o?r.Buffer:void 0,s=a?a.allocUnsafe:void 0;function c(u,d){if(d)return u.slice();var l=u.length,f=s?s(l):new u.constructor(l);return u.copy(f),f}e.exports=c})(pt,pt.exports)),pt.exports}var zn,Gd;function bv(){if(Gd)return zn;Gd=1;function e(t,r){var i=-1,n=t.length;for(r||(r=Array(n));++i<n;)r[i]=t[i];return r}return zn=e,zn}var $n,Ud;function xv(){if(Ud)return $n;Ud=1;function e(t,r){for(var i=-1,n=t==null?0:t.length,o=0,a=[];++i<n;){var s=t[i];r(s,i,t)&&(a[o++]=s)}return a}return $n=e,$n}var Vn,Wd;function _v(){if(Wd)return Vn;Wd=1;function e(){return[]}return Vn=e,Vn}var Gn,Yd;function gu(){if(Yd)return Gn;Yd=1;var e=xv(),t=_v(),r=Object.prototype,i=r.propertyIsEnumerable,n=Object.getOwnPropertySymbols,o=n?function(a){return a==null?[]:(a=Object(a),e(n(a),function(s){return i.call(a,s)}))}:t;return Gn=o,Gn}var Un,Kd;function ow(){if(Kd)return Un;Kd=1;var e=Rt(),t=gu();function r(i,n){return e(i,t(i),n)}return Un=r,Un}var Wn,Zd;function vu(){if(Zd)return Wn;Zd=1;function e(t,r){for(var i=-1,n=r.length,o=t.length;++i<n;)t[o+i]=r[i];return t}return Wn=e,Wn}var Yn,Xd;function ar(){if(Xd)return Yn;Xd=1;var e=mv(),t=e(Object.getPrototypeOf,Object);return Yn=t,Yn}var Kn,Qd;function wv(){if(Qd)return Kn;Qd=1;var e=vu(),t=ar(),r=gu(),i=_v(),n=Object.getOwnPropertySymbols,o=n?function(a){for(var s=[];a;)e(s,r(a)),a=t(a);return s}:i;return Kn=o,Kn}var Zn,Jd;function aw(){if(Jd)return Zn;Jd=1;var e=Rt(),t=wv();function r(i,n){return e(i,t(i),n)}return Zn=r,Zn}var Xn,el;function Ev(){if(el)return Xn;el=1;var e=vu(),t=de();function r(i,n,o){var a=n(i);return t(i)?a:e(a,o(i))}return Xn=r,Xn}var Qn,tl;function Cv(){if(tl)return Qn;tl=1;var e=Ev(),t=gu(),r=ze();function i(n){return e(n,r,t)}return Qn=i,Qn}var Jn,rl;function sw(){if(rl)return Jn;rl=1;var e=Ev(),t=wv(),r=Ke();function i(n){return e(n,r,t)}return Jn=i,Jn}var ei,nl;function uw(){if(nl)return ei;nl=1;var e=Ye(),t=xe(),r=e(t,"DataView");return ei=r,ei}var ti,il;function cw(){if(il)return ti;il=1;var e=Ye(),t=xe(),r=e(t,"Promise");return ti=r,ti}var ri,ol;function Sv(){if(ol)return ri;ol=1;var e=Ye(),t=xe(),r=e(t,"Set");return ri=r,ri}var ni,al;function dw(){if(al)return ni;al=1;var e=Ye(),t=xe(),r=e(t,"WeakMap");return ni=r,ni}var ii,sl;function dt(){if(sl)return ii;sl=1;var e=uw(),t=cu(),r=cw(),i=Sv(),n=dw(),o=We(),a=pv(),s="[object Map]",c="[object Object]",u="[object Promise]",d="[object Set]",l="[object WeakMap]",f="[object DataView]",h=a(e),m=a(t),v=a(r),g=a(i),y=a(n),b=o;return(e&&b(new e(new ArrayBuffer(1)))!=f||t&&b(new t)!=s||r&&b(r.resolve())!=u||i&&b(new i)!=d||n&&b(new n)!=l)&&(b=function(p){var x=o(p),E=x==c?p.constructor:void 0,_=E?a(E):"";if(_)switch(_){case h:return f;case m:return s;case v:return u;case g:return d;case y:return l}return x}),ii=b,ii}var oi,ul;function lw(){if(ul)return oi;ul=1;var e=Object.prototype,t=e.hasOwnProperty;function r(i){var n=i.length,o=new i.constructor(n);return n&&typeof i[0]=="string"&&t.call(i,"index")&&(o.index=i.index,o.input=i.input),o}return oi=r,oi}var ai,cl;function Nv(){if(cl)return ai;cl=1;var e=xe(),t=e.Uint8Array;return ai=t,ai}var si,dl;function mu(){if(dl)return si;dl=1;var e=Nv();function t(r){var i=new r.constructor(r.byteLength);return new e(i).set(new e(r)),i}return si=t,si}var ui,ll;function fw(){if(ll)return ui;ll=1;var e=mu();function t(r,i){var n=i?e(r.buffer):r.buffer;return new r.constructor(n,r.byteOffset,r.byteLength)}return ui=t,ui}var ci,fl;function hw(){if(fl)return ci;fl=1;var e=/\w*$/;function t(r){var i=new r.constructor(r.source,e.exec(r));return i.lastIndex=r.lastIndex,i}return ci=t,ci}var di,hl;function pw(){if(hl)return di;hl=1;var e=ut(),t=e?e.prototype:void 0,r=t?t.valueOf:void 0;function i(n){return r?Object(r.call(n)):{}}return di=i,di}var li,pl;function Rv(){if(pl)return li;pl=1;var e=mu();function t(r,i){var n=i?e(r.buffer):r.buffer;return new r.constructor(n,r.byteOffset,r.length)}return li=t,li}var fi,gl;function gw(){if(gl)return fi;gl=1;var e=mu(),t=fw(),r=hw(),i=pw(),n=Rv(),o="[object Boolean]",a="[object Date]",s="[object Map]",c="[object Number]",u="[object RegExp]",d="[object Set]",l="[object String]",f="[object Symbol]",h="[object ArrayBuffer]",m="[object DataView]",v="[object Float32Array]",g="[object Float64Array]",y="[object Int8Array]",b="[object Int16Array]",p="[object Int32Array]",x="[object Uint8Array]",E="[object Uint8ClampedArray]",_="[object Uint16Array]",w="[object Uint32Array]";function S(R,M,N){var q=R.constructor;switch(M){case h:return e(R);case o:case a:return new q(+R);case m:return t(R,N);case v:case g:case y:case b:case p:case x:case E:case _:case w:return n(R,N);case s:return new q;case c:case l:return new q(R);case u:return r(R);case d:return new q;case f:return i(R)}}return fi=S,fi}var hi,vl;function qv(){if(vl)return hi;vl=1;var e=ge(),t=Object.create,r=(function(){function i(){}return function(n){if(!e(n))return{};if(t)return t(n);i.prototype=n;var o=new i;return i.prototype=void 0,o}})();return hi=r,hi}var pi,ml;function Iv(){if(ml)return pi;ml=1;var e=qv(),t=ar(),r=or();function i(n){return typeof n.constructor=="function"&&!r(n)?e(t(n)):{}}return pi=i,pi}var gi,yl;function vw(){if(yl)return gi;yl=1;var e=dt(),t=Ce(),r="[object Map]";function i(n){return t(n)&&e(n)==r}return gi=i,gi}var vi,bl;function mw(){if(bl)return vi;bl=1;var e=vw(),t=ir(),r=hu(),i=r&&r.isMap,n=i?t(i):e;return vi=n,vi}var mi,xl;function yw(){if(xl)return mi;xl=1;var e=dt(),t=Ce(),r="[object Set]";function i(n){return t(n)&&e(n)==r}return mi=i,mi}var yi,_l;function bw(){if(_l)return yi;_l=1;var e=yw(),t=ir(),r=hu(),i=r&&r.isSet,n=i?t(i):e;return yi=n,yi}var bi,wl;function Mv(){if(wl)return bi;wl=1;var e=er(),t=lu(),r=rr(),i=tw(),n=iw(),o=yv(),a=bv(),s=ow(),c=aw(),u=Cv(),d=sw(),l=dt(),f=lw(),h=gw(),m=Iv(),v=de(),g=ct(),y=mw(),b=ge(),p=bw(),x=ze(),E=Ke(),_=1,w=2,S=4,R="[object Arguments]",M="[object Array]",N="[object Boolean]",q="[object Date]",P="[object Error]",D="[object Function]",O="[object GeneratorFunction]",H="[object Map]",z="[object Number]",L="[object Object]",F="[object RegExp]",U="[object Set]",G="[object String]",$="[object Symbol]",W="[object WeakMap]",A="[object ArrayBuffer]",I="[object DataView]",T="[object Float32Array]",j="[object Float64Array]",B="[object Int8Array]",V="[object Int16Array]",Z="[object Int32Array]",J="[object Uint8Array]",Q="[object Uint8ClampedArray]",Y="[object Uint16Array]",te="[object Uint32Array]",X={};X[R]=X[M]=X[A]=X[I]=X[N]=X[q]=X[T]=X[j]=X[B]=X[V]=X[Z]=X[H]=X[z]=X[L]=X[F]=X[U]=X[G]=X[$]=X[J]=X[Q]=X[Y]=X[te]=!0,X[P]=X[D]=X[W]=!1;function ne(ee,fe,le,Se,_e,he){var se,Te=fe&_,Ne=fe&w,Pe=fe&S;if(le&&(se=_e?le(ee,Se,_e,he):le(ee)),se!==void 0)return se;if(!b(ee))return ee;var Oe=v(ee);if(Oe){if(se=f(ee),!Te)return a(ee,se)}else{var Re=l(ee),At=Re==D||Re==O;if(g(ee))return o(ee,Te);if(Re==L||Re==R||At&&!_e){if(se=Ne||At?{}:m(ee),!Te)return Ne?c(ee,n(se,ee)):s(ee,i(se,ee))}else{if(!X[Re])return _e?ee:{};se=h(ee,Re,Te)}}he||(he=new e);var Xe=he.get(ee);if(Xe)return Xe;he.set(ee,se),p(ee)?ee.forEach(function(we){se.add(ne(we,fe,le,we,ee,he))}):y(ee)&&ee.forEach(function(we,qe){se.set(qe,ne(we,fe,le,qe,ee,he))});var hr=Pe?Ne?d:u:Ne?E:x,kt=Oe?void 0:hr(ee);return t(kt||ee,function(we,qe){kt&&(qe=we,we=ee[qe]),r(se,qe,ne(we,fe,le,qe,ee,he))}),se}return bi=ne,bi}var xi,El;function xw(){if(El)return xi;El=1;var e=Mv(),t=4;function r(i){return e(i,t)}return xi=r,xi}var _i,Cl;function yu(){if(Cl)return _i;Cl=1;function e(t){return function(){return t}}return _i=e,_i}var wi,Sl;function _w(){if(Sl)return wi;Sl=1;function e(t){return function(r,i,n){for(var o=-1,a=Object(r),s=n(r),c=s.length;c--;){var u=s[t?c:++o];if(i(a[u],u,a)===!1)break}return r}}return wi=e,wi}var Ei,Nl;function bu(){if(Nl)return Ei;Nl=1;var e=_w(),t=e();return Ei=t,Ei}var Ci,Rl;function xu(){if(Rl)return Ci;Rl=1;var e=bu(),t=ze();function r(i,n){return i&&e(i,n,t)}return Ci=r,Ci}var Si,ql;function ww(){if(ql)return Si;ql=1;var e=Ae();function t(r,i){return function(n,o){if(n==null)return n;if(!e(n))return r(n,o);for(var a=n.length,s=i?a:-1,c=Object(n);(i?s--:++s<a)&&o(c[s],s,c)!==!1;);return n}}return Si=t,Si}var Ni,Il;function sr(){if(Il)return Ni;Il=1;var e=xu(),t=ww(),r=t(e);return Ni=r,Ni}var Ri,Ml;function Ze(){if(Ml)return Ri;Ml=1;function e(t){return t}return Ri=e,Ri}var qi,Al;function Av(){if(Al)return qi;Al=1;var e=Ze();function t(r){return typeof r=="function"?r:e}return qi=t,qi}var Ii,kl;function kv(){if(kl)return Ii;kl=1;var e=lu(),t=sr(),r=Av(),i=de();function n(o,a){var s=i(o)?e:t;return s(o,r(a))}return Ii=n,Ii}var Mi,Tl;function Tv(){return Tl||(Tl=1,Mi=kv()),Mi}var Ai,Pl;function Ew(){if(Pl)return Ai;Pl=1;var e=sr();function t(r,i){var n=[];return e(r,function(o,a,s){i(o,a,s)&&n.push(o)}),n}return Ai=t,Ai}var ki,Ol;function Cw(){if(Ol)return ki;Ol=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return ki=t,ki}var Ti,jl;function Sw(){if(jl)return Ti;jl=1;function e(t){return this.__data__.has(t)}return Ti=e,Ti}var Pi,Dl;function Pv(){if(Dl)return Pi;Dl=1;var e=du(),t=Cw(),r=Sw();function i(n){var o=-1,a=n==null?0:n.length;for(this.__data__=new e;++o<a;)this.add(n[o])}return i.prototype.add=i.prototype.push=t,i.prototype.has=r,Pi=i,Pi}var Oi,Ll;function Nw(){if(Ll)return Oi;Ll=1;function e(t,r){for(var i=-1,n=t==null?0:t.length;++i<n;)if(r(t[i],i,t))return!0;return!1}return Oi=e,Oi}var ji,Bl;function Ov(){if(Bl)return ji;Bl=1;function e(t,r){return t.has(r)}return ji=e,ji}var Di,Fl;function jv(){if(Fl)return Di;Fl=1;var e=Pv(),t=Nw(),r=Ov(),i=1,n=2;function o(a,s,c,u,d,l){var f=c&i,h=a.length,m=s.length;if(h!=m&&!(f&&m>h))return!1;var v=l.get(a),g=l.get(s);if(v&&g)return v==s&&g==a;var y=-1,b=!0,p=c&n?new e:void 0;for(l.set(a,s),l.set(s,a);++y<h;){var x=a[y],E=s[y];if(u)var _=f?u(E,x,y,s,a,l):u(x,E,y,a,s,l);if(_!==void 0){if(_)continue;b=!1;break}if(p){if(!t(s,function(w,S){if(!r(p,S)&&(x===w||d(x,w,c,u,l)))return p.push(S)})){b=!1;break}}else if(!(x===E||d(x,E,c,u,l))){b=!1;break}}return l.delete(a),l.delete(s),b}return Di=o,Di}var Li,Hl;function Rw(){if(Hl)return Li;Hl=1;function e(t){var r=-1,i=Array(t.size);return t.forEach(function(n,o){i[++r]=[o,n]}),i}return Li=e,Li}var Bi,zl;function _u(){if(zl)return Bi;zl=1;function e(t){var r=-1,i=Array(t.size);return t.forEach(function(n){i[++r]=n}),i}return Bi=e,Bi}var Fi,$l;function qw(){if($l)return Fi;$l=1;var e=ut(),t=Nv(),r=st(),i=jv(),n=Rw(),o=_u(),a=1,s=2,c="[object Boolean]",u="[object Date]",d="[object Error]",l="[object Map]",f="[object Number]",h="[object RegExp]",m="[object Set]",v="[object String]",g="[object Symbol]",y="[object ArrayBuffer]",b="[object DataView]",p=e?e.prototype:void 0,x=p?p.valueOf:void 0;function E(_,w,S,R,M,N,q){switch(S){case b:if(_.byteLength!=w.byteLength||_.byteOffset!=w.byteOffset)return!1;_=_.buffer,w=w.buffer;case y:return!(_.byteLength!=w.byteLength||!N(new t(_),new t(w)));case c:case u:case f:return r(+_,+w);case d:return _.name==w.name&&_.message==w.message;case h:case v:return _==w+"";case l:var P=n;case m:var D=R&a;if(P||(P=o),_.size!=w.size&&!D)return!1;var O=q.get(_);if(O)return O==w;R|=s,q.set(_,w);var H=i(P(_),P(w),R,M,N,q);return q.delete(_),H;case g:if(x)return x.call(_)==x.call(w)}return!1}return Fi=E,Fi}var Hi,Vl;function Iw(){if(Vl)return Hi;Vl=1;var e=Cv(),t=1,r=Object.prototype,i=r.hasOwnProperty;function n(o,a,s,c,u,d){var l=s&t,f=e(o),h=f.length,m=e(a),v=m.length;if(h!=v&&!l)return!1;for(var g=h;g--;){var y=f[g];if(!(l?y in a:i.call(a,y)))return!1}var b=d.get(o),p=d.get(a);if(b&&p)return b==a&&p==o;var x=!0;d.set(o,a),d.set(a,o);for(var E=l;++g<h;){y=f[g];var _=o[y],w=a[y];if(c)var S=l?c(w,_,y,a,o,d):c(_,w,y,o,a,d);if(!(S===void 0?_===w||u(_,w,s,c,d):S)){x=!1;break}E||(E=y=="constructor")}if(x&&!E){var R=o.constructor,M=a.constructor;R!=M&&"constructor"in o&&"constructor"in a&&!(typeof R=="function"&&R instanceof R&&typeof M=="function"&&M instanceof M)&&(x=!1)}return d.delete(o),d.delete(a),x}return Hi=n,Hi}var zi,Gl;function Mw(){if(Gl)return zi;Gl=1;var e=er(),t=jv(),r=qw(),i=Iw(),n=dt(),o=de(),a=ct(),s=It(),c=1,u="[object Arguments]",d="[object Array]",l="[object Object]",f=Object.prototype,h=f.hasOwnProperty;function m(v,g,y,b,p,x){var E=o(v),_=o(g),w=E?d:n(v),S=_?d:n(g);w=w==u?l:w,S=S==u?l:S;var R=w==l,M=S==l,N=w==S;if(N&&a(v)){if(!a(g))return!1;E=!0,R=!1}if(N&&!R)return x||(x=new e),E||s(v)?t(v,g,y,b,p,x):r(v,g,w,y,b,p,x);if(!(y&c)){var q=R&&h.call(v,"__wrapped__"),P=M&&h.call(g,"__wrapped__");if(q||P){var D=q?v.value():v,O=P?g.value():g;return x||(x=new e),p(D,O,y,b,x)}}return N?(x||(x=new e),i(v,g,y,b,p,x)):!1}return zi=m,zi}var $i,Ul;function Dv(){if(Ul)return $i;Ul=1;var e=Mw(),t=Ce();function r(i,n,o,a,s){return i===n?!0:i==null||n==null||!t(i)&&!t(n)?i!==i&&n!==n:e(i,n,o,a,r,s)}return $i=r,$i}var Vi,Wl;function Aw(){if(Wl)return Vi;Wl=1;var e=er(),t=Dv(),r=1,i=2;function n(o,a,s,c){var u=s.length,d=u,l=!c;if(o==null)return!d;for(o=Object(o);u--;){var f=s[u];if(l&&f[2]?f[1]!==o[f[0]]:!(f[0]in o))return!1}for(;++u<d;){f=s[u];var h=f[0],m=o[h],v=f[1];if(l&&f[2]){if(m===void 0&&!(h in o))return!1}else{var g=new e;if(c)var y=c(m,v,h,o,a,g);if(!(y===void 0?t(v,m,r|i,c,g):y))return!1}}return!0}return Vi=n,Vi}var Gi,Yl;function Lv(){if(Yl)return Gi;Yl=1;var e=ge();function t(r){return r===r&&!e(r)}return Gi=t,Gi}var Ui,Kl;function kw(){if(Kl)return Ui;Kl=1;var e=Lv(),t=ze();function r(i){for(var n=t(i),o=n.length;o--;){var a=n[o],s=i[a];n[o]=[a,s,e(s)]}return n}return Ui=r,Ui}var Wi,Zl;function Bv(){if(Zl)return Wi;Zl=1;function e(t,r){return function(i){return i==null?!1:i[t]===r&&(r!==void 0||t in Object(i))}}return Wi=e,Wi}var Yi,Xl;function Tw(){if(Xl)return Yi;Xl=1;var e=Aw(),t=kw(),r=Bv();function i(n){var o=t(n);return o.length==1&&o[0][2]?r(o[0][0],o[0][1]):function(a){return a===n||e(a,n,o)}}return Yi=i,Yi}var Ki,Ql;function lt(){if(Ql)return Ki;Ql=1;var e=We(),t=Ce(),r="[object Symbol]";function i(n){return typeof n=="symbol"||t(n)&&e(n)==r}return Ki=i,Ki}var Zi,Jl;function wu(){if(Jl)return Zi;Jl=1;var e=de(),t=lt(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;function n(o,a){if(e(o))return!1;var s=typeof o;return s=="number"||s=="symbol"||s=="boolean"||o==null||t(o)?!0:i.test(o)||!r.test(o)||a!=null&&o in Object(a)}return Zi=n,Zi}var Xi,ef;function Pw(){if(ef)return Xi;ef=1;var e=du(),t="Expected a function";function r(i,n){if(typeof i!="function"||n!=null&&typeof n!="function")throw new TypeError(t);var o=function(){var a=arguments,s=n?n.apply(this,a):a[0],c=o.cache;if(c.has(s))return c.get(s);var u=i.apply(this,a);return o.cache=c.set(s,u)||c,u};return o.cache=new(r.Cache||e),o}return r.Cache=e,Xi=r,Xi}var Qi,tf;function Ow(){if(tf)return Qi;tf=1;var e=Pw(),t=500;function r(i){var n=e(i,function(a){return o.size===t&&o.clear(),a}),o=n.cache;return n}return Qi=r,Qi}var Ji,rf;function jw(){if(rf)return Ji;rf=1;var e=Ow(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,i=e(function(n){var o=[];return n.charCodeAt(0)===46&&o.push(""),n.replace(t,function(a,s,c,u){o.push(c?u.replace(r,"$1"):s||a)}),o});return Ji=i,Ji}var eo,nf;function ur(){if(nf)return eo;nf=1;function e(t,r){for(var i=-1,n=t==null?0:t.length,o=Array(n);++i<n;)o[i]=r(t[i],i,t);return o}return eo=e,eo}var to,of;function Dw(){if(of)return to;of=1;var e=ut(),t=ur(),r=de(),i=lt(),n=e?e.prototype:void 0,o=n?n.toString:void 0;function a(s){if(typeof s=="string")return s;if(r(s))return t(s,a)+"";if(i(s))return o?o.call(s):"";var c=s+"";return c=="0"&&1/s==-1/0?"-0":c}return to=a,to}var ro,af;function Fv(){if(af)return ro;af=1;var e=Dw();function t(r){return r==null?"":e(r)}return ro=t,ro}var no,sf;function cr(){if(sf)return no;sf=1;var e=de(),t=wu(),r=jw(),i=Fv();function n(o,a){return e(o)?o:t(o,a)?[o]:r(i(o))}return no=n,no}var io,uf;function Mt(){if(uf)return io;uf=1;var e=lt();function t(r){if(typeof r=="string"||e(r))return r;var i=r+"";return i=="0"&&1/r==-1/0?"-0":i}return io=t,io}var oo,cf;function dr(){if(cf)return oo;cf=1;var e=cr(),t=Mt();function r(i,n){n=e(n,i);for(var o=0,a=n.length;i!=null&&o<a;)i=i[t(n[o++])];return o&&o==a?i:void 0}return oo=r,oo}var ao,df;function Lw(){if(df)return ao;df=1;var e=dr();function t(r,i,n){var o=r==null?void 0:e(r,i);return o===void 0?n:o}return ao=t,ao}var so,lf;function Bw(){if(lf)return so;lf=1;function e(t,r){return t!=null&&r in Object(t)}return so=e,so}var uo,ff;function Hv(){if(ff)return uo;ff=1;var e=cr(),t=qt(),r=de(),i=nr(),n=fu(),o=Mt();function a(s,c,u){c=e(c,s);for(var d=-1,l=c.length,f=!1;++d<l;){var h=o(c[d]);if(!(f=s!=null&&u(s,h)))break;s=s[h]}return f||++d!=l?f:(l=s==null?0:s.length,!!l&&n(l)&&i(h,l)&&(r(s)||t(s)))}return uo=a,uo}var co,hf;function zv(){if(hf)return co;hf=1;var e=Bw(),t=Hv();function r(i,n){return i!=null&&t(i,n,e)}return co=r,co}var lo,pf;function Fw(){if(pf)return lo;pf=1;var e=Dv(),t=Lw(),r=zv(),i=wu(),n=Lv(),o=Bv(),a=Mt(),s=1,c=2;function u(d,l){return i(d)&&n(l)?o(a(d),l):function(f){var h=t(f,d);return h===void 0&&h===l?r(f,d):e(l,h,s|c)}}return lo=u,lo}var fo,gf;function $v(){if(gf)return fo;gf=1;function e(t){return function(r){return r?.[t]}}return fo=e,fo}var ho,vf;function Hw(){if(vf)return ho;vf=1;var e=dr();function t(r){return function(i){return e(i,r)}}return ho=t,ho}var po,mf;function zw(){if(mf)return po;mf=1;var e=$v(),t=Hw(),r=wu(),i=Mt();function n(o){return r(o)?e(i(o)):t(o)}return po=n,po}var go,yf;function ke(){if(yf)return go;yf=1;var e=Tw(),t=Fw(),r=Ze(),i=de(),n=zw();function o(a){return typeof a=="function"?a:a==null?r:typeof a=="object"?i(a)?t(a[0],a[1]):e(a):n(a)}return go=o,go}var vo,bf;function Vv(){if(bf)return vo;bf=1;var e=xv(),t=Ew(),r=ke(),i=de();function n(o,a){var s=i(o)?e:t;return s(o,r(a,3))}return vo=n,vo}var mo,xf;function $w(){if(xf)return mo;xf=1;var e=Object.prototype,t=e.hasOwnProperty;function r(i,n){return i!=null&&t.call(i,n)}return mo=r,mo}var yo,_f;function Gv(){if(_f)return yo;_f=1;var e=$w(),t=Hv();function r(i,n){return i!=null&&t(i,n,e)}return yo=r,yo}var bo,wf;function Vw(){if(wf)return bo;wf=1;var e=pu(),t=dt(),r=qt(),i=de(),n=Ae(),o=ct(),a=or(),s=It(),c="[object Map]",u="[object Set]",d=Object.prototype,l=d.hasOwnProperty;function f(h){if(h==null)return!0;if(n(h)&&(i(h)||typeof h=="string"||typeof h.splice=="function"||o(h)||s(h)||r(h)))return!h.length;var m=t(h);if(m==c||m==u)return!h.size;if(a(h))return!e(h).length;for(var v in h)if(l.call(h,v))return!1;return!0}return bo=f,bo}var xo,Ef;function Uv(){if(Ef)return xo;Ef=1;function e(t){return t===void 0}return xo=e,xo}var _o,Cf;function Wv(){if(Cf)return _o;Cf=1;var e=sr(),t=Ae();function r(i,n){var o=-1,a=t(i)?Array(i.length):[];return e(i,function(s,c,u){a[++o]=n(s,c,u)}),a}return _o=r,_o}var wo,Sf;function Yv(){if(Sf)return wo;Sf=1;var e=ur(),t=ke(),r=Wv(),i=de();function n(o,a){var s=i(o)?e:r;return s(o,t(a,3))}return wo=n,wo}var Eo,Nf;function Gw(){if(Nf)return Eo;Nf=1;function e(t,r,i,n){var o=-1,a=t==null?0:t.length;for(n&&a&&(i=t[++o]);++o<a;)i=r(i,t[o],o,t);return i}return Eo=e,Eo}var Co,Rf;function Uw(){if(Rf)return Co;Rf=1;function e(t,r,i,n,o){return o(t,function(a,s,c){i=n?(n=!1,a):r(i,a,s,c)}),i}return Co=e,Co}var So,qf;function Kv(){if(qf)return So;qf=1;var e=Gw(),t=sr(),r=ke(),i=Uw(),n=de();function o(a,s,c){var u=n(a)?e:i,d=arguments.length<3;return u(a,r(s,4),c,d,t)}return So=o,So}var No,If;function Ww(){if(If)return No;If=1;var e=We(),t=de(),r=Ce(),i="[object String]";function n(o){return typeof o=="string"||!t(o)&&r(o)&&e(o)==i}return No=n,No}var Ro,Mf;function Yw(){if(Mf)return Ro;Mf=1;var e=$v(),t=e("length");return Ro=t,Ro}var qo,Af;function Kw(){if(Af)return qo;Af=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",i="\\u20d0-\\u20ff",n=t+r+i,o="\\ufe0e\\ufe0f",a="\\u200d",s=RegExp("["+a+e+n+o+"]");function c(u){return s.test(u)}return qo=c,qo}var Io,kf;function Zw(){if(kf)return Io;kf=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",i="\\u20d0-\\u20ff",n=t+r+i,o="\\ufe0e\\ufe0f",a="["+e+"]",s="["+n+"]",c="\\ud83c[\\udffb-\\udfff]",u="(?:"+s+"|"+c+")",d="[^"+e+"]",l="(?:\\ud83c[\\udde6-\\uddff]){2}",f="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",m=u+"?",v="["+o+"]?",g="(?:"+h+"(?:"+[d,l,f].join("|")+")"+v+m+")*",y=v+m+g,b="(?:"+[d+s+"?",s,l,f,a].join("|")+")",p=RegExp(c+"(?="+c+")|"+b+y,"g");function x(E){for(var _=p.lastIndex=0;p.test(E);)++_;return _}return Io=x,Io}var Mo,Tf;function Xw(){if(Tf)return Mo;Tf=1;var e=Yw(),t=Kw(),r=Zw();function i(n){return t(n)?r(n):e(n)}return Mo=i,Mo}var Ao,Pf;function Qw(){if(Pf)return Ao;Pf=1;var e=pu(),t=dt(),r=Ae(),i=Ww(),n=Xw(),o="[object Map]",a="[object Set]";function s(c){if(c==null)return 0;if(r(c))return i(c)?n(c):c.length;var u=t(c);return u==o||u==a?c.size:e(c).length}return Ao=s,Ao}var ko,Of;function Jw(){if(Of)return ko;Of=1;var e=lu(),t=qv(),r=xu(),i=ke(),n=ar(),o=de(),a=ct(),s=Nt(),c=ge(),u=It();function d(l,f,h){var m=o(l),v=m||a(l)||u(l);if(f=i(f,4),h==null){var g=l&&l.constructor;v?h=m?new g:[]:c(l)?h=s(g)?t(n(l)):{}:h={}}return(v?e:r)(l,function(y,b,p){return f(h,y,b,p)}),h}return ko=d,ko}var To,jf;function e1(){if(jf)return To;jf=1;var e=ut(),t=qt(),r=de(),i=e?e.isConcatSpreadable:void 0;function n(o){return r(o)||t(o)||!!(i&&o&&o[i])}return To=n,To}var Po,Df;function Eu(){if(Df)return Po;Df=1;var e=vu(),t=e1();function r(i,n,o,a,s){var c=-1,u=i.length;for(o||(o=t),s||(s=[]);++c<u;){var d=i[c];n>0&&o(d)?n>1?r(d,n-1,o,a,s):e(s,d):a||(s[s.length]=d)}return s}return Po=r,Po}var Oo,Lf;function t1(){if(Lf)return Oo;Lf=1;function e(t,r,i){switch(i.length){case 0:return t.call(r);case 1:return t.call(r,i[0]);case 2:return t.call(r,i[0],i[1]);case 3:return t.call(r,i[0],i[1],i[2])}return t.apply(r,i)}return Oo=e,Oo}var jo,Bf;function Zv(){if(Bf)return jo;Bf=1;var e=t1(),t=Math.max;function r(i,n,o){return n=t(n===void 0?i.length-1:n,0),function(){for(var a=arguments,s=-1,c=t(a.length-n,0),u=Array(c);++s<c;)u[s]=a[n+s];s=-1;for(var d=Array(n+1);++s<n;)d[s]=a[s];return d[n]=o(u),e(i,this,d)}}return jo=r,jo}var Do,Ff;function r1(){if(Ff)return Do;Ff=1;var e=yu(),t=gv(),r=Ze(),i=t?function(n,o){return t(n,"toString",{configurable:!0,enumerable:!1,value:e(o),writable:!0})}:r;return Do=i,Do}var Lo,Hf;function n1(){if(Hf)return Lo;Hf=1;var e=800,t=16,r=Date.now;function i(n){var o=0,a=0;return function(){var s=r(),c=t-(s-a);if(a=s,c>0){if(++o>=e)return arguments[0]}else o=0;return n.apply(void 0,arguments)}}return Lo=i,Lo}var Bo,zf;function Xv(){if(zf)return Bo;zf=1;var e=r1(),t=n1(),r=t(e);return Bo=r,Bo}var Fo,$f;function lr(){if($f)return Fo;$f=1;var e=Ze(),t=Zv(),r=Xv();function i(n,o){return r(t(n,o,e),n+"")}return Fo=i,Fo}var Ho,Vf;function Qv(){if(Vf)return Ho;Vf=1;function e(t,r,i,n){for(var o=t.length,a=i+(n?1:-1);n?a--:++a<o;)if(r(t[a],a,t))return a;return-1}return Ho=e,Ho}var zo,Gf;function i1(){if(Gf)return zo;Gf=1;function e(t){return t!==t}return zo=e,zo}var $o,Uf;function o1(){if(Uf)return $o;Uf=1;function e(t,r,i){for(var n=i-1,o=t.length;++n<o;)if(t[n]===r)return n;return-1}return $o=e,$o}var Vo,Wf;function a1(){if(Wf)return Vo;Wf=1;var e=Qv(),t=i1(),r=o1();function i(n,o,a){return o===o?r(n,o,a):e(n,t,a)}return Vo=i,Vo}var Go,Yf;function s1(){if(Yf)return Go;Yf=1;var e=a1();function t(r,i){var n=r==null?0:r.length;return!!n&&e(r,i,0)>-1}return Go=t,Go}var Uo,Kf;function u1(){if(Kf)return Uo;Kf=1;function e(t,r,i){for(var n=-1,o=t==null?0:t.length;++n<o;)if(i(r,t[n]))return!0;return!1}return Uo=e,Uo}var Wo,Zf;function c1(){if(Zf)return Wo;Zf=1;function e(){}return Wo=e,Wo}var Yo,Xf;function d1(){if(Xf)return Yo;Xf=1;var e=Sv(),t=c1(),r=_u(),i=1/0,n=e&&1/r(new e([,-0]))[1]==i?function(o){return new e(o)}:t;return Yo=n,Yo}var Ko,Qf;function l1(){if(Qf)return Ko;Qf=1;var e=Pv(),t=s1(),r=u1(),i=Ov(),n=d1(),o=_u(),a=200;function s(c,u,d){var l=-1,f=t,h=c.length,m=!0,v=[],g=v;if(d)m=!1,f=r;else if(h>=a){var y=u?null:n(c);if(y)return o(y);m=!1,f=i,g=new e}else g=u?[]:v;e:for(;++l<h;){var b=c[l],p=u?u(b):b;if(b=d||b!==0?b:0,m&&p===p){for(var x=g.length;x--;)if(g[x]===p)continue e;u&&g.push(p),v.push(b)}else f(g,p,d)||(g!==v&&g.push(p),v.push(b))}return v}return Ko=s,Ko}var Zo,Jf;function Jv(){if(Jf)return Zo;Jf=1;var e=Ae(),t=Ce();function r(i){return t(i)&&e(i)}return Zo=r,Zo}var Xo,eh;function f1(){if(eh)return Xo;eh=1;var e=Eu(),t=lr(),r=l1(),i=Jv(),n=t(function(o){return r(e(o,1,i,!0))});return Xo=n,Xo}var Qo,th;function h1(){if(th)return Qo;th=1;var e=ur();function t(r,i){return e(i,function(n){return r[n]})}return Qo=t,Qo}var Jo,rh;function em(){if(rh)return Jo;rh=1;var e=h1(),t=ze();function r(i){return i==null?[]:e(i,t(i))}return Jo=r,Jo}var ea,nh;function ve(){if(nh)return ea;nh=1;var e;if(typeof uu=="function")try{e={clone:xw(),constant:yu(),each:Tv(),filter:Vv(),has:Gv(),isArray:de(),isEmpty:Vw(),isFunction:Nt(),isUndefined:Uv(),keys:ze(),map:Yv(),reduce:Kv(),size:Qw(),transform:Jw(),union:f1(),values:em()}}catch{}return e||(e=window._),ea=e,ea}var ta,ih;function Cu(){if(ih)return ta;ih=1;var e=ve();ta=n;var t="\0",r="\0",i="";function n(d){this._isDirected=e.has(d,"directed")?d.directed:!0,this._isMultigraph=e.has(d,"multigraph")?d.multigraph:!1,this._isCompound=e.has(d,"compound")?d.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}n.prototype._nodeCount=0,n.prototype._edgeCount=0,n.prototype.isDirected=function(){return this._isDirected},n.prototype.isMultigraph=function(){return this._isMultigraph},n.prototype.isCompound=function(){return this._isCompound},n.prototype.setGraph=function(d){return this._label=d,this},n.prototype.graph=function(){return this._label},n.prototype.setDefaultNodeLabel=function(d){return e.isFunction(d)||(d=e.constant(d)),this._defaultNodeLabelFn=d,this},n.prototype.nodeCount=function(){return this._nodeCount},n.prototype.nodes=function(){return e.keys(this._nodes)},n.prototype.sources=function(){var d=this;return e.filter(this.nodes(),function(l){return e.isEmpty(d._in[l])})},n.prototype.sinks=function(){var d=this;return e.filter(this.nodes(),function(l){return e.isEmpty(d._out[l])})},n.prototype.setNodes=function(d,l){var f=arguments,h=this;return e.each(d,function(m){f.length>1?h.setNode(m,l):h.setNode(m)}),this},n.prototype.setNode=function(d,l){return e.has(this._nodes,d)?(arguments.length>1&&(this._nodes[d]=l),this):(this._nodes[d]=arguments.length>1?l:this._defaultNodeLabelFn(d),this._isCompound&&(this._parent[d]=r,this._children[d]={},this._children[r][d]=!0),this._in[d]={},this._preds[d]={},this._out[d]={},this._sucs[d]={},++this._nodeCount,this)},n.prototype.node=function(d){return this._nodes[d]},n.prototype.hasNode=function(d){return e.has(this._nodes,d)},n.prototype.removeNode=function(d){var l=this;if(e.has(this._nodes,d)){var f=function(h){l.removeEdge(l._edgeObjs[h])};delete this._nodes[d],this._isCompound&&(this._removeFromParentsChildList(d),delete this._parent[d],e.each(this.children(d),function(h){l.setParent(h)}),delete this._children[d]),e.each(e.keys(this._in[d]),f),delete this._in[d],delete this._preds[d],e.each(e.keys(this._out[d]),f),delete this._out[d],delete this._sucs[d],--this._nodeCount}return this},n.prototype.setParent=function(d,l){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(l))l=r;else{l+="";for(var f=l;!e.isUndefined(f);f=this.parent(f))if(f===d)throw new Error("Setting "+l+" as parent of "+d+" would create a cycle");this.setNode(l)}return this.setNode(d),this._removeFromParentsChildList(d),this._parent[d]=l,this._children[l][d]=!0,this},n.prototype._removeFromParentsChildList=function(d){delete this._children[this._parent[d]][d]},n.prototype.parent=function(d){if(this._isCompound){var l=this._parent[d];if(l!==r)return l}},n.prototype.children=function(d){if(e.isUndefined(d)&&(d=r),this._isCompound){var l=this._children[d];if(l)return e.keys(l)}else{if(d===r)return this.nodes();if(this.hasNode(d))return[]}},n.prototype.predecessors=function(d){var l=this._preds[d];if(l)return e.keys(l)},n.prototype.successors=function(d){var l=this._sucs[d];if(l)return e.keys(l)},n.prototype.neighbors=function(d){var l=this.predecessors(d);if(l)return e.union(l,this.successors(d))},n.prototype.isLeaf=function(d){var l;return this.isDirected()?l=this.successors(d):l=this.neighbors(d),l.length===0},n.prototype.filterNodes=function(d){var l=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});l.setGraph(this.graph());var f=this;e.each(this._nodes,function(v,g){d(g)&&l.setNode(g,v)}),e.each(this._edgeObjs,function(v){l.hasNode(v.v)&&l.hasNode(v.w)&&l.setEdge(v,f.edge(v))});var h={};function m(v){var g=f.parent(v);return g===void 0||l.hasNode(g)?(h[v]=g,g):g in h?h[g]:m(g)}return this._isCompound&&e.each(l.nodes(),function(v){l.setParent(v,m(v))}),l},n.prototype.setDefaultEdgeLabel=function(d){return e.isFunction(d)||(d=e.constant(d)),this._defaultEdgeLabelFn=d,this},n.prototype.edgeCount=function(){return this._edgeCount},n.prototype.edges=function(){return e.values(this._edgeObjs)},n.prototype.setPath=function(d,l){var f=this,h=arguments;return e.reduce(d,function(m,v){return h.length>1?f.setEdge(m,v,l):f.setEdge(m,v),v}),this},n.prototype.setEdge=function(){var d,l,f,h,m=!1,v=arguments[0];typeof v=="object"&&v!==null&&"v"in v?(d=v.v,l=v.w,f=v.name,arguments.length===2&&(h=arguments[1],m=!0)):(d=v,l=arguments[1],f=arguments[3],arguments.length>2&&(h=arguments[2],m=!0)),d=""+d,l=""+l,e.isUndefined(f)||(f=""+f);var g=s(this._isDirected,d,l,f);if(e.has(this._edgeLabels,g))return m&&(this._edgeLabels[g]=h),this;if(!e.isUndefined(f)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(d),this.setNode(l),this._edgeLabels[g]=m?h:this._defaultEdgeLabelFn(d,l,f);var y=c(this._isDirected,d,l,f);return d=y.v,l=y.w,Object.freeze(y),this._edgeObjs[g]=y,o(this._preds[l],d),o(this._sucs[d],l),this._in[l][g]=y,this._out[d][g]=y,this._edgeCount++,this},n.prototype.edge=function(d,l,f){var h=arguments.length===1?u(this._isDirected,arguments[0]):s(this._isDirected,d,l,f);return this._edgeLabels[h]},n.prototype.hasEdge=function(d,l,f){var h=arguments.length===1?u(this._isDirected,arguments[0]):s(this._isDirected,d,l,f);return e.has(this._edgeLabels,h)},n.prototype.removeEdge=function(d,l,f){var h=arguments.length===1?u(this._isDirected,arguments[0]):s(this._isDirected,d,l,f),m=this._edgeObjs[h];return m&&(d=m.v,l=m.w,delete this._edgeLabels[h],delete this._edgeObjs[h],a(this._preds[l],d),a(this._sucs[d],l),delete this._in[l][h],delete this._out[d][h],this._edgeCount--),this},n.prototype.inEdges=function(d,l){var f=this._in[d];if(f){var h=e.values(f);return l?e.filter(h,function(m){return m.v===l}):h}},n.prototype.outEdges=function(d,l){var f=this._out[d];if(f){var h=e.values(f);return l?e.filter(h,function(m){return m.w===l}):h}},n.prototype.nodeEdges=function(d,l){var f=this.inEdges(d,l);if(f)return f.concat(this.outEdges(d,l))};function o(d,l){d[l]?d[l]++:d[l]=1}function a(d,l){--d[l]||delete d[l]}function s(d,l,f,h){var m=""+l,v=""+f;if(!d&&m>v){var g=m;m=v,v=g}return m+i+v+i+(e.isUndefined(h)?t:h)}function c(d,l,f,h){var m=""+l,v=""+f;if(!d&&m>v){var g=m;m=v,v=g}var y={v:m,w:v};return h&&(y.name=h),y}function u(d,l){return s(d,l.v,l.w,l.name)}return ta}var ra,oh;function p1(){return oh||(oh=1,ra="2.1.8"),ra}var na,ah;function g1(){return ah||(ah=1,na={Graph:Cu(),version:p1()}),na}var ia,sh;function v1(){if(sh)return ia;sh=1;var e=ve(),t=Cu();ia={write:r,read:o};function r(a){var s={options:{directed:a.isDirected(),multigraph:a.isMultigraph(),compound:a.isCompound()},nodes:i(a),edges:n(a)};return e.isUndefined(a.graph())||(s.value=e.clone(a.graph())),s}function i(a){return e.map(a.nodes(),function(s){var c=a.node(s),u=a.parent(s),d={v:s};return e.isUndefined(c)||(d.value=c),e.isUndefined(u)||(d.parent=u),d})}function n(a){return e.map(a.edges(),function(s){var c=a.edge(s),u={v:s.v,w:s.w};return e.isUndefined(s.name)||(u.name=s.name),e.isUndefined(c)||(u.value=c),u})}function o(a){var s=new t(a.options).setGraph(a.value);return e.each(a.nodes,function(c){s.setNode(c.v,c.value),c.parent&&s.setParent(c.v,c.parent)}),e.each(a.edges,function(c){s.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),s}return ia}var oa,uh;function m1(){if(uh)return oa;uh=1;var e=ve();oa=t;function t(r){var i={},n=[],o;function a(s){e.has(i,s)||(i[s]=!0,o.push(s),e.each(r.successors(s),a),e.each(r.predecessors(s),a))}return e.each(r.nodes(),function(s){o=[],a(s),o.length&&n.push(o)}),n}return oa}var aa,ch;function tm(){if(ch)return aa;ch=1;var e=ve();aa=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(r){return r.key})},t.prototype.has=function(r){return e.has(this._keyIndices,r)},t.prototype.priority=function(r){var i=this._keyIndices[r];if(i!==void 0)return this._arr[i].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(r,i){var n=this._keyIndices;if(r=String(r),!e.has(n,r)){var o=this._arr,a=o.length;return n[r]=a,o.push({key:r,priority:i}),this._decrease(a),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key},t.prototype.decrease=function(r,i){var n=this._keyIndices[r];if(i>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[n].priority+" New: "+i);this._arr[n].priority=i,this._decrease(n)},t.prototype._heapify=function(r){var i=this._arr,n=2*r,o=n+1,a=r;n<i.length&&(a=i[n].priority<i[a].priority?n:a,o<i.length&&(a=i[o].priority<i[a].priority?o:a),a!==r&&(this._swap(r,a),this._heapify(a)))},t.prototype._decrease=function(r){for(var i=this._arr,n=i[r].priority,o;r!==0&&(o=r>>1,!(i[o].priority<n));)this._swap(r,o),r=o},t.prototype._swap=function(r,i){var n=this._arr,o=this._keyIndices,a=n[r],s=n[i];n[r]=s,n[i]=a,o[s.key]=r,o[a.key]=i},aa}var sa,dh;function rm(){if(dh)return sa;dh=1;var e=ve(),t=tm();sa=i;var r=e.constant(1);function i(o,a,s,c){return n(o,String(a),s||r,c||function(u){return o.outEdges(u)})}function n(o,a,s,c){var u={},d=new t,l,f,h=function(m){var v=m.v!==l?m.v:m.w,g=u[v],y=s(m),b=f.distance+y;if(y<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+m+" Weight: "+y);b<g.distance&&(g.distance=b,g.predecessor=l,d.decrease(v,b))};for(o.nodes().forEach(function(m){var v=m===a?0:Number.POSITIVE_INFINITY;u[m]={distance:v},d.add(m,v)});d.size()>0&&(l=d.removeMin(),f=u[l],f.distance!==Number.POSITIVE_INFINITY);)c(l).forEach(h);return u}return sa}var ua,lh;function y1(){if(lh)return ua;lh=1;var e=rm(),t=ve();ua=r;function r(i,n,o){return t.transform(i.nodes(),function(a,s){a[s]=e(i,s,n,o)},{})}return ua}var ca,fh;function nm(){if(fh)return ca;fh=1;var e=ve();ca=t;function t(r){var i=0,n=[],o={},a=[];function s(c){var u=o[c]={onStack:!0,lowlink:i,index:i++};if(n.push(c),r.successors(c).forEach(function(f){e.has(o,f)?o[f].onStack&&(u.lowlink=Math.min(u.lowlink,o[f].index)):(s(f),u.lowlink=Math.min(u.lowlink,o[f].lowlink))}),u.lowlink===u.index){var d=[],l;do l=n.pop(),o[l].onStack=!1,d.push(l);while(c!==l);a.push(d)}}return r.nodes().forEach(function(c){e.has(o,c)||s(c)}),a}return ca}var da,hh;function b1(){if(hh)return da;hh=1;var e=ve(),t=nm();da=r;function r(i){return e.filter(t(i),function(n){return n.length>1||n.length===1&&i.hasEdge(n[0],n[0])})}return da}var la,ph;function x1(){if(ph)return la;ph=1;var e=ve();la=r;var t=e.constant(1);function r(n,o,a){return i(n,o||t,a||function(s){return n.outEdges(s)})}function i(n,o,a){var s={},c=n.nodes();return c.forEach(function(u){s[u]={},s[u][u]={distance:0},c.forEach(function(d){u!==d&&(s[u][d]={distance:Number.POSITIVE_INFINITY})}),a(u).forEach(function(d){var l=d.v===u?d.w:d.v,f=o(d);s[u][l]={distance:f,predecessor:u}})}),c.forEach(function(u){var d=s[u];c.forEach(function(l){var f=s[l];c.forEach(function(h){var m=f[u],v=d[h],g=f[h],y=m.distance+v.distance;y<g.distance&&(g.distance=y,g.predecessor=v.predecessor)})})}),s}return la}var fa,gh;function im(){if(gh)return fa;gh=1;var e=ve();fa=t,t.CycleException=r;function t(i){var n={},o={},a=[];function s(c){if(e.has(o,c))throw new r;e.has(n,c)||(o[c]=!0,n[c]=!0,e.each(i.predecessors(c),s),delete o[c],a.push(c))}if(e.each(i.sinks(),s),e.size(n)!==i.nodeCount())throw new r;return a}function r(){}return r.prototype=new Error,fa}var ha,vh;function _1(){if(vh)return ha;vh=1;var e=im();ha=t;function t(r){try{e(r)}catch(i){if(i instanceof e.CycleException)return!1;throw i}return!0}return ha}var pa,mh;function om(){if(mh)return pa;mh=1;var e=ve();pa=t;function t(i,n,o){e.isArray(n)||(n=[n]);var a=(i.isDirected()?i.successors:i.neighbors).bind(i),s=[],c={};return e.each(n,function(u){if(!i.hasNode(u))throw new Error("Graph does not have node: "+u);r(i,u,o==="post",c,a,s)}),s}function r(i,n,o,a,s,c){e.has(a,n)||(a[n]=!0,o||c.push(n),e.each(s(n),function(u){r(i,u,o,a,s,c)}),o&&c.push(n))}return pa}var ga,yh;function w1(){if(yh)return ga;yh=1;var e=om();ga=t;function t(r,i){return e(r,i,"post")}return ga}var va,bh;function E1(){if(bh)return va;bh=1;var e=om();va=t;function t(r,i){return e(r,i,"pre")}return va}var ma,xh;function C1(){if(xh)return ma;xh=1;var e=ve(),t=Cu(),r=tm();ma=i;function i(n,o){var a=new t,s={},c=new r,u;function d(f){var h=f.v===u?f.w:f.v,m=c.priority(h);if(m!==void 0){var v=o(f);v<m&&(s[h]=u,c.decrease(h,v))}}if(n.nodeCount()===0)return a;e.each(n.nodes(),function(f){c.add(f,Number.POSITIVE_INFINITY),a.setNode(f)}),c.decrease(n.nodes()[0],0);for(var l=!1;c.size()>0;){if(u=c.removeMin(),e.has(s,u))a.setEdge(u,s[u]);else{if(l)throw new Error("Input graph is not connected: "+n);l=!0}n.nodeEdges(u).forEach(d)}return a}return ma}var ya,_h;function S1(){return _h||(_h=1,ya={components:m1(),dijkstra:rm(),dijkstraAll:y1(),findCycles:b1(),floydWarshall:x1(),isAcyclic:_1(),postorder:w1(),preorder:E1(),prim:C1(),tarjan:nm(),topsort:im()}),ya}var ba,wh;function N1(){if(wh)return ba;wh=1;var e=g1();return ba={Graph:e.Graph,json:v1(),alg:S1(),version:e.version},ba}var xa,Eh;function be(){if(Eh)return xa;Eh=1;var e;if(typeof uu=="function")try{e=N1()}catch{}return e||(e=window.graphlib),xa=e,xa}var _a,Ch;function R1(){if(Ch)return _a;Ch=1;var e=Mv(),t=1,r=4;function i(n){return e(n,t|r)}return _a=i,_a}var wa,Sh;function fr(){if(Sh)return wa;Sh=1;var e=st(),t=Ae(),r=nr(),i=ge();function n(o,a,s){if(!i(s))return!1;var c=typeof a;return(c=="number"?t(s)&&r(a,s.length):c=="string"&&a in s)?e(s[a],o):!1}return wa=n,wa}var Ea,Nh;function q1(){if(Nh)return Ea;Nh=1;var e=lr(),t=st(),r=fr(),i=Ke(),n=Object.prototype,o=n.hasOwnProperty,a=e(function(s,c){s=Object(s);var u=-1,d=c.length,l=d>2?c[2]:void 0;for(l&&r(c[0],c[1],l)&&(d=1);++u<d;)for(var f=c[u],h=i(f),m=-1,v=h.length;++m<v;){var g=h[m],y=s[g];(y===void 0||t(y,n[g])&&!o.call(s,g))&&(s[g]=f[g])}return s});return Ea=a,Ea}var Ca,Rh;function I1(){if(Rh)return Ca;Rh=1;var e=ke(),t=Ae(),r=ze();function i(n){return function(o,a,s){var c=Object(o);if(!t(o)){var u=e(a,3);o=r(o),a=function(l){return u(c[l],l,c)}}var d=n(o,a,s);return d>-1?c[u?o[d]:d]:void 0}}return Ca=i,Ca}var Sa,qh;function M1(){if(qh)return Sa;qh=1;var e=/\s/;function t(r){for(var i=r.length;i--&&e.test(r.charAt(i)););return i}return Sa=t,Sa}var Na,Ih;function A1(){if(Ih)return Na;Ih=1;var e=M1(),t=/^\s+/;function r(i){return i&&i.slice(0,e(i)+1).replace(t,"")}return Na=r,Na}var Ra,Mh;function k1(){if(Mh)return Ra;Mh=1;var e=A1(),t=ge(),r=lt(),i=NaN,n=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,s=parseInt;function c(u){if(typeof u=="number")return u;if(r(u))return i;if(t(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=t(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=e(u);var l=o.test(u);return l||a.test(u)?s(u.slice(2),l?2:8):n.test(u)?i:+u}return Ra=c,Ra}var qa,Ah;function am(){if(Ah)return qa;Ah=1;var e=k1(),t=1/0,r=17976931348623157e292;function i(n){if(!n)return n===0?n:0;if(n=e(n),n===t||n===-t){var o=n<0?-1:1;return o*r}return n===n?n:0}return qa=i,qa}var Ia,kh;function T1(){if(kh)return Ia;kh=1;var e=am();function t(r){var i=e(r),n=i%1;return i===i?n?i-n:i:0}return Ia=t,Ia}var Ma,Th;function P1(){if(Th)return Ma;Th=1;var e=Qv(),t=ke(),r=T1(),i=Math.max;function n(o,a,s){var c=o==null?0:o.length;if(!c)return-1;var u=s==null?0:r(s);return u<0&&(u=i(c+u,0)),e(o,t(a,3),u)}return Ma=n,Ma}var Aa,Ph;function O1(){if(Ph)return Aa;Ph=1;var e=I1(),t=P1(),r=e(t);return Aa=r,Aa}var ka,Oh;function sm(){if(Oh)return ka;Oh=1;var e=Eu();function t(r){var i=r==null?0:r.length;return i?e(r,1):[]}return ka=t,ka}var Ta,jh;function j1(){if(jh)return Ta;jh=1;var e=bu(),t=Av(),r=Ke();function i(n,o){return n==null?n:e(n,t(o),r)}return Ta=i,Ta}var Pa,Dh;function D1(){if(Dh)return Pa;Dh=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return Pa=e,Pa}var Oa,Lh;function L1(){if(Lh)return Oa;Lh=1;var e=tr(),t=xu(),r=ke();function i(n,o){var a={};return o=r(o,3),t(n,function(s,c,u){e(a,c,o(s,c,u))}),a}return Oa=i,Oa}var ja,Bh;function Su(){if(Bh)return ja;Bh=1;var e=lt();function t(r,i,n){for(var o=-1,a=r.length;++o<a;){var s=r[o],c=i(s);if(c!=null&&(u===void 0?c===c&&!e(c):n(c,u)))var u=c,d=s}return d}return ja=t,ja}var Da,Fh;function B1(){if(Fh)return Da;Fh=1;function e(t,r){return t>r}return Da=e,Da}var La,Hh;function F1(){if(Hh)return La;Hh=1;var e=Su(),t=B1(),r=Ze();function i(n){return n&&n.length?e(n,r,t):void 0}return La=i,La}var Ba,zh;function um(){if(zh)return Ba;zh=1;var e=tr(),t=st();function r(i,n,o){(o!==void 0&&!t(i[n],o)||o===void 0&&!(n in i))&&e(i,n,o)}return Ba=r,Ba}var Fa,$h;function H1(){if($h)return Fa;$h=1;var e=We(),t=ar(),r=Ce(),i="[object Object]",n=Function.prototype,o=Object.prototype,a=n.toString,s=o.hasOwnProperty,c=a.call(Object);function u(d){if(!r(d)||e(d)!=i)return!1;var l=t(d);if(l===null)return!0;var f=s.call(l,"constructor")&&l.constructor;return typeof f=="function"&&f instanceof f&&a.call(f)==c}return Fa=u,Fa}var Ha,Vh;function cm(){if(Vh)return Ha;Vh=1;function e(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}return Ha=e,Ha}var za,Gh;function z1(){if(Gh)return za;Gh=1;var e=Rt(),t=Ke();function r(i){return e(i,t(i))}return za=r,za}var $a,Uh;function $1(){if(Uh)return $a;Uh=1;var e=um(),t=yv(),r=Rv(),i=bv(),n=Iv(),o=qt(),a=de(),s=Jv(),c=ct(),u=Nt(),d=ge(),l=H1(),f=It(),h=cm(),m=z1();function v(g,y,b,p,x,E,_){var w=h(g,b),S=h(y,b),R=_.get(S);if(R){e(g,b,R);return}var M=E?E(w,S,b+"",g,y,_):void 0,N=M===void 0;if(N){var q=a(S),P=!q&&c(S),D=!q&&!P&&f(S);M=S,q||P||D?a(w)?M=w:s(w)?M=i(w):P?(N=!1,M=t(S,!0)):D?(N=!1,M=r(S,!0)):M=[]:l(S)||o(S)?(M=w,o(w)?M=m(w):(!d(w)||u(w))&&(M=n(S))):N=!1}N&&(_.set(S,M),x(M,S,p,E,_),_.delete(S)),e(g,b,M)}return $a=v,$a}var Va,Wh;function V1(){if(Wh)return Va;Wh=1;var e=er(),t=um(),r=bu(),i=$1(),n=ge(),o=Ke(),a=cm();function s(c,u,d,l,f){c!==u&&r(u,function(h,m){if(f||(f=new e),n(h))i(c,u,m,d,s,l,f);else{var v=l?l(a(c,m),h,m+"",c,u,f):void 0;v===void 0&&(v=h),t(c,m,v)}},o)}return Va=s,Va}var Ga,Yh;function G1(){if(Yh)return Ga;Yh=1;var e=lr(),t=fr();function r(i){return e(function(n,o){var a=-1,s=o.length,c=s>1?o[s-1]:void 0,u=s>2?o[2]:void 0;for(c=i.length>3&&typeof c=="function"?(s--,c):void 0,u&&t(o[0],o[1],u)&&(c=s<3?void 0:c,s=1),n=Object(n);++a<s;){var d=o[a];d&&i(n,d,a,c)}return n})}return Ga=r,Ga}var Ua,Kh;function U1(){if(Kh)return Ua;Kh=1;var e=V1(),t=G1(),r=t(function(i,n,o){e(i,n,o)});return Ua=r,Ua}var Wa,Zh;function dm(){if(Zh)return Wa;Zh=1;function e(t,r){return t<r}return Wa=e,Wa}var Ya,Xh;function W1(){if(Xh)return Ya;Xh=1;var e=Su(),t=dm(),r=Ze();function i(n){return n&&n.length?e(n,r,t):void 0}return Ya=i,Ya}var Ka,Qh;function Y1(){if(Qh)return Ka;Qh=1;var e=Su(),t=ke(),r=dm();function i(n,o){return n&&n.length?e(n,t(o,2),r):void 0}return Ka=i,Ka}var Za,Jh;function K1(){if(Jh)return Za;Jh=1;var e=xe(),t=function(){return e.Date.now()};return Za=t,Za}var Xa,ep;function Z1(){if(ep)return Xa;ep=1;var e=rr(),t=cr(),r=nr(),i=ge(),n=Mt();function o(a,s,c,u){if(!i(a))return a;s=t(s,a);for(var d=-1,l=s.length,f=l-1,h=a;h!=null&&++d<l;){var m=n(s[d]),v=c;if(m==="__proto__"||m==="constructor"||m==="prototype")return a;if(d!=f){var g=h[m];v=u?u(g,m,h):void 0,v===void 0&&(v=i(g)?g:r(s[d+1])?[]:{})}e(h,m,v),h=h[m]}return a}return Xa=o,Xa}var Qa,tp;function X1(){if(tp)return Qa;tp=1;var e=dr(),t=Z1(),r=cr();function i(n,o,a){for(var s=-1,c=o.length,u={};++s<c;){var d=o[s],l=e(n,d);a(l,d)&&t(u,r(d,n),l)}return u}return Qa=i,Qa}var Ja,rp;function Q1(){if(rp)return Ja;rp=1;var e=X1(),t=zv();function r(i,n){return e(i,n,function(o,a){return t(i,a)})}return Ja=r,Ja}var es,np;function J1(){if(np)return es;np=1;var e=sm(),t=Zv(),r=Xv();function i(n){return r(t(n,void 0,e),n+"")}return es=i,es}var ts,ip;function eE(){if(ip)return ts;ip=1;var e=Q1(),t=J1(),r=t(function(i,n){return i==null?{}:e(i,n)});return ts=r,ts}var rs,op;function tE(){if(op)return rs;op=1;var e=Math.ceil,t=Math.max;function r(i,n,o,a){for(var s=-1,c=t(e((n-i)/(o||1)),0),u=Array(c);c--;)u[a?c:++s]=i,i+=o;return u}return rs=r,rs}var ns,ap;function rE(){if(ap)return ns;ap=1;var e=tE(),t=fr(),r=am();function i(n){return function(o,a,s){return s&&typeof s!="number"&&t(o,a,s)&&(a=s=void 0),o=r(o),a===void 0?(a=o,o=0):a=r(a),s=s===void 0?o<a?1:-1:r(s),e(o,a,s,n)}}return ns=i,ns}var is,sp;function nE(){if(sp)return is;sp=1;var e=rE(),t=e();return is=t,is}var os,up;function iE(){if(up)return os;up=1;function e(t,r){var i=t.length;for(t.sort(r);i--;)t[i]=t[i].value;return t}return os=e,os}var as,cp;function oE(){if(cp)return as;cp=1;var e=lt();function t(r,i){if(r!==i){var n=r!==void 0,o=r===null,a=r===r,s=e(r),c=i!==void 0,u=i===null,d=i===i,l=e(i);if(!u&&!l&&!s&&r>i||s&&c&&d&&!u&&!l||o&&c&&d||!n&&d||!a)return 1;if(!o&&!s&&!l&&r<i||l&&n&&a&&!o&&!s||u&&n&&a||!c&&a||!d)return-1}return 0}return as=t,as}var ss,dp;function aE(){if(dp)return ss;dp=1;var e=oE();function t(r,i,n){for(var o=-1,a=r.criteria,s=i.criteria,c=a.length,u=n.length;++o<c;){var d=e(a[o],s[o]);if(d){if(o>=u)return d;var l=n[o];return d*(l=="desc"?-1:1)}}return r.index-i.index}return ss=t,ss}var us,lp;function sE(){if(lp)return us;lp=1;var e=ur(),t=dr(),r=ke(),i=Wv(),n=iE(),o=ir(),a=aE(),s=Ze(),c=de();function u(d,l,f){l.length?l=e(l,function(v){return c(v)?function(g){return t(g,v.length===1?v[0]:v)}:v}):l=[s];var h=-1;l=e(l,o(r));var m=i(d,function(v,g,y){var b=e(l,function(p){return p(v)});return{criteria:b,index:++h,value:v}});return n(m,function(v,g){return a(v,g,f)})}return us=u,us}var cs,fp;function uE(){if(fp)return cs;fp=1;var e=Eu(),t=sE(),r=lr(),i=fr(),n=r(function(o,a){if(o==null)return[];var s=a.length;return s>1&&i(o,a[0],a[1])?a=[]:s>2&&i(a[0],a[1],a[2])&&(a=[a[0]]),t(o,e(a,1),[])});return cs=n,cs}var ds,hp;function cE(){if(hp)return ds;hp=1;var e=Fv(),t=0;function r(i){var n=++t;return e(i)+n}return ds=r,ds}var ls,pp;function dE(){if(pp)return ls;pp=1;function e(t,r,i){for(var n=-1,o=t.length,a=r.length,s={};++n<o;){var c=n<a?r[n]:void 0;i(s,t[n],c)}return s}return ls=e,ls}var fs,gp;function lE(){if(gp)return fs;gp=1;var e=rr(),t=dE();function r(i,n){return t(i||[],n||[],e)}return fs=r,fs}var hs,vp;function ae(){if(vp)return hs;vp=1;var e;if(typeof uu=="function")try{e={cloneDeep:R1(),constant:yu(),defaults:q1(),each:Tv(),filter:Vv(),find:O1(),flatten:sm(),forEach:kv(),forIn:j1(),has:Gv(),isUndefined:Uv(),last:D1(),map:Yv(),mapValues:L1(),max:F1(),merge:U1(),min:W1(),minBy:Y1(),now:K1(),pick:eE(),range:nE(),reduce:Kv(),sortBy:uE(),uniqueId:cE(),values:em(),zipObject:lE()}}catch{}return e||(e=window._),hs=e,hs}var ps,mp;function fE(){if(mp)return ps;mp=1,ps=e;function e(){var i={};i._next=i._prev=i,this._sentinel=i}e.prototype.dequeue=function(){var i=this._sentinel,n=i._prev;if(n!==i)return t(n),n},e.prototype.enqueue=function(i){var n=this._sentinel;i._prev&&i._next&&t(i),i._next=n._next,n._next._prev=i,n._next=i,i._prev=n},e.prototype.toString=function(){for(var i=[],n=this._sentinel,o=n._prev;o!==n;)i.push(JSON.stringify(o,r)),o=o._prev;return"["+i.join(", ")+"]"};function t(i){i._prev._next=i._next,i._next._prev=i._prev,delete i._next,delete i._prev}function r(i,n){if(i!=="_next"&&i!=="_prev")return n}return ps}var gs,yp;function hE(){if(yp)return gs;yp=1;var e=ae(),t=be().Graph,r=fE();gs=n;var i=e.constant(1);function n(u,d){if(u.nodeCount()<=1)return[];var l=s(u,d||i),f=o(l.graph,l.buckets,l.zeroIdx);return e.flatten(e.map(f,function(h){return u.outEdges(h.v,h.w)}),!0)}function o(u,d,l){for(var f=[],h=d[d.length-1],m=d[0],v;u.nodeCount();){for(;v=m.dequeue();)a(u,d,l,v);for(;v=h.dequeue();)a(u,d,l,v);if(u.nodeCount()){for(var g=d.length-2;g>0;--g)if(v=d[g].dequeue(),v){f=f.concat(a(u,d,l,v,!0));break}}}return f}function a(u,d,l,f,h){var m=h?[]:void 0;return e.forEach(u.inEdges(f.v),function(v){var g=u.edge(v),y=u.node(v.v);h&&m.push({v:v.v,w:v.w}),y.out-=g,c(d,l,y)}),e.forEach(u.outEdges(f.v),function(v){var g=u.edge(v),y=v.w,b=u.node(y);b.in-=g,c(d,l,b)}),u.removeNode(f.v),m}function s(u,d){var l=new t,f=0,h=0;e.forEach(u.nodes(),function(g){l.setNode(g,{v:g,in:0,out:0})}),e.forEach(u.edges(),function(g){var y=l.edge(g.v,g.w)||0,b=d(g),p=y+b;l.setEdge(g.v,g.w,p),h=Math.max(h,l.node(g.v).out+=b),f=Math.max(f,l.node(g.w).in+=b)});var m=e.range(h+f+3).map(function(){return new r}),v=f+1;return e.forEach(l.nodes(),function(g){c(m,v,l.node(g))}),{graph:l,buckets:m,zeroIdx:v}}function c(u,d,l){l.out?l.in?u[l.out-l.in+d].enqueue(l):u[u.length-1].enqueue(l):u[0].enqueue(l)}return gs}var vs,bp;function pE(){if(bp)return vs;bp=1;var e=ae(),t=hE();vs={run:r,undo:n};function r(o){var a=o.graph().acyclicer==="greedy"?t(o,s(o)):i(o);e.forEach(a,function(c){var u=o.edge(c);o.removeEdge(c),u.forwardName=c.name,u.reversed=!0,o.setEdge(c.w,c.v,u,e.uniqueId("rev"))});function s(c){return function(u){return c.edge(u).weight}}}function i(o){var a=[],s={},c={};function u(d){e.has(c,d)||(c[d]=!0,s[d]=!0,e.forEach(o.outEdges(d),function(l){e.has(s,l.w)?a.push(l):u(l.w)}),delete s[d])}return e.forEach(o.nodes(),u),a}function n(o){e.forEach(o.edges(),function(a){var s=o.edge(a);if(s.reversed){o.removeEdge(a);var c=s.forwardName;delete s.reversed,delete s.forwardName,o.setEdge(a.w,a.v,s,c)}})}return vs}var ms,xp;function pe(){if(xp)return ms;xp=1;var e=ae(),t=be().Graph;ms={addDummyNode:r,simplify:i,asNonCompoundGraph:n,successorWeights:o,predecessorWeights:a,intersectRect:s,buildLayerMatrix:c,normalizeRanks:u,removeEmptyRanks:d,addBorderNode:l,maxRank:f,partition:h,time:m,notime:v};function r(g,y,b,p){var x;do x=e.uniqueId(p);while(g.hasNode(x));return b.dummy=y,g.setNode(x,b),x}function i(g){var y=new t().setGraph(g.graph());return e.forEach(g.nodes(),function(b){y.setNode(b,g.node(b))}),e.forEach(g.edges(),function(b){var p=y.edge(b.v,b.w)||{weight:0,minlen:1},x=g.edge(b);y.setEdge(b.v,b.w,{weight:p.weight+x.weight,minlen:Math.max(p.minlen,x.minlen)})}),y}function n(g){var y=new t({multigraph:g.isMultigraph()}).setGraph(g.graph());return e.forEach(g.nodes(),function(b){g.children(b).length||y.setNode(b,g.node(b))}),e.forEach(g.edges(),function(b){y.setEdge(b,g.edge(b))}),y}function o(g){var y=e.map(g.nodes(),function(b){var p={};return e.forEach(g.outEdges(b),function(x){p[x.w]=(p[x.w]||0)+g.edge(x).weight}),p});return e.zipObject(g.nodes(),y)}function a(g){var y=e.map(g.nodes(),function(b){var p={};return e.forEach(g.inEdges(b),function(x){p[x.v]=(p[x.v]||0)+g.edge(x).weight}),p});return e.zipObject(g.nodes(),y)}function s(g,y){var b=g.x,p=g.y,x=y.x-b,E=y.y-p,_=g.width/2,w=g.height/2;if(!x&&!E)throw new Error("Not possible to find intersection inside of the rectangle");var S,R;return Math.abs(E)*_>Math.abs(x)*w?(E<0&&(w=-w),S=w*x/E,R=w):(x<0&&(_=-_),S=_,R=_*E/x),{x:b+S,y:p+R}}function c(g){var y=e.map(e.range(f(g)+1),function(){return[]});return e.forEach(g.nodes(),function(b){var p=g.node(b),x=p.rank;e.isUndefined(x)||(y[x][p.order]=b)}),y}function u(g){var y=e.min(e.map(g.nodes(),function(b){return g.node(b).rank}));e.forEach(g.nodes(),function(b){var p=g.node(b);e.has(p,"rank")&&(p.rank-=y)})}function d(g){var y=e.min(e.map(g.nodes(),function(E){return g.node(E).rank})),b=[];e.forEach(g.nodes(),function(E){var _=g.node(E).rank-y;b[_]||(b[_]=[]),b[_].push(E)});var p=0,x=g.graph().nodeRankFactor;e.forEach(b,function(E,_){e.isUndefined(E)&&_%x!==0?--p:p&&e.forEach(E,function(w){g.node(w).rank+=p})})}function l(g,y,b,p){var x={width:0,height:0};return arguments.length>=4&&(x.rank=b,x.order=p),r(g,"border",x,y)}function f(g){return e.max(e.map(g.nodes(),function(y){var b=g.node(y).rank;if(!e.isUndefined(b))return b}))}function h(g,y){var b={lhs:[],rhs:[]};return e.forEach(g,function(p){y(p)?b.lhs.push(p):b.rhs.push(p)}),b}function m(g,y){var b=e.now();try{return y()}finally{console.log(g+" time: "+(e.now()-b)+"ms")}}function v(g,y){return y()}return ms}var ys,_p;function gE(){if(_p)return ys;_p=1;var e=ae(),t=pe();ys={run:r,undo:n};function r(o){o.graph().dummyChains=[],e.forEach(o.edges(),function(a){i(o,a)})}function i(o,a){var s=a.v,c=o.node(s).rank,u=a.w,d=o.node(u).rank,l=a.name,f=o.edge(a),h=f.labelRank;if(d!==c+1){o.removeEdge(a);var m,v,g;for(g=0,++c;c<d;++g,++c)f.points=[],v={width:0,height:0,edgeLabel:f,edgeObj:a,rank:c},m=t.addDummyNode(o,"edge",v,"_d"),c===h&&(v.width=f.width,v.height=f.height,v.dummy="edge-label",v.labelpos=f.labelpos),o.setEdge(s,m,{weight:f.weight},l),g===0&&o.graph().dummyChains.push(m),s=m;o.setEdge(s,u,{weight:f.weight},l)}}function n(o){e.forEach(o.graph().dummyChains,function(a){var s=o.node(a),c=s.edgeLabel,u;for(o.setEdge(s.edgeObj,c);s.dummy;)u=o.successors(a)[0],o.removeNode(a),c.points.push({x:s.x,y:s.y}),s.dummy==="edge-label"&&(c.x=s.x,c.y=s.y,c.width=s.width,c.height=s.height),a=u,s=o.node(a)})}return ys}var bs,wp;function Ht(){if(wp)return bs;wp=1;var e=ae();bs={longestPath:t,slack:r};function t(i){var n={};function o(a){var s=i.node(a);if(e.has(n,a))return s.rank;n[a]=!0;var c=e.min(e.map(i.outEdges(a),function(u){return o(u.w)-i.edge(u).minlen}));return(c===Number.POSITIVE_INFINITY||c===void 0||c===null)&&(c=0),s.rank=c}e.forEach(i.sources(),o)}function r(i,n){return i.node(n.w).rank-i.node(n.v).rank-i.edge(n).minlen}return bs}var xs,Ep;function lm(){if(Ep)return xs;Ep=1;var e=ae(),t=be().Graph,r=Ht().slack;xs=i;function i(s){var c=new t({directed:!1}),u=s.nodes()[0],d=s.nodeCount();c.setNode(u,{});for(var l,f;n(c,s)<d;)l=o(c,s),f=c.hasNode(l.v)?r(s,l):-r(s,l),a(c,s,f);return c}function n(s,c){function u(d){e.forEach(c.nodeEdges(d),function(l){var f=l.v,h=d===f?l.w:f;!s.hasNode(h)&&!r(c,l)&&(s.setNode(h,{}),s.setEdge(d,h,{}),u(h))})}return e.forEach(s.nodes(),u),s.nodeCount()}function o(s,c){return e.minBy(c.edges(),function(u){if(s.hasNode(u.v)!==s.hasNode(u.w))return r(c,u)})}function a(s,c,u){e.forEach(s.nodes(),function(d){c.node(d).rank+=u})}return xs}var _s,Cp;function vE(){if(Cp)return _s;Cp=1;var e=ae(),t=lm(),r=Ht().slack,i=Ht().longestPath,n=be().alg.preorder,o=be().alg.postorder,a=pe().simplify;_s=s,s.initLowLimValues=l,s.initCutValues=c,s.calcCutValue=d,s.leaveEdge=h,s.enterEdge=m,s.exchangeEdges=v;function s(p){p=a(p),i(p);var x=t(p);l(x),c(x,p);for(var E,_;E=h(x);)_=m(x,p,E),v(x,p,E,_)}function c(p,x){var E=o(p,p.nodes());E=E.slice(0,E.length-1),e.forEach(E,function(_){u(p,x,_)})}function u(p,x,E){var _=p.node(E),w=_.parent;p.edge(E,w).cutvalue=d(p,x,E)}function d(p,x,E){var _=p.node(E),w=_.parent,S=!0,R=x.edge(E,w),M=0;return R||(S=!1,R=x.edge(w,E)),M=R.weight,e.forEach(x.nodeEdges(E),function(N){var q=N.v===E,P=q?N.w:N.v;if(P!==w){var D=q===S,O=x.edge(N).weight;if(M+=D?O:-O,y(p,E,P)){var H=p.edge(E,P).cutvalue;M+=D?-H:H}}}),M}function l(p,x){arguments.length<2&&(x=p.nodes()[0]),f(p,{},1,x)}function f(p,x,E,_,w){var S=E,R=p.node(_);return x[_]=!0,e.forEach(p.neighbors(_),function(M){e.has(x,M)||(E=f(p,x,E,M,_))}),R.low=S,R.lim=E++,w?R.parent=w:delete R.parent,E}function h(p){return e.find(p.edges(),function(x){return p.edge(x).cutvalue<0})}function m(p,x,E){var _=E.v,w=E.w;x.hasEdge(_,w)||(_=E.w,w=E.v);var S=p.node(_),R=p.node(w),M=S,N=!1;S.lim>R.lim&&(M=R,N=!0);var q=e.filter(x.edges(),function(P){return N===b(p,p.node(P.v),M)&&N!==b(p,p.node(P.w),M)});return e.minBy(q,function(P){return r(x,P)})}function v(p,x,E,_){var w=E.v,S=E.w;p.removeEdge(w,S),p.setEdge(_.v,_.w,{}),l(p),c(p,x),g(p,x)}function g(p,x){var E=e.find(p.nodes(),function(w){return!x.node(w).parent}),_=n(p,E);_=_.slice(1),e.forEach(_,function(w){var S=p.node(w).parent,R=x.edge(w,S),M=!1;R||(R=x.edge(S,w),M=!0),x.node(w).rank=x.node(S).rank+(M?R.minlen:-R.minlen)})}function y(p,x,E){return p.hasEdge(x,E)}function b(p,x,E){return E.low<=x.lim&&x.lim<=E.lim}return _s}var ws,Sp;function mE(){if(Sp)return ws;Sp=1;var e=Ht(),t=e.longestPath,r=lm(),i=vE();ws=n;function n(c){switch(c.graph().ranker){case"network-simplex":s(c);break;case"tight-tree":a(c);break;case"longest-path":o(c);break;default:s(c)}}var o=t;function a(c){t(c),r(c)}function s(c){i(c)}return ws}var Es,Np;function yE(){if(Np)return Es;Np=1;var e=ae();Es=t;function t(n){var o=i(n);e.forEach(n.graph().dummyChains,function(a){for(var s=n.node(a),c=s.edgeObj,u=r(n,o,c.v,c.w),d=u.path,l=u.lca,f=0,h=d[f],m=!0;a!==c.w;){if(s=n.node(a),m){for(;(h=d[f])!==l&&n.node(h).maxRank<s.rank;)f++;h===l&&(m=!1)}if(!m){for(;f<d.length-1&&n.node(h=d[f+1]).minRank<=s.rank;)f++;h=d[f]}n.setParent(a,h),a=n.successors(a)[0]}})}function r(n,o,a,s){var c=[],u=[],d=Math.min(o[a].low,o[s].low),l=Math.max(o[a].lim,o[s].lim),f,h;f=a;do f=n.parent(f),c.push(f);while(f&&(o[f].low>d||l>o[f].lim));for(h=f,f=s;(f=n.parent(f))!==h;)u.push(f);return{path:c.concat(u.reverse()),lca:h}}function i(n){var o={},a=0;function s(c){var u=a;e.forEach(n.children(c),s),o[c]={low:u,lim:a++}}return e.forEach(n.children(),s),o}return Es}var Cs,Rp;function bE(){if(Rp)return Cs;Rp=1;var e=ae(),t=pe();Cs={run:r,cleanup:a};function r(s){var c=t.addDummyNode(s,"root",{},"_root"),u=n(s),d=e.max(e.values(u))-1,l=2*d+1;s.graph().nestingRoot=c,e.forEach(s.edges(),function(h){s.edge(h).minlen*=l});var f=o(s)+1;e.forEach(s.children(),function(h){i(s,c,l,f,d,u,h)}),s.graph().nodeRankFactor=l}function i(s,c,u,d,l,f,h){var m=s.children(h);if(!m.length){h!==c&&s.setEdge(c,h,{weight:0,minlen:u});return}var v=t.addBorderNode(s,"_bt"),g=t.addBorderNode(s,"_bb"),y=s.node(h);s.setParent(v,h),y.borderTop=v,s.setParent(g,h),y.borderBottom=g,e.forEach(m,function(b){i(s,c,u,d,l,f,b);var p=s.node(b),x=p.borderTop?p.borderTop:b,E=p.borderBottom?p.borderBottom:b,_=p.borderTop?d:2*d,w=x!==E?1:l-f[h]+1;s.setEdge(v,x,{weight:_,minlen:w,nestingEdge:!0}),s.setEdge(E,g,{weight:_,minlen:w,nestingEdge:!0})}),s.parent(h)||s.setEdge(c,v,{weight:0,minlen:l+f[h]})}function n(s){var c={};function u(d,l){var f=s.children(d);f&&f.length&&e.forEach(f,function(h){u(h,l+1)}),c[d]=l}return e.forEach(s.children(),function(d){u(d,1)}),c}function o(s){return e.reduce(s.edges(),function(c,u){return c+s.edge(u).weight},0)}function a(s){var c=s.graph();s.removeNode(c.nestingRoot),delete c.nestingRoot,e.forEach(s.edges(),function(u){var d=s.edge(u);d.nestingEdge&&s.removeEdge(u)})}return Cs}var Ss,qp;function xE(){if(qp)return Ss;qp=1;var e=ae(),t=pe();Ss=r;function r(n){function o(a){var s=n.children(a),c=n.node(a);if(s.length&&e.forEach(s,o),e.has(c,"minRank")){c.borderLeft=[],c.borderRight=[];for(var u=c.minRank,d=c.maxRank+1;u<d;++u)i(n,"borderLeft","_bl",a,c,u),i(n,"borderRight","_br",a,c,u)}}e.forEach(n.children(),o)}function i(n,o,a,s,c,u){var d={width:0,height:0,rank:u,borderType:o},l=c[o][u-1],f=t.addDummyNode(n,"border",d,a);c[o][u]=f,n.setParent(f,s),l&&n.setEdge(l,f,{weight:1})}return Ss}var Ns,Ip;function _E(){if(Ip)return Ns;Ip=1;var e=ae();Ns={adjust:t,undo:r};function t(u){var d=u.graph().rankdir.toLowerCase();(d==="lr"||d==="rl")&&i(u)}function r(u){var d=u.graph().rankdir.toLowerCase();(d==="bt"||d==="rl")&&o(u),(d==="lr"||d==="rl")&&(s(u),i(u))}function i(u){e.forEach(u.nodes(),function(d){n(u.node(d))}),e.forEach(u.edges(),function(d){n(u.edge(d))})}function n(u){var d=u.width;u.width=u.height,u.height=d}function o(u){e.forEach(u.nodes(),function(d){a(u.node(d))}),e.forEach(u.edges(),function(d){var l=u.edge(d);e.forEach(l.points,a),e.has(l,"y")&&a(l)})}function a(u){u.y=-u.y}function s(u){e.forEach(u.nodes(),function(d){c(u.node(d))}),e.forEach(u.edges(),function(d){var l=u.edge(d);e.forEach(l.points,c),e.has(l,"x")&&c(l)})}function c(u){var d=u.x;u.x=u.y,u.y=d}return Ns}var Rs,Mp;function wE(){if(Mp)return Rs;Mp=1;var e=ae();Rs=t;function t(r){var i={},n=e.filter(r.nodes(),function(u){return!r.children(u).length}),o=e.max(e.map(n,function(u){return r.node(u).rank})),a=e.map(e.range(o+1),function(){return[]});function s(u){if(!e.has(i,u)){i[u]=!0;var d=r.node(u);a[d.rank].push(u),e.forEach(r.successors(u),s)}}var c=e.sortBy(n,function(u){return r.node(u).rank});return e.forEach(c,s),a}return Rs}var qs,Ap;function EE(){if(Ap)return qs;Ap=1;var e=ae();qs=t;function t(i,n){for(var o=0,a=1;a<n.length;++a)o+=r(i,n[a-1],n[a]);return o}function r(i,n,o){for(var a=e.zipObject(o,e.map(o,function(f,h){return h})),s=e.flatten(e.map(n,function(f){return e.sortBy(e.map(i.outEdges(f),function(h){return{pos:a[h.w],weight:i.edge(h).weight}}),"pos")}),!0),c=1;c<o.length;)c<<=1;var u=2*c-1;c-=1;var d=e.map(new Array(u),function(){return 0}),l=0;return e.forEach(s.forEach(function(f){var h=f.pos+c;d[h]+=f.weight;for(var m=0;h>0;)h%2&&(m+=d[h+1]),h=h-1>>1,d[h]+=f.weight;l+=f.weight*m})),l}return qs}var Is,kp;function CE(){if(kp)return Is;kp=1;var e=ae();Is=t;function t(r,i){return e.map(i,function(n){var o=r.inEdges(n);if(o.length){var a=e.reduce(o,function(s,c){var u=r.edge(c),d=r.node(c.v);return{sum:s.sum+u.weight*d.order,weight:s.weight+u.weight}},{sum:0,weight:0});return{v:n,barycenter:a.sum/a.weight,weight:a.weight}}else return{v:n}})}return Is}var Ms,Tp;function SE(){if(Tp)return Ms;Tp=1;var e=ae();Ms=t;function t(n,o){var a={};e.forEach(n,function(c,u){var d=a[c.v]={indegree:0,in:[],out:[],vs:[c.v],i:u};e.isUndefined(c.barycenter)||(d.barycenter=c.barycenter,d.weight=c.weight)}),e.forEach(o.edges(),function(c){var u=a[c.v],d=a[c.w];!e.isUndefined(u)&&!e.isUndefined(d)&&(d.indegree++,u.out.push(a[c.w]))});var s=e.filter(a,function(c){return!c.indegree});return r(s)}function r(n){var o=[];function a(u){return function(d){d.merged||(e.isUndefined(d.barycenter)||e.isUndefined(u.barycenter)||d.barycenter>=u.barycenter)&&i(u,d)}}function s(u){return function(d){d.in.push(u),--d.indegree===0&&n.push(d)}}for(;n.length;){var c=n.pop();o.push(c),e.forEach(c.in.reverse(),a(c)),e.forEach(c.out,s(c))}return e.map(e.filter(o,function(u){return!u.merged}),function(u){return e.pick(u,["vs","i","barycenter","weight"])})}function i(n,o){var a=0,s=0;n.weight&&(a+=n.barycenter*n.weight,s+=n.weight),o.weight&&(a+=o.barycenter*o.weight,s+=o.weight),n.vs=o.vs.concat(n.vs),n.barycenter=a/s,n.weight=s,n.i=Math.min(o.i,n.i),o.merged=!0}return Ms}var As,Pp;function NE(){if(Pp)return As;Pp=1;var e=ae(),t=pe();As=r;function r(o,a){var s=t.partition(o,function(v){return e.has(v,"barycenter")}),c=s.lhs,u=e.sortBy(s.rhs,function(v){return-v.i}),d=[],l=0,f=0,h=0;c.sort(n(!!a)),h=i(d,u,h),e.forEach(c,function(v){h+=v.vs.length,d.push(v.vs),l+=v.barycenter*v.weight,f+=v.weight,h=i(d,u,h)});var m={vs:e.flatten(d,!0)};return f&&(m.barycenter=l/f,m.weight=f),m}function i(o,a,s){for(var c;a.length&&(c=e.last(a)).i<=s;)a.pop(),o.push(c.vs),s++;return s}function n(o){return function(a,s){return a.barycenter<s.barycenter?-1:a.barycenter>s.barycenter?1:o?s.i-a.i:a.i-s.i}}return As}var ks,Op;function RE(){if(Op)return ks;Op=1;var e=ae(),t=CE(),r=SE(),i=NE();ks=n;function n(s,c,u,d){var l=s.children(c),f=s.node(c),h=f?f.borderLeft:void 0,m=f?f.borderRight:void 0,v={};h&&(l=e.filter(l,function(E){return E!==h&&E!==m}));var g=t(s,l);e.forEach(g,function(E){if(s.children(E.v).length){var _=n(s,E.v,u,d);v[E.v]=_,e.has(_,"barycenter")&&a(E,_)}});var y=r(g,u);o(y,v);var b=i(y,d);if(h&&(b.vs=e.flatten([h,b.vs,m],!0),s.predecessors(h).length)){var p=s.node(s.predecessors(h)[0]),x=s.node(s.predecessors(m)[0]);e.has(b,"barycenter")||(b.barycenter=0,b.weight=0),b.barycenter=(b.barycenter*b.weight+p.order+x.order)/(b.weight+2),b.weight+=2}return b}function o(s,c){e.forEach(s,function(u){u.vs=e.flatten(u.vs.map(function(d){return c[d]?c[d].vs:d}),!0)})}function a(s,c){e.isUndefined(s.barycenter)?(s.barycenter=c.barycenter,s.weight=c.weight):(s.barycenter=(s.barycenter*s.weight+c.barycenter*c.weight)/(s.weight+c.weight),s.weight+=c.weight)}return ks}var Ts,jp;function qE(){if(jp)return Ts;jp=1;var e=ae(),t=be().Graph;Ts=r;function r(n,o,a){var s=i(n),c=new t({compound:!0}).setGraph({root:s}).setDefaultNodeLabel(function(u){return n.node(u)});return e.forEach(n.nodes(),function(u){var d=n.node(u),l=n.parent(u);(d.rank===o||d.minRank<=o&&o<=d.maxRank)&&(c.setNode(u),c.setParent(u,l||s),e.forEach(n[a](u),function(f){var h=f.v===u?f.w:f.v,m=c.edge(h,u),v=e.isUndefined(m)?0:m.weight;c.setEdge(h,u,{weight:n.edge(f).weight+v})}),e.has(d,"minRank")&&c.setNode(u,{borderLeft:d.borderLeft[o],borderRight:d.borderRight[o]}))}),c}function i(n){for(var o;n.hasNode(o=e.uniqueId("_root")););return o}return Ts}var Ps,Dp;function IE(){if(Dp)return Ps;Dp=1;var e=ae();Ps=t;function t(r,i,n){var o={},a;e.forEach(n,function(s){for(var c=r.parent(s),u,d;c;){if(u=r.parent(c),u?(d=o[u],o[u]=c):(d=a,a=c),d&&d!==c){i.setEdge(d,c);return}c=u}})}return Ps}var Os,Lp;function ME(){if(Lp)return Os;Lp=1;var e=ae(),t=wE(),r=EE(),i=RE(),n=qE(),o=IE(),a=be().Graph,s=pe();Os=c;function c(f){var h=s.maxRank(f),m=u(f,e.range(1,h+1),"inEdges"),v=u(f,e.range(h-1,-1,-1),"outEdges"),g=t(f);l(f,g);for(var y=Number.POSITIVE_INFINITY,b,p=0,x=0;x<4;++p,++x){d(p%2?m:v,p%4>=2),g=s.buildLayerMatrix(f);var E=r(f,g);E<y&&(x=0,b=e.cloneDeep(g),y=E)}l(f,b)}function u(f,h,m){return e.map(h,function(v){return n(f,v,m)})}function d(f,h){var m=new a;e.forEach(f,function(v){var g=v.graph().root,y=i(v,g,m,h);e.forEach(y.vs,function(b,p){v.node(b).order=p}),o(v,m,y.vs)})}function l(f,h){e.forEach(h,function(m){e.forEach(m,function(v,g){f.node(v).order=g})})}return Os}var js,Bp;function AE(){if(Bp)return js;Bp=1;var e=ae(),t=be().Graph,r=pe();js={positionX:m,findType1Conflicts:i,findType2Conflicts:n,addConflict:a,hasConflict:s,verticalAlignment:c,horizontalCompaction:u,alignCoordinates:f,findSmallestWidthAlignment:l,balance:h};function i(y,b){var p={};function x(E,_){var w=0,S=0,R=E.length,M=e.last(_);return e.forEach(_,function(N,q){var P=o(y,N),D=P?y.node(P).order:R;(P||N===M)&&(e.forEach(_.slice(S,q+1),function(O){e.forEach(y.predecessors(O),function(H){var z=y.node(H),L=z.order;(L<w||D<L)&&!(z.dummy&&y.node(O).dummy)&&a(p,H,O)})}),S=q+1,w=D)}),_}return e.reduce(b,x),p}function n(y,b){var p={};function x(_,w,S,R,M){var N;e.forEach(e.range(w,S),function(q){N=_[q],y.node(N).dummy&&e.forEach(y.predecessors(N),function(P){var D=y.node(P);D.dummy&&(D.order<R||D.order>M)&&a(p,P,N)})})}function E(_,w){var S=-1,R,M=0;return e.forEach(w,function(N,q){if(y.node(N).dummy==="border"){var P=y.predecessors(N);P.length&&(R=y.node(P[0]).order,x(w,M,q,S,R),M=q,S=R)}x(w,M,w.length,R,_.length)}),w}return e.reduce(b,E),p}function o(y,b){if(y.node(b).dummy)return e.find(y.predecessors(b),function(p){return y.node(p).dummy})}function a(y,b,p){if(b>p){var x=b;b=p,p=x}var E=y[b];E||(y[b]=E={}),E[p]=!0}function s(y,b,p){if(b>p){var x=b;b=p,p=x}return e.has(y[b],p)}function c(y,b,p,x){var E={},_={},w={};return e.forEach(b,function(S){e.forEach(S,function(R,M){E[R]=R,_[R]=R,w[R]=M})}),e.forEach(b,function(S){var R=-1;e.forEach(S,function(M){var N=x(M);if(N.length){N=e.sortBy(N,function(H){return w[H]});for(var q=(N.length-1)/2,P=Math.floor(q),D=Math.ceil(q);P<=D;++P){var O=N[P];_[M]===M&&R<w[O]&&!s(p,M,O)&&(_[O]=M,_[M]=E[M]=E[O],R=w[O])}}})}),{root:E,align:_}}function u(y,b,p,x,E){var _={},w=d(y,b,p,E),S=E?"borderLeft":"borderRight";function R(q,P){for(var D=w.nodes(),O=D.pop(),H={};O;)H[O]?q(O):(H[O]=!0,D.push(O),D=D.concat(P(O))),O=D.pop()}function M(q){_[q]=w.inEdges(q).reduce(function(P,D){return Math.max(P,_[D.v]+w.edge(D))},0)}function N(q){var P=w.outEdges(q).reduce(function(O,H){return Math.min(O,_[H.w]-w.edge(H))},Number.POSITIVE_INFINITY),D=y.node(q);P!==Number.POSITIVE_INFINITY&&D.borderType!==S&&(_[q]=Math.max(_[q],P))}return R(M,w.predecessors.bind(w)),R(N,w.successors.bind(w)),e.forEach(x,function(q){_[q]=_[p[q]]}),_}function d(y,b,p,x){var E=new t,_=y.graph(),w=v(_.nodesep,_.edgesep,x);return e.forEach(b,function(S){var R;e.forEach(S,function(M){var N=p[M];if(E.setNode(N),R){var q=p[R],P=E.edge(q,N);E.setEdge(q,N,Math.max(w(y,M,R),P||0))}R=M})}),E}function l(y,b){return e.minBy(e.values(b),function(p){var x=Number.NEGATIVE_INFINITY,E=Number.POSITIVE_INFINITY;return e.forIn(p,function(_,w){var S=g(y,w)/2;x=Math.max(_+S,x),E=Math.min(_-S,E)}),x-E})}function f(y,b){var p=e.values(b),x=e.min(p),E=e.max(p);e.forEach(["u","d"],function(_){e.forEach(["l","r"],function(w){var S=_+w,R=y[S],M;if(R!==b){var N=e.values(R);M=w==="l"?x-e.min(N):E-e.max(N),M&&(y[S]=e.mapValues(R,function(q){return q+M}))}})})}function h(y,b){return e.mapValues(y.ul,function(p,x){if(b)return y[b.toLowerCase()][x];var E=e.sortBy(e.map(y,x));return(E[1]+E[2])/2})}function m(y){var b=r.buildLayerMatrix(y),p=e.merge(i(y,b),n(y,b)),x={},E;e.forEach(["u","d"],function(w){E=w==="u"?b:e.values(b).reverse(),e.forEach(["l","r"],function(S){S==="r"&&(E=e.map(E,function(q){return e.values(q).reverse()}));var R=(w==="u"?y.predecessors:y.successors).bind(y),M=c(y,E,p,R),N=u(y,E,M.root,M.align,S==="r");S==="r"&&(N=e.mapValues(N,function(q){return-q})),x[w+S]=N})});var _=l(y,x);return f(x,_),h(x,y.graph().align)}function v(y,b,p){return function(x,E,_){var w=x.node(E),S=x.node(_),R=0,M;if(R+=w.width/2,e.has(w,"labelpos"))switch(w.labelpos.toLowerCase()){case"l":M=-w.width/2;break;case"r":M=w.width/2;break}if(M&&(R+=p?M:-M),M=0,R+=(w.dummy?b:y)/2,R+=(S.dummy?b:y)/2,R+=S.width/2,e.has(S,"labelpos"))switch(S.labelpos.toLowerCase()){case"l":M=S.width/2;break;case"r":M=-S.width/2;break}return M&&(R+=p?M:-M),M=0,R}}function g(y,b){return y.node(b).width}return js}var Ds,Fp;function kE(){if(Fp)return Ds;Fp=1;var e=ae(),t=pe(),r=AE().positionX;Ds=i;function i(o){o=t.asNonCompoundGraph(o),n(o),e.forEach(r(o),function(a,s){o.node(s).x=a})}function n(o){var a=t.buildLayerMatrix(o),s=o.graph().ranksep,c=0;e.forEach(a,function(u){var d=e.max(e.map(u,function(l){return o.node(l).height}));e.forEach(u,function(l){o.node(l).y=c+d/2}),c+=d+s})}return Ds}var Ls,Hp;function TE(){if(Hp)return Ls;Hp=1;var e=ae(),t=pE(),r=gE(),i=mE(),n=pe().normalizeRanks,o=yE(),a=pe().removeEmptyRanks,s=bE(),c=xE(),u=_E(),d=ME(),l=kE(),f=pe(),h=be().Graph;Ls=m;function m(A,I){var T=I&&I.debugTiming?f.time:f.notime;T("layout",function(){var j=T("  buildLayoutGraph",function(){return R(A)});T("  runLayout",function(){v(j,T)}),T("  updateInputGraph",function(){g(A,j)})})}function v(A,I){I("    makeSpaceForEdgeLabels",function(){M(A)}),I("    removeSelfEdges",function(){F(A)}),I("    acyclic",function(){t.run(A)}),I("    nestingGraph.run",function(){s.run(A)}),I("    rank",function(){i(f.asNonCompoundGraph(A))}),I("    injectEdgeLabelProxies",function(){N(A)}),I("    removeEmptyRanks",function(){a(A)}),I("    nestingGraph.cleanup",function(){s.cleanup(A)}),I("    normalizeRanks",function(){n(A)}),I("    assignRankMinMax",function(){q(A)}),I("    removeEdgeLabelProxies",function(){P(A)}),I("    normalize.run",function(){r.run(A)}),I("    parentDummyChains",function(){o(A)}),I("    addBorderSegments",function(){c(A)}),I("    order",function(){d(A)}),I("    insertSelfEdges",function(){U(A)}),I("    adjustCoordinateSystem",function(){u.adjust(A)}),I("    position",function(){l(A)}),I("    positionSelfEdges",function(){G(A)}),I("    removeBorderNodes",function(){L(A)}),I("    normalize.undo",function(){r.undo(A)}),I("    fixupEdgeLabelCoords",function(){H(A)}),I("    undoCoordinateSystem",function(){u.undo(A)}),I("    translateGraph",function(){D(A)}),I("    assignNodeIntersects",function(){O(A)}),I("    reversePoints",function(){z(A)}),I("    acyclic.undo",function(){t.undo(A)})}function g(A,I){e.forEach(A.nodes(),function(T){var j=A.node(T),B=I.node(T);j&&(j.x=B.x,j.y=B.y,I.children(T).length&&(j.width=B.width,j.height=B.height))}),e.forEach(A.edges(),function(T){var j=A.edge(T),B=I.edge(T);j.points=B.points,e.has(B,"x")&&(j.x=B.x,j.y=B.y)}),A.graph().width=I.graph().width,A.graph().height=I.graph().height}var y=["nodesep","edgesep","ranksep","marginx","marginy"],b={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},p=["acyclicer","ranker","rankdir","align"],x=["width","height"],E={width:0,height:0},_=["minlen","weight","width","height","labeloffset"],w={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},S=["labelpos"];function R(A){var I=new h({multigraph:!0,compound:!0}),T=W(A.graph());return I.setGraph(e.merge({},b,$(T,y),e.pick(T,p))),e.forEach(A.nodes(),function(j){var B=W(A.node(j));I.setNode(j,e.defaults($(B,x),E)),I.setParent(j,A.parent(j))}),e.forEach(A.edges(),function(j){var B=W(A.edge(j));I.setEdge(j,e.merge({},w,$(B,_),e.pick(B,S)))}),I}function M(A){var I=A.graph();I.ranksep/=2,e.forEach(A.edges(),function(T){var j=A.edge(T);j.minlen*=2,j.labelpos.toLowerCase()!=="c"&&(I.rankdir==="TB"||I.rankdir==="BT"?j.width+=j.labeloffset:j.height+=j.labeloffset)})}function N(A){e.forEach(A.edges(),function(I){var T=A.edge(I);if(T.width&&T.height){var j=A.node(I.v),B=A.node(I.w),V={rank:(B.rank-j.rank)/2+j.rank,e:I};f.addDummyNode(A,"edge-proxy",V,"_ep")}})}function q(A){var I=0;e.forEach(A.nodes(),function(T){var j=A.node(T);j.borderTop&&(j.minRank=A.node(j.borderTop).rank,j.maxRank=A.node(j.borderBottom).rank,I=e.max(I,j.maxRank))}),A.graph().maxRank=I}function P(A){e.forEach(A.nodes(),function(I){var T=A.node(I);T.dummy==="edge-proxy"&&(A.edge(T.e).labelRank=T.rank,A.removeNode(I))})}function D(A){var I=Number.POSITIVE_INFINITY,T=0,j=Number.POSITIVE_INFINITY,B=0,V=A.graph(),Z=V.marginx||0,J=V.marginy||0;function Q(Y){var te=Y.x,X=Y.y,ne=Y.width,ee=Y.height;I=Math.min(I,te-ne/2),T=Math.max(T,te+ne/2),j=Math.min(j,X-ee/2),B=Math.max(B,X+ee/2)}e.forEach(A.nodes(),function(Y){Q(A.node(Y))}),e.forEach(A.edges(),function(Y){var te=A.edge(Y);e.has(te,"x")&&Q(te)}),I-=Z,j-=J,e.forEach(A.nodes(),function(Y){var te=A.node(Y);te.x-=I,te.y-=j}),e.forEach(A.edges(),function(Y){var te=A.edge(Y);e.forEach(te.points,function(X){X.x-=I,X.y-=j}),e.has(te,"x")&&(te.x-=I),e.has(te,"y")&&(te.y-=j)}),V.width=T-I+Z,V.height=B-j+J}function O(A){e.forEach(A.edges(),function(I){var T=A.edge(I),j=A.node(I.v),B=A.node(I.w),V,Z;T.points?(V=T.points[0],Z=T.points[T.points.length-1]):(T.points=[],V=B,Z=j),T.points.unshift(f.intersectRect(j,V)),T.points.push(f.intersectRect(B,Z))})}function H(A){e.forEach(A.edges(),function(I){var T=A.edge(I);if(e.has(T,"x"))switch((T.labelpos==="l"||T.labelpos==="r")&&(T.width-=T.labeloffset),T.labelpos){case"l":T.x-=T.width/2+T.labeloffset;break;case"r":T.x+=T.width/2+T.labeloffset;break}})}function z(A){e.forEach(A.edges(),function(I){var T=A.edge(I);T.reversed&&T.points.reverse()})}function L(A){e.forEach(A.nodes(),function(I){if(A.children(I).length){var T=A.node(I),j=A.node(T.borderTop),B=A.node(T.borderBottom),V=A.node(e.last(T.borderLeft)),Z=A.node(e.last(T.borderRight));T.width=Math.abs(Z.x-V.x),T.height=Math.abs(B.y-j.y),T.x=V.x+T.width/2,T.y=j.y+T.height/2}}),e.forEach(A.nodes(),function(I){A.node(I).dummy==="border"&&A.removeNode(I)})}function F(A){e.forEach(A.edges(),function(I){if(I.v===I.w){var T=A.node(I.v);T.selfEdges||(T.selfEdges=[]),T.selfEdges.push({e:I,label:A.edge(I)}),A.removeEdge(I)}})}function U(A){var I=f.buildLayerMatrix(A);e.forEach(I,function(T){var j=0;e.forEach(T,function(B,V){var Z=A.node(B);Z.order=V+j,e.forEach(Z.selfEdges,function(J){f.addDummyNode(A,"selfedge",{width:J.label.width,height:J.label.height,rank:Z.rank,order:V+ ++j,e:J.e,label:J.label},"_se")}),delete Z.selfEdges})})}function G(A){e.forEach(A.nodes(),function(I){var T=A.node(I);if(T.dummy==="selfedge"){var j=A.node(T.e.v),B=j.x+j.width/2,V=j.y,Z=T.x-B,J=j.height/2;A.setEdge(T.e,T.label),A.removeNode(I),T.label.points=[{x:B+2*Z/3,y:V-J},{x:B+5*Z/6,y:V-J},{x:B+Z,y:V},{x:B+5*Z/6,y:V+J},{x:B+2*Z/3,y:V+J}],T.label.x=T.x,T.label.y=T.y}})}function $(A,I){return e.mapValues(e.pick(A,I),Number)}function W(A){var I={};return e.forEach(A,function(T,j){I[j.toLowerCase()]=T}),I}return Ls}var Bs,zp;function PE(){if(zp)return Bs;zp=1;var e=ae(),t=pe(),r=be().Graph;Bs={debugOrdering:i};function i(n){var o=t.buildLayerMatrix(n),a=new r({compound:!0,multigraph:!0}).setGraph({});return e.forEach(n.nodes(),function(s){a.setNode(s,{label:s}),a.setParent(s,"layer"+n.node(s).rank)}),e.forEach(n.edges(),function(s){a.setEdge(s.v,s.w,{},s.name)}),e.forEach(o,function(s,c){var u="layer"+c;a.setNode(u,{rank:"same"}),e.reduce(s,function(d,l){return a.setEdge(d,l,{style:"invis"}),l})}),a}return Bs}var Fs,$p;function OE(){return $p||($p=1,Fs="0.8.5"),Fs}var Hs,Vp;function jE(){return Vp||(Vp=1,Hs={graphlib:be(),layout:TE(),debug:PE(),util:{time:pe().time,notime:pe().notime},version:OE()}),Hs}var DE=jE();const Gp=Wp(DE),LE=/^graph\s+(TD|TB|LR|RL|BT)/i,BE=/^\s*(\w+)\["([^"]+)"\]/,FE=/^\s*(\w+)\(["']?([^)"']+)["']?\)/,HE=/^\s*(\w+)\{["']?([^}"']+)["']?\}/,zE=/^\s*(\w+)\s*-->\s*\|([^|]+)\|\s*(\w+)/,$E=/^\s*(\w+)\s*-->\s*(\w+)/,VE=/^\s*(\w+)\s*-->\s*(\w+)\["([^"]+)"\]/;function GE(e){const t=e.split(`
`).map(s=>s.trim()).filter(Boolean);let r="TB";const i=new Map,n=[];let o=0;for(const s of t){const c=s.match(LE);if(c){const v=c[1].toUpperCase();r=v==="LR"||v==="RL"?"LR":"TB";continue}if(/^(subgraph|end|style|class|classDef|linkStyle)\b/i.test(s))continue;const u=s.match(zE);if(u){const[,v,g,y]=u;i.has(v)||i.set(v,v),i.has(y)||i.set(y,y),n.push({id:`e${o++}`,source:v,target:y,label:g.trim()});continue}const d=s.match(VE);if(d){const[,v,g,y]=d;i.has(v)||i.set(v,v),i.set(g,y),n.push({id:`e${o++}`,source:v,target:g});continue}const l=s.match($E);if(l){const[,v,g]=l;i.has(v)||i.set(v,v),i.has(g)||i.set(g,g),n.push({id:`e${o++}`,source:v,target:g});continue}const f=s.match(BE);if(f){const[,v,g]=f;i.set(v,g);continue}const h=s.match(FE);if(h){const[,v,g]=h;i.set(v,g);continue}const m=s.match(HE);if(m){const[,v,g]=m;i.set(v,g);continue}}return{nodes:Array.from(i.entries()).map(([s,c])=>({id:s,type:"arcade",position:{x:0,y:0},data:{label:c}})),edges:n,direction:r}}function zs(e,t,r="TB"){const i=[`graph ${r}`];for(const n of e){const o=n.data.label||n.id;i.push(`    ${n.id}["${o}"]`)}i.push("");for(const n of t)n.label?i.push(`    ${n.source} -->|${n.label}| ${n.target}`):i.push(`    ${n.source} --> ${n.target}`);return i.join(`
`)}function $s(e,t,r){const{direction:i,nodeWidth:n=180,nodeHeight:o=50,rankSep:a=80,nodeSep:s=40}=r,c=new Gp.graphlib.Graph;c.setDefaultEdgeLabel(()=>({})),c.setGraph({rankdir:i,ranksep:a,nodesep:s});for(const u of e)c.setNode(u.id,{width:n,height:o});for(const u of t)c.setEdge(u.source,u.target);return Gp.layout(c),e.map(u=>{const d=c.node(u.id);return{...u,position:{x:d.x-n/2,y:d.y-o/2}}})}const Zs=[{name:"Default",border:"border-secondary",bg:"bg-black/80",text:"text-secondary-foreground",hex:""},{name:"Red",border:"border-red-500",bg:"bg-red-500/10",text:"text-red-400",hex:"#ef4444"},{name:"Blue",border:"border-blue-500",bg:"bg-blue-500/10",text:"text-blue-400",hex:"#3b82f6"},{name:"Green",border:"border-green-500",bg:"bg-green-500/10",text:"text-green-400",hex:"#22c55e"},{name:"Yellow",border:"border-yellow-500",bg:"bg-yellow-500/10",text:"text-yellow-400",hex:"#eab308"},{name:"Purple",border:"border-purple-500",bg:"bg-purple-500/10",text:"text-purple-400",hex:"#a855f7"},{name:"Cyan",border:"border-cyan-400",bg:"bg-cyan-400/10",text:"text-cyan-400",hex:"#22d3ee"},{name:"Orange",border:"border-orange-500",bg:"bg-orange-500/10",text:"text-orange-400",hex:"#f97316"},{name:"Pink",border:"border-pink-500",bg:"bg-pink-500/10",text:"text-pink-400",hex:"#ec4899"}],UE=[{name:"Primary",stroke:"hsl(var(--primary))"},{name:"Red",stroke:"#ef4444"},{name:"Blue",stroke:"#3b82f6"},{name:"Green",stroke:"#22c55e"},{name:"Yellow",stroke:"#eab308"},{name:"Purple",stroke:"#a855f7"},{name:"Cyan",stroke:"#22d3ee"},{name:"Orange",stroke:"#f97316"},{name:"Pink",stroke:"#ec4899"}];function WE({data:e,selected:t}){const r=e.label,i=e.colorIdx??0,n=Zs[i]||Zs[0];return C.jsxs("div",{className:Ie("px-3 py-2 font-terminal text-xs border-2 rounded-none min-w-[100px] text-center",t?"border-primary text-primary ring-1 ring-primary":`${n.border} ${n.text}`,n.bg),children:[C.jsx(Be,{type:"target",position:K.Top,className:"!bg-primary !border-primary !w-2 !h-2"}),C.jsx(Be,{type:"target",position:K.Left,className:"!bg-primary !border-primary !w-2 !h-2"}),r,C.jsx(Be,{type:"source",position:K.Bottom,className:"!bg-primary !border-primary !w-2 !h-2"}),C.jsx(Be,{type:"source",position:K.Right,className:"!bg-primary !border-primary !w-2 !h-2"})]})}const YE={arcade:WE},KE={type:"smoothstep",style:{stroke:"hsl(var(--primary))",strokeWidth:2},markerEnd:{type:rt.ArrowClosed,color:"hsl(var(--primary))"}},ZE=[{id:"basic-concept-map",name:"Concept Map",description:"Central concept with labeled branches",category:"concept-map",mermaid:`graph TD
    A["Central Concept"]
    B["Related Idea 1"]
    C["Related Idea 2"]
    D["Related Idea 3"]
    E["Related Idea 4"]
    A -->|"causes"| B
    A -->|"includes"| C
    A -->|"affects"| D
    B -->|"leads to"| E`},{id:"process-flowchart",name:"Process Flowchart",description:"Linear process with decision point",category:"flowchart",mermaid:`graph TD
    A["Start / Input"]
    B["Step 1"]
    C{"Decision?"}
    D["Path A"]
    E["Path B"]
    F["Outcome"]
    A --> B
    B --> C
    C -->|"Yes"| D
    C -->|"No"| E
    D --> F
    E --> F`},{id:"clinical-decision-tree",name:"Clinical Decision Tree",description:"Presentation to diagnosis reasoning",category:"decision-tree",mermaid:`graph TD
    A["Patient Presentation"]
    B{"Key Finding 1?"}
    C{"Key Finding 2?"}
    D["Differential A"]
    E["Differential B"]
    F["Confirm: Test X"]
    G["Confirm: Test Y"]
    A --> B
    B -->|"Present"| D
    B -->|"Absent"| C
    C -->|"Positive"| E
    C -->|"Negative"| D
    D --> F
    E --> G`},{id:"physiological-pathway",name:"Physiological Pathway",description:"Stimulus to response cascade",category:"pathway",mermaid:`graph TD
    A["Stimulus"]
    B["Receptor / Sensor"]
    C["Signal Transduction"]
    D["Effector Response"]
    E["Outcome / Adaptation"]
    F["Feedback Loop"]
    A --> B
    B --> C
    C --> D
    D --> E
    E -->|"negative feedback"| A
    E -->|"modulates"| F
    F --> B`},{id:"compare-contrast",name:"Compare & Contrast",description:"Two concepts with shared and unique features",category:"compare",mermaid:`graph LR
    A["Concept A"]
    B["Shared Feature 1"]
    C["Shared Feature 2"]
    D["Concept B"]
    E["Unique to A"]
    F["Unique to B"]
    A --> B
    D --> B
    A --> C
    D --> C
    A --> E
    D --> F`}];function XE({mermaidInput:e,onMermaidInputChange:t,onImport:r,onBlank:i,className:n}){return C.jsxs("div",{className:Ie("flex flex-col items-center h-full p-4 gap-3 overflow-auto",n),children:[C.jsx("p",{className:"font-arcade text-[10px] text-primary",children:"CONCEPT MAP EDITOR"}),C.jsx("p",{className:"font-terminal text-[10px] text-muted-foreground",children:"START FROM TEMPLATE"}),C.jsx("div",{className:"grid grid-cols-2 gap-2 w-full max-w-md",children:ZE.map(o=>C.jsxs("button",{onClick:()=>r(o.mermaid),className:"border-2 border-secondary/50 hover:border-primary p-3 cursor-pointer text-left transition-colors bg-black/40",children:[C.jsx("p",{className:"font-terminal text-[10px] text-primary",children:o.name}),C.jsx("p",{className:"font-terminal text-[9px] text-muted-foreground mt-0.5",children:o.description})]},o.id))}),C.jsx("div",{className:"w-px h-2"}),C.jsx("p",{className:"font-terminal text-[10px] text-muted-foreground",children:"OR PASTE MERMAID CODE"}),C.jsx(by,{value:e,onChange:o=>t(o.target.value),placeholder:`graph TD
    A["Main Topic"]
    B["Subtopic 1"]
    C["Subtopic 2"]
    A --> B
    A --> C`,className:"w-full max-w-md h-32 font-mono text-xs rounded-none border-secondary bg-black/60"}),C.jsxs("div",{className:"flex gap-2",children:[C.jsxs(ue,{size:"sm",className:"font-terminal text-xs rounded-none",onClick:()=>r(e),disabled:!e.trim(),children:[C.jsx(tg,{className:"w-3 h-3 mr-1"}),"Import"]}),C.jsxs(ue,{size:"sm",variant:"outline",className:"font-terminal text-xs rounded-none",onClick:i,children:[C.jsx(eg,{className:"w-3 h-3 mr-1"}),"Blank Canvas"]})]})]})}function QE({initialMermaid:e,onSave:t,onInitialMermaidConsumed:r,className:i}){const[n,o,a]=U_([]),[s,c,u]=W_([]),[d,l]=k.useState("TB"),[f,h]=k.useState(!e&&n.length===0),[m,v]=k.useState(e||""),[g,y]=k.useState(0),[b,p]=k.useState(!1),[x,E]=k.useState(null),[_,w]=k.useState(!1),S=k.useRef(null),R=k.useRef(!1),{toast:M}=Up(),N=k.useCallback(I=>{if(!I.trim())return;const T=GE(I);l(T.direction);const j=$s(T.nodes,T.edges,{direction:T.direction});o(j),c(T.edges),y(T.nodes.length),h(!1),w(!0)},[o,c]);k.useEffect(()=>{e?.trim()&&!R.current&&(R.current=!0,N(e),v(e),r?.())},[e,N,r]),k.useEffect(()=>{if(!b)return;const I=T=>{T.key==="Escape"&&p(!1)};return window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I)},[b]);const q=k.useCallback(I=>{w(!0),a(I)},[a]),P=k.useCallback(I=>{w(!0),u(I)},[u]),D=k.useCallback(I=>{w(!0),c(T=>bg(I,T))},[c]),O=k.useCallback(()=>{const I=$s(n,s,{direction:d});o(I),w(!0)},[n,s,d,o]),H=k.useCallback(()=>{const I=d==="TB"?"LR":"TB";l(I);const T=$s(n,s,{direction:I});o(T),w(!0)},[d,n,s,o]),z=k.useCallback(()=>{const I=`N${g+1}`;y(j=>j+1);const T={id:I,type:"arcade",position:{x:Math.random()*300+50,y:Math.random()*200+50},data:{label:`New Node ${g+1}`,colorIdx:0}};o(j=>[...j,T]),w(!0)},[g,o]),L=k.useCallback(()=>{o(I=>I.filter(T=>!T.selected)),c(I=>I.filter(T=>!T.selected)),w(!0)},[o,c]),F=k.useCallback(I=>{o(T=>T.map(j=>j.selected?{...j,data:{...j.data,colorIdx:I}}:j)),E(null),w(!0)},[o]),U=k.useCallback(I=>{c(T=>T.map(j=>j.selected?{...j,style:{...j.style,stroke:I,strokeWidth:2},markerEnd:{type:rt.ArrowClosed,color:I}}:j)),E(null),w(!0)},[c]),G=k.useCallback(async()=>{if(S.current)try{const I=S.current.querySelector(".react-flow__viewport");if(!I)return;const T=await _y(I,{backgroundColor:"#000",quality:1}),j=document.createElement("a");j.download="concept-map.png",j.href=T,j.click(),M({title:"PNG exported"})}catch(I){M({title:"Export failed",description:String(I),variant:"destructive"})}},[M]),$=k.useCallback(()=>{const I=zs(n,s,d);navigator.clipboard.writeText(I),M({title:"Mermaid copied to clipboard"})},[n,s,d,M]),W=k.useCallback(async()=>{const I=zs(n,s,d),T=(n[0]?.data?.label||"Untitled").replace(/[/\\?%*:|"<>]/g,"-"),j=`---
type: concept-map
created: ${new Date().toISOString()}
---

# ${T} Concept Map

\`\`\`mermaid
${I}
\`\`\`
`,B=`Concept Maps/${T}.md`;try{await Yp.obsidian.saveFile(B,j),M({title:"Saved to vault",description:B}),t?.(I),w(!1)}catch(V){M({title:"Save failed",description:String(V),variant:"destructive"})}},[n,s,d,M,t]),A=k.useCallback(()=>{h(!0),v(n.length>0?zs(n,s,d):"")},[n,s,d]);return f&&n.length===0?C.jsx(XE,{mermaidInput:m,onMermaidInputChange:v,onImport:N,onBlank:()=>{h(!1),z()},className:i}):C.jsxs("div",{className:Ie("flex flex-col",b?"fixed inset-0 z-[100010] bg-black":"h-full",i),children:[C.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 border-b border-secondary/30 bg-black/40 shrink-0 flex-wrap",children:[C.jsx(ue,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:A,title:"Back to import",children:C.jsx(wy,{className:"w-3 h-3"})}),C.jsx("div",{className:"w-px h-4 bg-secondary/30"}),C.jsx(ue,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:z,title:"Add node",children:C.jsx(eg,{className:"w-3 h-3"})}),C.jsx(ue,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:L,title:"Delete selected",children:C.jsx(xy,{className:"w-3 h-3"})}),C.jsxs("div",{className:"relative",children:[C.jsx(ue,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:()=>E(x?null:"node"),title:"Color selected",children:C.jsx(Fy,{className:"w-3 h-3"})}),x&&C.jsxs("div",{className:"absolute top-full left-0 mt-1 p-2 bg-black border-2 border-primary/50 z-50 space-y-2 min-w-[160px]",children:[C.jsx("p",{className:"font-terminal text-[9px] text-muted-foreground",children:"NODE COLORS"}),C.jsx("div",{className:"flex flex-wrap gap-1",children:Zs.map((I,T)=>C.jsx("button",{onClick:()=>F(T),className:Ie("w-5 h-5 border-2 rounded-none",I.border,I.bg),title:I.name},I.name))}),C.jsx("p",{className:"font-terminal text-[9px] text-muted-foreground pt-1",children:"EDGE COLORS"}),C.jsx("div",{className:"flex flex-wrap gap-1",children:UE.map(I=>C.jsx("button",{onClick:()=>U(I.stroke),className:"w-5 h-5 border-2 border-secondary/50 rounded-none",style:{backgroundColor:I.stroke},title:I.name},I.name))})]})]}),C.jsx("div",{className:"w-px h-4 bg-secondary/30"}),C.jsx(ue,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:O,title:"Auto layout",children:C.jsx(Ly,{className:"w-3 h-3"})}),C.jsx(ue,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:H,title:`Direction: ${d}`,children:d==="TB"?C.jsx(Ty,{className:"w-3 h-3"}):C.jsx(Ay,{className:"w-3 h-3"})}),C.jsx("div",{className:"w-px h-4 bg-secondary/30"}),C.jsx(ue,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:$,title:"Copy Mermaid",children:C.jsx(Iy,{className:"w-3 h-3"})}),C.jsx(ue,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:G,title:"Export PNG",children:C.jsx(Zp,{className:"w-3 h-3"})}),C.jsx(ue,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:W,title:"Save to vault",children:C.jsx(Kp,{className:"w-3 h-3"})}),C.jsx(ue,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:()=>p(!b),title:b?"Exit fullscreen":"Fullscreen",children:b?C.jsx(Ey,{className:"w-3 h-3"}):C.jsx(Cy,{className:"w-3 h-3"})}),C.jsx(ue,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-[9px] font-terminal",onClick:()=>{h(!0),o([]),c([])},title:"Import Mermaid",children:C.jsx(tg,{className:"w-3 h-3"})}),C.jsxs("div",{className:"ml-auto flex items-center gap-2 text-[9px] font-terminal text-muted-foreground",children:[C.jsxs("span",{children:[n.length,"N / ",s.length,"E"]}),C.jsx("span",{className:Ie("w-2 h-2 rounded-full",_?"bg-red-500":"bg-green-500")}),C.jsx("span",{children:_?"Unsaved":"Saved"})]})]}),C.jsx("div",{className:"flex-1 min-h-0",ref:S,children:C.jsxs(G_,{nodes:n,edges:s,onNodesChange:q,onEdgesChange:P,onConnect:D,nodeTypes:YE,defaultEdgeOptions:KE,fitView:!0,className:"bg-black/80",proOptions:{hideAttribution:!0},onPaneClick:()=>E(null),children:[C.jsx(Q_,{color:"hsl(var(--primary) / 0.1)",gap:20}),C.jsx(o0,{className:"!bg-black !border-primary [&_button]:!bg-black/80 [&_button]:!border-primary/50 [&_button]:!text-primary"}),C.jsx(y0,{className:"!bg-black/80 !border-primary",nodeColor:"hsl(var(--primary))",maskColor:"rgba(0,0,0,0.5)"})]})})]})}const JE=[{id:"freehand",label:"Freehand"},{id:"structured",label:"Structured (Mermaid)"}];function _C({initialMermaid:e,onSave:t,className:r}){const[i,n]=k.useState("freehand"),[o,a]=k.useState(null),s=k.useCallback(u=>{a(u.trim()||null),n("structured")},[]),c=k.useCallback(()=>a(null),[]);return C.jsxs("div",{className:Ie("flex flex-col h-full",r),children:[C.jsxs("div",{className:"section-block section-block-gap border-primary/30 shrink-0 flex-row flex-wrap gap-2",children:[C.jsx("span",{className:"section-header text-primary/90 w-full sm:w-auto",children:"Concept Map"}),C.jsx("div",{className:"flex items-center gap-1 flex-wrap",children:JE.map(u=>C.jsx("button",{type:"button",onClick:()=>n(u.id),className:Ie("tab-sub-item min-h-[32px]",i===u.id&&"active"),children:u.label},u.id))}),C.jsx("span",{className:"text-[10px] font-terminal text-muted-foreground ml-auto",children:i==="freehand"?"tldraw Â· infinite canvas":"Mermaid + React Flow"})]}),C.jsx("div",{className:"flex-1 min-h-0",children:i==="freehand"?C.jsx(Gy,{className:"h-full",onImportMermaid:s}):C.jsx(QE,{initialMermaid:o??e,onSave:t,onInitialMermaidConsumed:c,className:"h-full"})})]})}export{_C as ConceptMapEditor};

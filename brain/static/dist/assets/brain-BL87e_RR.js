const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ConceptMapEditor-BhvdCsQu.js","assets/index-Ney09JIT.js","assets/index-CuTS6MA1.css","assets/layout-DrTDpAPS.js","assets/select-B6nvumql.js","assets/index-BYJaSdCW.js","assets/tabs-DOiIlW8G.js","assets/mermaid-to-reactflow-CIDMX9_R.js","assets/zoom-tdgUGed2.js","assets/mermaid-to-reactflow-BZV40eAE.css","assets/colors-BDuz-soV.js","assets/plus-BZkKN-7s.js","assets/triangle-alert-AgaXmY6m.js","assets/file-text-D2AIgzrF.js","assets/refresh-cw-DilKBPoS.js","assets/index-D4azcMu8.js","assets/search-CLYU6h3-.js","assets/message-square-BM-TphxK.js","assets/loader-circle-Cukh0dGl.js","assets/send-CjlLm_ad.js","assets/badge-CxmU_6k5.js","assets/checkbox-ntfrV4kT.js","assets/external-link-BJmBFGp1.js","assets/star-BhvJvhcs.js","assets/ConceptMapEditor-BWDvGoXv.css","assets/VaultGraphView-D_ucm7ZI.js","assets/MindMapView-DMCndcGc.js","assets/square-0Cn_Nc41.js"])))=>i.map(i=>d[i]);
import{c as ee,r as c,R as wn,j as t,b as X,X as Nt,f as Cs,e as jn,P as Ze,d as Pt,g as Es,h as Ps,u as et,a as tt,_ as Rt}from"./index-Ney09JIT.js";import{G as Rs,f as Y,a as G,B as q,I as Ce,S as $e,p as St,r as Is,g as It,i as zt,j as At,k as Tt,l as Mt,s as Dt,n as Ke,u as me,o as dt,m as Ue,t as Wt,v as zs,L as As}from"./layout-DrTDpAPS.js";import{T as _t,A as Ts,C as Ms}from"./triangle-alert-AgaXmY6m.js";import{R as Ae}from"./refresh-cw-DilKBPoS.js";import{F as Nn,P as Ds,M as _s,r as Ls,D as Os}from"./index-D4azcMu8.js";import{S as Sn}from"./search-CLYU6h3-.js";import{F as nt}from"./file-text-D2AIgzrF.js";import{a as $s,C as Fs,u as Hs}from"./index-BYJaSdCW.js";import{M as kn}from"./message-square-BM-TphxK.js";import{L as Fe,c as Cn,R as Vs,I as Gs,T as Bs,a as qs,b as ut,d as mt,C as Ks}from"./tabs-DOiIlW8G.js";import{L as Lt}from"./loader-circle-Cukh0dGl.js";import{S as Us}from"./send-CjlLm_ad.js";import{B as We,C as Ee,a as Pe,b as Re,c as Ie}from"./badge-CxmU_6k5.js";import{C as En}from"./checkbox-ntfrV4kT.js";import{C as Ws}from"./colors-BDuz-soV.js";import{E as Js}from"./external-link-BJmBFGp1.js";import{P as Jt}from"./plus-BZkKN-7s.js";import{S as Ys}from"./star-BhvJvhcs.js";import{S as Qs,a as Xs,b as Zs,c as er,d as xe}from"./select-B6nvumql.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],nr=ee("brain-circuit",tr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Yt=ee("calendar-days",sr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]],ar=ee("columns-2",rr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],or=ee("copy",ir);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Pn=ee("download",lr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],dr=ee("file",cr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],mr=ee("folder",ur);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],hr=ee("image",fr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],xr=ee("maximize-2",pr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],gr=ee("minimize-2",br);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]],vr=ee("network",yr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],Qt=ee("panel-left-close",wr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}]],Nr=ee("rows-2",jr);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]],kr=ee("table-2",Sr),st=c.createContext(null);st.displayName="PanelGroupContext";const J={group:"data-panel-group",groupDirection:"data-panel-group-direction",groupId:"data-panel-group-id",panel:"data-panel",panelCollapsible:"data-panel-collapsible",panelId:"data-panel-id",panelSize:"data-panel-size",resizeHandle:"data-resize-handle",resizeHandleActive:"data-resize-handle-active",resizeHandleEnabled:"data-panel-resize-handle-enabled",resizeHandleId:"data-panel-resize-handle-id",resizeHandleState:"data-resize-handle-state"},Ot=10,ye=c.useLayoutEffect,Xt=wn.useId,Cr=typeof Xt=="function"?Xt:()=>null;let Er=0;function $t(e=null){const n=Cr(),s=c.useRef(e||n||null);return s.current===null&&(s.current=""+Er++),e??s.current}function Rn({children:e,className:n="",collapsedSize:s,collapsible:r,defaultSize:a,forwardedRef:i,id:l,maxSize:o,minSize:d,onCollapse:h,onExpand:p,onResize:g,order:x,style:j,tagName:S="div",...I}){const f=c.useContext(st);if(f===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:u,expandPanel:y,getPanelSize:b,getPanelStyle:v,groupId:T,isPanelCollapsed:_,reevaluatePanelConstraints:k,registerPanel:w,resizePanel:F,unregisterPanel:E}=f,P=$t(l),D=c.useRef({callbacks:{onCollapse:h,onExpand:p,onResize:g},constraints:{collapsedSize:s,collapsible:r,defaultSize:a,maxSize:o,minSize:d},id:P,idIsFromProps:l!==void 0,order:x});c.useRef({didLogMissingDefaultSizeWarning:!1}),ye(()=>{const{callbacks:R,constraints:M}=D.current,O={...M};D.current.id=P,D.current.idIsFromProps=l!==void 0,D.current.order=x,R.onCollapse=h,R.onExpand=p,R.onResize=g,M.collapsedSize=s,M.collapsible=r,M.defaultSize=a,M.maxSize=o,M.minSize=d,(O.collapsedSize!==M.collapsedSize||O.collapsible!==M.collapsible||O.maxSize!==M.maxSize||O.minSize!==M.minSize)&&k(D.current,O)}),ye(()=>{const R=D.current;return w(R),()=>{E(R)}},[x,P,w,E]),c.useImperativeHandle(i,()=>({collapse:()=>{u(D.current)},expand:R=>{y(D.current,R)},getId(){return P},getSize(){return b(D.current)},isCollapsed(){return _(D.current)},isExpanded(){return!_(D.current)},resize:R=>{F(D.current,R)}}),[u,y,b,_,P,F]);const H=v(D.current,a);return c.createElement(S,{...I,children:e,className:n,id:P,style:{...H,...j},[J.groupId]:T,[J.panel]:"",[J.panelCollapsible]:r||void 0,[J.panelId]:P,[J.panelSize]:parseFloat(""+H.flexGrow).toFixed(1)})}const In=c.forwardRef((e,n)=>c.createElement(Rn,{...e,forwardedRef:n}));Rn.displayName="Panel";In.displayName="forwardRef(Panel)";let kt=null,qe=-1,he=null;function Pr(e,n){if(n){const s=(n&Dn)!==0,r=(n&_n)!==0,a=(n&Ln)!==0,i=(n&On)!==0;if(s)return a?"se-resize":i?"ne-resize":"e-resize";if(r)return a?"sw-resize":i?"nw-resize":"w-resize";if(a)return"s-resize";if(i)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function Rr(){he!==null&&(document.head.removeChild(he),kt=null,he=null,qe=-1)}function ft(e,n){var s,r;const a=Pr(e,n);if(kt!==a){if(kt=a,he===null&&(he=document.createElement("style"),document.head.appendChild(he)),qe>=0){var i;(i=he.sheet)===null||i===void 0||i.removeRule(qe)}qe=(s=(r=he.sheet)===null||r===void 0?void 0:r.insertRule(`*{cursor: ${a} !important;}`))!==null&&s!==void 0?s:-1}}function zn(e){return e.type==="keydown"}function An(e){return e.type.startsWith("pointer")}function Tn(e){return e.type.startsWith("mouse")}function rt(e){if(An(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(Tn(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}function Ir(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function zr(e,n,s){return e.x<n.x+n.width&&e.x+e.width>n.x&&e.y<n.y+n.height&&e.y+e.height>n.y}function Ar(e,n){if(e===n)throw new Error("Cannot compare node with itself");const s={a:tn(e),b:tn(n)};let r;for(;s.a.at(-1)===s.b.at(-1);)e=s.a.pop(),n=s.b.pop(),r=e;$(r,"Stacking order can only be calculated for elements with a common ancestor");const a={a:en(Zt(s.a)),b:en(Zt(s.b))};if(a.a===a.b){const i=r.childNodes,l={a:s.a.at(-1),b:s.b.at(-1)};let o=i.length;for(;o--;){const d=i[o];if(d===l.a)return 1;if(d===l.b)return-1}}return Math.sign(a.a-a.b)}const Tr=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function Mr(e){var n;const s=getComputedStyle((n=Mn(e))!==null&&n!==void 0?n:e).display;return s==="flex"||s==="inline-flex"}function Dr(e){const n=getComputedStyle(e);return!!(n.position==="fixed"||n.zIndex!=="auto"&&(n.position!=="static"||Mr(e))||+n.opacity<1||"transform"in n&&n.transform!=="none"||"webkitTransform"in n&&n.webkitTransform!=="none"||"mixBlendMode"in n&&n.mixBlendMode!=="normal"||"filter"in n&&n.filter!=="none"||"webkitFilter"in n&&n.webkitFilter!=="none"||"isolation"in n&&n.isolation==="isolate"||Tr.test(n.willChange)||n.webkitOverflowScrolling==="touch")}function Zt(e){let n=e.length;for(;n--;){const s=e[n];if($(s,"Missing node"),Dr(s))return s}return null}function en(e){return e&&Number(getComputedStyle(e).zIndex)||0}function tn(e){const n=[];for(;e;)n.push(e),e=Mn(e);return n}function Mn(e){const{parentNode:n}=e;return n&&n instanceof ShadowRoot?n.host:n}const Dn=1,_n=2,Ln=4,On=8,_r=Ir()==="coarse";let oe=[],Te=!1,ge=new Map,at=new Map;const He=new Set;function Lr(e,n,s,r,a){var i;const{ownerDocument:l}=n,o={direction:s,element:n,hitAreaMargins:r,setResizeHandlerState:a},d=(i=ge.get(l))!==null&&i!==void 0?i:0;return ge.set(l,d+1),He.add(o),Je(),function(){var p;at.delete(e),He.delete(o);const g=(p=ge.get(l))!==null&&p!==void 0?p:1;if(ge.set(l,g-1),Je(),g===1&&ge.delete(l),oe.includes(o)){const x=oe.indexOf(o);x>=0&&oe.splice(x,1),Ht(),a("up",!0,null)}}}function Or(e){const{target:n}=e,{x:s,y:r}=rt(e);Te=!0,Ft({target:n,x:s,y:r}),Je(),oe.length>0&&(Ye("down",e),e.preventDefault(),$n(n)||e.stopImmediatePropagation())}function ht(e){const{x:n,y:s}=rt(e);if(Te&&e.buttons===0&&(Te=!1,Ye("up",e)),!Te){const{target:r}=e;Ft({target:r,x:n,y:s})}Ye("move",e),Ht(),oe.length>0&&e.preventDefault()}function pt(e){const{target:n}=e,{x:s,y:r}=rt(e);at.clear(),Te=!1,oe.length>0&&(e.preventDefault(),$n(n)||e.stopImmediatePropagation()),Ye("up",e),Ft({target:n,x:s,y:r}),Ht(),Je()}function $n(e){let n=e;for(;n;){if(n.hasAttribute(J.resizeHandle))return!0;n=n.parentElement}return!1}function Ft({target:e,x:n,y:s}){oe.splice(0);let r=null;(e instanceof HTMLElement||e instanceof SVGElement)&&(r=e),He.forEach(a=>{const{element:i,hitAreaMargins:l}=a,o=i.getBoundingClientRect(),{bottom:d,left:h,right:p,top:g}=o,x=_r?l.coarse:l.fine;if(n>=h-x&&n<=p+x&&s>=g-x&&s<=d+x){if(r!==null&&document.contains(r)&&i!==r&&!i.contains(r)&&!r.contains(i)&&Ar(r,i)>0){let S=r,I=!1;for(;S&&!S.contains(i);){if(zr(S.getBoundingClientRect(),o)){I=!0;break}S=S.parentElement}if(I)return}oe.push(a)}})}function xt(e,n){at.set(e,n)}function Ht(){let e=!1,n=!1;oe.forEach(r=>{const{direction:a}=r;a==="horizontal"?e=!0:n=!0});let s=0;at.forEach(r=>{s|=r}),e&&n?ft("intersection",s):e?ft("horizontal",s):n?ft("vertical",s):Rr()}let bt=new AbortController;function Je(){bt.abort(),bt=new AbortController;const e={capture:!0,signal:bt.signal};He.size&&(Te?(oe.length>0&&ge.forEach((n,s)=>{const{body:r}=s;n>0&&(r.addEventListener("contextmenu",pt,e),r.addEventListener("pointerleave",ht,e),r.addEventListener("pointermove",ht,e))}),window.addEventListener("pointerup",pt,e),window.addEventListener("pointercancel",pt,e)):ge.forEach((n,s)=>{const{body:r}=s;n>0&&(r.addEventListener("pointerdown",Or,e),r.addEventListener("pointermove",ht,e))}))}function Ye(e,n){He.forEach(s=>{const{setResizeHandlerState:r}=s,a=oe.includes(s);r(e,a,n)})}function $r(){const[e,n]=c.useState(0);return c.useCallback(()=>n(s=>s+1),[])}function $(e,n){if(!e)throw console.error(n),Error(n)}function ve(e,n,s=Ot){return e.toFixed(s)===n.toFixed(s)?0:e>n?1:-1}function ue(e,n,s=Ot){return ve(e,n,s)===0}function ne(e,n,s){return ve(e,n,s)===0}function Fr(e,n,s){if(e.length!==n.length)return!1;for(let r=0;r<e.length;r++){const a=e[r],i=n[r];if(!ne(a,i,s))return!1}return!0}function ze({panelConstraints:e,panelIndex:n,size:s}){const r=e[n];$(r!=null,`Panel constraints not found for index ${n}`);let{collapsedSize:a=0,collapsible:i,maxSize:l=100,minSize:o=0}=r;if(ve(s,o)<0)if(i){const d=(a+o)/2;ve(s,d)<0?s=a:s=o}else s=o;return s=Math.min(l,s),s=parseFloat(s.toFixed(Ot)),s}function Le({delta:e,initialLayout:n,panelConstraints:s,pivotIndices:r,prevLayout:a,trigger:i}){if(ne(e,0))return n;const l=[...n],[o,d]=r;$(o!=null,"Invalid first pivot index"),$(d!=null,"Invalid second pivot index");let h=0;if(i==="keyboard"){{const g=e<0?d:o,x=s[g];$(x,`Panel constraints not found for index ${g}`);const{collapsedSize:j=0,collapsible:S,minSize:I=0}=x;if(S){const f=n[g];if($(f!=null,`Previous layout not found for panel index ${g}`),ne(f,j)){const u=I-f;ve(u,Math.abs(e))>0&&(e=e<0?0-u:u)}}}{const g=e<0?o:d,x=s[g];$(x,`No panel constraints found for index ${g}`);const{collapsedSize:j=0,collapsible:S,minSize:I=0}=x;if(S){const f=n[g];if($(f!=null,`Previous layout not found for panel index ${g}`),ne(f,I)){const u=f-j;ve(u,Math.abs(e))>0&&(e=e<0?0-u:u)}}}}{const g=e<0?1:-1;let x=e<0?d:o,j=0;for(;;){const I=n[x];$(I!=null,`Previous layout not found for panel index ${x}`);const u=ze({panelConstraints:s,panelIndex:x,size:100})-I;if(j+=u,x+=g,x<0||x>=s.length)break}const S=Math.min(Math.abs(e),Math.abs(j));e=e<0?0-S:S}{let x=e<0?o:d;for(;x>=0&&x<s.length;){const j=Math.abs(e)-Math.abs(h),S=n[x];$(S!=null,`Previous layout not found for panel index ${x}`);const I=S-j,f=ze({panelConstraints:s,panelIndex:x,size:I});if(!ne(S,f)&&(h+=S-f,l[x]=f,h.toPrecision(3).localeCompare(Math.abs(e).toPrecision(3),void 0,{numeric:!0})>=0))break;e<0?x--:x++}}if(Fr(a,l))return a;{const g=e<0?d:o,x=n[g];$(x!=null,`Previous layout not found for panel index ${g}`);const j=x+h,S=ze({panelConstraints:s,panelIndex:g,size:j});if(l[g]=S,!ne(S,j)){let I=j-S,u=e<0?d:o;for(;u>=0&&u<s.length;){const y=l[u];$(y!=null,`Previous layout not found for panel index ${u}`);const b=y+I,v=ze({panelConstraints:s,panelIndex:u,size:b});if(ne(y,v)||(I-=v-y,l[u]=v),ne(I,0))break;e>0?u--:u++}}}const p=l.reduce((g,x)=>x+g,0);return ne(p,100)?l:a}function Hr({layout:e,panelsArray:n,pivotIndices:s}){let r=0,a=100,i=0,l=0;const o=s[0];$(o!=null,"No pivot index found"),n.forEach((g,x)=>{const{constraints:j}=g,{maxSize:S=100,minSize:I=0}=j;x===o?(r=I,a=S):(i+=I,l+=S)});const d=Math.min(a,100-i),h=Math.max(r,100-l),p=e[o];return{valueMax:d,valueMin:h,valueNow:p}}function Ve(e,n=document){return Array.from(n.querySelectorAll(`[${J.resizeHandleId}][data-panel-group-id="${e}"]`))}function Fn(e,n,s=document){const a=Ve(e,s).findIndex(i=>i.getAttribute(J.resizeHandleId)===n);return a??null}function Hn(e,n,s){const r=Fn(e,n,s);return r!=null?[r,r+1]:[-1,-1]}function Vn(e,n=document){var s;if(n instanceof HTMLElement&&(n==null||(s=n.dataset)===null||s===void 0?void 0:s.panelGroupId)==e)return n;const r=n.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return r||null}function it(e,n=document){const s=n.querySelector(`[${J.resizeHandleId}="${e}"]`);return s||null}function Vr(e,n,s,r=document){var a,i,l,o;const d=it(n,r),h=Ve(e,r),p=d?h.indexOf(d):-1,g=(a=(i=s[p])===null||i===void 0?void 0:i.id)!==null&&a!==void 0?a:null,x=(l=(o=s[p+1])===null||o===void 0?void 0:o.id)!==null&&l!==void 0?l:null;return[g,x]}function Gr({committedValuesRef:e,eagerValuesRef:n,groupId:s,layout:r,panelDataArray:a,panelGroupElement:i,setLayout:l}){c.useRef({didWarnAboutMissingResizeHandle:!1}),ye(()=>{if(!i)return;const o=Ve(s,i);for(let d=0;d<a.length-1;d++){const{valueMax:h,valueMin:p,valueNow:g}=Hr({layout:r,panelsArray:a,pivotIndices:[d,d+1]}),x=o[d];if(x!=null){const j=a[d];$(j,`No panel data found for index "${d}"`),x.setAttribute("aria-controls",j.id),x.setAttribute("aria-valuemax",""+Math.round(h)),x.setAttribute("aria-valuemin",""+Math.round(p)),x.setAttribute("aria-valuenow",g!=null?""+Math.round(g):"")}}return()=>{o.forEach((d,h)=>{d.removeAttribute("aria-controls"),d.removeAttribute("aria-valuemax"),d.removeAttribute("aria-valuemin"),d.removeAttribute("aria-valuenow")})}},[s,r,a,i]),c.useEffect(()=>{if(!i)return;const o=n.current;$(o,"Eager values not found");const{panelDataArray:d}=o,h=Vn(s,i);$(h!=null,`No group found for id "${s}"`);const p=Ve(s,i);$(p,`No resize handles found for group id "${s}"`);const g=p.map(x=>{const j=x.getAttribute(J.resizeHandleId);$(j,"Resize handle element has no handle id attribute");const[S,I]=Vr(s,j,d,i);if(S==null||I==null)return()=>{};const f=u=>{if(!u.defaultPrevented)switch(u.key){case"Enter":{u.preventDefault();const y=d.findIndex(b=>b.id===S);if(y>=0){const b=d[y];$(b,`No panel data found for index ${y}`);const v=r[y],{collapsedSize:T=0,collapsible:_,minSize:k=0}=b.constraints;if(v!=null&&_){const w=Le({delta:ne(v,T)?k-T:T-v,initialLayout:r,panelConstraints:d.map(F=>F.constraints),pivotIndices:Hn(s,j,i),prevLayout:r,trigger:"keyboard"});r!==w&&l(w)}}break}}};return x.addEventListener("keydown",f),()=>{x.removeEventListener("keydown",f)}});return()=>{g.forEach(x=>x())}},[i,e,n,s,r,a,l])}function nn(e,n){if(e.length!==n.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!==n[s])return!1;return!0}function Gn(e,n){const s=e==="horizontal",{x:r,y:a}=rt(n);return s?r:a}function Br(e,n,s,r,a){const i=s==="horizontal",l=it(n,a);$(l,`No resize handle element found for id "${n}"`);const o=l.getAttribute(J.groupId);$(o,"Resize handle element has no group id attribute");let{initialCursorPosition:d}=r;const h=Gn(s,e),p=Vn(o,a);$(p,`No group element found for id "${o}"`);const g=p.getBoundingClientRect(),x=i?g.width:g.height;return(h-d)/x*100}function qr(e,n,s,r,a,i){if(zn(e)){const l=s==="horizontal";let o=0;e.shiftKey?o=100:a!=null?o=a:o=10;let d=0;switch(e.key){case"ArrowDown":d=l?0:o;break;case"ArrowLeft":d=l?-o:0;break;case"ArrowRight":d=l?o:0;break;case"ArrowUp":d=l?0:-o;break;case"End":d=100;break;case"Home":d=-100;break}return d}else return r==null?0:Br(e,n,s,r,i)}function Kr({panelDataArray:e}){const n=Array(e.length),s=e.map(i=>i.constraints);let r=0,a=100;for(let i=0;i<e.length;i++){const l=s[i];$(l,`Panel constraints not found for index ${i}`);const{defaultSize:o}=l;o!=null&&(r++,n[i]=o,a-=o)}for(let i=0;i<e.length;i++){const l=s[i];$(l,`Panel constraints not found for index ${i}`);const{defaultSize:o}=l;if(o!=null)continue;const d=e.length-r,h=a/d;r++,n[i]=h,a-=h}return n}function we(e,n,s){n.forEach((r,a)=>{const i=e[a];$(i,`Panel data not found for index ${a}`);const{callbacks:l,constraints:o,id:d}=i,{collapsedSize:h=0,collapsible:p}=o,g=s[d];if(g==null||r!==g){s[d]=r;const{onCollapse:x,onExpand:j,onResize:S}=l;S&&S(r,g),p&&(x||j)&&(j&&(g==null||ue(g,h))&&!ue(r,h)&&j(),x&&(g==null||!ue(g,h))&&ue(r,h)&&x())}})}function Be(e,n){if(e.length!==n.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!=n[s])return!1;return!0}function Ur({defaultSize:e,dragState:n,layout:s,panelData:r,panelIndex:a,precision:i=3}){const l=s[a];let o;return l==null?o=e!=null?e.toPrecision(i):"1":r.length===1?o="1":o=l.toPrecision(i),{flexBasis:0,flexGrow:o,flexShrink:1,overflow:"hidden",pointerEvents:n!==null?"none":void 0}}function Wr(e,n=10){let s=null;return(...a)=>{s!==null&&clearTimeout(s),s=setTimeout(()=>{e(...a)},n)}}function sn(e){try{if(typeof localStorage<"u")e.getItem=n=>localStorage.getItem(n),e.setItem=(n,s)=>{localStorage.setItem(n,s)};else throw new Error("localStorage not supported in this environment")}catch(n){console.error(n),e.getItem=()=>null,e.setItem=()=>{}}}function Bn(e){return`react-resizable-panels:${e}`}function qn(e){return e.map(n=>{const{constraints:s,id:r,idIsFromProps:a,order:i}=n;return a?r:i?`${i}:${JSON.stringify(s)}`:JSON.stringify(s)}).sort((n,s)=>n.localeCompare(s)).join(",")}function Kn(e,n){try{const s=Bn(e),r=n.getItem(s);if(r){const a=JSON.parse(r);if(typeof a=="object"&&a!=null)return a}}catch{}return null}function Jr(e,n,s){var r,a;const i=(r=Kn(e,s))!==null&&r!==void 0?r:{},l=qn(n);return(a=i[l])!==null&&a!==void 0?a:null}function Yr(e,n,s,r,a){var i;const l=Bn(e),o=qn(n),d=(i=Kn(e,a))!==null&&i!==void 0?i:{};d[o]={expandToSizes:Object.fromEntries(s.entries()),layout:r};try{a.setItem(l,JSON.stringify(d))}catch(h){console.error(h)}}function rn({layout:e,panelConstraints:n}){const s=[...e],r=s.reduce((i,l)=>i+l,0);if(s.length!==n.length)throw Error(`Invalid ${n.length} panel layout: ${s.map(i=>`${i}%`).join(", ")}`);if(!ne(r,100)&&s.length>0)for(let i=0;i<n.length;i++){const l=s[i];$(l!=null,`No layout data found for index ${i}`);const o=100/r*l;s[i]=o}let a=0;for(let i=0;i<n.length;i++){const l=s[i];$(l!=null,`No layout data found for index ${i}`);const o=ze({panelConstraints:n,panelIndex:i,size:l});l!=o&&(a+=l-o,s[i]=o)}if(!ne(a,0))for(let i=0;i<n.length;i++){const l=s[i];$(l!=null,`No layout data found for index ${i}`);const o=l+a,d=ze({panelConstraints:n,panelIndex:i,size:o});if(l!==d&&(a-=d-l,s[i]=d,ne(a,0)))break}return s}const Qr=100,Oe={getItem:e=>(sn(Oe),Oe.getItem(e)),setItem:(e,n)=>{sn(Oe),Oe.setItem(e,n)}},an={};function Un({autoSaveId:e=null,children:n,className:s="",direction:r,forwardedRef:a,id:i=null,onLayout:l=null,keyboardResizeBy:o=null,storage:d=Oe,style:h,tagName:p="div",...g}){const x=$t(i),j=c.useRef(null),[S,I]=c.useState(null),[f,u]=c.useState([]),y=$r(),b=c.useRef({}),v=c.useRef(new Map),T=c.useRef(0),_=c.useRef({autoSaveId:e,direction:r,dragState:S,id:x,keyboardResizeBy:o,onLayout:l,storage:d}),k=c.useRef({layout:f,panelDataArray:[],panelDataArrayChanged:!1});c.useRef({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),c.useImperativeHandle(a,()=>({getId:()=>_.current.id,getLayout:()=>{const{layout:m}=k.current;return m},setLayout:m=>{const{onLayout:N}=_.current,{layout:A,panelDataArray:C}=k.current,z=rn({layout:m,panelConstraints:C.map(L=>L.constraints)});nn(A,z)||(u(z),k.current.layout=z,N&&N(z),we(C,z,b.current))}}),[]),ye(()=>{_.current.autoSaveId=e,_.current.direction=r,_.current.dragState=S,_.current.id=x,_.current.onLayout=l,_.current.storage=d}),Gr({committedValuesRef:_,eagerValuesRef:k,groupId:x,layout:f,panelDataArray:k.current.panelDataArray,setLayout:u,panelGroupElement:j.current}),c.useEffect(()=>{const{panelDataArray:m}=k.current;if(e){if(f.length===0||f.length!==m.length)return;let N=an[e];N==null&&(N=Wr(Yr,Qr),an[e]=N);const A=[...m],C=new Map(v.current);N(e,A,C,f,d)}},[e,f,d]),c.useEffect(()=>{});const w=c.useCallback(m=>{const{onLayout:N}=_.current,{layout:A,panelDataArray:C}=k.current;if(m.constraints.collapsible){const z=C.map(le=>le.constraints),{collapsedSize:L=0,panelSize:V,pivotIndices:U}=be(C,m,A);if($(V!=null,`Panel size not found for panel "${m.id}"`),!ue(V,L)){v.current.set(m.id,V);const ce=Se(C,m)===C.length-1?V-L:L-V,W=Le({delta:ce,initialLayout:A,panelConstraints:z,pivotIndices:U,prevLayout:A,trigger:"imperative-api"});Be(A,W)||(u(W),k.current.layout=W,N&&N(W),we(C,W,b.current))}}},[]),F=c.useCallback((m,N)=>{const{onLayout:A}=_.current,{layout:C,panelDataArray:z}=k.current;if(m.constraints.collapsible){const L=z.map(ie=>ie.constraints),{collapsedSize:V=0,panelSize:U=0,minSize:le=0,pivotIndices:ce}=be(z,m,C),W=N??le;if(ue(U,V)){const ie=v.current.get(m.id),Me=ie!=null&&ie>=W?ie:W,ct=Se(z,m)===z.length-1?U-Me:Me-U,Q=Le({delta:ct,initialLayout:C,panelConstraints:L,pivotIndices:ce,prevLayout:C,trigger:"imperative-api"});Be(C,Q)||(u(Q),k.current.layout=Q,A&&A(Q),we(z,Q,b.current))}}},[]),E=c.useCallback(m=>{const{layout:N,panelDataArray:A}=k.current,{panelSize:C}=be(A,m,N);return $(C!=null,`Panel size not found for panel "${m.id}"`),C},[]),P=c.useCallback((m,N)=>{const{panelDataArray:A}=k.current,C=Se(A,m);return Ur({defaultSize:N,dragState:S,layout:f,panelData:A,panelIndex:C})},[S,f]),D=c.useCallback(m=>{const{layout:N,panelDataArray:A}=k.current,{collapsedSize:C=0,collapsible:z,panelSize:L}=be(A,m,N);return $(L!=null,`Panel size not found for panel "${m.id}"`),z===!0&&ue(L,C)},[]),H=c.useCallback(m=>{const{layout:N,panelDataArray:A}=k.current,{collapsedSize:C=0,collapsible:z,panelSize:L}=be(A,m,N);return $(L!=null,`Panel size not found for panel "${m.id}"`),!z||ve(L,C)>0},[]),R=c.useCallback(m=>{const{panelDataArray:N}=k.current;N.push(m),N.sort((A,C)=>{const z=A.order,L=C.order;return z==null&&L==null?0:z==null?-1:L==null?1:z-L}),k.current.panelDataArrayChanged=!0,y()},[y]);ye(()=>{if(k.current.panelDataArrayChanged){k.current.panelDataArrayChanged=!1;const{autoSaveId:m,onLayout:N,storage:A}=_.current,{layout:C,panelDataArray:z}=k.current;let L=null;if(m){const U=Jr(m,z,A);U&&(v.current=new Map(Object.entries(U.expandToSizes)),L=U.layout)}L==null&&(L=Kr({panelDataArray:z}));const V=rn({layout:L,panelConstraints:z.map(U=>U.constraints)});nn(C,V)||(u(V),k.current.layout=V,N&&N(V),we(z,V,b.current))}}),ye(()=>{const m=k.current;return()=>{m.layout=[]}},[]);const M=c.useCallback(m=>{let N=!1;const A=j.current;return A&&window.getComputedStyle(A,null).getPropertyValue("direction")==="rtl"&&(N=!0),function(z){z.preventDefault();const L=j.current;if(!L)return()=>null;const{direction:V,dragState:U,id:le,keyboardResizeBy:ce,onLayout:W}=_.current,{layout:ie,panelDataArray:Me}=k.current,{initialLayout:Ge}=U??{},ct=Hn(le,m,L);let Q=qr(z,m,V,U,ce,L);const Kt=V==="horizontal";Kt&&N&&(Q=-Q);const Ss=Me.map(ks=>ks.constraints),De=Le({delta:Q,initialLayout:Ge??ie,panelConstraints:Ss,pivotIndices:ct,prevLayout:ie,trigger:zn(z)?"keyboard":"mouse-or-touch"}),Ut=!Be(ie,De);(An(z)||Tn(z))&&T.current!=Q&&(T.current=Q,!Ut&&Q!==0?Kt?xt(m,Q<0?Dn:_n):xt(m,Q<0?Ln:On):xt(m,0)),Ut&&(u(De),k.current.layout=De,W&&W(De),we(Me,De,b.current))}},[]),O=c.useCallback((m,N)=>{const{onLayout:A}=_.current,{layout:C,panelDataArray:z}=k.current,L=z.map(ie=>ie.constraints),{panelSize:V,pivotIndices:U}=be(z,m,C);$(V!=null,`Panel size not found for panel "${m.id}"`);const ce=Se(z,m)===z.length-1?V-N:N-V,W=Le({delta:ce,initialLayout:C,panelConstraints:L,pivotIndices:U,prevLayout:C,trigger:"imperative-api"});Be(C,W)||(u(W),k.current.layout=W,A&&A(W),we(z,W,b.current))},[]),B=c.useCallback((m,N)=>{const{layout:A,panelDataArray:C}=k.current,{collapsedSize:z=0,collapsible:L}=N,{collapsedSize:V=0,collapsible:U,maxSize:le=100,minSize:ce=0}=m.constraints,{panelSize:W}=be(C,m,A);W!=null&&(L&&U&&ue(W,z)?ue(z,V)||O(m,V):W<ce?O(m,ce):W>le&&O(m,le))},[O]),K=c.useCallback((m,N)=>{const{direction:A}=_.current,{layout:C}=k.current;if(!j.current)return;const z=it(m,j.current);$(z,`Drag handle element not found for id "${m}"`);const L=Gn(A,N);I({dragHandleId:m,dragHandleRect:z.getBoundingClientRect(),initialCursorPosition:L,initialLayout:C})},[]),se=c.useCallback(()=>{I(null)},[]),de=c.useCallback(m=>{const{panelDataArray:N}=k.current,A=Se(N,m);A>=0&&(N.splice(A,1),delete b.current[m.id],k.current.panelDataArrayChanged=!0,y())},[y]),ae=c.useMemo(()=>({collapsePanel:w,direction:r,dragState:S,expandPanel:F,getPanelSize:E,getPanelStyle:P,groupId:x,isPanelCollapsed:D,isPanelExpanded:H,reevaluatePanelConstraints:B,registerPanel:R,registerResizeHandle:M,resizePanel:O,startDragging:K,stopDragging:se,unregisterPanel:de,panelGroupElement:j.current}),[w,S,r,F,E,P,x,D,H,B,R,M,O,K,se,de]),re={display:"flex",flexDirection:r==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return c.createElement(st.Provider,{value:ae},c.createElement(p,{...g,children:n,className:s,id:i,ref:j,style:{...re,...h},[J.group]:"",[J.groupDirection]:r,[J.groupId]:x}))}const Wn=c.forwardRef((e,n)=>c.createElement(Un,{...e,forwardedRef:n}));Un.displayName="PanelGroup";Wn.displayName="forwardRef(PanelGroup)";function Se(e,n){return e.findIndex(s=>s===n||s.id===n.id)}function be(e,n,s){const r=Se(e,n),i=r===e.length-1?[r-1,r]:[r,r+1],l=s[r];return{...n.constraints,panelSize:l,pivotIndices:i}}function Xr({disabled:e,handleId:n,resizeHandler:s,panelGroupElement:r}){c.useEffect(()=>{if(e||s==null||r==null)return;const a=it(n,r);if(a==null)return;const i=l=>{if(!l.defaultPrevented)switch(l.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{l.preventDefault(),s(l);break}case"F6":{l.preventDefault();const o=a.getAttribute(J.groupId);$(o,`No group element found for id "${o}"`);const d=Ve(o,r),h=Fn(o,n,r);$(h!==null,`No resize element found for id "${n}"`);const p=l.shiftKey?h>0?h-1:d.length-1:h+1<d.length?h+1:0;d[p].focus();break}}};return a.addEventListener("keydown",i),()=>{a.removeEventListener("keydown",i)}},[r,e,n,s])}function Jn({children:e=null,className:n="",disabled:s=!1,hitAreaMargins:r,id:a,onBlur:i,onClick:l,onDragging:o,onFocus:d,onPointerDown:h,onPointerUp:p,style:g={},tabIndex:x=0,tagName:j="div",...S}){var I,f;const u=c.useRef(null),y=c.useRef({onClick:l,onDragging:o,onPointerDown:h,onPointerUp:p});c.useEffect(()=>{y.current.onClick=l,y.current.onDragging=o,y.current.onPointerDown=h,y.current.onPointerUp=p});const b=c.useContext(st);if(b===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:v,groupId:T,registerResizeHandle:_,startDragging:k,stopDragging:w,panelGroupElement:F}=b,E=$t(a),[P,D]=c.useState("inactive"),[H,R]=c.useState(!1),[M,O]=c.useState(null),B=c.useRef({state:P});ye(()=>{B.current.state=P}),c.useEffect(()=>{if(s)O(null);else{const ae=_(E);O(()=>ae)}},[s,E,_]);const K=(I=r?.coarse)!==null&&I!==void 0?I:15,se=(f=r?.fine)!==null&&f!==void 0?f:5;c.useEffect(()=>{if(s||M==null)return;const ae=u.current;$(ae,"Element ref not attached");let re=!1;return Lr(E,ae,v,{coarse:K,fine:se},(N,A,C)=>{if(!A){D("inactive");return}switch(N){case"down":{D("drag"),re=!1,$(C,'Expected event to be defined for "down" action'),k(E,C);const{onDragging:z,onPointerDown:L}=y.current;z?.(!0),L?.();break}case"move":{const{state:z}=B.current;re=!0,z!=="drag"&&D("hover"),$(C,'Expected event to be defined for "move" action'),M(C);break}case"up":{D("hover"),w();const{onClick:z,onDragging:L,onPointerUp:V}=y.current;L?.(!1),V?.(),re||z?.();break}}})},[K,v,s,se,_,E,M,k,w]),Xr({disabled:s,handleId:E,resizeHandler:M,panelGroupElement:F});const de={touchAction:"none",userSelect:"none"};return c.createElement(j,{...S,children:e,className:n,id:a,onBlur:()=>{R(!1),i?.()},onFocus:()=>{R(!0),d?.()},ref:u,role:"separator",style:{...de,...g},tabIndex:x,[J.groupDirection]:v,[J.groupId]:T,[J.resizeHandle]:"",[J.resizeHandleActive]:P==="drag"?"pointer":H?"keyboard":void 0,[J.resizeHandleEnabled]:!s,[J.resizeHandleId]:E,[J.resizeHandleState]:P})}Jn.displayName="PanelResizeHandle";const Zr=({className:e,...n})=>t.jsx(Wn,{className:X("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",e),...n}),on=In,ea=({withHandle:e,className:n,...s})=>t.jsx(Jn,{className:X("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",n),...s,children:e&&t.jsx("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:t.jsx(Rs,{className:"h-2.5 w-2.5"})})}),Vt=[{id:"ebp",name:"EBP",path:"School/Evidence Based Practice"},{id:"exphys",name:"ExPhys",path:"School/Exercise Physiology"},{id:"ms1",name:"MS1",path:"School/Movement Science 1"},{id:"neuro",name:"Neuro",path:"School/Neuroscience"},{id:"ti",name:"TI",path:"School/Therapeutic Intervention"}];function ta(){return Vt.map(e=>e.path)}function ln(e,n){try{const s=localStorage.getItem(e);if(s!==null)return JSON.parse(s)}catch{}return n}function gt(e,n){try{localStorage.setItem(e,JSON.stringify(n))}catch{}}function na(){const[e,n]=c.useState(()=>ln("brain-main-mode","edit")),[s,r]=c.useState(null),[a,i]=c.useState(""),[l,o]=c.useState(!1),[d,h]=c.useState(!1),[p,g]=c.useState(!1),[x,j]=c.useState(()=>ln("brain-sidebar-expanded",!0)),[S,I]=c.useState(!1),f=c.useCallback(R=>{n(R),gt("brain-main-mode",R)},[]),u=c.useCallback(R=>{j(R),gt("brain-sidebar-expanded",R)},[]),y=c.useCallback(()=>{j(R=>{const M=!R;return gt("brain-sidebar-expanded",M),M})},[]),{data:b}=Y({queryKey:["obsidian","status"],queryFn:G.obsidian.getStatus,refetchInterval:3e4}),{data:v}=Y({queryKey:["obsidian","config"],queryFn:G.obsidian.getConfig}),{data:T}=Y({queryKey:["obsidian","vault-index"],queryFn:()=>G.obsidian.getVaultIndex(),enabled:b?.connected===!0}),{data:_}=Y({queryKey:["anki","status"],queryFn:G.anki.getStatus,refetchInterval:3e4}),{data:k}=Y({queryKey:["brain","metrics"],queryFn:G.brain.getMetrics}),{data:w=[]}=Y({queryKey:["anki","drafts"],queryFn:G.anki.getDrafts}),F=w.filter(R=>R.status==="pending"),E=c.useCallback(async R=>{try{const M=await G.obsidian.getFile(R);M.success&&M.content!==void 0&&(r(R),i(M.content),o(!1),h(!1))}catch(M){console.error("Failed to load file:",M)}},[]),P=c.useCallback(async()=>{if(s){g(!0);try{(await G.obsidian.saveFile(s,a)).success&&o(!1)}catch(R){console.error("Failed to save file:",R)}finally{g(!1)}}},[s,a]),D=c.useCallback(R=>{i(R),o(!0)},[]),H=c.useCallback(async(R,M)=>{if(M){const B=v?.vaultName||"Treys School";window.open(`obsidian://open?vault=${encodeURIComponent(B)}&file=${encodeURIComponent(R)}`,"_blank");return}const O=T?.paths?.[R];if(O){await E(O),h(!0);return}for(const B of ta())try{const K=await G.obsidian.getFile(`${B}/${R}.md`);if(K.success&&K.content!==void 0){r(`${B}/${R}.md`),i(K.content),o(!1),h(!0);return}}catch{}console.warn(`Note not found: ${R}`)},[v,T,E]);return{mainMode:e,setMainMode:f,currentFile:s,setCurrentFile:r,fileContent:a,setFileContent:D,hasChanges:l,setHasChanges:o,previewMode:d,setPreviewMode:h,isSaving:p,openFile:E,saveFile:P,sidebarExpanded:x,setSidebarExpanded:u,toggleSidebar:y,importOpen:S,setImportOpen:I,handleWikilinkClick:H,obsidianStatus:b,obsidianConfig:v,vaultIndex:T,ankiStatus:_,metrics:k,ankiDrafts:w,pendingDrafts:F}}class ke extends c.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null},this.reset=()=>{this.setState({hasError:!1,error:null})}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,s){console.error("ErrorBoundary caught error:",n,s),this.props.onError?.(n,s)}componentDidUpdate(n){this.state.hasError&&this.props.resetKeys&&this.props.resetKeys.some((r,a)=>r!==n.resetKeys?.[a])&&this.reset()}render(){return this.state.hasError?this.props.fallback?this.props.fallback:t.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center",children:[t.jsx(_t,{className:"w-10 h-10 text-destructive mb-3"}),t.jsx("h3",{className:"font-arcade text-sm text-destructive mb-2",children:"COMPONENT ERROR"}),t.jsx("p",{className:"font-terminal text-xs text-muted-foreground mb-4 max-w-xs",children:this.state.error?.message||"Something went wrong"}),t.jsxs(q,{variant:"outline",size:"sm",onClick:this.reset,className:"rounded-none font-terminal text-xs",children:[t.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Try Again"]})]}):this.props.children}}function sa({onReset:e}){return t.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center",children:[t.jsx(_t,{className:"w-8 h-8 text-destructive mb-2"}),t.jsx("p",{className:"font-terminal text-xs text-destructive mb-2",children:"Sidebar Error"}),t.jsxs(q,{variant:"ghost",size:"sm",onClick:e,className:"rounded-none font-terminal text-xs h-6",children:[t.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Retry"]})]})}function _e({tabName:e,onReset:n}){return t.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center",children:[t.jsx(_t,{className:"w-10 h-10 text-destructive mb-3"}),t.jsxs("h3",{className:"font-arcade text-sm text-destructive mb-2",children:[e," TAB ERROR"]}),t.jsxs("p",{className:"font-terminal text-xs text-muted-foreground mb-4",children:["Failed to load ",e.toLowerCase()," view"]}),t.jsxs(q,{variant:"outline",size:"sm",onClick:n,className:"rounded-none font-terminal text-xs",children:[t.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Reload Tab"]})]})}const ra=12,aa=16;function Yn({name:e,isFolder:n,isExpanded:s,isActive:r,depth:a,onClick:i}){return t.jsxs("button",{type:"button",onClick:i,className:`w-full flex items-center gap-2 py-2 font-terminal text-sm text-left transition-colors duration-150 focus:outline-none focus-visible:ring-1 focus-visible:ring-primary/50 focus-visible:ring-inset min-h-[36px] ${r?"bg-primary/15 text-primary border-l-2 border-primary/60":"border-l-2 border-transparent hover:bg-primary/10 text-foreground"}`,style:{paddingLeft:`${ra+a*aa}px`},children:[n?t.jsxs(t.Fragment,{children:[s?t.jsx($s,{className:"w-3.5 h-3.5 text-muted-foreground shrink-0","aria-hidden":"true"}):t.jsx(Fs,{className:"w-3.5 h-3.5 text-muted-foreground shrink-0","aria-hidden":"true"}),t.jsx(mr,{className:"w-4 h-4 text-yellow-500 shrink-0","aria-hidden":"true"})]}):t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"w-3.5 shrink-0"}),t.jsx(dr,{className:"w-4 h-4 text-blue-400 shrink-0","aria-hidden":"true"})]}),t.jsx("span",{className:"truncate min-w-0",children:e})]})}function Qn({folderPath:e,depth:n,expandedFolders:s,toggleFolder:r,workspace:a,connected:i}){const{data:l}=Y({queryKey:["obsidian","files",e],queryFn:()=>G.obsidian.getFiles(e),enabled:i}),o=l?.files||[];return t.jsx(t.Fragment,{children:o.map(d=>{const h=typeof d=="string"?d:d.path,p=h.endsWith("/"),g=h.replace(/\/$/,"").split("/").pop()||h,x=`${e}/${g}`,j=s.has(x);return t.jsxs("div",{children:[t.jsx(Yn,{name:g,isFolder:p,isExpanded:j,isActive:a.currentFile?.endsWith(g)||!1,depth:n,onClick:()=>{p?r(x):a.openFile(x)}}),p&&j&&t.jsx(Qn,{folderPath:x,depth:n+1,expandedFolders:s,toggleFolder:r,workspace:a,connected:i})]},h)})})}function cn({workspace:e,onCollapse:n}){const[s,r]=c.useState("School"),[a,i]=c.useState(""),[l,o]=c.useState(new Set),[d,h]=c.useState(0),p=e.obsidianStatus?.connected===!0,{data:g}=Y({queryKey:["obsidian","files",s],queryFn:()=>G.obsidian.getFiles(s),enabled:p}),x=c.useCallback(b=>{r(b),o(new Set)},[]),j=c.useCallback(()=>{const b=s.split("/");b.pop(),x(b.join("/"))},[s,x]),S=c.useCallback(b=>{o(v=>{const T=new Set(v);return T.has(b)?T.delete(b):T.add(b),T})},[]),I=c.useCallback(()=>{const b=new Date().toISOString().split("T")[0],v=s?`${s}/Session-${b}.md`:`Session-${b}.md`,T=`# Study Session - ${b}

## Summary


## Concepts Covered
- 

## Notes

`;e.setCurrentFile(v),e.setFileContent(T),e.setHasChanges(!0)},[s,e]),f=c.useMemo(()=>{const b=g?.files||[];if(!a.trim())return b;const v=a.toLowerCase();return b.filter(T=>(typeof T=="string"?T:T.path).toLowerCase().includes(v))},[g,a]),u=s.includes("/"),y=c.useMemo(()=>s?s.split("/"):[],[s]);return p?t.jsxs("div",{className:"flex flex-col h-full min-h-0 overflow-hidden",children:[t.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-primary/20 shrink-0",children:[t.jsx("h2",{className:"section-header",children:"Vault"}),n&&t.jsx("button",{type:"button",onClick:n,className:"size-7 flex items-center justify-center rounded-sm hover:bg-primary/20 hover:text-primary text-muted-foreground",title:"Collapse sidebar","aria-label":"Collapse sidebar",children:t.jsx(Qt,{className:"w-4 h-4","aria-hidden":"true"})})]}),t.jsxs("div",{className:"section-block section-block-gap",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Sn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none","aria-hidden":"true"}),t.jsx(Ce,{value:a,onChange:b=>i(b.target.value),placeholder:"Search filesâ€¦",className:"h-9 pl-9 pr-3 text-sm font-terminal rounded-none border border-primary/20 bg-black/40 placeholder:text-muted-foreground/80 focus-visible:ring-1 focus-visible:ring-primary/60 focus-visible:border-primary/40","aria-label":"Search files"})]}),t.jsxs(q,{size:"sm",variant:"ghost",className:"w-full h-9 text-sm font-terminal rounded-none border border-primary/20 bg-black/30 text-foreground hover:bg-primary/10 hover:border-primary/40 hover:text-primary justify-start gap-2",onClick:I,children:[t.jsx(nt,{className:"w-4 h-4 shrink-0","aria-hidden":"true"}),"New Note"]})]}),t.jsxs("div",{className:"section-block section-block-gap",children:[t.jsx("h3",{className:"section-header",children:"Courses"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:Vt.map(b=>{const v=s===b.path;return t.jsx("button",{type:"button",onClick:()=>x(b.path),className:`min-h-[36px] px-4 py-2 font-arcade text-xs tracking-wider rounded-none border-2 transition-colors focus:outline-none focus-visible:ring-1 focus-visible:ring-primary/50 focus-visible:ring-offset-1 focus-visible:ring-offset-black ${v?"bg-primary text-primary-foreground border-primary":"border-primary/40 bg-black/50 text-primary/80 hover:bg-primary/20 hover:border-primary/60 hover:text-primary"}`,"aria-pressed":v,children:b.name},b.path)})})]}),s&&t.jsxs("div",{className:"flex items-center gap-2 px-3 py-2.5 font-arcade text-xs border-b border-primary/20 bg-black/30 shrink-0 min-h-[40px]",children:[u&&t.jsx("button",{type:"button",onClick:j,className:"size-8 flex items-center justify-center rounded-sm hover:bg-primary/20 hover:text-primary focus:outline-none focus-visible:ring-1 focus-visible:ring-primary shrink-0",title:"Go to parent folder","aria-label":"Go to parent folder",children:t.jsx(Ts,{className:"w-4 h-4","aria-hidden":"true"})}),t.jsx("nav",{"aria-label":"Folder breadcrumb",className:"flex items-center gap-1 flex-wrap text-primary/80 min-w-0",children:y.map((b,v,T)=>t.jsxs("span",{className:"flex items-center gap-1",children:[v>0&&t.jsx("span",{"aria-hidden":"true",className:"text-primary/40",children:"/"}),t.jsx("button",{type:"button",onClick:()=>x(T.slice(0,v+1).join("/")),className:"hover:text-primary focus:outline-none focus-visible:ring-1 focus-visible:ring-primary focus-visible:ring-inset rounded-sm px-1.5 py-1 min-h-[28px] flex items-center tracking-wider uppercase",children:b})]},v))})]}),t.jsxs("div",{className:"flex-1 min-h-0 flex flex-col",children:[t.jsx("div",{className:"shrink-0 px-3 py-2 border-b border-primary/20",children:t.jsx("span",{className:"section-header text-primary/90",children:"Files"})}),t.jsx(ke,{fallback:t.jsx(sa,{onReset:()=>h(b=>b+1)}),children:t.jsx($e,{className:"flex-1 min-h-0",children:t.jsx("div",{className:"py-2",children:f.map(b=>{const v=typeof b=="string"?b:b.path,T=v.endsWith("/"),_=v.replace(/\/$/,"").split("/").pop()||v,k=s?`${s}/${_}`:_,w=l.has(k),F=e.currentFile?.endsWith(_)||!1;return t.jsxs("div",{children:[t.jsx(Yn,{name:_,isFolder:T,isExpanded:w,isActive:F,depth:0,onClick:()=>{T?S(k):e.openFile(k)}}),T&&w&&t.jsx(Qn,{folderPath:k,depth:1,expandedFolders:l,toggleFolder:S,workspace:e,connected:p})]},v)})})})},`filetree-${d}`)]})]}):t.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[t.jsxs("div",{className:"section-block border-primary/30 flex items-center justify-between",children:[t.jsx("h2",{className:"section-header",children:"Vault"}),n&&t.jsx("button",{type:"button",onClick:n,className:"size-7 flex items-center justify-center rounded-sm hover:bg-primary/20 hover:text-primary text-muted-foreground",title:"Collapse sidebar","aria-label":"Collapse sidebar",children:t.jsx(Qt,{className:"w-4 h-4","aria-hidden":"true"})})]}),t.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-3 py-6 border border-primary/30 bg-black/30 m-3",children:[t.jsx(Nn,{className:"w-8 h-8 text-primary/80 mb-3","aria-hidden":"true"}),t.jsx("p",{className:"font-arcade text-sm text-primary/90 text-center",children:"Obsidian offline"}),t.jsx("p",{className:"font-terminal text-sm text-muted-foreground text-center mt-2",children:"Open Obsidian with Local REST API enabled"})]})]})}function ia({onExpand:e,workspace:n}){return t.jsxs("div",{className:"brain-sidebar-rail","aria-label":"Sidebar rail",children:[t.jsx("button",{type:"button",onClick:e,className:"brain-sidebar-rail__btn",title:"Expand sidebar","aria-label":"Expand sidebar",children:t.jsx(Ds,{className:"w-4 h-4","aria-hidden":"true"})}),t.jsx("button",{type:"button",onClick:e,className:"brain-sidebar-rail__btn",title:"Search files","aria-label":"Search files",children:t.jsx(Sn,{className:"w-4 h-4","aria-hidden":"true"})}),t.jsx("button",{type:"button",onClick:()=>{const s=new Date().toISOString().split("T")[0];n.setCurrentFile(`School/Session-${s}.md`),n.setFileContent(`# Study Session - ${s}

## Summary


## Concepts Covered
- 

## Notes

`),n.setHasChanges(!0)},className:"brain-sidebar-rail__btn",title:"New note","aria-label":"New note",children:t.jsx(nt,{className:"w-4 h-4","aria-hidden":"true"})}),t.jsx("div",{className:"w-6 h-px bg-primary/30 my-1"}),Vt.map(s=>t.jsx("button",{type:"button",onClick:e,className:"brain-sidebar-rail__course",title:s.name,"aria-label":s.name,children:s.name.charAt(0)},s.id))]})}const oa=`Generate Anki flashcards from the following study material. Output ONLY a numbered list in this exact format:

1. Front: [question]
Back: [answer]
Tags: [comma-separated tags like: Module1, Obj2, TopicName]

Rules:
- Front = the question only (no module/objective prefixes)
- Back = concise answer
- Tags = include Module#, Obj#, and topic keywords
- One card per concept
- No extra text before or after the list

Study material:
[PASTE YOUR NOTES HERE]`;function dn(e,n){if(n.length===0)return e;const s=[];for(const r of n)s.push({type:"image_url",image_url:{url:r}});return e.trim()&&s.push({type:"text",text:e}),s}function la({mode:e,setMode:n,ingestTarget:s,setIngestTarget:r,promptCopied:a,setPromptCopied:i}){const l=()=>{navigator.clipboard.writeText(oa),i(!0),setTimeout(()=>i(!1),2e3)};return t.jsxs("div",{className:"px-3 py-1 border-b border-primary/30 flex items-center justify-between gap-2 shrink-0",children:[t.jsxs("div",{className:"flex bg-black/40 border border-primary/40 rounded-none overflow-hidden mr-2",children:[t.jsxs("button",{onClick:()=>n("chat"),className:`flex items-center gap-1 px-2 py-0.5 text-xs font-arcade transition-colors ${e==="chat"?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,children:[t.jsx(kn,{className:"w-3 h-3"})," CHAT"]}),t.jsxs("button",{onClick:()=>n("ingest"),className:`flex items-center gap-1 px-2 py-0.5 text-xs font-arcade transition-colors ${e==="ingest"?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,children:[t.jsx(nr,{className:"w-3 h-3"})," INGEST"]})]}),t.jsx("p",{className:"text-xs text-muted-foreground truncate flex-1",children:e==="chat"?"Chat with Gemini Flash":"Paste notes to create cards & save sessions"}),e==="ingest"&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex bg-black/40 border border-primary/40 rounded-none overflow-hidden shrink-0",children:["anki","obsidian","both"].map(o=>t.jsxs("button",{onClick:()=>r(o),className:`flex items-center gap-1 px-2 py-0.5 text-xs font-arcade transition-colors ${s===o?"bg-primary text-black":"text-muted-foreground hover:text-foreground"}`,children:[o==="anki"&&t.jsxs(t.Fragment,{children:[t.jsx(Fe,{className:"w-3 h-3"})," ANKI"]}),o==="obsidian"&&t.jsxs(t.Fragment,{children:[t.jsx(St,{className:"w-3 h-3"})," OBSIDIAN"]}),o==="both"&&t.jsx(t.Fragment,{children:"BOTH"})]},o))}),t.jsx("button",{type:"button",className:"bg-primary hover:bg-primary/80 px-2 py-0.5 rounded-none text-xs font-terminal shrink-0",onClick:l,children:a?"Copied!":"Copy Prompt"})]})]})}function ca({messages:e,loading:n,mode:s,scrollRef:r}){const a=c.useCallback(()=>{r.current&&(r.current.scrollTop=r.current.scrollHeight)},[r]);return c.useEffect(()=>{a()},[e,a]),t.jsxs("div",{ref:r,className:"flex-1 overflow-y-auto px-4 py-2 space-y-3",children:[e.length===0&&t.jsx("p",{className:"text-muted-foreground text-sm font-terminal text-center py-8",children:s==="chat"?"Ask anything. Paste screenshots with Ctrl+V.":"Paste your study notes to ingest into Brain."}),e.map((i,l)=>t.jsx("div",{className:`flex ${i.role==="user"?"justify-end":"justify-start"}`,children:t.jsxs("div",{className:`max-w-[80%] rounded-none px-3 py-2 text-sm font-terminal whitespace-pre-wrap ${i.role==="user"?"bg-primary/20 text-foreground border border-primary/30":"bg-secondary/40 text-foreground border border-secondary/60"}`,children:[i.images?.map((o,d)=>t.jsx("img",{src:o,alt:"attached",className:"max-h-32 rounded-none mb-1"},d)),i.content]})},l)),n&&t.jsx("div",{className:"flex justify-start",children:t.jsx("div",{className:"bg-secondary/40 border border-secondary/60 rounded-none px-3 py-2",children:t.jsx(Lt,{className:"w-4 h-4 animate-spin text-primary"})})})]})}function da({images:e,onRemove:n}){return e.length===0?null:t.jsx("div",{className:"px-4 py-1 flex gap-2 flex-wrap shrink-0",children:e.map((s,r)=>t.jsxs("div",{className:"relative",children:[t.jsx("img",{src:s,alt:"pending",className:"h-12 rounded-none border border-primary/30"}),t.jsx("button",{onClick:()=>n(r),className:"absolute -top-1 -right-1 bg-destructive rounded-none p-0.5","aria-label":"Remove image",children:t.jsx(Nt,{className:"w-3 h-3"})})]},r))})}function ua({input:e,setInput:n,onSend:s,onImageSelect:r,onPaste:a,loading:i,mode:l}){const o=c.useRef(null),d=p=>{p.key==="Enter"&&!p.shiftKey&&(p.preventDefault(),s())},h=p=>{const g=p.target.files;g&&(r(g),p.target.value="")};return t.jsxs("div",{className:"flex items-end gap-2 px-4 py-2 border-t border-primary/30 shrink-0",children:[t.jsx("input",{ref:o,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:h}),l==="chat"&&t.jsx(q,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 shrink-0",onClick:()=>o.current?.click(),"aria-label":"Attach image",children:t.jsx(hr,{className:"w-4 h-4 text-primary"})}),t.jsx("textarea",{value:e,onChange:p=>n(p.target.value),onKeyDown:d,onPaste:a,placeholder:l==="chat"?"Ask anything... (Ctrl+V to paste images)":"Paste study notes to ingest...",rows:l==="ingest"?3:1,className:"flex-1 bg-black/60 border-2 border-muted-foreground/20 rounded-none px-3 py-1.5 text-sm font-terminal resize-none focus:outline-none focus:ring-1 focus:ring-ring"}),t.jsx(q,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 shrink-0",onClick:s,disabled:i,"aria-label":"Send message",children:t.jsx(Us,{className:"w-4 h-4 text-primary"})})]})}function Ct(e,n,{checkForDefaultPrevented:s=!0}={}){return function(a){if(e?.(a),s===!1||!a.defaultPrevented)return n?.(a)}}var ma=wn[" useInsertionEffect ".trim().toString()]||Cs;function fa({prop:e,defaultProp:n,onChange:s=()=>{},caller:r}){const[a,i,l]=ha({defaultProp:n,onChange:s}),o=e!==void 0,d=o?e:a;{const p=c.useRef(e!==void 0);c.useEffect(()=>{const g=p.current;g!==o&&console.warn(`${r} is changing from ${g?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),p.current=o},[o,r])}const h=c.useCallback(p=>{if(o){const g=pa(p)?p(e):p;g!==e&&l.current?.(g)}else i(p)},[o,e,i,l]);return[d,h]}function ha({defaultProp:e,onChange:n}){const[s,r]=c.useState(e),a=c.useRef(s),i=c.useRef(n);return ma(()=>{i.current=n},[n]),c.useEffect(()=>{a.current!==s&&(i.current?.(s),a.current=s)},[s,a]),[s,r,i]}function pa(e){return typeof e=="function"}var Gt="Radio",[xa,Xn]=jn(Gt),[ba,ga]=xa(Gt),Zn=c.forwardRef((e,n)=>{const{__scopeRadio:s,name:r,checked:a=!1,required:i,disabled:l,value:o="on",onCheck:d,form:h,...p}=e,[g,x]=c.useState(null),j=Pt(n,f=>x(f)),S=c.useRef(!1),I=g?h||!!g.closest("form"):!0;return t.jsxs(ba,{scope:s,checked:a,disabled:l,children:[t.jsx(Ze.button,{type:"button",role:"radio","aria-checked":a,"data-state":ss(a),"data-disabled":l?"":void 0,disabled:l,value:o,...p,ref:j,onClick:Ct(e.onClick,f=>{a||d?.(),I&&(S.current=f.isPropagationStopped(),S.current||f.stopPropagation())})}),I&&t.jsx(ns,{control:g,bubbles:!S.current,name:r,value:o,checked:a,required:i,disabled:l,form:h,style:{transform:"translateX(-100%)"}})]})});Zn.displayName=Gt;var es="RadioIndicator",ts=c.forwardRef((e,n)=>{const{__scopeRadio:s,forceMount:r,...a}=e,i=ga(es,s);return t.jsx(Es,{present:r||i.checked,children:t.jsx(Ze.span,{"data-state":ss(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:n})})});ts.displayName=es;var ya="RadioBubbleInput",ns=c.forwardRef(({__scopeRadio:e,control:n,checked:s,bubbles:r=!0,...a},i)=>{const l=c.useRef(null),o=Pt(l,i),d=Hs(s),h=Ps(n);return c.useEffect(()=>{const p=l.current;if(!p)return;const g=window.HTMLInputElement.prototype,j=Object.getOwnPropertyDescriptor(g,"checked").set;if(d!==s&&j){const S=new Event("click",{bubbles:r});j.call(p,s),p.dispatchEvent(S)}},[d,s,r]),t.jsx(Ze.input,{type:"radio","aria-hidden":!0,defaultChecked:s,...a,tabIndex:-1,ref:o,style:{...a.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});ns.displayName=ya;function ss(e){return e?"checked":"unchecked"}var va=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ot="RadioGroup",[wa]=jn(ot,[Cn,Xn]),rs=Cn(),as=Xn(),[ja,Na]=wa(ot),is=c.forwardRef((e,n)=>{const{__scopeRadioGroup:s,name:r,defaultValue:a,value:i,required:l=!1,disabled:o=!1,orientation:d,dir:h,loop:p=!0,onValueChange:g,...x}=e,j=rs(s),S=Is(h),[I,f]=fa({prop:i,defaultProp:a??null,onChange:g,caller:ot});return t.jsx(ja,{scope:s,name:r,required:l,disabled:o,value:I,onValueChange:f,children:t.jsx(Vs,{asChild:!0,...j,orientation:d,dir:S,loop:p,children:t.jsx(Ze.div,{role:"radiogroup","aria-required":l,"aria-orientation":d,"data-disabled":o?"":void 0,dir:S,...x,ref:n})})})});is.displayName=ot;var os="RadioGroupItem",ls=c.forwardRef((e,n)=>{const{__scopeRadioGroup:s,disabled:r,...a}=e,i=Na(os,s),l=i.disabled||r,o=rs(s),d=as(s),h=c.useRef(null),p=Pt(n,h),g=i.value===a.value,x=c.useRef(!1);return c.useEffect(()=>{const j=I=>{va.includes(I.key)&&(x.current=!0)},S=()=>x.current=!1;return document.addEventListener("keydown",j),document.addEventListener("keyup",S),()=>{document.removeEventListener("keydown",j),document.removeEventListener("keyup",S)}},[]),t.jsx(Gs,{asChild:!0,...o,focusable:!l,active:g,children:t.jsx(Zn,{disabled:l,required:i.required,checked:g,...d,...a,name:i.name,ref:p,onCheck:()=>i.onValueChange(a.value),onKeyDown:Ct(j=>{j.key==="Enter"&&j.preventDefault()}),onFocus:Ct(a.onFocus,()=>{x.current&&h.current?.click()})})})});ls.displayName=os;var Sa="RadioGroupIndicator",cs=c.forwardRef((e,n)=>{const{__scopeRadioGroup:s,...r}=e,a=as(s);return t.jsx(ts,{...a,...r,ref:n})});cs.displayName=Sa;var ds=is,us=ls,ka=cs;const ms=c.forwardRef(({className:e,...n},s)=>t.jsx(ds,{className:X("grid gap-2",e),...n,ref:s}));ms.displayName=ds.displayName;const fs=c.forwardRef(({className:e,...n},s)=>t.jsx(us,{ref:s,className:X("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),...n,children:t.jsx(ka,{className:"flex items-center justify-center",children:t.jsx(Ms,{className:"h-3.5 w-3.5 fill-primary"})})}));fs.displayName=us.displayName;const Ca=/(\[\[.*?\]\])/g,Ea=/!\[\[(.*?)\]\]/g,Pa=[".png",".jpg",".jpeg",".gif",".svg",".webp",".bmp"],Ra=/^\[!([\w-]+)\]\s*(.*)?$/,un=Ws;function yt(e,n){return e.split(Ca).map((s,r)=>{const a=s.match(/^\[\[(.*?)\]\]$/);if(a){const i=a[1].includes("|")?a[1].split("|")[1]:a[1],l=a[1].includes("|")?a[1].split("|")[0]:a[1];return t.jsx("span",{className:"text-blue-400 hover:text-blue-300 cursor-pointer underline decoration-dotted",onClick:o=>n?.(l,o.shiftKey),title:`${l} (Shift+click for Obsidian app)`,children:i},r)}return t.jsx("span",{children:s},r)})}function Ia(e){return e.replace(Ea,(n,s)=>{const r=s.toLowerCase();return Pa.some(i=>r.endsWith(i))?`![${s}](/api/obsidian/vault-file/${encodeURIComponent(s)})`:`[[${s}]]`})}function za(e){const n=e.split(`
`),s=[];let r=!1,a="",i="",l=[];const o=()=>{if(!r)return;const d=un[a.toLowerCase()]||un.note,h=i||a.charAt(0).toUpperCase()+a.slice(1);s.push(`<div class="callout ${d} border-l-4 rounded px-3 py-2 my-2">`),s.push(`<div class="font-bold text-xs uppercase tracking-wider mb-1">${h}</div>`),s.push(""),s.push(l.join(`
`)),s.push(""),s.push("</div>"),r=!1,l=[]};for(const d of n){if(d.startsWith("> ")){const h=d.slice(2),p=h.match(Ra);if(p&&!r){r=!0,a=p[1],i=p[2]||"";continue}if(r){l.push(h);continue}}else if(d===">"&&r){l.push("");continue}else o();s.push(d)}return o(),s.join(`
`)}function hs({content:e,onWikilinkClick:n}){const s=za(Ia(e)),r={h1:({children:a})=>t.jsx("h1",{className:"text-xl font-bold text-primary border-b border-primary/30 pb-1 mb-3 mt-4",children:a}),h2:({children:a})=>t.jsx("h2",{className:"text-lg font-bold text-primary/90 border-b border-primary/20 pb-1 mb-2 mt-3",children:a}),h3:({children:a})=>t.jsx("h3",{className:"text-base font-semibold text-primary/80 mb-2 mt-3",children:a}),h4:({children:a})=>t.jsx("h4",{className:"text-sm font-semibold text-primary/70 mb-1 mt-2",children:a}),p:({children:a})=>typeof a=="string"?t.jsx("p",{className:"mb-2 leading-relaxed",children:yt(a,n)}):t.jsx("p",{className:"mb-2 leading-relaxed",children:a}),strong:({children:a})=>t.jsx("strong",{className:"font-bold text-foreground",children:a}),em:({children:a})=>t.jsx("em",{className:"italic text-foreground/90",children:a}),ul:({children:a})=>t.jsx("ul",{className:"list-disc list-inside mb-2 space-y-0.5 ml-2",children:a}),ol:({children:a})=>t.jsx("ol",{className:"list-decimal list-inside mb-2 space-y-0.5 ml-2",children:a}),li:({children:a})=>typeof a=="string"?t.jsx("li",{className:"leading-relaxed",children:yt(a,n)}):t.jsx("li",{className:"leading-relaxed",children:a}),blockquote:({children:a})=>t.jsx("blockquote",{className:"border-l-4 border-primary/30 pl-3 my-2 text-muted-foreground italic",children:a}),code:({children:a,className:i})=>i?.startsWith("language-")?t.jsx("code",{className:"block bg-black/80 border border-secondary/40 rounded p-3 my-2 text-xs font-mono overflow-x-auto whitespace-pre",children:a}):t.jsx("code",{className:"bg-secondary/40 px-1.5 py-0.5 rounded text-xs font-mono text-primary",children:a}),pre:({children:a})=>t.jsx("pre",{className:"my-2",children:a}),hr:()=>t.jsx("hr",{className:"border-primary/20 my-4"}),a:({href:a,children:i})=>t.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:i}),table:({children:a})=>t.jsx("div",{className:"overflow-x-auto my-2",children:t.jsx("table",{className:"w-full text-xs border-collapse border border-secondary/40",children:a})}),th:({children:a})=>t.jsx("th",{className:"border border-secondary/40 bg-secondary/20 px-2 py-1 text-left font-semibold",children:a}),td:({children:a})=>typeof a=="string"?t.jsx("td",{className:"border border-secondary/40 px-2 py-1",children:yt(a,n)}):t.jsx("td",{className:"border border-secondary/40 px-2 py-1",children:a}),img:({src:a,alt:i})=>t.jsx("img",{src:a,alt:i||"",className:"max-w-full rounded border border-secondary/40 my-2",loading:"lazy"}),del:({children:a})=>t.jsx("del",{className:"line-through text-muted-foreground",children:a}),input:({checked:a,...i})=>t.jsx("input",{type:"checkbox",checked:a,readOnly:!0,className:"mr-1.5 accent-primary",...i})};return t.jsx("div",{className:"obsidian-preview prose-invert max-w-none text-sm leading-relaxed",children:t.jsx(_s,{remarkPlugins:[Ls],components:r,allowedElements:void 0,unwrapDisallowed:!1,children:s})})}function Aa({line:e,index:n}){const s=e.startsWith("+"),r=e.startsWith("-");return t.jsx("div",{className:`font-terminal text-sm px-2 ${s?"bg-green-900/30 text-green-400":r?"bg-red-900/30 text-red-400":"text-muted-foreground"}`,children:e})}function Ta({open:e,onOpenChange:n,loading:s,error:r,rawNotes:a,organized:i,destination:l,selectedDestinationId:o,setSelectedDestinationId:d,customDestination:h,setCustomDestination:p,checklistState:g,onToggleChecklist:x,diffLines:j,onConfirm:S,onCancel:I}){const f=Object.values(g).length===0?!0:Object.values(g).every(Boolean),y=l?o==="custom"?h.trim():l.options.find(v=>v.id===o)?.path||"":"";return t.jsx(It,{open:e,onOpenChange:n,children:t.jsxs(zt,{className:"max-w-6xl w-full h-[85vh] bg-black border-2 border-primary rounded-none p-4 overflow-hidden",children:[t.jsxs(At,{className:"space-y-1",children:[t.jsxs(Tt,{className:"font-arcade text-sm text-primary flex items-center gap-2",children:[t.jsx(nt,{className:"w-4 h-4"}),"ORGANIZE + REVIEW"]}),t.jsx(Mt,{className:"font-terminal text-sm text-muted-foreground",children:"Review the organized notes, compare to raw, then choose where to save."})]}),r&&t.jsx("div",{className:"border border-red-500/50 bg-red-900/20 text-red-200 font-terminal text-xs p-2 rounded-none",children:r}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 h-[70vh]",children:[t.jsx("div",{className:"col-span-2 flex flex-col gap-3",children:t.jsxs(Bs,{defaultValue:"preview",className:"w-full",children:[t.jsxs(qs,{className:"grid grid-cols-3 rounded-none",children:[t.jsx(ut,{value:"preview",className:"rounded-none text-xs",children:"Preview"}),t.jsx(ut,{value:"raw",className:"rounded-none text-xs",children:"Raw"}),t.jsx(ut,{value:"diff",className:"rounded-none text-xs",children:"Diff"})]}),t.jsx(mt,{value:"preview",className:"mt-2",children:t.jsx($e,{className:"h-[56vh] border border-secondary/40 rounded-none bg-black/40 p-3",children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"font-arcade text-xs text-primary",children:i?.title||"Untitled"}),t.jsx(hs,{content:i?.markdown||""})]})})}),t.jsx(mt,{value:"raw",className:"mt-2",children:t.jsx($e,{className:"h-[56vh] border border-secondary/40 rounded-none bg-black/40 p-3",children:t.jsx("pre",{className:"whitespace-pre-wrap font-terminal text-sm text-foreground",children:a})})}),t.jsx(mt,{value:"diff",className:"mt-2",children:t.jsx($e,{className:"h-[56vh] border border-secondary/40 rounded-none bg-black/40 p-0",children:t.jsx("div",{className:"p-2",children:j.length===0?t.jsx("div",{className:"text-muted-foreground font-terminal text-xs",children:"No diff available."}):j.map((b,v)=>t.jsx(Aa,{line:b,index:v},v))})})})]})}),t.jsxs("div",{className:"col-span-1 flex flex-col gap-3",children:[t.jsxs("div",{className:"border border-secondary/50 bg-black/40 p-3 rounded-none",children:[t.jsx("div",{className:"font-arcade text-xs text-primary mb-2",children:"DESTINATION"}),t.jsx(ms,{value:o,onValueChange:d,className:"space-y-2",children:(l?.options||[]).map(b=>t.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[t.jsx(fs,{value:b.id,className:"mt-1"}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"font-terminal text-sm text-foreground flex items-center gap-1",children:[b.label,b.exists&&t.jsx(We,{variant:"outline",className:"text-xs",children:"existing"})]}),t.jsx("div",{className:"font-terminal text-xs text-muted-foreground break-all",children:b.path||"Custom path"})]})]},b.id))}),o==="custom"&&t.jsxs("div",{className:"mt-2 space-y-1",children:[t.jsx("div",{className:"font-terminal text-xs text-muted-foreground",children:"Custom path"}),t.jsx(Ce,{value:h,onChange:b=>p(b.target.value),placeholder:"School/Therapeutic Intervention/Module 01 - Title.md",className:"bg-black border-secondary/60 rounded-none text-xs font-terminal"})]})]}),t.jsxs("div",{className:"border border-secondary/50 bg-black/40 p-3 rounded-none",children:[t.jsx("div",{className:"font-arcade text-xs text-primary mb-2",children:"REVIEW CHECKLIST"}),t.jsx("div",{className:"space-y-2",children:(i?.checklist||[]).map(b=>t.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[t.jsx(En,{checked:!!g[b],onCheckedChange:()=>x(b)}),t.jsx("span",{className:"font-terminal text-sm text-foreground",children:b})]},b))})]}),(i?.suggested_links||[]).length>0&&t.jsxs("div",{className:"border border-secondary/50 bg-black/40 p-3 rounded-none",children:[t.jsx("div",{className:"font-arcade text-xs text-primary mb-2",children:"SUGGESTED LINKS"}),t.jsx("div",{className:"space-y-1",children:i?.suggested_links?.map(b=>t.jsxs("div",{className:"font-terminal text-sm text-muted-foreground",children:["[[",b,"]]"]},b))})]}),t.jsxs("div",{className:"flex gap-2 mt-auto",children:[t.jsx(q,{variant:"outline",className:"flex-1 rounded-none font-terminal text-xs",onClick:I,disabled:s,children:"Cancel"}),t.jsxs(q,{className:"flex-1 bg-primary hover:bg-primary/80 rounded-none font-terminal text-xs",onClick:S,disabled:!f||s||!y,children:[t.jsx(Ks,{className:"w-3 h-3 mr-1"}),s?"Saving...":"Confirm & Save"]})]})]})]})]})})}function Ma(){const[e,n]=c.useState(!1),[s,r]=c.useState(!1),[a,i]=c.useState(null),[l,o]=c.useState(""),[d,h]=c.useState(null),[p,g]=c.useState(null),[x,j]=c.useState(""),[S,I]=c.useState(""),[f,u]=c.useState({}),[y,b]=c.useState([]),v=(E,P)=>{const D=E.split(`
`),H=P.split(`
`),R=[];let M=0,O=0;for(;M<D.length||O<H.length;){const B=D[M],K=H[O];if(M<D.length&&O<H.length&&B===K){R.push(` ${B}`),M+=1,O+=1;continue}M<D.length&&(R.push(`-${B}`),M+=1),O<H.length&&(R.push(`+${K}`),O+=1)}return R},T=c.useCallback(()=>{n(!1),r(!1),i(null),o(""),h(null),g(null),j(""),I(""),u({}),b([])},[]),_=c.useCallback(async E=>{r(!0),i(null),o(E);try{const P=await G.brain.organizePreview(E);if(!P.success||!P.organized||!P.destination)throw new Error(P.error||"Unable to organize notes.");h(P.organized),g(P.destination),j("recommended");const D=P.organized.checklist??[],H={};return D.forEach(R=>{H[R]=!1}),u(H),b(v(E,P.organized.markdown||"")),n(!0),!0}catch(P){const D=P instanceof Error?P.message:String(P);return i(D),!1}finally{r(!1)}},[]),k=c.useCallback(E=>{u(P=>({...P,[E]:!P[E]}))},[]),w=c.useCallback(()=>p?x==="custom"?S.trim():p.options.find(P=>P.id===x)?.path||"":"",[p,x,S]),F=Object.values(f).length===0?!0:Object.values(f).every(Boolean);return{open:e,setOpen:n,loading:s,error:a,rawNotes:l,organized:d,destination:p,selectedDestinationId:x,setSelectedDestinationId:j,customDestination:S,setCustomDestination:I,checklistState:f,diffLines:y,allChecklistChecked:F,reset:T,startPreview:_,toggleChecklist:k,getSelectedDestinationPath:w}}function Da(){const[e,n]=c.useState("chat"),[s,r]=c.useState([]),[a,i]=c.useState(""),[l,o]=c.useState([]),[d,h]=c.useState(!1),[p,g]=c.useState("anki"),[x,j]=c.useState(!1),S=c.useRef(null),I=et(),{toast:f}=tt(),u=Ma(),y=c.useCallback(E=>{const P=new FileReader;P.onload=()=>{typeof P.result=="string"&&o(D=>[...D,P.result])},P.readAsDataURL(E)},[]),b=c.useCallback(E=>{const P=E.clipboardData?.items;if(P){for(const D of Array.from(P))if(D.type.startsWith("image/")){E.preventDefault();const H=D.getAsFile();H&&y(H)}}},[y]),v=c.useCallback(E=>{for(const P of Array.from(E))P.type.startsWith("image/")&&y(P)},[y]),T=c.useCallback(E=>{o(P=>P.filter((D,H)=>H!==E))},[]),_=c.useCallback(async(E,P)=>{r(B=>[...B,{role:"assistant",content:""}]);const D=s.map(B=>({role:B.role,content:B.images?.length?dn(B.content,B.images):B.content})).concat([{role:"user",content:dn(E,P)}]),R=(await fetch("/api/brain/quick-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:D})})).body?.getReader(),M=new TextDecoder;if(!R)throw new Error("No response body");let O="";for(;;){const{done:B,value:K}=await R.read();if(B)break;O+=M.decode(K,{stream:!0});const se=O.split(`
`);O=se.pop()??"";for(const de of se){if(!de.startsWith("data: "))continue;const ae=de.slice(6);if(ae==="[DONE]")break;try{const re=JSON.parse(ae);if(re.error){r(m=>{const N=[...m];return N[N.length-1]={role:"assistant",content:`Error: ${re.error}`},N});return}re.content&&r(m=>{const N=[...m],A=N[N.length-1];return N[N.length-1]={...A,content:A.content+re.content},N})}catch{}}}},[s]),k=c.useCallback(async(E,P)=>{try{const R={message:E,syncToObsidian:p==="obsidian"||p==="both",mode:p==="both"?"all":p,destinationPath:P?.destinationPath,organizedMarkdown:P?.organizedMarkdown,organizedTitle:P?.organizedTitle,confirmWrite:P?.confirmWrite},M=await G.brain.chat(R);let O=M.response;const B={cardsCreated:M.cardsCreated,sessionSaved:M.sessionSaved,sessionId:M.sessionId},K=[];M.sessionSaved&&K.push(`Session saved (ID: ${M.sessionId})`),M.cardsCreated&&K.push(`${M.cardsCreated} Anki cards created`),M.obsidianSynced&&K.push("Synced to Obsidian"),M.obsidianError&&K.push(`Obsidian error: ${M.obsidianError}`),K.length>0&&(O=`${K.join(" | ")}

${O}`),r(se=>[...se,{role:"assistant",content:O,meta:B}]),I.invalidateQueries({queryKey:["anki","drafts"]}),I.invalidateQueries({queryKey:["brain","metrics"]}),I.invalidateQueries({queryKey:["sessions"]})}catch(D){const H=D instanceof Error?D.message:String(D);r(R=>[...R,{role:"assistant",content:`Error: ${H}`}]),f({title:"Ingest failed",description:H,variant:"destructive"})}},[p,I,f]),w=c.useCallback(async()=>{const E=a.trim();if(!E&&l.length===0)return;const P={role:"user",content:E,images:[...l]};r(D=>[...D,P]),i(""),o([]),h(!0);try{e==="chat"?await _(E,P.images??[]):p==="obsidian"||p==="both"?await u.startPreview(E)||r(H=>[...H,{role:"assistant",content:"Error: Unable to prepare preview."}]):await k(E)}catch(D){const H=D instanceof Error?D.message:String(D);r(R=>{const M=R[R.length-1];if(M?.role==="assistant"&&!M.content){const O=[...R];return O[O.length-1]={role:"assistant",content:`Error: ${H}`},O}return[...R,{role:"assistant",content:`Error: ${H}`}]})}finally{h(!1)}},[a,l,e,p,_,k,u]),F=c.useCallback(async()=>{if(!u.organized)return;const E=u.getSelectedDestinationPath();if(!E){u.setOpen(!1),f({title:"Error",description:"Select a destination path.",variant:"destructive"});return}h(!0);try{await k(u.rawNotes,{destinationPath:E,organizedMarkdown:u.organized.markdown,organizedTitle:u.organized.title,confirmWrite:!0}),u.reset()}catch(P){const D=P instanceof Error?P.message:String(P);f({title:"Save failed",description:D,variant:"destructive"})}finally{h(!1)}},[u,k,f]);return t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsx(la,{mode:e,setMode:n,ingestTarget:p,setIngestTarget:g,promptCopied:x,setPromptCopied:j}),t.jsx(ca,{messages:s,loading:d,mode:e,scrollRef:S}),t.jsx(da,{images:l,onRemove:T}),t.jsx(ua,{input:a,setInput:i,onSend:w,onImageSelect:v,onPaste:b,loading:d,mode:e}),t.jsx(Ta,{open:u.open,onOpenChange:E=>{E?u.setOpen(!0):u.reset()},loading:u.loading,error:u.error,rawNotes:u.rawNotes,organized:u.organized,destination:u.destination,selectedDestinationId:u.selectedDestinationId,setSelectedDestinationId:u.setSelectedDestinationId,customDestination:u.customDestination,setCustomDestination:u.setCustomDestination,checklistState:u.checklistState,onToggleChecklist:u.toggleChecklist,diffLines:u.diffLines,onConfirm:F,onCancel:u.reset})]})}const _a="/assets/TreysStudySystemIMAGE-nejJlbV0.jpg";function La({workspace:e}){const[n,s]=c.useState(!1),[r,a]=c.useState(!1),i=c.useCallback(async()=>{await e.saveFile(),a(!0),setTimeout(()=>a(!1),300)},[e]);return c.useEffect(()=>{if(!n)return;const l=o=>{o.key==="Escape"&&s(!1)};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[n]),e.currentFile?t.jsxs("div",{className:X("flex flex-col",n?"fixed inset-0 z-50 bg-black":"h-full"),children:[t.jsxs("div",{className:X("flex items-center justify-between px-3 py-1.5 border-b bg-black/40",r?"brain-save-flash":"border-secondary/30"),children:[t.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[t.jsxs("span",{className:"font-terminal text-sm text-primary truncate",children:[e.currentFile.split("/").pop(),e.hasChanges&&t.jsx("span",{className:"text-yellow-500 ml-1",children:"*"})]}),t.jsx("button",{onClick:()=>{const l=e.obsidianConfig?.vaultName||"Treys School",o=e.currentFile.replace(/\.md$/,"");window.open(`obsidian://open?vault=${encodeURIComponent(l)}&file=${encodeURIComponent(o)}`,"_blank")},className:"text-muted-foreground hover:text-primary shrink-0",title:"Open in Obsidian",children:t.jsx(Js,{className:"w-3 h-3"})})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(q,{size:"sm",variant:"ghost",className:"h-5 px-2 text-xs font-terminal",onClick:()=>e.setPreviewMode(!e.previewMode),children:e.previewMode?"Edit":"Preview"}),t.jsxs(q,{size:"sm",variant:"ghost",onClick:i,disabled:!e.hasChanges||e.isSaving,className:"h-5 px-2 text-xs font-terminal",children:[t.jsx(Dt,{className:"w-3 h-3 mr-1"}),e.isSaving?"Saving...":"Save"]}),t.jsx(q,{size:"sm",variant:"ghost",className:"h-5 px-1.5 text-xs font-terminal",onClick:()=>s(!n),title:n?"Exit fullscreen":"Fullscreen",children:n?t.jsx(gr,{className:"w-3 h-3"}):t.jsx(xr,{className:"w-3 h-3"})})]})]}),e.previewMode?t.jsx("div",{className:"flex-1 p-3 bg-black/60 font-terminal overflow-y-auto",children:t.jsx(hs,{content:e.fileContent,onWikilinkClick:e.handleWikilinkClick})}):t.jsx("textarea",{value:e.fileContent,onChange:l=>e.setFileContent(l.target.value),className:"flex-1 w-full p-3 bg-black/60 font-terminal text-sm resize-none focus:outline-none focus:ring-1 focus:ring-primary overflow-y-auto min-h-[200px]",placeholder:"File content...",style:{height:"100%"}})]}):t.jsxs("div",{className:"brain-workspace__empty flex-1 flex flex-col items-center justify-center gap-4 relative overflow-hidden min-h-[200px]",children:[t.jsx("img",{src:_a,alt:"",className:"absolute inset-0 w-full h-full object-cover opacity-[0.12] pointer-events-none select-none"}),t.jsxs("div",{className:"relative z-10 flex flex-col items-center gap-3 text-center px-4",children:[t.jsx(nt,{className:"brain-empty-icon w-10 h-10 text-primary/60","aria-hidden":"true"}),t.jsx("p",{className:"font-arcade text-xs text-primary/90 tracking-widest uppercase",children:"No file open"}),t.jsx("p",{className:"font-terminal text-sm text-muted-foreground max-w-[260px]",children:"Select a file from the vault sidebar or create a new note"})]})]})}const Oa=c.lazy(()=>Rt(()=>import("./ConceptMapEditor-BhvdCsQu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(e=>({default:e.ConceptMapEditor}))),$a=c.lazy(()=>Rt(()=>import("./VaultGraphView-D_ucm7ZI.js"),__vite__mapDeps([25,1,2,8,3,21,5,10])).then(e=>({default:e.VaultGraphView}))),Fa=c.lazy(()=>Rt(()=>import("./MindMapView-DMCndcGc.js"),__vite__mapDeps([26,1,2,7,8,9,3,21,5,10,11,12,27,14,15,16,13,17,6,4,18,19,20,22,23])).then(e=>({default:e.MindMapView})));class Ha extends c.Component{constructor(){super(...arguments),this.state={error:null}}static getDerivedStateFromError(n){return{error:n.message}}render(){return this.state.error?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-2 p-4",children:[t.jsx("p",{className:"font-arcade text-xs text-red-400",children:"GRAPH RENDER ERROR"}),t.jsx("p",{className:"font-terminal text-xs text-muted-foreground text-center",children:this.state.error}),t.jsx("button",{className:"font-terminal text-sm text-primary underline",onClick:()=>this.setState({error:null}),children:"Try again"})]}):this.props.children}}function Va(){return t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx(Lt,{className:"w-6 h-6 animate-spin text-primary"})})}function Ga(){const[e,n]=c.useState("concept"),s=[{id:"concept",label:"Concept Map"},{id:"vault",label:"Vault Graph"},{id:"mindmap",label:"Mind Map"}];return t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsx("div",{className:"tab-sub-bar",role:"tablist","aria-label":"Graph view",children:s.map(r=>t.jsx("button",{role:"tab","aria-selected":e===r.id,onClick:()=>n(r.id),className:X("tab-sub-item",e===r.id&&"active"),children:r.label},r.id))}),t.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:t.jsx(Ha,{children:t.jsxs(c.Suspense,{fallback:t.jsx(Va,{}),children:[e==="concept"&&t.jsx(Oa,{}),e==="vault"&&t.jsx($a,{}),e==="mindmap"&&t.jsx(Fa,{})]})})})]})}function Ba(e,n){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const s=document.implementation.createHTMLDocument(),r=s.createElement("base"),a=s.createElement("a");return s.head.appendChild(r),s.body.appendChild(a),n&&(r.href=n),a.href=e,a.href}const qa=(()=>{let e=0;const n=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${n()}${e}`)})();function pe(e){const n=[];for(let s=0,r=e.length;s<r;s++)n.push(e[s]);return n}let je=null;function ps(e={}){return je||(e.includeStyleProperties?(je=e.includeStyleProperties,je):(je=pe(window.getComputedStyle(document.documentElement)),je))}function Qe(e,n){const r=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(n);return r?parseFloat(r.replace("px","")):0}function Ka(e){const n=Qe(e,"border-left-width"),s=Qe(e,"border-right-width");return e.clientWidth+n+s}function Ua(e){const n=Qe(e,"border-top-width"),s=Qe(e,"border-bottom-width");return e.clientHeight+n+s}function xs(e,n={}){const s=n.width||Ka(e),r=n.height||Ua(e);return{width:s,height:r}}function Wa(){let e,n;try{n=process}catch{}const s=n&&n.env?n.env.devicePixelRatio:null;return s&&(e=parseInt(s,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const te=16384;function Ja(e){(e.width>te||e.height>te)&&(e.width>te&&e.height>te?e.width>e.height?(e.height*=te/e.width,e.width=te):(e.width*=te/e.height,e.height=te):e.width>te?(e.height*=te/e.width,e.width=te):(e.width*=te/e.height,e.height=te))}function Xe(e){return new Promise((n,s)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>n(r))})},r.onerror=s,r.crossOrigin="anonymous",r.decoding="async",r.src=e})}async function Ya(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(n=>`data:image/svg+xml;charset=utf-8,${n}`)}async function Qa(e,n,s){const r="http://www.w3.org/2000/svg",a=document.createElementNS(r,"svg"),i=document.createElementNS(r,"foreignObject");return a.setAttribute("width",`${n}`),a.setAttribute("height",`${s}`),a.setAttribute("viewBox",`0 0 ${n} ${s}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),a.appendChild(i),i.appendChild(e),Ya(a)}const Z=(e,n)=>{if(e instanceof n)return!0;const s=Object.getPrototypeOf(e);return s===null?!1:s.constructor.name===n.name||Z(s,n)};function Xa(e){const n=e.getPropertyValue("content");return`${e.cssText} content: '${n.replace(/'|"/g,"")}';`}function Za(e,n){return ps(n).map(s=>{const r=e.getPropertyValue(s),a=e.getPropertyPriority(s);return`${s}: ${r}${a?" !important":""};`}).join(" ")}function ei(e,n,s,r){const a=`.${e}:${n}`,i=s.cssText?Xa(s):Za(s,r);return document.createTextNode(`${a}{${i}}`)}function mn(e,n,s,r){const a=window.getComputedStyle(e,s),i=a.getPropertyValue("content");if(i===""||i==="none")return;const l=qa();try{n.className=`${n.className} ${l}`}catch{return}const o=document.createElement("style");o.appendChild(ei(l,s,a,r)),n.appendChild(o)}function ti(e,n,s){mn(e,n,":before",s),mn(e,n,":after",s)}const fn="application/font-woff",hn="image/jpeg",ni={woff:fn,woff2:fn,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:hn,jpeg:hn,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function si(e){const n=/\.([^./]*?)$/g.exec(e);return n?n[1]:""}function Bt(e){const n=si(e).toLowerCase();return ni[n]||""}function ri(e){return e.split(/,/)[1]}function Et(e){return e.search(/^(data:)/)!==-1}function ai(e,n){return`data:${n};base64,${e}`}async function bs(e,n,s){const r=await fetch(e,n);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const a=await r.blob();return new Promise((i,l)=>{const o=new FileReader;o.onerror=l,o.onloadend=()=>{try{i(s({res:r,result:o.result}))}catch(d){l(d)}},o.readAsDataURL(a)})}const vt={};function ii(e,n,s){let r=e.replace(/\?.*/,"");return s&&(r=e),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),n?`[${n}]${r}`:r}async function qt(e,n,s){const r=ii(e,n,s.includeQueryParams);if(vt[r]!=null)return vt[r];s.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let a;try{const i=await bs(e,s.fetchRequestInit,({res:l,result:o})=>(n||(n=l.headers.get("Content-Type")||""),ri(o)));a=ai(i,n)}catch(i){a=s.imagePlaceholder||"";let l=`Failed to fetch resource: ${e}`;i&&(l=typeof i=="string"?i:i.message),l&&console.warn(l)}return vt[r]=a,a}async function oi(e){const n=e.toDataURL();return n==="data:,"?e.cloneNode(!1):Xe(n)}async function li(e,n){if(e.currentSrc){const i=document.createElement("canvas"),l=i.getContext("2d");i.width=e.clientWidth,i.height=e.clientHeight,l?.drawImage(e,0,0,i.width,i.height);const o=i.toDataURL();return Xe(o)}const s=e.poster,r=Bt(s),a=await qt(s,r,n);return Xe(a)}async function ci(e,n){var s;try{if(!((s=e?.contentDocument)===null||s===void 0)&&s.body)return await lt(e.contentDocument.body,n,!0)}catch{}return e.cloneNode(!1)}async function di(e,n){return Z(e,HTMLCanvasElement)?oi(e):Z(e,HTMLVideoElement)?li(e,n):Z(e,HTMLIFrameElement)?ci(e,n):e.cloneNode(gs(e))}const ui=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",gs=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function mi(e,n,s){var r,a;if(gs(n))return n;let i=[];return ui(e)&&e.assignedNodes?i=pe(e.assignedNodes()):Z(e,HTMLIFrameElement)&&(!((r=e.contentDocument)===null||r===void 0)&&r.body)?i=pe(e.contentDocument.body.childNodes):i=pe(((a=e.shadowRoot)!==null&&a!==void 0?a:e).childNodes),i.length===0||Z(e,HTMLVideoElement)||await i.reduce((l,o)=>l.then(()=>lt(o,s)).then(d=>{d&&n.appendChild(d)}),Promise.resolve()),n}function fi(e,n,s){const r=n.style;if(!r)return;const a=window.getComputedStyle(e);a.cssText?(r.cssText=a.cssText,r.transformOrigin=a.transformOrigin):ps(s).forEach(i=>{let l=a.getPropertyValue(i);i==="font-size"&&l.endsWith("px")&&(l=`${Math.floor(parseFloat(l.substring(0,l.length-2)))-.1}px`),Z(e,HTMLIFrameElement)&&i==="display"&&l==="inline"&&(l="block"),i==="d"&&n.getAttribute("d")&&(l=`path(${n.getAttribute("d")})`),r.setProperty(i,l,a.getPropertyPriority(i))})}function hi(e,n){Z(e,HTMLTextAreaElement)&&(n.innerHTML=e.value),Z(e,HTMLInputElement)&&n.setAttribute("value",e.value)}function pi(e,n){if(Z(e,HTMLSelectElement)){const s=n,r=Array.from(s.children).find(a=>e.value===a.getAttribute("value"));r&&r.setAttribute("selected","")}}function xi(e,n,s){return Z(n,Element)&&(fi(e,n,s),ti(e,n,s),hi(e,n),pi(e,n)),n}async function bi(e,n){const s=e.querySelectorAll?e.querySelectorAll("use"):[];if(s.length===0)return e;const r={};for(let i=0;i<s.length;i++){const o=s[i].getAttribute("xlink:href");if(o){const d=e.querySelector(o),h=document.querySelector(o);!d&&h&&!r[o]&&(r[o]=await lt(h,n,!0))}}const a=Object.values(r);if(a.length){const i="http://www.w3.org/1999/xhtml",l=document.createElementNS(i,"svg");l.setAttribute("xmlns",i),l.style.position="absolute",l.style.width="0",l.style.height="0",l.style.overflow="hidden",l.style.display="none";const o=document.createElementNS(i,"defs");l.appendChild(o);for(let d=0;d<a.length;d++)o.appendChild(a[d]);e.appendChild(l)}return e}async function lt(e,n,s){return!s&&n.filter&&!n.filter(e)?null:Promise.resolve(e).then(r=>di(r,n)).then(r=>mi(e,r,n)).then(r=>xi(e,r,n)).then(r=>bi(r,n))}const ys=/url\((['"]?)([^'"]+?)\1\)/g,gi=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,yi=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function vi(e){const n=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${n})(['"]?\\))`,"g")}function wi(e){const n=[];return e.replace(ys,(s,r,a)=>(n.push(a),s)),n.filter(s=>!Et(s))}async function ji(e,n,s,r,a){try{const i=s?Ba(n,s):n,l=Bt(n);let o;return a||(o=await qt(i,l,r)),e.replace(vi(n),`$1${o}$3`)}catch{}return e}function Ni(e,{preferredFontFormat:n}){return n?e.replace(yi,s=>{for(;;){const[r,,a]=gi.exec(s)||[];if(!a)return"";if(a===n)return`src: ${r};`}}):e}function vs(e){return e.search(ys)!==-1}async function ws(e,n,s){if(!vs(e))return e;const r=Ni(e,s);return wi(r).reduce((i,l)=>i.then(o=>ji(o,l,n,s)),Promise.resolve(r))}async function Ne(e,n,s){var r;const a=(r=n.style)===null||r===void 0?void 0:r.getPropertyValue(e);if(a){const i=await ws(a,null,s);return n.style.setProperty(e,i,n.style.getPropertyPriority(e)),!0}return!1}async function Si(e,n){await Ne("background",e,n)||await Ne("background-image",e,n),await Ne("mask",e,n)||await Ne("-webkit-mask",e,n)||await Ne("mask-image",e,n)||await Ne("-webkit-mask-image",e,n)}async function ki(e,n){const s=Z(e,HTMLImageElement);if(!(s&&!Et(e.src))&&!(Z(e,SVGImageElement)&&!Et(e.href.baseVal)))return;const r=s?e.src:e.href.baseVal,a=await qt(r,Bt(r),n);await new Promise((i,l)=>{e.onload=i,e.onerror=n.onImageErrorHandler?(...d)=>{try{i(n.onImageErrorHandler(...d))}catch(h){l(h)}}:l;const o=e;o.decode&&(o.decode=i),o.loading==="lazy"&&(o.loading="eager"),s?(e.srcset="",e.src=a):e.href.baseVal=a})}async function Ci(e,n){const r=pe(e.childNodes).map(a=>js(a,n));await Promise.all(r).then(()=>e)}async function js(e,n){Z(e,Element)&&(await Si(e,n),await ki(e,n),await Ci(e,n))}function Ei(e,n){const{style:s}=e;n.backgroundColor&&(s.backgroundColor=n.backgroundColor),n.width&&(s.width=`${n.width}px`),n.height&&(s.height=`${n.height}px`);const r=n.style;return r!=null&&Object.keys(r).forEach(a=>{s[a]=r[a]}),e}const pn={};async function xn(e){let n=pn[e];if(n!=null)return n;const r=await(await fetch(e)).text();return n={url:e,cssText:r},pn[e]=n,n}async function bn(e,n){let s=e.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,i=(s.match(/url\([^)]+\)/g)||[]).map(async l=>{let o=l.replace(r,"$1");return o.startsWith("https://")||(o=new URL(o,e.url).href),bs(o,n.fetchRequestInit,({result:d})=>(s=s.replace(l,`url(${d})`),[l,d]))});return Promise.all(i).then(()=>s)}function gn(e){if(e==null)return[];const n=[],s=/(\/\*[\s\S]*?\*\/)/gi;let r=e.replace(s,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const d=a.exec(r);if(d===null)break;n.push(d[0])}r=r.replace(a,"");const i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,l="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",o=new RegExp(l,"gi");for(;;){let d=i.exec(r);if(d===null){if(d=o.exec(r),d===null)break;i.lastIndex=o.lastIndex}else o.lastIndex=i.lastIndex;n.push(d[0])}return n}async function Pi(e,n){const s=[],r=[];return e.forEach(a=>{if("cssRules"in a)try{pe(a.cssRules||[]).forEach((i,l)=>{if(i.type===CSSRule.IMPORT_RULE){let o=l+1;const d=i.href,h=xn(d).then(p=>bn(p,n)).then(p=>gn(p).forEach(g=>{try{a.insertRule(g,g.startsWith("@import")?o+=1:a.cssRules.length)}catch(x){console.error("Error inserting rule from remote css",{rule:g,error:x})}})).catch(p=>{console.error("Error loading remote css",p.toString())});r.push(h)}})}catch(i){const l=e.find(o=>o.href==null)||document.styleSheets[0];a.href!=null&&r.push(xn(a.href).then(o=>bn(o,n)).then(o=>gn(o).forEach(d=>{l.insertRule(d,l.cssRules.length)})).catch(o=>{console.error("Error loading remote stylesheet",o)})),console.error("Error inlining remote css file",i)}}),Promise.all(r).then(()=>(e.forEach(a=>{if("cssRules"in a)try{pe(a.cssRules||[]).forEach(i=>{s.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${a.href}`,i)}}),s))}function Ri(e){return e.filter(n=>n.type===CSSRule.FONT_FACE_RULE).filter(n=>vs(n.style.getPropertyValue("src")))}async function Ii(e,n){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const s=pe(e.ownerDocument.styleSheets),r=await Pi(s,n);return Ri(r)}function Ns(e){return e.trim().replace(/["']/g,"")}function zi(e){const n=new Set;function s(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(i=>{n.add(Ns(i))}),Array.from(r.children).forEach(i=>{i instanceof HTMLElement&&s(i)})}return s(e),n}async function Ai(e,n){const s=await Ii(e,n),r=zi(e);return(await Promise.all(s.filter(i=>r.has(Ns(i.style.fontFamily))).map(i=>{const l=i.parentStyleSheet?i.parentStyleSheet.href:null;return ws(i.cssText,l,n)}))).join(`
`)}async function Ti(e,n){const s=n.fontEmbedCSS!=null?n.fontEmbedCSS:n.skipFonts?null:await Ai(e,n);if(s){const r=document.createElement("style"),a=document.createTextNode(s);r.appendChild(a),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}}async function Mi(e,n={}){const{width:s,height:r}=xs(e,n),a=await lt(e,n,!0);return await Ti(a,n),await js(a,n),Ei(a,n),await Qa(a,s,r)}async function Di(e,n={}){const{width:s,height:r}=xs(e,n),a=await Mi(e,n),i=await Xe(a),l=document.createElement("canvas"),o=l.getContext("2d"),d=n.pixelRatio||Wa(),h=n.canvasWidth||s,p=n.canvasHeight||r;return l.width=h*d,l.height=p*d,n.skipAutoScale||Ja(l),l.style.width=`${h}`,l.style.height=`${p}`,n.backgroundColor&&(o.fillStyle=n.backgroundColor,o.fillRect(0,0,l.width,l.height)),o.drawImage(i,0,0,l.width,l.height),l}async function _i(e,n={}){return(await Di(e,n)).toDataURL()}const wt={title:"Untitled Comparison",columns:["Concept A","Concept B"],rows:[{feature:"Feature 1",values:["",""],isKey:!1},{feature:"Feature 2",values:["",""],isKey:!1},{feature:"Feature 3",values:["",""],isKey:!1}]};function yn(e){const n=`| Feature | ${e.columns.join(" | ")} |`,s=`|${"----|".repeat(e.columns.length+1)}`,r=e.rows.map(a=>`| ${a.isKey?`**${a.feature}**`:a.feature} | ${a.values.join(" | ")} |`);return[n,s,...r].join(`
`)}function Li({className:e}){const[n,s]=c.useState(()=>({...wt,columns:[...wt.columns],rows:wt.rows.map(u=>({...u,values:[...u.values]}))})),r=c.useRef(null),{toast:a}=tt(),i=c.useCallback(u=>{s(y=>({...y,title:u}))},[]),l=c.useCallback((u,y)=>{s(b=>{const v=[...b.columns];return v[u]=y,{...b,columns:v}})},[]),o=c.useCallback((u,y)=>{s(b=>{const v=b.rows.map((T,_)=>_===u?{...T,feature:y}:T);return{...b,rows:v}})},[]),d=c.useCallback((u,y,b)=>{s(v=>{const T=v.rows.map((_,k)=>{if(k!==u)return _;const w=[..._.values];return w[y]=b,{..._,values:w}});return{...v,rows:T}})},[]),h=c.useCallback(u=>{s(y=>{const b=y.rows.map((v,T)=>T===u?{...v,isKey:!v.isKey}:v);return{...y,rows:b}})},[]),p=c.useCallback(()=>{s(u=>{if(u.columns.length>=4)return u;const y=[...u.columns,`Concept ${u.columns.length+1}`],b=u.rows.map(v=>({...v,values:[...v.values,""]}));return{...u,columns:y,rows:b}})},[]),g=c.useCallback(u=>{s(y=>{if(y.columns.length<=2)return y;const b=y.columns.filter((T,_)=>_!==u),v=y.rows.map(T=>({...T,values:T.values.filter((_,k)=>k!==u)}));return{...y,columns:b,rows:v}})},[]),x=c.useCallback(()=>{s(u=>({...u,rows:[...u.rows,{feature:`Feature ${u.rows.length+1}`,values:u.columns.map(()=>""),isKey:!1}]}))},[]),j=c.useCallback(u=>{s(y=>y.rows.length<=1?y:{...y,rows:y.rows.filter((b,v)=>v!==u)})},[]),S=c.useCallback(()=>{const u=yn(n);navigator.clipboard.writeText(u),a({title:"Markdown copied to clipboard"})},[n,a]),I=c.useCallback(async()=>{if(r.current)try{const u=await _i(r.current,{backgroundColor:"#000",quality:1}),y=document.createElement("a");y.download=`${n.title.replace(/[/\\?%*:|"<>]/g,"-")}.png`,y.href=u,y.click(),a({title:"PNG exported"})}catch(u){a({title:"Export failed",description:String(u),variant:"destructive"})}},[n.title,a]),f=c.useCallback(async()=>{const u=yn(n),y=n.title.replace(/[/\\?%*:|"<>]/g,"-"),b=`---
type: comparison-table
created: ${new Date().toISOString()}
---

# ${n.title}

${u}
`,v=`Comparison Tables/${y}.md`;try{await G.obsidian.saveFile(v,b),a({title:"Saved to vault",description:v})}catch(T){a({title:"Save failed",description:String(T),variant:"destructive"})}},[n,a]);return t.jsxs("div",{className:X("flex flex-col h-full",e),children:[t.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 border-b border-secondary/30 bg-black/40 shrink-0 flex-wrap",children:[t.jsxs(q,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-xs font-terminal",onClick:p,disabled:n.columns.length>=4,title:"Add column",children:[t.jsx(ar,{className:"w-3 h-3"}),t.jsx(Jt,{className:"w-2 h-2"})]}),t.jsxs(q,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-xs font-terminal",onClick:x,title:"Add row",children:[t.jsx(Nr,{className:"w-3 h-3"}),t.jsx(Jt,{className:"w-2 h-2"})]}),t.jsx("div",{className:"w-px h-4 bg-secondary/30"}),t.jsx(q,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-xs font-terminal",onClick:S,title:"Copy markdown",children:t.jsx(or,{className:"w-3 h-3"})}),t.jsx(q,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-xs font-terminal",onClick:I,title:"Export PNG",children:t.jsx(Pn,{className:"w-3 h-3"})}),t.jsx(q,{size:"sm",variant:"ghost",className:"h-6 px-1.5 text-xs font-terminal",onClick:f,title:"Save to vault",children:t.jsx(Dt,{className:"w-3 h-3"})}),t.jsxs("span",{className:"ml-auto text-xs font-terminal text-muted-foreground",children:[n.columns.length,"C / ",n.rows.length,"R"]})]}),t.jsx("div",{className:"px-2 py-1 border-b border-secondary/20",children:t.jsx(Ce,{value:n.title,onChange:u=>i(u.target.value),className:"h-6 text-xs font-arcade bg-transparent border-none px-1 text-primary focus-visible:ring-0",placeholder:"Table title..."})}),t.jsx("div",{className:"flex-1 overflow-auto p-2",children:t.jsxs("div",{ref:r,className:"bg-black/80 border-2 border-primary/50",children:[t.jsxs("div",{className:"flex border-b-2 border-primary/50",children:[t.jsx("div",{className:"w-28 shrink-0 p-1 border-r border-secondary/30 bg-black/60",children:t.jsx("span",{className:"font-arcade text-xs text-muted-foreground",children:"FEATURE"})}),n.columns.map((u,y)=>t.jsxs("div",{className:"flex-1 min-w-[100px] p-1 border-r border-secondary/30 bg-black/60 flex items-center gap-1",children:[t.jsx(Ce,{value:u,onChange:b=>l(y,b.target.value),className:"h-5 text-xs font-arcade bg-transparent border-none px-0 text-primary focus-visible:ring-0 flex-1"}),n.columns.length>2&&t.jsx("button",{onClick:()=>g(y),className:"text-muted-foreground hover:text-destructive shrink-0",children:t.jsx(Ke,{className:"w-2.5 h-2.5"})})]},y))]}),n.rows.map((u,y)=>t.jsxs("div",{className:X("flex border-b border-secondary/20",u.isKey&&"border-l-2 border-l-primary"),children:[t.jsxs("div",{className:"w-28 shrink-0 p-1 border-r border-secondary/30 flex items-center gap-1",children:[t.jsx("button",{onClick:()=>h(y),className:X("shrink-0",u.isKey?"text-primary":"text-muted-foreground/40 hover:text-muted-foreground"),title:"Toggle key feature",children:t.jsx(Ys,{className:"w-2.5 h-2.5",fill:u.isKey?"currentColor":"none"})}),t.jsx(Ce,{value:u.feature,onChange:b=>o(y,b.target.value),className:X("h-5 text-xs font-terminal bg-transparent border-none px-0 focus-visible:ring-0 flex-1",u.isKey?"text-primary font-bold":"text-secondary-foreground")}),n.rows.length>1&&t.jsx("button",{onClick:()=>j(y),className:"text-muted-foreground hover:text-destructive shrink-0",children:t.jsx(Ke,{className:"w-2.5 h-2.5"})})]}),u.values.map((b,v)=>t.jsx("div",{className:"flex-1 min-w-[100px] p-1 border-r border-secondary/30",children:t.jsx(Ce,{value:b,onChange:T=>d(y,v,T.target.value),className:"h-5 text-xs font-terminal bg-transparent border-none px-0 text-secondary-foreground focus-visible:ring-0",placeholder:"..."})},v))]},y))]})})]})}function Oi({totalCards:e,compact:n}){const[s,r]=c.useState(new Set),[a,i]=c.useState(null),[l,o]=c.useState({front:"",back:"",deckName:""}),d=et(),{toast:h}=tt(),{data:p,isLoading:g,refetch:x}=Y({queryKey:["anki","status"],queryFn:G.anki.getStatus,refetchInterval:3e4}),{data:j}=Y({queryKey:["anki","due"],queryFn:G.anki.getDue,enabled:p?.connected===!0}),{data:S=[],refetch:I}=Y({queryKey:["anki","drafts"],queryFn:G.anki.getDrafts}),f=S.filter(w=>w.status==="pending"),u=me({mutationFn:G.anki.sync,onSuccess:w=>{d.invalidateQueries({queryKey:["anki"]}),I(),h({title:"Anki sync complete",description:w.output||"Cards synced successfully"})},onError:w=>{h({title:"Anki sync failed",description:w.message,variant:"destructive"})}}),y=me({mutationFn:w=>G.anki.approveDraft(w),onSuccess:()=>I()}),b=me({mutationFn:w=>G.anki.deleteDraft(w),onMutate:async w=>{await d.cancelQueries({queryKey:["anki","drafts"]});const F=d.getQueryData(["anki","drafts"]);return d.setQueryData(["anki","drafts"],E=>E?E.filter(P=>P.id!==w):[]),{prev:F}},onError:(w,F,E)=>{E?.prev&&d.setQueryData(["anki","drafts"],E.prev)},onSettled:()=>I()}),v=me({mutationFn:({id:w,data:F})=>G.anki.updateDraft(w,F),onSuccess:()=>{I(),i(null)}}),T=w=>{i(w.id),o({front:w.front,back:w.back,deckName:w.deckName})},_=()=>{a!==null&&v.mutate({id:a,data:l})},k=t.jsx("div",{className:n?"p-3 space-y-3":"p-4 space-y-3",children:g?t.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Checking Anki..."}):p?.connected?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-4 font-terminal text-xs",children:[t.jsx(We,{variant:"outline",className:"bg-success/20 text-success border-success",children:"Connected"}),t.jsxs("span",{className:"text-muted-foreground",children:["Cards: ",t.jsx("span",{className:"text-primary font-arcade",children:e})]}),t.jsxs("span",{className:"text-muted-foreground",children:["Due: ",t.jsx("span",{className:"text-secondary font-arcade",children:j?.dueCount||0})]}),t.jsxs("span",{className:"text-muted-foreground",children:["Reviewed: ",t.jsx("span",{className:"font-arcade",children:p.reviewedToday||0})]}),t.jsxs("span",{className:"text-muted-foreground",children:["Decks: ",t.jsx("span",{className:"font-arcade",children:p.decks?.length||0})]})]}),t.jsxs("div",{className:"pt-2 flex gap-2",children:[t.jsxs(q,{size:"sm",variant:"outline",className:"flex-1 font-terminal text-xs",onClick:()=>x(),children:[t.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Refresh"]}),t.jsxs(q,{size:"sm",className:"flex-1 font-terminal text-xs bg-secondary hover:bg-secondary/80",onClick:()=>u.mutate(),disabled:u.isPending,children:[u.isPending?t.jsx(Lt,{className:"w-3 h-3 mr-1 animate-spin"}):t.jsx(Ae,{className:"w-3 h-3 mr-1"}),u.isPending?"Syncing...":"Sync Cards"]})]}),u.isError&&t.jsxs("div",{className:"p-2 bg-destructive/10 border border-destructive/30 text-destructive font-terminal text-xs",children:[t.jsx("span",{className:"font-arcade",children:"SYNC ERROR:"})," ",u.error?.message||"Unknown error",t.jsx(q,{size:"sm",variant:"outline",className:"ml-2 h-5 px-2 text-xs font-terminal border-destructive/50 text-destructive",onClick:()=>u.mutate(),disabled:u.isPending,children:"Retry"})]}),f.length>0&&t.jsxs("div",{className:"pt-3 border-t border-secondary/30",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsxs("span",{className:"font-arcade text-xs text-warning",children:["PENDING CARDS (",f.length,")"]}),t.jsx("div",{className:"flex gap-1",children:t.jsx(q,{size:"sm",variant:"outline",className:"h-5 px-2 text-xs font-terminal",onClick:()=>{s.size===f.length?r(new Set):r(new Set(f.map(w=>w.id)))},children:s.size===f.length?"None":"All"})})]}),s.size>0&&t.jsxs("div",{className:"flex gap-1 mb-2",children:[t.jsxs(q,{size:"sm",className:"h-6 px-2 text-xs font-terminal bg-success hover:bg-success/80",onClick:()=>{s.forEach(w=>y.mutate(w)),r(new Set)},children:[t.jsx(dt,{className:"w-3 h-3 mr-1"}),"Approve (",s.size,")"]}),t.jsxs(q,{size:"sm",variant:"destructive",className:"h-6 px-2 text-xs font-terminal",onClick:()=>{s.forEach(w=>b.mutate(w)),r(new Set)},children:[t.jsx(Ke,{className:"w-3 h-3 mr-1"}),"Delete (",s.size,")"]})]}),t.jsx($e,{className:"h-[140px]",children:t.jsx("div",{className:"space-y-2",children:f.map(w=>t.jsx("div",{className:`p-2 bg-black/40 border text-xs ${s.has(w.id)?"border-primary":"border-secondary/30"}`,children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(En,{checked:s.has(w.id),onCheckedChange:F=>{const E=new Set(s);F?E.add(w.id):E.delete(w.id),r(E)},className:"mt-1 border-secondary data-[state=checked]:bg-primary"}),t.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[t.jsx("div",{className:"font-terminal text-primary truncate",children:w.front}),t.jsx("div",{className:"font-terminal text-muted-foreground mt-1 truncate",children:w.back}),t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[t.jsx(We,{variant:"outline",className:"text-xs border-info/50 text-info shrink-0",children:w.deckName}),t.jsx(q,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-warning/50 text-warning hover:bg-warning/20",onClick:()=>T(w),title:"Edit card",children:t.jsx(Ue,{className:"w-3 h-3"})}),t.jsx(q,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-success/50 text-success hover:bg-success/20",onClick:()=>y.mutate(w.id),title:"Approve card",children:t.jsx(dt,{className:"w-3 h-3"})}),t.jsx(q,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-destructive/50 text-destructive hover:bg-destructive/20",onClick:()=>b.mutate(w.id),title:"Delete card",children:t.jsx(Ke,{className:"w-3 h-3"})})]})]})]})},w.id))})})]})]}):t.jsxs("div",{className:"text-center space-y-2",children:[t.jsx("p",{className:"font-terminal text-xs text-destructive",children:p?.error||"Anki not connected"}),t.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Anki with AnkiConnect plugin"}),t.jsxs(q,{size:"sm",variant:"outline",className:"font-terminal text-xs",onClick:()=>x(),children:[t.jsx(Ae,{className:"w-3 h-3 mr-1"}),"Retry"]})]})});return t.jsxs(t.Fragment,{children:[n?k:t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-3",children:[t.jsx(Fe,{className:"w-4 h-4"}),"ANKI INTEGRATION",p?.connected?t.jsx(dt,{className:"w-3 h-3 text-success ml-auto"}):t.jsx(Nt,{className:"w-3 h-3 text-destructive ml-auto"})]})}),t.jsx(Ie,{className:"p-0",children:k})]}),t.jsx(It,{open:a!==null,onOpenChange:w=>{w||i(null)},children:t.jsxs(zt,{"data-modal":"brain-edit-draft",className:"bg-black border-2 border-primary rounded-none max-w-lg translate-y-0",style:{zIndex:100005,top:"6rem",left:"50%",transform:"translate(-50%, 0)"},children:[t.jsxs(At,{children:[t.jsxs(Tt,{className:"font-arcade text-primary flex items-center gap-2",children:[t.jsx(Ue,{className:"w-5 h-5"}),"EDIT CARD"]}),t.jsx(Mt,{className:"font-terminal text-muted-foreground",children:"Edit card content and select target deck"})]}),t.jsxs("div",{className:"space-y-4 font-terminal",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-muted-foreground",children:"Front (Question)"}),t.jsx(Wt,{value:l.front,onChange:w=>o(F=>({...F,front:w.target.value})),placeholder:"Card front...",className:"rounded-none border-secondary min-h-[80px]"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-muted-foreground",children:"Back (Answer)"}),t.jsx(Wt,{value:l.back,onChange:w=>o(F=>({...F,back:w.target.value})),placeholder:"Card back...",className:"rounded-none border-secondary min-h-[80px]"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-muted-foreground",children:"Target Deck"}),t.jsxs(Qs,{value:l.deckName,onValueChange:w=>o(F=>({...F,deckName:w})),children:[t.jsx(Xs,{className:"rounded-none border-secondary",children:t.jsx(Zs,{placeholder:"Select deck"})}),t.jsxs(er,{className:"rounded-none border-secondary bg-black max-h-[200px]",children:[t.jsx(xe,{value:"PT::EBP",children:"PT::EBP (Evidence Based Practice)"}),t.jsx(xe,{value:"PT::ExPhys",children:"PT::ExPhys (Exercise Physiology)"}),t.jsx(xe,{value:"PT::MS1",children:"PT::MS1 (Movement Science 1)"}),t.jsx(xe,{value:"PT::Neuro",children:"PT::Neuro (Neuroscience)"}),t.jsx(xe,{value:"PT::TI",children:"PT::TI (Therapeutic Intervention)"}),t.jsx(xe,{value:"PT::General",children:"PT::General"}),p?.decks?.filter(w=>!w.startsWith("PT::")).map(w=>t.jsx(xe,{value:w,children:w},w))]})]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Current: ",t.jsx("span",{className:"text-blue-400",children:l.deckName})]})]})]}),t.jsxs(zs,{className:"gap-2",children:[t.jsxs(q,{variant:"outline",onClick:()=>i(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[t.jsx(Nt,{className:"w-4 h-4 mr-2"}),"Cancel"]}),t.jsxs(q,{onClick:_,disabled:v.isPending,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[t.jsx(Dt,{className:"w-4 h-4 mr-2"}),v.isPending?"Saving...":"Save"]})]})]})})]})}const fe=[{id:"edit",label:"EDIT",icon:Ue,hint:"Alt+1"},{id:"chat",label:"CHAT",icon:kn,hint:"Alt+2"},{id:"graph",label:"GRAPH",icon:vr,hint:"Alt+3"},{id:"table",label:"TABLE",icon:kr,hint:"Alt+4"},{id:"anki",label:"ANKI",icon:Fe,hint:"Alt+5"}];function jt({workspace:e}){const[n,s]=c.useState({}),r=c.useCallback(o=>{s(d=>({...d,[o]:(d[o]||0)+1}))},[]);c.useEffect(()=>{const o=d=>{if(!d.altKey||d.ctrlKey||d.metaKey)return;const h=parseInt(d.key,10)-1;h>=0&&h<fe.length&&(d.preventDefault(),e.setMainMode(fe[h].id))};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[e]);const a=e.mainMode,i=fe.findIndex(o=>o.id===a),l=c.useCallback(o=>{let d=null;o.key==="ArrowLeft"?d=i<=0?fe.length-1:i-1:o.key==="ArrowRight"?d=i>=fe.length-1?0:i+1:o.key==="Home"?d=0:o.key==="End"&&(d=fe.length-1),d!==null&&(o.preventDefault(),e.setMainMode(fe[d].id))},[i,e]);return t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsxs("div",{role:"tablist","aria-label":"Main content view",className:"tab-bar",children:[fe.map(o=>{const d=o.icon,h=a===o.id,p=`brain-tab-${o.id}`,g=`brain-tabpanel-${o.id}`;return t.jsxs("button",{id:p,role:"tab","aria-selected":h,"aria-controls":g,tabIndex:h?0:-1,onClick:()=>e.setMainMode(o.id),onKeyDown:l,className:X("tab-item",h&&"active"),title:o.hint,children:[t.jsx(d,{className:"w-3.5 h-3.5 shrink-0","aria-hidden":"true"}),o.label,o.id==="anki"&&e.pendingDrafts.length>0&&t.jsx("span",{className:"ml-1 px-1 py-0 text-xs bg-secondary text-primary-foreground font-arcade",children:e.pendingDrafts.length})]},o.id)}),t.jsxs("div",{className:"flex items-center gap-3 ml-auto pr-3 font-terminal text-xs",role:"status","aria-label":"Connection status",children:[t.jsxs("span",{className:"flex items-center gap-1","aria-label":e.obsidianStatus?.connected?"Obsidian: connected":"Obsidian: disconnected",children:[t.jsx("span",{className:X("w-1.5 h-1.5 rounded-full",e.obsidianStatus?.connected?"bg-success":"bg-destructive"),"aria-hidden":"true"}),t.jsx("span",{className:"text-muted-foreground hidden sm:inline",children:"Obsidian"})]}),t.jsxs("span",{className:"flex items-center gap-1","aria-label":e.ankiStatus?.connected?"Anki: connected":"Anki: disconnected",children:[t.jsx("span",{className:X("w-1.5 h-1.5 rounded-full",e.ankiStatus?.connected?"bg-success":"bg-destructive"),"aria-hidden":"true"}),t.jsx("span",{className:"text-muted-foreground hidden sm:inline",children:"Anki"})]}),e.pendingDrafts.length>0&&t.jsxs(We,{variant:"outline",className:"h-5 px-1.5 text-xs rounded-none border-secondary/50 text-secondary",children:[e.pendingDrafts.length," drafts"]})]})]}),t.jsxs("div",{className:"flex-1 min-h-0 overflow-hidden flex flex-col",children:[a==="edit"&&t.jsx("div",{id:"brain-tabpanel-edit",role:"tabpanel","aria-labelledby":"brain-tab-edit","data-tab":"edit",className:"flex-1 min-h-0 overflow-hidden flex flex-col brain-tab-enter",tabIndex:0,children:t.jsx(ke,{fallback:t.jsx(_e,{tabName:"EDIT",onReset:()=>r("edit")}),children:t.jsx(La,{workspace:e})},`edit-${n.edit||0}`)}),a==="chat"&&t.jsx("div",{id:"brain-tabpanel-chat",role:"tabpanel","aria-labelledby":"brain-tab-chat","data-tab":"chat",className:"flex-1 min-h-0 overflow-hidden flex flex-col brain-tab-enter",tabIndex:0,children:t.jsx(ke,{fallback:t.jsx(_e,{tabName:"CHAT",onReset:()=>r("chat")}),children:t.jsx(Da,{})},`chat-${n.chat||0}`)}),a==="graph"&&t.jsx("div",{id:"brain-tabpanel-graph",role:"tabpanel","aria-labelledby":"brain-tab-graph","data-tab":"graph",className:"flex-1 min-h-0 overflow-hidden flex flex-col brain-tab-enter",tabIndex:0,children:t.jsx(ke,{fallback:t.jsx(_e,{tabName:"GRAPH",onReset:()=>r("graph")}),children:t.jsx(Ga,{})},`graph-${n.graph||0}`)}),a==="table"&&t.jsx("div",{id:"brain-tabpanel-table",role:"tabpanel","aria-labelledby":"brain-tab-table","data-tab":"table",className:"flex-1 min-h-0 overflow-hidden flex flex-col brain-tab-enter",tabIndex:0,children:t.jsx(ke,{fallback:t.jsx(_e,{tabName:"TABLE",onReset:()=>r("table")}),children:t.jsx(Li,{})},`table-${n.table||0}`)}),a==="anki"&&t.jsx("div",{id:"brain-tabpanel-anki",role:"tabpanel","aria-labelledby":"brain-tab-anki","data-tab":"anki",className:"flex-1 min-h-0 overflow-hidden flex flex-col brain-tab-enter",tabIndex:0,children:t.jsx(ke,{fallback:t.jsx(_e,{tabName:"ANKI",onReset:()=>r("anki")}),children:t.jsx(Oi,{totalCards:e.metrics?.totalCards||0,compact:!0})},`anki-${n.anki||0}`)})]})]})}function $i(){const[e,n]=c.useState(""),[s,r]=c.useState(null),[a,i]=c.useState("auto"),[l,o]=c.useState([]),d=et(),{toast:h}=tt(),{data:p=[]}=Y({queryKey:["sessions"],queryFn:G.sessions.getAll}),x=p.map(f=>({id:f.id,date:f.date,topic:f.topic,mainTopic:f.mainTopic,mode:f.mode,createdAt:f.createdAt})).slice().sort((f,u)=>{const y=f.date||f.createdAt||"";return(u.date||u.createdAt||"").localeCompare(y)}).slice(0,20),j=me({mutationFn:()=>G.planner.generate(),onSuccess:f=>{h({title:"Planner tasks generated",description:`${f.tasks_created} review tasks created`}),d.invalidateQueries({queryKey:["planner","queue"]})},onError:f=>{h({title:"Failed to generate tasks",description:f.message,variant:"destructive"})}}),S=me({mutationFn:async()=>{if(!s)throw new Error("Select a session first");let f;try{f=JSON.parse(e)}catch{throw new Error("Invalid JSON â€” check syntax")}let u=a;if(u==="auto"){const v=Object.keys(f),T=["source_lock","plan_of_attack","frameworks_used","buckets","confusables_interleaved","anki_cards","glossary","exit_ticket_blurt","exit_ticket_muddiest","exit_ticket_next_action","retrospective_status","spaced_reviews","next_session","errors_by_type","errors_by_severity","error_patterns","spacing_algorithm","rsr_adaptive_adjustment","adaptive_multipliers"];u=v.some(_=>T.includes(_))?"enhanced":"tracker"}const y=u==="tracker"?f:void 0,b=u==="enhanced"?f:void 0;return G.brain.ingestSessionJson(s,y,b)},onSuccess:f=>{h({title:"JSON ingested",description:`${f.fields_updated} fields updated on session #${f.session_id}`}),d.invalidateQueries({queryKey:["sessions"]}),d.invalidateQueries({queryKey:["brain","metrics"]}),h({title:"Next step: Generate planner tasks?",description:"Create review tasks from weak anchors",duration:1e4,action:t.jsx(q,{size:"sm",onClick:()=>j.mutate(),disabled:j.isPending,className:"bg-primary text-black hover:bg-primary/80",children:j.isPending?"Generating...":"Generate Now"})}),n(""),o([])},onError:f=>{h({title:"Ingestion failed",description:f.message,variant:"destructive"})}});function I(){const f=[];if(s||f.push("Select a session"),!e.trim())f.push("Paste JSON first");else try{const u=JSON.parse(e);(typeof u!="object"||Array.isArray(u))&&f.push("JSON must be an object, not array"),u.schema_version&&u.schema_version!=="9.4"&&f.push(`Expected schema_version 9.4, got ${u.schema_version}`)}catch{f.push("Invalid JSON syntax")}return o(f),f.length===0}return t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 bg-primary inline-block"}),"SESSION_JSON_INGEST"]})}),t.jsxs(Ie,{className:"p-4 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"TARGET SESSION"}),t.jsxs("select",{value:s??"",onChange:f=>r(f.target.value?Number(f.target.value):null),className:"w-full bg-black border border-primary/50 text-white font-terminal text-xs p-2 rounded-none focus:border-primary outline-none",children:[t.jsx("option",{value:"",children:"-- select session --"}),x.map(f=>t.jsxs("option",{value:f.id,children:["#",f.id," | ",f.date?.slice(0,10)||"?"," | ",f.topic||f.mainTopic||"Untitled"," | ",f.mode||"?"]},f.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"JSON TYPE"}),t.jsx("div",{className:"flex gap-2",children:["auto","tracker","enhanced"].map(f=>t.jsx("button",{onClick:()=>i(f),className:`px-3 py-1 font-arcade text-xs rounded-none border ${a===f?"bg-primary text-black border-primary":"border-primary/30 text-muted-foreground hover:text-white"}`,children:f.toUpperCase()},f))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"font-terminal text-xs text-muted-foreground block mb-1",children:"PASTE TRACKER OR ENHANCED JSON"}),t.jsx("textarea",{value:e,onChange:f=>n(f.target.value),placeholder:'{"schema_version": "9.4", "topic": "...", "mode": "Core", ...}',rows:10,className:"w-full bg-black border border-primary/50 text-green-400 font-terminal text-xs p-2 rounded-none focus:border-primary outline-none resize-y"})]}),l.length>0&&t.jsx("div",{className:"border border-red-500/50 bg-red-500/10 p-2 font-terminal text-xs text-red-400 space-y-1",children:l.map((f,u)=>t.jsxs("div",{children:["- ",f]},u))}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>{I()&&S.mutate()},disabled:S.isPending,className:"px-4 py-2 bg-primary text-black font-arcade text-xs rounded-none hover:bg-primary/80 disabled:opacity-50",children:S.isPending?"INGESTING...":"INGEST"}),t.jsx("button",{onClick:I,className:"px-4 py-2 border border-primary/50 text-primary font-arcade text-xs rounded-none hover:bg-primary/10",children:"VALIDATE"}),t.jsx("button",{onClick:()=>{n(""),o([])},className:"px-4 py-2 border border-primary/30 text-muted-foreground font-arcade text-xs rounded-none hover:text-white",children:"CLEAR"})]})]})]})}const Fi=`You are extracting a course schedule for ingestion.

Return ONLY a valid JSON object with NO additional text, NO markdown code blocks, NO explanation.

Structure:
{
  "name": "Course Name (e.g. Anatomy & Physiology II)",
  "term": {
    "startDate": "2026-01-05",
    "endDate": "2026-04-24",
    "timezone": "America/Chicago"
  },
  "events": [
    {
      "type": "class" | "lecture" | "reading" | "topic" | "assignment" | "quiz" | "exam" | "assessment",
      "title": "string",
      "date": "YYYY-MM-DD",
      "dueDate": "YYYY-MM-DD | null",
      "startTime": "HH:MM | null",
      "endTime": "HH:MM | null",
      "daysOfWeek": ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
      "delivery": "in_person" | "virtual_sync" | "virtual_async" | "hybrid",
      "assessmentType": "EA | null",
      "moduleName": "Module 1: ... | null",
      "notes": "string | null"
    }
  ]
}

Rules:
1. Include ALL schedule items: class meetings, assignments, quizzes, exams, readings, virtual activities, and learning assessments (EA).
2. For repeating class meetings, set daysOfWeek + startTime/endTime, and include term start/end.
3. For one-off items, set date or dueDate.
4. Do NOT include a "modules" array â€” schedule only.
5. Return ONLY the JSON object, nothing else.

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,Hi=`You are extracting course module structure for ingestion.

Return ONLY a valid JSON object with NO additional text, NO markdown code blocks, NO explanation.

Structure:
{
  "modules": [
    {
      "name": "Module 1: Topic Name",
      "orderIndex": 1,
      "topics": ["Topic A", "Topic B"],
      "readings": ["Chapter 1", "Article X"],
      "assessments": ["Quiz 1", "Exam 1"]
    }
  ]
}

Rules:
1. Include ALL modules/units with their topics, readings, and assessments.
2. orderIndex should be sequential starting at 1.
3. Do NOT include dates or events â€” structure only.
4. Return ONLY the JSON object, nothing else.

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,Vi=`I need you to extract learning objectives from my course material.

Return ONLY a valid JSON array with NO additional text, NO markdown code blocks, NO explanation.

Structure for each item:
{
  "loCode": "string",
  "title": "string"
}

Rules:
1. loCode: Preserve original numbering if present, or create sequential "1", "2", "3"...
2. title: Keep the objective text exactly as written
3. Return ONLY the JSON array, nothing else

Here are my learning objectives:

[PASTE YOUR LOs BELOW]`,Gi=`I need you to convert my study session notes into WRAP format.

WRAP format has 4 sections:

Section A: Obsidian Notes
- Main concepts and insights from the session
- Key points to remember

Section B: Anki Cards
- Format: "front: [question]" on one line, "back: [answer]" on next line
- Create cards for important facts and concepts

Section C: Spaced Schedule
- R1=tomorrow
- R2=3d
- R3=1w
- R4=2w

Section D: JSON Logs
\`\`\`json
{
  "merged": {
    "topic": "[main topic]",
    "mode": "Core",
    "duration_minutes": [number],
    "understanding": [1-5],
    "retention": [1-5]
  }
}
\`\`\`

Return ONLY the WRAP formatted content, NO additional text or explanation.

Here are my study notes:

[PASTE YOUR NOTES BELOW]`;function Bi(){const e=et(),[n,s]=c.useState(null),[r,a]=c.useState(null),[i,l]=c.useState("schedule"),[o,d]=c.useState(""),[h,p]=c.useState(""),[g,x]=c.useState(""),[j,S]=c.useState(""),[I,f]=c.useState(null),[u,y]=c.useState(null),[b,v]=c.useState(null),[T,_]=c.useState(null),[k,w]=c.useState(null),[F,E]=c.useState(null),{data:P=[]}=Y({queryKey:["courses"],queryFn:()=>G.courses.getActive()}),{data:D=[]}=Y({queryKey:["modules",n],queryFn:()=>n?G.modules.getByCourse(n):Promise.resolve([]),enabled:!!n}),{data:H=[]}=Y({queryKey:["learningObjectives",n],queryFn:()=>n?G.learningObjectives.getByCourse(n):Promise.resolve([]),enabled:!!n}),R=m=>{const N=m.trim();if(!N)return"";const A=N.match(/```json\s*([\s\S]*?)```/i)||N.match(/```\s*([\s\S]*?)```/i),C=A?A[1].trim():N,z=C.indexOf("["),L=C.lastIndexOf("]"),V=C.indexOf("{"),U=C.lastIndexOf("}");return z!==-1&&L!==-1&&L>z&&(V===-1||z<V)?C.slice(z,L+1).trim():V!==-1&&U!==-1&&U>V?C.slice(V,U+1).trim():C},M=m=>{navigator.clipboard.writeText(m)},O=me({mutationFn:async m=>{if(!n)throw new Error("Select a course first");const A={...JSON.parse(R(m)),modules:[]};return G.syllabus.importBulk(n,A)},onSuccess:m=>{e.invalidateQueries({queryKey:["scheduleEvents"]}),d(""),w(null),v({type:"success",message:`Imported: ${m.eventsCreated} events (${m.classMeetingsExpanded} class meetings expanded)`}),f(null)},onError:m=>{v({type:"error",message:m.message||"Failed to import schedule"})}}),B=me({mutationFn:async m=>{if(!n)throw new Error("Select a course first");const N=JSON.parse(R(m)),A=N.modules||N;return G.modules.createBulk(n,A)},onSuccess:()=>{e.invalidateQueries({queryKey:["modules"]}),p(""),E(null),_({type:"success",message:"Modules imported successfully"}),f(null)},onError:m=>{_({type:"error",message:m.message||"Failed to import modules"})}}),K=me({mutationFn:async m=>{if(!n)throw new Error("Select a course first");const N=JSON.parse(R(m));return G.learningObjectives.createBulk(n,r,N)},onSuccess:()=>{e.invalidateQueries({queryKey:["learningObjectives"]}),x(""),f(null)},onError:m=>{f(m.message||"Failed to import LOs")}}),se=m=>{const N=[];try{const A=R(m);if(!A){w({isValid:!1,errors:["No JSON found"]});return}const C=JSON.parse(A);(!C||typeof C!="object")&&N.push("JSON must be an object"),(!C.name||typeof C.name!="string")&&N.push("Missing 'name' field"),!C.term||typeof C.term!="object"?N.push("Missing 'term' object"):(C.term.startDate||N.push("term.startDate is required"),C.term.endDate||N.push("term.endDate is required")),Array.isArray(C.events)||N.push("Missing 'events' array"),N.length===0?w({isValid:!0,errors:[],preview:{courseName:C.name,eventCount:C.events.length,startDate:C.term?.startDate,endDate:C.term?.endDate}}):w({isValid:!1,errors:N})}catch(A){w({isValid:!1,errors:[`Invalid JSON: ${A.message}`]})}},de=m=>{const N=[];try{const A=R(m);if(!A){E({isValid:!1,errors:["No JSON found"]});return}const C=JSON.parse(A),z=C.modules||(Array.isArray(C)?C:null);Array.isArray(z)?z.length===0&&N.push("modules array is empty"):N.push("Missing 'modules' array"),N.length===0?E({isValid:!0,errors:[],preview:{moduleCount:z.length}}):E({isValid:!1,errors:N})}catch(A){E({isValid:!1,errors:[`Invalid JSON: ${A.message}`]})}},ae=async()=>{try{y(null);const m=await G.brain.chat(j,!1,"wrap");m.sessionSaved?(y({type:"success",message:`Session saved! ID: ${m.sessionId}, Cards: ${m.cardsCreated||0}`}),S("")):y({type:"error",message:m.sessionError||"Failed to process WRAP content"})}catch(m){y({type:"error",message:m.message||"Failed to ingest"})}},re=[{key:"schedule",label:"SCHEDULE",icon:t.jsx(Yt,{className:"w-3.5 h-3.5"})},{key:"modules",label:"MODULES",icon:t.jsx(Fe,{className:"w-3.5 h-3.5"})},{key:"objectives",label:"OBJECTIVES",icon:t.jsx(St,{className:"w-3.5 h-3.5"})}];return t.jsxs("div",{className:"space-y-6 p-4",children:[t.jsx($i,{}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),t.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:n||"",onChange:m=>{s(m.target.value?parseInt(m.target.value):null),a(null)},children:[t.jsx("option",{value:"",children:"-- Select Course --"}),P.map(m=>t.jsx("option",{value:m.id,children:m.name},m.id))]})]}),!n&&t.jsx("p",{className:"text-center text-muted-foreground font-terminal text-sm py-8",children:"Select a course above to begin ingestion."}),n&&t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none mb-6",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-2",children:[t.jsx(Os,{className:"w-4 h-4"}),"WRAP SESSION INGESTION"]})}),t.jsxs(Ie,{className:"p-4",children:[u&&t.jsx("div",{className:`mb-4 p-3 rounded-none font-terminal text-sm ${u.type==="success"?"bg-success/20 border border-success text-success":"bg-destructive/20 border border-destructive text-destructive"}`,children:u.message}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("button",{onClick:()=>M(Gi),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),t.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Use ChatGPT to convert your notes to WRAP format, then paste or upload below:"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm mb-2 font-terminal text-muted-foreground",children:"Paste WRAP Content"}),t.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-48 font-terminal text-sm",placeholder:"Paste your WRAP session here...",value:j,onChange:m=>{S(m.target.value),y(null)}})]}),t.jsx("button",{onClick:ae,disabled:!j,className:"bg-primary hover:bg-primary/80 disabled:opacity-50 px-6 py-3 rounded-none font-arcade text-sm w-full",type:"button",children:"INGEST WRAP SESSION"})]})]})]}),n&&I&&t.jsx("div",{className:"bg-destructive/20 border border-destructive rounded-none p-3 text-destructive font-terminal",children:I}),n&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex border-b border-primary/50",children:re.map(m=>t.jsxs("button",{onClick:()=>l(m.key),className:`flex items-center gap-1.5 px-4 py-2 font-arcade text-xs border-b-2 transition-colors ${i===m.key?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-primary/70"}`,type:"button",children:[m.icon,m.label]},m.key))}),i==="schedule"&&t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-2",children:[t.jsx(Yt,{className:"w-4 h-4"}),"SCHEDULE IMPORT"]})}),t.jsxs(Ie,{className:"p-4 space-y-4",children:[t.jsx("button",{onClick:()=>M(Fi),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),t.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (schedule JSON) below:"}),t.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-40 font-terminal text-sm",placeholder:'{"name":"...","term":{...},"events":[...]}',value:o,onChange:m=>{d(m.target.value),v(null),m.target.value.trim()?se(m.target.value):w(null)}}),k&&!k.isValid&&t.jsxs("div",{className:"p-2 border border-destructive bg-destructive/20 rounded-none font-terminal text-xs text-destructive",children:[t.jsx("div",{className:"font-bold mb-1",children:"Validation Errors:"}),k.errors.map((m,N)=>t.jsxs("div",{children:["â€¢ ",m]},N))]}),k?.isValid&&k.preview&&t.jsxs("div",{className:"p-3 border border-primary bg-primary/10 rounded-none font-terminal text-xs text-primary",children:[t.jsx("div",{className:"font-bold mb-2",children:"Valid JSON Preview:"}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Course:"})," ",k.preview.courseName]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Events:"})," ",k.preview.eventCount]}),k.preview.startDate&&t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Start:"})," ",k.preview.startDate]}),k.preview.endDate&&t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"End:"})," ",k.preview.endDate]})]})]}),t.jsx("button",{onClick:()=>O.mutate(o),disabled:!k?.isValid||O.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:O.isPending?"Importing...":"Import Schedule"}),b&&t.jsx("div",{className:`p-2 border font-terminal text-xs ${b.type==="success"?"border-success text-success":"border-destructive text-destructive"}`,children:b.message})]})]}),i==="modules"&&t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-2",children:[t.jsx(Fe,{className:"w-4 h-4"}),"MODULES IMPORT"]})}),t.jsxs(Ie,{className:"p-4 space-y-4",children:[t.jsx("button",{onClick:()=>M(Hi),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),t.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (modules JSON) below:"}),t.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-40 font-terminal text-sm",placeholder:'{"modules":[{"name":"Module 1: ...","orderIndex":1,"topics":[...],"readings":[...],"assessments":[...]}]}',value:h,onChange:m=>{p(m.target.value),_(null),m.target.value.trim()?de(m.target.value):E(null)}}),F&&!F.isValid&&t.jsxs("div",{className:"p-2 border border-destructive bg-destructive/20 rounded-none font-terminal text-xs text-destructive",children:[t.jsx("div",{className:"font-bold mb-1",children:"Validation Errors:"}),F.errors.map((m,N)=>t.jsxs("div",{children:["â€¢ ",m]},N))]}),F?.isValid&&F.preview&&t.jsxs("div",{className:"p-3 border border-primary bg-primary/10 rounded-none font-terminal text-xs text-primary",children:[t.jsx("div",{className:"font-bold mb-2",children:"Valid JSON Preview:"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted-foreground",children:"Modules:"})," ",F.preview.moduleCount]})]}),t.jsx("button",{onClick:()=>B.mutate(h),disabled:!F?.isValid||B.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:B.isPending?"Importing...":"Import Modules"}),T&&t.jsx("div",{className:`p-2 border font-terminal text-xs ${T.type==="success"?"border-success text-success":"border-destructive text-destructive"}`,children:T.message})]})]}),i==="objectives"&&t.jsxs(Ee,{className:"bg-black/40 border-2 border-primary rounded-none",children:[t.jsx(Pe,{className:"border-b border-primary/50 p-4",children:t.jsxs(Re,{className:"font-arcade text-sm flex items-center gap-2",children:[t.jsx(St,{className:"w-4 h-4"}),"LEARNING OBJECTIVES IMPORT"]})}),t.jsxs(Ie,{className:"p-4 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs mb-1 font-terminal text-muted-foreground",children:"Target Module (optional)"}),t.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:r||"",onChange:m=>a(m.target.value?parseInt(m.target.value):null),children:[t.jsx("option",{value:"",children:"-- No Module (Course-level) --"}),D.map(m=>t.jsx("option",{value:m.id,children:m.name},m.id))]})]}),t.jsx("button",{onClick:()=>M(Vi),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal",type:"button",children:"Copy Prompt for ChatGPT"}),t.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"Paste the ChatGPT response (JSON array) below:"}),t.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-32 font-terminal text-sm",placeholder:'[{"loCode": "1.1", "title": "Define..."}]',value:g,onChange:m=>x(m.target.value)}),t.jsx("button",{onClick:()=>K.mutate(g),disabled:!g||K.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none font-terminal text-xs",type:"button",children:K.isPending?"Importing...":"Import LOs"}),H.length>0&&t.jsxs("div",{children:[t.jsxs("h4",{className:"font-terminal text-xs mb-2",children:["Current LOs (",H.length,")"]}),t.jsx("div",{className:"max-h-48 overflow-y-auto",children:H.map(m=>t.jsxs("div",{className:"text-xs py-1 border-b border-secondary/30 font-terminal",children:[t.jsx("span",{className:"text-primary",children:m.loCode}),": ",m.title,t.jsx("span",{className:`ml-2 text-xs px-1 rounded-none ${m.status==="solid"?"bg-success":m.status==="in_progress"?"bg-warning":m.status==="need_review"?"bg-urgent":"bg-secondary"}`,children:m.status})]},m.id))})]})]})]})]})]})}function qi({workspace:e}){return t.jsx(It,{open:e.importOpen,onOpenChange:e.setImportOpen,children:t.jsxs(zt,{"data-modal":"brain-import",className:"max-w-2xl bg-black border-2 border-primary rounded-none",children:[t.jsxs(At,{children:[t.jsxs(Tt,{className:"font-arcade text-sm text-primary flex items-center gap-2",children:[t.jsx(Pn,{className:"w-4 h-4"}),"IMPORT / INGEST"]}),t.jsx(Mt,{className:"font-terminal text-xs text-muted-foreground",children:"Import study materials, JSON session data, or documents into the system."})]}),t.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:t.jsx(Bi,{})})]})})}const Ki=["vault","main"];function vn(){if(typeof window>"u")return"main";const n=new URLSearchParams(window.location.search).get("tab");return Ki.includes(n)?n:"main"}function Ui(e){if(typeof window>"u")return;const n=new URLSearchParams(window.location.search);n.set("tab",e);const s=`${window.location.pathname}?${n.toString()}`;window.history.replaceState({},"",s)}function Wi(){const e=na(),[n,s]=c.useState("main"),[r,a]=c.useState(!1),i=c.useRef(!1);c.useEffect(()=>{s(vn())},[]),c.useEffect(()=>{if(i.current)return;i.current=!0;const o=requestAnimationFrame(()=>{requestAnimationFrame(()=>a(!0))});return()=>cancelAnimationFrame(o)},[]);const l=c.useCallback(o=>{s(o),Ui(o)},[]);return c.useEffect(()=>{const o=()=>{s(vn())};return window.addEventListener("popstate",o),()=>window.removeEventListener("popstate",o)},[]),c.useEffect(()=>{const o=d=>{d.ctrlKey&&d.key==="i"&&(d.preventDefault(),e.setImportOpen(!0))};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[e]),t.jsx(As,{children:t.jsxs("div",{className:`brain-workspace fixed inset-x-0 top-[68px] bottom-[48px] flex flex-col min-w-0 overflow-hidden z-30 ${r?"brain-workspace--ready":""}`,"data-active-tab":e.mainMode,children:[t.jsx("div",{className:"hidden lg:flex flex-1 min-h-0",children:e.sidebarExpanded?t.jsxs(Zr,{direction:"horizontal",autoSaveId:"brain-workspace-v2",className:"h-full",children:[t.jsx(on,{defaultSize:20,minSize:12,maxSize:35,children:t.jsx("div",{className:"brain-workspace__sidebar-wrap brain-sidebar-expand h-full border-r border-primary/30 bg-black/40",children:t.jsx(cn,{workspace:e,onCollapse:e.toggleSidebar})})}),t.jsx(ea,{withHandle:!0,className:"hover:bg-primary/10 transition-colors data-[resize-handle-active]:bg-primary/20"}),t.jsx(on,{defaultSize:80,minSize:50,children:t.jsx("div",{className:"brain-workspace__main-wrap brain-workspace__canvas h-full min-h-0 overflow-hidden",children:t.jsx(jt,{workspace:e})})})]}):t.jsxs("div",{className:"flex flex-1 min-h-0 h-full",children:[t.jsx(ia,{onExpand:e.toggleSidebar,workspace:e}),t.jsx("div",{className:"brain-workspace__main-wrap brain-workspace__canvas flex-1 min-h-0 h-full overflow-hidden",children:t.jsx(jt,{workspace:e})})]})}),t.jsxs("div",{className:"flex flex-col flex-1 min-h-0 lg:hidden",children:[t.jsxs("div",{className:"brain-workspace__canvas flex-1 min-h-0 overflow-auto",children:[n==="vault"&&t.jsx(cn,{workspace:e}),n==="main"&&t.jsx(jt,{workspace:e})]}),t.jsxs("nav",{className:"flex items-center border-t-2 border-primary/50 bg-black/80 shrink-0","aria-label":"Mobile navigation",children:[t.jsxs("button",{onClick:()=>l("vault"),className:`flex-1 flex flex-col items-center gap-0.5 py-3 text-xs font-terminal transition-colors ${n==="vault"?"text-primary":"text-muted-foreground"}`,"aria-current":n==="vault"?"page":void 0,"aria-label":"Vault",children:[t.jsx(Nn,{className:"w-5 h-5","aria-hidden":"true"}),"Vault"]}),t.jsxs("button",{onClick:()=>l("main"),className:`flex-1 flex flex-col items-center gap-0.5 py-3 text-xs font-terminal transition-colors ${n==="main"?"text-primary":"text-muted-foreground"}`,"aria-current":n==="main"?"page":void 0,"aria-label":"Content",children:[t.jsx(Ue,{className:"w-5 h-5","aria-hidden":"true"}),"Content"]})]})]}),t.jsx(qi,{workspace:e})]})})}const po=Object.freeze(Object.defineProperty({__proto__:null,default:Wi},Symbol.toStringTag,{value:"Module"}));export{Pn as D,gr as M,xr as a,po as b,_i as t};

import{c as Ce,r as i,j as e,b as E,R as Is,d as Ds,e as k,f as Ts,P as He,g as Es,u as Ye,X as oe}from"./index-6ypeUSBG.js";import{h as Ps,i as Rs,j as Fs,u as F,a as z,g,L as Ms,k as Ls,C as le,B as b,f as _s,S as be,l as Ne,T as W,P as ce,D as Ee,c as Pe,d as Re,e as Fe,m as Me,I as Le,n as Y,o as _e}from"./layout-IL1eaOBx.js";import{C as ee,c as se,a as ie,b as de}from"./card-ia28aHge.js";import{e as qs,B as me,S as qe,a as ze,b as $e,c as Be,d as T}from"./select-BhqDjebt.js";import{c as Ue,R as zs,T as $s,C as Bs,a as je}from"./index-Cuk1uVqr.js";import{T as Ks,A as Gs,a as Hs,b as Ys,c as Us,d as Ws,e as Vs,f as Js,g as Qs}from"./alert-dialog-D8Qp4vHt.js";import{F as Xs,a as Ke}from"./folder-CZD-oWhR.js";import{F as Zs}from"./file-text-B5g1xveO.js";import{R as Ge}from"./refresh-cw-o_ATFIoH.js";import{i as et,f as st}from"./format-D7m0hUtg.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],at=Ce("database",tt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],rt=Ce("file",nt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],lt=Ce("layers",ot),We=i.forwardRef(({className:t,...n},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:E("w-full caption-bottom text-sm",t),...n})}));We.displayName="Table";const Ve=i.forwardRef(({className:t,...n},a)=>e.jsx("thead",{ref:a,className:E("[&_tr]:border-b",t),...n}));Ve.displayName="TableHeader";const Je=i.forwardRef(({className:t,...n},a)=>e.jsx("tbody",{ref:a,className:E("[&_tr:last-child]:border-0",t),...n}));Je.displayName="TableBody";const ct=i.forwardRef(({className:t,...n},a)=>e.jsx("tfoot",{ref:a,className:E("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...n}));ct.displayName="TableFooter";const ye=i.forwardRef(({className:t,...n},a)=>e.jsx("tr",{ref:a,className:E("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...n}));ye.displayName="TableRow";const _=i.forwardRef(({className:t,...n},a)=>e.jsx("th",{ref:a,className:E("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...n}));_.displayName="TableHead";const q=i.forwardRef(({className:t,...n},a)=>e.jsx("td",{ref:a,className:E("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...n}));q.displayName="TableCell";const it=i.forwardRef(({className:t,...n},a)=>e.jsx("caption",{ref:a,className:E("mt-4 text-sm text-muted-foreground",t),...n}));it.displayName="TableCaption";function dt(t,n,{checkForDefaultPrevented:a=!0}={}){return function(d){if(t?.(d),a===!1||!d.defaultPrevented)return n?.(d)}}var mt=Is[" useInsertionEffect ".trim().toString()]||Ds;function Qe({prop:t,defaultProp:n,onChange:a=()=>{},caller:c}){const[d,l,f]=xt({defaultProp:n,onChange:a}),x=t!==void 0,y=x?t:d;{const m=i.useRef(t!==void 0);i.useEffect(()=>{const p=m.current;p!==x&&console.warn(`${c} is changing from ${p?"controlled":"uncontrolled"} to ${x?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),m.current=x},[x,c])}const S=i.useCallback(m=>{if(x){const p=ut(m)?m(t):m;p!==t&&f.current?.(p)}else l(m)},[x,t,l,f]);return[y,S]}function xt({defaultProp:t,onChange:n}){const[a,c]=i.useState(t),d=i.useRef(a),l=i.useRef(n);return mt(()=>{l.current=n},[n]),i.useEffect(()=>{d.current!==a&&(l.current?.(a),d.current=a)},[a,d]),[a,c,l]}function ut(t){return typeof t=="function"}var P="Accordion",ht=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[we,pt,ft]=qs(P),[ue]=Ts(P,[ft,Ue]),ke=Ue(),Xe=k.forwardRef((t,n)=>{const{type:a,...c}=t,d=c,l=c;return e.jsx(we.Provider,{scope:t.__scopeAccordion,children:a==="multiple"?e.jsx(jt,{...l,ref:n}):e.jsx(Nt,{...d,ref:n})})});Xe.displayName=P;var[Ze,gt]=ue(P),[es,bt]=ue(P,{collapsible:!1}),Nt=k.forwardRef((t,n)=>{const{value:a,defaultValue:c,onValueChange:d=()=>{},collapsible:l=!1,...f}=t,[x,y]=Qe({prop:a,defaultProp:c??"",onChange:d,caller:P});return e.jsx(Ze,{scope:t.__scopeAccordion,value:k.useMemo(()=>x?[x]:[],[x]),onItemOpen:y,onItemClose:k.useCallback(()=>l&&y(""),[l,y]),children:e.jsx(es,{scope:t.__scopeAccordion,collapsible:l,children:e.jsx(ss,{...f,ref:n})})})}),jt=k.forwardRef((t,n)=>{const{value:a,defaultValue:c,onValueChange:d=()=>{},...l}=t,[f,x]=Qe({prop:a,defaultProp:c??[],onChange:d,caller:P}),y=k.useCallback(m=>x((p=[])=>[...p,m]),[x]),S=k.useCallback(m=>x((p=[])=>p.filter(O=>O!==m)),[x]);return e.jsx(Ze,{scope:t.__scopeAccordion,value:f,onItemOpen:y,onItemClose:S,children:e.jsx(es,{scope:t.__scopeAccordion,collapsible:!0,children:e.jsx(ss,{...l,ref:n})})})}),[yt,he]=ue(P),ss=k.forwardRef((t,n)=>{const{__scopeAccordion:a,disabled:c,dir:d,orientation:l="vertical",...f}=t,x=k.useRef(null),y=Es(x,n),S=pt(a),p=Rs(d)==="ltr",O=dt(t.onKeyDown,C=>{if(!ht.includes(C.key))return;const w=C.target,R=S().filter(N=>!N.ref.current?.disabled),h=R.findIndex(N=>N.ref.current===w),v=R.length;if(h===-1)return;C.preventDefault();let u=h;const M=0,A=v-1,I=()=>{u=h+1,u>A&&(u=M)},$=()=>{u=h-1,u<M&&(u=A)};switch(C.key){case"Home":u=M;break;case"End":u=A;break;case"ArrowRight":l==="horizontal"&&(p?I():$());break;case"ArrowDown":l==="vertical"&&I();break;case"ArrowLeft":l==="horizontal"&&(p?$():I());break;case"ArrowUp":l==="vertical"&&$();break}const r=u%v;R[r].ref.current?.focus()});return e.jsx(yt,{scope:a,disabled:c,direction:d,orientation:l,children:e.jsx(we.Slot,{scope:a,children:e.jsx(He.div,{...f,"data-orientation":l,ref:y,onKeyDown:c?void 0:O})})})}),xe="AccordionItem",[vt,Ae]=ue(xe),ts=k.forwardRef((t,n)=>{const{__scopeAccordion:a,value:c,...d}=t,l=he(xe,a),f=gt(xe,a),x=ke(a),y=Ps(),S=c&&f.value.includes(c)||!1,m=l.disabled||t.disabled;return e.jsx(vt,{scope:a,open:S,disabled:m,triggerId:y,children:e.jsx(zs,{"data-orientation":l.orientation,"data-state":cs(S),...x,...d,ref:n,disabled:m,open:S,onOpenChange:p=>{p?f.onItemOpen(c):f.onItemClose(c)}})})});ts.displayName=xe;var as="AccordionHeader",ns=k.forwardRef((t,n)=>{const{__scopeAccordion:a,...c}=t,d=he(P,a),l=Ae(as,a);return e.jsx(He.h3,{"data-orientation":d.orientation,"data-state":cs(l.open),"data-disabled":l.disabled?"":void 0,...c,ref:n})});ns.displayName=as;var ve="AccordionTrigger",rs=k.forwardRef((t,n)=>{const{__scopeAccordion:a,...c}=t,d=he(P,a),l=Ae(ve,a),f=bt(ve,a),x=ke(a);return e.jsx(we.ItemSlot,{scope:a,children:e.jsx($s,{"aria-disabled":l.open&&!f.collapsible||void 0,"data-orientation":d.orientation,id:l.triggerId,...x,...c,ref:n})})});rs.displayName=ve;var os="AccordionContent",ls=k.forwardRef((t,n)=>{const{__scopeAccordion:a,...c}=t,d=he(P,a),l=Ae(os,a),f=ke(a);return e.jsx(Bs,{role:"region","aria-labelledby":l.triggerId,"data-orientation":d.orientation,...f,...c,ref:n,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});ls.displayName=os;function cs(t){return t?"open":"closed"}var St=Xe,Ct=ts,wt=ns,is=rs,ds=ls;const Se=St,V=i.forwardRef(({className:t,...n},a)=>e.jsx(Ct,{ref:a,className:E("border-b",t),...n}));V.displayName="AccordionItem";const J=i.forwardRef(({className:t,children:n,...a},c)=>e.jsx(wt,{className:"flex",children:e.jsxs(is,{ref:c,className:E("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",t),...a,children:[n,e.jsx(Fs,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})}));J.displayName=is.displayName;const Q=i.forwardRef(({className:t,children:n,...a},c)=>e.jsx(ds,{ref:c,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...a,children:e.jsx("div",{className:E("pb-4 pt-0",t),children:n})}));Q.displayName=ds.displayName;const kt=`I need you to extract schedule events from my course syllabus.

Return ONLY a valid JSON array with NO additional text, NO markdown code blocks, NO explanation.

Structure for each item:
{
  "type": "chapter" | "quiz" | "assignment" | "exam",
  "title": "string",
  "dueDate": "YYYY-MM-DD",
  "notes": "optional string or null"
}

Rules:
1. type must be EXACTLY one of: "chapter", "quiz", "assignment", "exam"
2. dueDate must be ISO format (YYYY-MM-DD) - if no date given, use null
3. Return ONLY the JSON array, nothing else

Here's my syllabus:

[PASTE YOUR SYLLABUS BELOW]`,At=`I need you to extract learning objectives from my course material.

Return ONLY a valid JSON array with NO additional text, NO markdown code blocks, NO explanation.

Structure for each item:
{
  "loCode": "string",
  "title": "string"
}

Rules:
1. loCode: Preserve original numbering if present, or create sequential "1", "2", "3"...
2. title: Keep the objective text exactly as written
3. Return ONLY the JSON array, nothing else

Here are my learning objectives:

[PASTE YOUR LOs BELOW]`,Ot=`I need you to convert my study session notes into WRAP format.

WRAP format has 4 sections:

Section A: Obsidian Notes
- Main concepts and insights from the session
- Key points to remember

Section B: Anki Cards
- Format: "front: [question]" on one line, "back: [answer]" on next line
- Create cards for important facts and concepts

Section C: Spaced Schedule
- R1=tomorrow
- R2=3d
- R3=1w
- R4=2w

Section D: JSON Logs
\`\`\`json
{
  "merged": {
    "topic": "[main topic]",
    "mode": "Core",
    "duration_minutes": [number],
    "understanding": [1-5],
    "retention": [1-5]
  }
}
\`\`\`

Return ONLY the WRAP formatted content, NO additional text or explanation.

Here are my study notes:

[PASTE YOUR NOTES BELOW]`;function It(){const t=Ye(),[n,a]=i.useState(null),[c,d]=i.useState(null),[l,f]=i.useState(""),[x,y]=i.useState(""),[S,m]=i.useState(null),[p,O]=i.useState(""),[C,w]=i.useState(null),{data:R=[]}=F({queryKey:["courses"],queryFn:()=>g.courses.getActive()}),{data:h=[]}=F({queryKey:["modules",n],queryFn:()=>n?g.modules.getByCourse(n):Promise.resolve([]),enabled:!!n}),{data:v=[]}=F({queryKey:["learningObjectives",n],queryFn:()=>n?g.learningObjectives.getByCourse(n):Promise.resolve([]),enabled:!!n}),u=z({mutationFn:async r=>{if(!n)throw new Error("Select a course first");const N=JSON.parse(r);return g.scheduleEvents.createBulk(n,N)},onSuccess:()=>{t.invalidateQueries({queryKey:["scheduleEvents"]}),f(""),m(null)},onError:r=>{m(r.message||"Failed to import schedule")}}),M=z({mutationFn:async r=>{if(!n)throw new Error("Select a course first");const N=JSON.parse(r);return g.learningObjectives.createBulk(n,c,N)},onSuccess:()=>{t.invalidateQueries({queryKey:["learningObjectives"]}),y(""),m(null)},onError:r=>{m(r.message||"Failed to import LOs")}}),A=z({mutationFn:({id:r,data:N})=>g.modules.update(r,N),onSuccess:()=>{t.invalidateQueries({queryKey:["modules"]})}}),I=r=>{navigator.clipboard.writeText(r)},$=async()=>{try{w(null);const r=p,B=await g.brain.ingest(r,"pasted_wrap.md");B.sessionSaved?(w({type:"success",message:`âœ“ Session saved! ID: ${B.sessionId}, Cards: ${B.cardsCreated||0}`}),O("")):w({type:"error",message:B.errors?.join(", ")||B.message})}catch(r){w({type:"error",message:r.message||"Failed to ingest"})}};return e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"border-2 border-primary rounded-none p-4 bg-primary/5",children:[e.jsx("h2",{className:"text-xl font-arcade text-primary mb-4",children:"WRAP SESSION INGESTION"}),C&&e.jsx("div",{className:`mb-4 p-3 rounded-none font-terminal text-sm ${C.type==="success"?"bg-green-900/30 border border-green-500 text-green-400":"bg-red-900/30 border border-red-500 text-red-400"}`,children:C.message}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:()=>I(Ot),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Use ChatGPT to convert your notes to WRAP format, then paste or upload below:"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-2 font-terminal text-muted-foreground",children:"Paste WRAP Content"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-48 font-terminal text-sm",placeholder:"Paste your WRAP session here...",value:p,onChange:r=>{O(r.target.value),w(null)}})]}),e.jsx("button",{onClick:$,disabled:!p,className:"bg-primary hover:bg-primary/80 disabled:opacity-50 px-6 py-3 rounded-none font-arcade text-sm w-full",type:"button",children:"INGEST WRAP SESSION"})]})]}),e.jsx("h2",{className:"text-xl font-arcade text-primary",children:"MATERIAL INGESTION"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1 font-terminal text-muted-foreground",children:"Select Course"}),e.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:n||"",onChange:r=>{a(r.target.value?parseInt(r.target.value):null),d(null)},children:[e.jsx("option",{value:"",children:"-- Select Course --"}),R.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),S&&e.jsx("div",{className:"bg-destructive/20 border border-destructive rounded-none p-3 text-destructive font-terminal",children:S}),n&&e.jsxs(Se,{type:"multiple",className:"border border-secondary/40 rounded-none divide-y divide-secondary/40",children:[e.jsxs(V,{value:"schedule",className:"border-secondary/40",children:[e.jsx(J,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"SCHEDULE IMPORT"}),e.jsxs(Q,{className:"px-3",children:[e.jsx("button",{onClick:()=>I(kt),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Paste the ChatGPT response (JSON array) below:"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-32 font-terminal text-sm",placeholder:'[{"type": "exam", "title": "...", "dueDate": "2026-01-20", "notes": null}]',value:l,onChange:r=>f(r.target.value)}),e.jsx("button",{onClick:()=>u.mutate(l),disabled:!l||u.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none mt-2 font-terminal text-xs",type:"button",children:u.isPending?"Importing...":"Import Schedule"})]})]}),e.jsxs(V,{value:"modules",className:"border-secondary/40",children:[e.jsx(J,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"MODULES"}),e.jsx(Q,{className:"px-3",children:h.length===0?e.jsx("p",{className:"text-xs text-muted-foreground font-terminal",children:"No modules yet. Add modules manually or import."}):e.jsxs("table",{className:"w-full text-sm font-terminal",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-secondary/50",children:[e.jsx("th",{className:"text-left p-2",children:"Module"}),e.jsx("th",{className:"text-center p-2",children:"Files"}),e.jsx("th",{className:"text-center p-2",children:"NotebookLM"}),e.jsx("th",{className:"text-center p-2",children:"Status"})]})}),e.jsx("tbody",{children:h.map(r=>e.jsxs("tr",{className:"border-b border-secondary/30",children:[e.jsx("td",{className:"p-2",children:r.name}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"checkbox",checked:r.filesDownloaded,onChange:N=>A.mutate({id:r.id,data:{filesDownloaded:N.target.checked}})})}),e.jsx("td",{className:"text-center p-2",children:e.jsx("input",{type:"checkbox",checked:r.notebooklmLoaded,onChange:N=>A.mutate({id:r.id,data:{notebooklmLoaded:N.target.checked}})})}),e.jsx("td",{className:"text-center p-2",children:r.filesDownloaded&&r.notebooklmLoaded?e.jsx("span",{className:"text-green-400",children:"Ready"}):e.jsx("span",{className:"text-yellow-400",children:"Pending"})})]},r.id))})]})})]}),e.jsxs(V,{value:"learning-objectives",className:"border-secondary/40",children:[e.jsx(J,{className:"font-arcade text-xs text-primary px-3 hover:no-underline",children:"LEARNING OBJECTIVES IMPORT"}),e.jsxs(Q,{className:"px-3",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-xs mb-1 font-terminal text-muted-foreground",children:"Target Module (optional)"}),e.jsxs("select",{className:"w-full bg-black border border-secondary rounded-none p-2 font-terminal",value:c||"",onChange:r=>d(r.target.value?parseInt(r.target.value):null),children:[e.jsx("option",{value:"",children:"-- No Module (Course-level) --"}),h.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),e.jsx("button",{onClick:()=>I(At),className:"bg-primary hover:bg-primary/80 px-3 py-1 rounded-none text-xs font-terminal mb-2",type:"button",children:"Copy Prompt for ChatGPT"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-terminal",children:"Paste the ChatGPT response (JSON array) below:"}),e.jsx("textarea",{className:"w-full bg-black border border-secondary rounded-none p-2 h-32 font-terminal text-sm",placeholder:'[{"loCode": "1.1", "title": "Define..."}]',value:x,onChange:r=>y(r.target.value)}),e.jsx("button",{onClick:()=>M.mutate(x),disabled:!x||M.isPending,className:"bg-secondary hover:bg-secondary/80 disabled:opacity-50 px-4 py-2 rounded-none mt-2 font-terminal text-xs",type:"button",children:M.isPending?"Importing...":"Import LOs"}),v.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"font-terminal text-xs mb-2",children:["Current LOs (",v.length,")"]}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:v.map(r=>e.jsxs("div",{className:"text-xs py-1 border-b border-secondary/30 font-terminal",children:[e.jsx("span",{className:"text-primary",children:r.loCode}),": ",r.title,e.jsx("span",{className:`ml-2 text-[10px] px-1 rounded ${r.status==="solid"?"bg-green-600":r.status==="in_progress"?"bg-yellow-600":r.status==="need_review"?"bg-orange-600":"bg-gray-600"}`,children:r.status})]},r.id))})]})]})]})]})]})}const Dt=(t,n="MM/dd")=>{if(!t)return"-";try{const a=t instanceof Date?t:new Date(t);return et(a)?st(a,n):"-"}catch{return"-"}},te=t=>{if(Array.isArray(t))return t.filter(n=>typeof n=="string");if(typeof t=="string"){const n=t.trim();if(!n)return[];try{const a=JSON.parse(n);if(Array.isArray(a))return a.filter(c=>typeof c=="string")}catch{}return n.split(",").map(a=>a.trim()).filter(Boolean)}return[]};function Bt(){const[t,n]=i.useState(new Set),[a,c]=i.useState(null),[d,l]=i.useState(!1),[f,x]=i.useState([]),[y,S]=i.useState(!1),[m,p]=i.useState(new Set),[O,C]=i.useState(null),[w,R]=i.useState({front:"",back:"",deckName:""}),[h,v]=i.useState({mode:"",minutes:"",cards:"",confusions:"",weakAnchors:"",concepts:"",issues:"",notes:""}),[u,M]=i.useState("School"),[A,I]=i.useState(null),[$,r]=i.useState(""),[N,B]=i.useState(!1),[Oe,ae]=i.useState(!1),ms=[{name:"EBP",path:"School/Evidence Based Practice"},{name:"ExPhys",path:"School/Exercise Physiology"},{name:"MS1",path:"School/Movement Science 1"},{name:"Neuro",path:"School/Neuroscience"},{name:"TI",path:"School/Theraputic Intervention"}],{data:K=[],isLoading:xs}=F({queryKey:["sessions"],queryFn:g.sessions.getAll}),{data:ne}=F({queryKey:["brain","metrics"],queryFn:g.brain.getMetrics}),X=Ye(),pe=z({mutationFn:s=>g.sessions.deleteMany(s),onSuccess:()=>{X.invalidateQueries({queryKey:["sessions"]}),X.invalidateQueries({queryKey:["brain","metrics"]}),n(new Set)}}),us=z({mutationFn:({id:s,updates:o})=>g.sessions.update(s,o),onSuccess:()=>{X.invalidateQueries({queryKey:["sessions"]}),X.invalidateQueries({queryKey:["brain","metrics"]}),c(null)}}),hs=s=>{n(o=>{const j=new Set(o);return j.has(s)?j.delete(s):j.add(s),j})},ps=()=>{t.size===K.length?n(new Set):n(new Set(K.map(s=>s.id)))},fs=()=>{t.size!==0&&(x(Array.from(t)),l(!0))},gs=s=>{x([s]),l(!0)},bs=()=>{pe.mutate(f),l(!1),x([])};i.useEffect(()=>{if(a!==null){const s=K.find(o=>o.id===a);s&&v({mode:s.mode||"",minutes:s.minutes?.toString()||"",cards:s.cards?.toString()||"",confusions:te(s.confusions).join(", "),weakAnchors:te(s.weakAnchors).join(", "),concepts:te(s.concepts).join(", "),issues:te(s.issues).join(", "),notes:s.notes||""})}},[a,K]);const Ns=()=>{if(a===null)return;const s=D=>D?D.split(",").map(U=>U.trim()).filter(Boolean):[],o=D=>D.length?JSON.stringify(D):null,j={mode:h.mode||"study",minutes:parseInt(h.minutes)||0,cards:parseInt(h.cards)||0,confusions:o(s(h.confusions)),weakAnchors:o(s(h.weakAnchors)),concepts:o(s(h.concepts)),issues:o(s(h.issues)),notes:h.notes||null};us.mutate({id:a,updates:j})},{data:G}=F({queryKey:["obsidian","status"],queryFn:g.obsidian.getStatus,refetchInterval:3e4}),{data:js,refetch:Tt}=F({queryKey:["obsidian","files",u],queryFn:()=>g.obsidian.getFiles(u),enabled:G?.connected===!0}),ys=async s=>{try{const o=await g.obsidian.getFile(s);o.success&&o.content!==void 0&&(I(s),r(o.content),ae(!1))}catch(o){console.error("Failed to load file:",o)}},vs=async()=>{if(A){B(!0);try{(await g.obsidian.saveFile(A,$)).success&&ae(!1)}catch(s){console.error("Failed to save file:",s)}finally{B(!1)}}},Z=s=>{M(s),I(null),r("")},Ss=()=>{const s=new Date().toISOString().split("T")[0],o=u?`${u}/Session-${s}.md`:`Session-${s}.md`,j=`# Study Session - ${s}

## Summary


## Concepts Covered
- 

## Strengths
- 

## Areas to Review
- 

## Notes

`;I(o),r(j),ae(!0)},{data:L,isLoading:Cs,refetch:Ie}=F({queryKey:["anki","status"],queryFn:g.anki.getStatus,refetchInterval:3e4}),{data:ws}=F({queryKey:["anki","due"],queryFn:g.anki.getDue,enabled:L?.connected===!0}),{data:ks=[],refetch:re}=F({queryKey:["anki","drafts"],queryFn:g.anki.getDrafts}),H=ks.filter(s=>s.status==="pending"),fe=z({mutationFn:g.anki.sync,onSuccess:()=>{X.invalidateQueries({queryKey:["anki"]}),re()}}),De=z({mutationFn:s=>g.anki.approveDraft(s),onSuccess:()=>{re()}}),Te=z({mutationFn:s=>g.anki.deleteDraft(s),onSuccess:()=>{re()}}),ge=z({mutationFn:({id:s,data:o})=>g.anki.updateDraft(s,o),onSuccess:()=>{re(),C(null)}}),As=s=>{C(s.id),R({front:s.front,back:s.back,deckName:s.deckName})},Os=()=>{O!==null&&ge.mutate({id:O,data:w})};return e.jsxs(Ms,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h1",{className:"font-arcade text-xl text-primary flex items-center gap-2",children:[e.jsx(Ls,{className:"w-6 h-6"}),"BRAIN ANALYTICS"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"SYSTEM STATUS"}),e.jsx(ee,{className:"brain-card rounded-none",children:e.jsx(se,{className:"p-3",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3 font-terminal text-xs",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${G?.connected?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-muted-foreground",children:"Obsidian"}),e.jsx("span",{className:"text-primary",children:G?.connected?"Online":"Offline"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${L?.connected?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-muted-foreground",children:"Anki"}),e.jsx("span",{className:"text-primary",children:L?.connected?"Connected":"Offline"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-muted-foreground",children:[e.jsxs("span",{children:["Cards: ",e.jsx("span",{className:"text-primary",children:ne?.totalCards||0})]}),e.jsxs("span",{children:["Drafts: ",e.jsx("span",{className:"text-primary",children:H.length})]})]})]})})})]}),e.jsx(Se,{type:"single",collapsible:!0,className:"border border-secondary/40 rounded-none",children:e.jsxs(V,{value:"ingestion",className:"border-secondary/40",children:[e.jsx(J,{className:"font-arcade text-sm text-primary px-4 hover:no-underline",children:"DATA INGESTION TOOLS"}),e.jsx(Q,{className:"px-2",children:e.jsx("div",{className:"pt-2",children:e.jsx(It,{})})})]})}),e.jsx(Se,{type:"single",collapsible:!0,className:"border border-secondary/40 rounded-none",children:e.jsxs(V,{value:"integrations",className:"border-secondary/40",children:[e.jsx(J,{className:"font-arcade text-sm text-primary px-4 hover:no-underline",children:"INTEGRATIONS"}),e.jsx(Q,{className:"px-2",children:e.jsxs("div",{className:"space-y-4 pt-2 min-w-0",children:[e.jsxs(ee,{className:"brain-card rounded-none",children:[e.jsxs(ie,{className:"border-b border-secondary/50 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(de,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(Xs,{className:"w-4 h-4"}),"OBSIDIAN VAULT",G?.connected?e.jsx(le,{className:"w-3 h-3 text-green-500"}):e.jsx(oe,{className:"w-3 h-3 text-red-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(b,{size:"sm",variant:"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:Ss,disabled:!G?.connected,children:[e.jsx(Zs,{className:"w-3 h-3 mr-1"}),"New Note"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y,onChange:s=>S(s.target.checked),disabled:!G?.connected,className:"w-4 h-4 accent-primary"}),e.jsx("span",{className:"font-terminal text-xs",children:"Auto-Sync"})]})]})]}),e.jsx("div",{className:"flex items-center gap-1 mt-2 flex-wrap",children:ms.map(s=>e.jsx(b,{size:"sm",variant:u===s.path?"default":"outline",className:"h-6 px-2 rounded-none font-terminal text-xs",onClick:()=>Z(s.path),children:s.name},s.path))}),u&&e.jsxs("div",{className:"flex items-center gap-1 mt-2 font-terminal text-xs text-muted-foreground",children:[e.jsx("button",{onClick:()=>Z(""),className:"hover:text-primary",children:"vault"}),u.split("/").map((s,o,j)=>e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_s,{className:"w-3 h-3"}),e.jsx("button",{onClick:()=>Z(j.slice(0,o+1).join("/")),className:"hover:text-primary",children:s})]},o))]})]}),e.jsx(se,{className:"p-0",children:G?.connected?e.jsxs("div",{className:"grid md:grid-cols-2 h-[240px] md:h-[300px]",children:[e.jsx("div",{className:"border-r border-secondary/30",children:e.jsx(be,{className:"h-[240px] md:h-[300px]",children:e.jsxs("div",{className:"p-2 space-y-1",children:[u&&e.jsxs("button",{onClick:()=>{const s=u.split("/");s.pop(),Z(s.join("/"))},className:"w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs text-muted-foreground",children:[e.jsx(Ke,{className:"w-3 h-3"}),".."]}),js?.files?.map(s=>{const o=typeof s=="string"?s:s.path,j=o.endsWith("/"),D=o.replace(/\/$/,"").split("/").pop()||o;return e.jsxs("button",{onClick:()=>{if(j){const U=D.replace(/\/$/,"");Z(u?`${u}/${U}`:U)}else{const U=u?`${u}/${D}`:D;ys(U)}},className:`w-full flex items-center gap-2 p-2 hover:bg-secondary/20 font-terminal text-xs ${A?.endsWith(D)?"bg-primary/20 text-primary":""}`,children:[j?e.jsx(Ke,{className:"w-3 h-3 text-yellow-500"}):e.jsx(rt,{className:"w-3 h-3 text-blue-400"}),D]},o)})]})})}),e.jsx("div",{className:"flex flex-col h-[240px] md:h-[300px]",children:A?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-secondary/30",children:[e.jsxs("span",{className:"font-terminal text-xs text-primary truncate",children:[A.split("/").pop(),Oe&&e.jsx("span",{className:"text-yellow-500 ml-1",children:"*"})]}),e.jsxs(b,{size:"sm",variant:"ghost",onClick:vs,disabled:!Oe||N,className:"h-6 px-2",children:[e.jsx(Ne,{className:"w-3 h-3 mr-1"}),N?"Saving...":"Save"]})]}),e.jsx("textarea",{value:$,onChange:s=>{r(s.target.value),ae(!0)},className:"flex-1 w-full p-3 bg-black/60 font-terminal text-sm resize-none focus:outline-none focus:ring-1 focus:ring-primary",placeholder:"File content..."})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center font-terminal text-xs text-muted-foreground",children:"Select a file to edit"})})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("p",{className:"font-terminal text-xs text-red-400 mb-2",children:"Obsidian Offline"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Obsidian with Local REST API plugin enabled"})]})})]}),e.jsxs(ee,{className:"brain-card rounded-none",children:[e.jsx(ie,{className:"border-b border-secondary/50 p-3",children:e.jsxs(de,{className:"font-arcade text-xs flex items-center gap-2 text-muted-foreground",children:[e.jsx(lt,{className:"w-3 h-3"}),"ANKI INTEGRATION",L?.connected?e.jsx(le,{className:"w-3 h-3 text-green-500 ml-auto"}):e.jsx(oe,{className:"w-3 h-3 text-red-500 ml-auto"})]})}),e.jsx(se,{className:"p-4 space-y-3",children:Cs?e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Checking Anki..."}):L?.connected?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Status:"}),e.jsx(me,{variant:"outline",className:"bg-green-500/20 text-green-400 border-green-500",children:"Connected"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Cards Created:"}),e.jsx("span",{className:"font-arcade text-xs text-primary",children:ne?.totalCards||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Due Today:"}),e.jsx("span",{className:"font-arcade text-xs text-secondary",children:ws?.dueCount||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Reviewed Today:"}),e.jsx("span",{className:"font-arcade text-xs text-muted-foreground",children:L.reviewedToday||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-terminal text-xs text-muted-foreground",children:"Decks:"}),e.jsx("span",{className:"font-arcade text-xs text-muted-foreground",children:L.decks?.length||0})]}),e.jsxs("div",{className:"pt-2 flex gap-2",children:[e.jsxs(b,{size:"sm",variant:"outline",className:"flex-1 font-terminal text-xs",onClick:()=>Ie(),children:[e.jsx(Ge,{className:"w-3 h-3 mr-1"}),"Refresh"]}),e.jsx(b,{size:"sm",className:"flex-1 font-terminal text-xs bg-secondary hover:bg-secondary/80",onClick:()=>fe.mutate(),disabled:fe.isPending,children:fe.isPending?"Syncing...":"Sync Cards"})]}),H.length>0&&e.jsxs("div",{className:"pt-3 border-t border-secondary/30",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-arcade text-[10px] text-yellow-400",children:["PENDING CARDS (",H.length,")"]}),e.jsx("div",{className:"flex gap-1",children:e.jsx(b,{size:"sm",variant:"outline",className:"h-5 px-2 text-[10px] font-terminal",onClick:()=>{m.size===H.length?p(new Set):p(new Set(H.map(s=>s.id)))},children:m.size===H.length?"None":"All"})})]}),m.size>0&&e.jsxs("div",{className:"flex gap-1 mb-2",children:[e.jsxs(b,{size:"sm",className:"h-6 px-2 text-[10px] font-terminal bg-green-600 hover:bg-green-700",onClick:()=>{m.forEach(s=>De.mutate(s)),p(new Set)},children:[e.jsx(le,{className:"w-3 h-3 mr-1"}),"Approve (",m.size,")"]}),e.jsxs(b,{size:"sm",variant:"destructive",className:"h-6 px-2 text-[10px] font-terminal",onClick:()=>{m.forEach(s=>Te.mutate(s)),p(new Set)},children:[e.jsx(W,{className:"w-3 h-3 mr-1"}),"Delete (",m.size,")"]})]}),e.jsx(be,{className:"h-[200px]",children:e.jsx("div",{className:"space-y-2",children:H.map(s=>e.jsx("div",{className:`p-2 bg-black/40 border text-xs ${m.has(s.id)?"border-primary":"border-secondary/30"}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(je,{checked:m.has(s.id),onCheckedChange:o=>{const j=new Set(m);o?j.add(s.id):j.delete(s.id),p(j)},className:"mt-1 border-secondary data-[state=checked]:bg-primary"}),e.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[e.jsx("div",{className:"font-terminal text-primary truncate",children:s.front}),e.jsx("div",{className:"font-terminal text-muted-foreground mt-1 truncate",children:s.back}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(me,{variant:"outline",className:"text-[9px] border-blue-500/50 text-blue-400 shrink-0",children:s.deckName}),e.jsx(b,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-yellow-500/50 text-yellow-400 hover:bg-yellow-500/20",onClick:()=>As(s),title:"Edit card",children:e.jsx(ce,{className:"w-3 h-3"})}),e.jsx(b,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-green-500/50 text-green-400 hover:bg-green-500/20",onClick:()=>De.mutate(s.id),title:"Approve card",children:e.jsx(le,{className:"w-3 h-3"})}),e.jsx(b,{size:"icon",variant:"outline",className:"h-5 w-5 shrink-0 border-red-500/50 text-red-400 hover:bg-red-500/20",onClick:()=>Te.mutate(s.id),title:"Delete card",children:e.jsx(W,{className:"w-3 h-3"})})]})]})]})},s.id))})})]})]}):e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"font-terminal text-xs text-red-400",children:L?.error||"Anki not connected"}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground",children:"Open Anki with AnkiConnect plugin"}),e.jsxs(b,{size:"sm",variant:"outline",className:"font-terminal text-xs",onClick:()=>Ie(),children:[e.jsx(Ge,{className:"w-3 h-3 mr-1"}),"Retry"]})]})})]})]})})]})}),e.jsxs("div",{className:"mb-6 min-w-0",children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"SESSION EVIDENCE"}),e.jsxs(ee,{className:"brain-card rounded-none",children:[e.jsx(ie,{className:"border-b border-secondary/60 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(de,{className:"font-arcade text-sm flex items-center gap-2",children:[e.jsx(at,{className:"w-4 h-4"}),"SESSION EVIDENCE TABLE"]}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mt-1",children:"Raw WRAP data. All metrics derive from these fields."})]}),t.size>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-terminal text-xs text-muted-foreground",children:[t.size," selected"]}),e.jsxs(b,{size:"sm",variant:"destructive",className:"font-terminal text-xs rounded-none",onClick:fs,disabled:pe.isPending,children:[e.jsx(W,{className:"w-3 h-3 mr-1"}),pe.isPending?"Deleting...":"Delete"]})]})]})}),e.jsx(se,{className:"p-0",children:xs?e.jsx("div",{className:"p-8 text-center font-terminal text-muted-foreground",children:"LOADING..."}):K.length===0?e.jsx("div",{className:"p-8 text-center font-terminal text-muted-foreground",children:"NO SESSIONS YET"}):e.jsx(be,{className:"h-[360px] xl:h-[420px]",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(We,{className:"min-w-[620px]",children:[e.jsx(Ve,{children:e.jsxs(ye,{className:"border-secondary/60 hover:bg-transparent",children:[e.jsx(_,{className:"w-10 px-2 py-2",children:e.jsx(je,{checked:t.size===K.length&&K.length>0,onCheckedChange:ps,className:"border-primary data-[state=checked]:bg-primary"})}),e.jsx(_,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"DATE"}),e.jsx(_,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"COURSE"}),e.jsx(_,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"MODE"}),e.jsx(_,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"MIN"}),e.jsx(_,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"CARDS"}),e.jsx(_,{className:"font-arcade text-[10px] text-primary px-2 py-2",children:"CONFUSIONS"}),e.jsx(_,{className:"font-arcade text-[10px] text-primary w-10 px-2 py-2",children:"ACTIONS"})]})}),e.jsx(Je,{children:K.map(s=>e.jsxs(ye,{className:"border-secondary/50 hover:bg-primary/10 font-terminal text-xs","data-testid":`row-session-${s.id}`,children:[e.jsx(q,{className:"px-2 py-2",children:e.jsx(je,{checked:t.has(s.id),onCheckedChange:()=>hs(s.id),className:"border-secondary data-[state=checked]:bg-primary"})}),e.jsx(q,{className:"text-muted-foreground px-2 py-2",children:Dt(s.date)}),e.jsx(q,{className:"font-bold px-2 py-2",children:s.topic||"-"}),e.jsx(q,{className:"px-2 py-2",children:e.jsx(me,{variant:"outline",className:"rounded-none border-secondary font-normal text-[10px]",children:s.mode})}),e.jsx(q,{className:"px-2 py-2",children:s.minutes||0}),e.jsx(q,{className:"px-2 py-2",children:s.cards||0}),e.jsx(q,{className:"max-w-[150px] truncate text-[10px] text-muted-foreground px-2 py-2",children:te(s.confusions).join(", ")||"-"}),e.jsx(q,{className:"px-2 py-2",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(b,{size:"icon",variant:"ghost",className:"h-6 w-6 rounded-none hover:bg-primary/20",onClick:()=>c(s.id),title:"Edit session",children:e.jsx(ce,{className:"w-3 h-3"})}),e.jsx(b,{size:"icon",variant:"ghost",className:"h-6 w-6 rounded-none hover:bg-destructive/20 text-destructive",onClick:()=>gs(s.id),title:"Delete session",children:e.jsx(W,{className:"w-3 h-3"})})]})})]},s.id))})]})})})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"font-arcade text-lg text-primary mb-4",children:"ISSUES LOG"}),e.jsxs(ee,{className:"brain-card rounded-none",children:[e.jsxs(ie,{className:"border-b border-secondary p-4",children:[e.jsxs(de,{className:"font-arcade text-sm flex items-center gap-2 text-red-400",children:[e.jsx(Ks,{className:"w-4 h-4"}),"ISSUES AND FAILURES LOG"]}),e.jsx("p",{className:"font-terminal text-xs text-muted-foreground mt-1",children:"Aggregated session issues: interruptions, source-lock failures, workflow problems"})]}),e.jsx(se,{className:"p-4",children:(ne?.issuesLog||[]).length===0?e.jsx("div",{className:"text-center font-terminal text-muted-foreground py-8",children:"NO ISSUES LOGGED"}):e.jsx("div",{className:"space-y-2",children:ne?.issuesLog.map((s,o)=>e.jsxs("div",{className:"flex items-center justify-between p-2 border border-red-500/30 bg-red-500/5 font-terminal text-sm",children:[e.jsx("span",{className:"text-red-300",children:s.issue}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:s.course}),e.jsxs(me,{variant:"outline",className:"rounded-none border-red-500/50 text-red-400",children:["x",s.count]})]})]},o))})})]})]})]})]}),e.jsx(Ee,{open:a!==null,onOpenChange:s=>{s||c(null)},children:e.jsxs(Pe,{className:"bg-black border-2 border-primary rounded-none max-w-2xl",children:[e.jsxs(Re,{children:[e.jsxs(Fe,{className:"font-arcade text-primary flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5"}),"EDIT SESSION #",a]}),e.jsx(Me,{className:"font-terminal text-muted-foreground",children:"Update WRAP methodology fields for this study session"})]}),e.jsxs("div",{className:"space-y-4 font-terminal",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Mode"}),e.jsxs(qe,{value:h.mode,onValueChange:s=>v(o=>({...o,mode:s})),children:[e.jsx(ze,{className:"rounded-none border-secondary",children:e.jsx($e,{placeholder:"Select mode"})}),e.jsxs(Be,{className:"rounded-none border-secondary bg-black",children:[e.jsx(T,{value:"Core",children:"Core"}),e.jsx(T,{value:"Sprint",children:"Sprint"}),e.jsx(T,{value:"Drill",children:"Drill"}),e.jsx(T,{value:"study",children:"Study"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Minutes"}),e.jsx(Le,{type:"number",value:h.minutes,onChange:s=>v(o=>({...o,minutes:s.target.value})),className:"rounded-none border-secondary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Cards"}),e.jsx(Le,{type:"number",value:h.cards,onChange:s=>v(o=>({...o,cards:s.target.value})),className:"rounded-none border-secondary"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Confusions (comma-separated)"}),e.jsx(Y,{value:h.confusions,onChange:s=>v(o=>({...o,confusions:s.target.value})),placeholder:"e.g., muscle insertion points, nerve pathways",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Weak Anchors (comma-separated)"}),e.jsx(Y,{value:h.weakAnchors,onChange:s=>v(o=>({...o,weakAnchors:s.target.value})),placeholder:"e.g., brachial plexus diagram, ROM measurements",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Concepts (comma-separated)"}),e.jsx(Y,{value:h.concepts,onChange:s=>v(o=>({...o,concepts:s.target.value})),placeholder:"e.g., upper extremity anatomy, peripheral nerves",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Issues (comma-separated)"}),e.jsx(Y,{value:h.issues,onChange:s=>v(o=>({...o,issues:s.target.value})),placeholder:"e.g., interrupted by phone, lost focus after 30 min",className:"rounded-none border-secondary min-h-[60px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Notes"}),e.jsx(Y,{value:h.notes,onChange:s=>v(o=>({...o,notes:s.target.value})),placeholder:"Free-form observations about the session",className:"rounded-none border-secondary min-h-[80px]"})]})]}),e.jsxs(_e,{className:"gap-2",children:[e.jsxs(b,{variant:"outline",onClick:()=>c(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(b,{onClick:Ns,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})}),e.jsx(Gs,{open:d,onOpenChange:l,children:e.jsxs(Hs,{className:"bg-black border-2 border-destructive rounded-none",children:[e.jsxs(Ys,{children:[e.jsxs(Us,{className:"font-arcade text-destructive flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"}),"CONFIRM DELETE"]}),e.jsxs(Ws,{className:"font-terminal text-muted-foreground",children:["Are you sure you want to delete ",f.length," session",f.length!==1?"s":"","? This action cannot be undone."]})]}),e.jsxs(Vs,{className:"gap-2",children:[e.jsx(Js,{className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:"Cancel"}),e.jsxs(Qs,{onClick:bs,className:"font-terminal rounded-none bg-destructive hover:bg-destructive/80 text-destructive-foreground",children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})}),e.jsx(Ee,{open:O!==null,onOpenChange:s=>{s||C(null)},children:e.jsxs(Pe,{className:"bg-black border-2 border-primary rounded-none max-w-lg",style:{top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:[e.jsxs(Re,{children:[e.jsxs(Fe,{className:"font-arcade text-primary flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5"}),"EDIT CARD"]}),e.jsx(Me,{className:"font-terminal text-muted-foreground",children:"Edit card content and select target deck"})]}),e.jsxs("div",{className:"space-y-4 font-terminal",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Front (Question)"}),e.jsx(Y,{value:w.front,onChange:s=>R(o=>({...o,front:s.target.value})),placeholder:"Card front...",className:"rounded-none border-secondary min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Back (Answer)"}),e.jsx(Y,{value:w.back,onChange:s=>R(o=>({...o,back:s.target.value})),placeholder:"Card back...",className:"rounded-none border-secondary min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Target Deck"}),e.jsxs(qe,{value:w.deckName,onValueChange:s=>R(o=>({...o,deckName:s})),children:[e.jsx(ze,{className:"rounded-none border-secondary",children:e.jsx($e,{placeholder:"Select deck"})}),e.jsxs(Be,{className:"rounded-none border-secondary bg-black max-h-[200px]",children:[e.jsx(T,{value:"PT::EBP",children:"PT::EBP (Evidence Based Practice)"}),e.jsx(T,{value:"PT::ExPhys",children:"PT::ExPhys (Exercise Physiology)"}),e.jsx(T,{value:"PT::MS1",children:"PT::MS1 (Movement Science 1)"}),e.jsx(T,{value:"PT::Neuro",children:"PT::Neuro (Neuroscience)"}),e.jsx(T,{value:"PT::TI",children:"PT::TI (Therapeutic Intervention)"}),e.jsx(T,{value:"PT::General",children:"PT::General"}),L?.decks?.filter(s=>!s.startsWith("PT::")).map(s=>e.jsx(T,{value:s,children:s},s))]})]}),e.jsxs("p",{className:"text-[10px] text-muted-foreground mt-1",children:["Current: ",e.jsx("span",{className:"text-blue-400",children:w.deckName})]})]})]}),e.jsxs(_e,{className:"gap-2",children:[e.jsxs(b,{variant:"outline",onClick:()=>C(null),className:"font-terminal rounded-none border-secondary hover:bg-secondary/20",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(b,{onClick:Os,disabled:ge.isPending,className:"font-terminal rounded-none bg-primary hover:bg-primary/80",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),ge.isPending?"Saving...":"Save"]})]})]})})]})}export{Bt as default};

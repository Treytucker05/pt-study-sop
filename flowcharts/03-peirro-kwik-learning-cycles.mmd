%% PT Study SOP - PEIRRO + KWIK Learning Cycles
%% How the cognitive framework drives encoding

flowchart TD
    Start([Session]) --> PEIRRO["PEIRRO MACRO CYCLE<br/>━━━━━━━━━━━━━━━━<br/>(6-phase learning cycle)<br/><br/>Aligns with MAP-LOOP-WRAP:<br/>- Prepare = M0-M1 (MAP)<br/>- Encode → Interrogate →<br/>  Retrieve = M2-M5 (LOOP)<br/>- Refine → Overlearn = M6 (WRAP)"]

    PEIRRO -->|1| P1["PREPARE<br/>M0-M1<br/>─────<br/>- Clarify target & scope<br/>- Declare sources<br/>- Map territory (M2 Prime)<br/>- Orient attention<br/>- Pre-test baseline"]

    P1 -->|2| P2["ENCODE<br/>M3<br/>─────<br/>Attach meaning via<br/><br/>↓↓↓<br/>KWIK MICRO-LOOP<br/>↓↓↓<br/>(nested here)"]

    P2 --> KWIK["KWIK: 5-STEP<br/>ENCODING FLOW<br/>━━━━━━━━━━━━━━<br/>Per hook/term<br/><br/>┌─────────────────┐<br/>│ 1. SOUND        │<br/>│ Phonetic seed   │<br/>└────────┬────────┘<br/>         ↓<br/>┌─────────────────┐<br/>│ 2. FUNCTION     │<br/>│ True action     │<br/>│ (word+meaning)  │<br/>└────────┬────────┘\n         ↓\n┌─────────────────┐\n│ 3. IMAGE        │\n│ Imagery tied to │\n│ function        │\n│ (NOT just sound)│\n└────────┬────────┘\n         ↓\n┌─────────────────┐\n│ 4. RESONANCE    │\n│ 'Sounds right'  │\n│ 'Feels right'   │\n│ Learner approval│\n│ GATE: required  │\n└────────┬────────┘\n         ↓\n┌─────────────────┐\n│ 5. LOCK         │\n│ Record card/log │\n│ Artifact saved  │\n└─────────────────┘\n\nRULES:\n├─ SEED-LOCK: Learner\n│  attempts first;\n│  ask-first rule\n├─ Function BEFORE Image\n│  (gate on word+meaning)\n└─ Never skip\n   resonance or lock"]

    KWIK -->|✓ Hooks Locked| P2_End["✓ Bucket Encoded<br/>(learner can explain<br/>in own words)"]

    P2_End -->|3| P3["INTERROGATE<br/>M3-M4<br/>────────<br/>- Question: Why/How?<br/>- Self-explanation<br/>- Build elaboration<br/>- Deepen understanding<br/>- Activate prior knowledge"]

    P3 -->|4| P4["RETRIEVE<br/>M4-M5<br/>────────<br/>- Effortful recall<br/>  (no cues)<br/>- Progressive ladder:<br/>  Guided → Faded →\n  Independent →\n  Interleaved<br/>- Capture misses"]

    P4 -->|5| P5["REFINE<br/>M6 WRAP<br/>──────<br/>- Correct errors<br/>- Address misconceptions<br/>- Use retrieval feedback<br/>- Flag weak anchors"]

    P5 -->|6| P6["OVERLEARN<br/>M6 WRAP +<br/>Post-Session<br/>─────────────<br/>- Spaced recall<br/>  beyond mastery<br/>- Weekly review (3+2)<br/>- Dashboard alerts<br/>- Next session scheduling"]

    P6 --> End(["✓ Session Complete"])

    style PEIRRO fill:#4ecdc4,stroke:#333,color:#fff
    style P1 fill:#ffab91,stroke:#333,color:#000
    style P2 fill:#ffcc80,stroke:#333,color:#000
    style KWIK fill:#fff59d,stroke:#2d5016,color:#000,stroke-width:3px
    style P2_End fill:#c5e1a5,stroke:#333,color:#000
    style P3 fill:#fff59d,stroke:#333,color:#000
    style P4 fill:#b2dfdb,stroke:#333,color:#000
    style P5 fill:#b3e5fc,stroke:#333,color:#000
    style P6 fill:#c8e6c9,stroke:#333,color:#000

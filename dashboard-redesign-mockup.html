<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Redesign — Trey's Study System</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=VT323&family=JetBrains+Mono:wght@400;600&display=swap');

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #080808;
    --surface-1: #121212;
    --surface-2: #1a1a1a;
    --surface-3: #222222;
    --primary: #CC2E48;
    --primary-dim: rgba(204,46,72,0.3);
    --primary-glow: rgba(204,46,72,0.5);
    --border: #2a2a2a;
    --fg: #eeeeee;
    --fg-muted: #888888;
    --success: #22c55e;
    --warning: #f59e0b;
    --urgent: #f97316;
    --danger: #ef4444;
    --info: #3b82f6;
    --font-arcade: 'VT323', monospace;
    --font-body: 'JetBrains Mono', 'VT323', monospace;
  }

  body {
    background: var(--bg);
    color: var(--fg);
    font-family: var(--font-body);
    font-size: 13px;
    line-height: 1.4;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* ── Playground Shell ── */
  .playground {
    display: grid;
    grid-template-columns: 240px 1fr;
    grid-template-rows: 1fr auto;
    height: 100vh;
  }

  /* ── Controls Panel ── */
  .controls {
    grid-row: 1 / 3;
    background: var(--surface-1);
    border-right: 2px solid var(--border);
    padding: 16px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .controls h2 {
    font-family: var(--font-arcade);
    font-size: 18px;
    color: var(--primary);
    letter-spacing: 2px;
    text-transform: uppercase;
    border-bottom: 2px double var(--primary);
    padding-bottom: 8px;
  }

  .control-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .control-group label {
    font-size: 11px;
    color: var(--fg-muted);
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .control-group select,
  .control-group input[type="range"] {
    background: var(--surface-2);
    border: 1px solid var(--border);
    color: var(--fg);
    padding: 6px 8px;
    font-family: var(--font-body);
    font-size: 12px;
  }

  .control-group input[type="range"] {
    accent-color: var(--primary);
    padding: 0;
  }

  .preset-btn {
    background: var(--surface-2);
    border: 1px solid var(--border);
    color: var(--fg);
    padding: 8px 12px;
    font-family: var(--font-arcade);
    font-size: 14px;
    letter-spacing: 1px;
    cursor: pointer;
    transition: all 0.15s;
    text-transform: uppercase;
  }

  .preset-btn:hover {
    border-color: var(--primary);
    color: var(--primary);
    box-shadow: 0 0 8px var(--primary-dim);
  }

  .preset-btn.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
  }

  .presets {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .range-val {
    font-size: 11px;
    color: var(--primary);
    font-family: var(--font-arcade);
  }

  /* ── Preview Area ── */
  .preview-area {
    background: var(--bg);
    overflow: auto;
    position: relative;
  }

  /* ── CRT Overlay ── */
  .crt-overlay {
    position: fixed;
    top: 0; left: 240px; right: 0; bottom: 0;
    background: repeating-linear-gradient(
      0deg,
      rgba(0,0,0,0.15) 0px,
      rgba(0,0,0,0.15) 2px,
      transparent 2px,
      transparent 4px
    );
    pointer-events: none;
    z-index: 100;
    opacity: 0.2;
  }

  .crt-overlay.hidden { display: none; }

  /* ── Grid BG ── */
  .grid-bg {
    background-image:
      linear-gradient(rgba(204,46,72,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(204,46,72,0.03) 1px, transparent 1px);
    background-size: 32px 32px;
  }

  /* ── Dashboard Preview ── */
  .dashboard {
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    min-height: 100%;
  }

  /* ── Header Bar ── */
  .dash-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 16px;
    background: rgba(0,0,0,0.8);
    border: 2px double var(--primary);
    backdrop-filter: blur(4px);
  }

  .dash-header .logo {
    font-family: var(--font-arcade);
    font-size: 16px;
    color: var(--fg);
    letter-spacing: 2px;
  }

  .nav-items {
    display: flex;
    gap: 4px;
  }

  .nav-item {
    font-family: var(--font-arcade);
    font-size: 12px;
    padding: 4px 10px;
    color: var(--fg-muted);
    border: 1px solid transparent;
    cursor: pointer;
    letter-spacing: 1px;
  }

  .nav-item.active {
    background: var(--primary);
    color: white;
  }

  /* ── Stats Bar ── */
  .stats-bar {
    display: flex;
    gap: 12px;
    align-items: stretch;
  }

  .stat-card {
    flex: 1;
    background: var(--surface-1);
    border: 2px double var(--border);
    padding: 12px 16px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
    transition: border-color 0.2s;
  }

  .stat-card:hover {
    border-color: var(--primary-dim);
  }

  .stat-card .stat-value {
    font-family: var(--font-arcade);
    font-size: 32px;
    color: var(--primary);
    line-height: 1;
  }

  .stat-card .stat-value.streak {
    color: var(--warning);
  }

  .stat-card .stat-label {
    font-size: 10px;
    color: var(--fg-muted);
    text-transform: uppercase;
    letter-spacing: 2px;
  }

  .streak-flame {
    display: inline;
    animation: flicker 1.5s infinite;
  }

  @keyframes flicker {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
  }

  @keyframes pulse-glow {
    0%, 100% { box-shadow: 0 0 8px var(--primary-dim); }
    50% { box-shadow: 0 0 20px var(--primary-glow); }
  }

  @keyframes slide-in {
    from { opacity: 0; transform: translateY(8px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* ── Main Grid ── */
  .main-grid {
    display: grid;
    gap: 12px;
    flex: 1;
  }

  .main-grid.layout-40-60 {
    grid-template-columns: 2fr 3fr;
    grid-template-rows: 1fr auto;
  }

  .main-grid.layout-30-70 {
    grid-template-columns: 3fr 7fr;
    grid-template-rows: 1fr auto;
  }

  .main-grid.layout-50-50 {
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr auto;
  }

  /* ── Panel Shared ── */
  .panel {
    background: var(--surface-1);
    border: 2px double var(--border);
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    border-bottom: 1px solid var(--border);
    background: rgba(0,0,0,0.3);
  }

  .panel-title {
    font-family: var(--font-arcade);
    font-size: 14px;
    color: var(--primary);
    letter-spacing: 2px;
    text-transform: uppercase;
  }

  .panel-badge {
    font-family: var(--font-arcade);
    font-size: 11px;
    padding: 2px 8px;
    border: 1px solid;
    letter-spacing: 1px;
  }

  .panel-body {
    flex: 1;
    padding: 12px;
    overflow-y: auto;
  }

  /* ── Study Wheel Panel ── */
  .next-up-label {
    font-size: 10px;
    color: var(--fg-muted);
    text-transform: uppercase;
    letter-spacing: 3px;
    text-align: center;
    margin-bottom: 4px;
  }

  .next-up-course {
    font-family: var(--font-arcade);
    font-size: 24px;
    color: var(--primary);
    text-align: center;
    padding: 12px;
    border: 2px double var(--primary);
    background: rgba(204,46,72,0.08);
    animation: pulse-glow 2s infinite;
    margin-bottom: 12px;
  }

  .complete-btn {
    width: 100%;
    padding: 12px;
    background: var(--primary);
    color: white;
    border: none;
    font-family: var(--font-arcade);
    font-size: 18px;
    letter-spacing: 3px;
    cursor: pointer;
    transition: all 0.15s;
    text-transform: uppercase;
    margin-bottom: 12px;
  }

  .complete-btn:hover {
    background: #e03358;
    box-shadow: 0 0 16px var(--primary-glow);
  }

  .complete-btn:active {
    transform: scale(0.98);
  }

  .queue-list {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .queue-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 10px;
    background: var(--surface-2);
    border: 1px solid var(--border);
    font-size: 12px;
    transition: all 0.3s;
  }

  .queue-item.active {
    border-color: var(--primary);
    background: rgba(204,46,72,0.1);
    color: var(--primary);
  }

  .queue-num {
    font-family: var(--font-arcade);
    font-size: 14px;
    color: var(--fg-muted);
    width: 20px;
    text-align: center;
  }

  .queue-item.active .queue-num {
    color: var(--primary);
  }

  .queue-check {
    color: var(--success);
    font-size: 12px;
    opacity: 0;
    transition: opacity 0.3s;
  }

  .queue-item.done .queue-check { opacity: 1; }
  .queue-item.done { color: var(--fg-muted); text-decoration: line-through; opacity: 0.5; }

  /* ── Right Column ── */
  .right-col {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  /* ── Tasks ── */
  .task-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 10px;
    border-bottom: 1px solid var(--border);
    cursor: pointer;
    transition: background 0.15s;
  }

  .task-item:hover { background: var(--surface-2); }
  .task-item:last-child { border-bottom: none; }

  .task-check {
    width: 16px;
    height: 16px;
    border: 2px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: all 0.2s;
    font-size: 10px;
    color: transparent;
  }

  .task-item.checked .task-check {
    border-color: var(--success);
    color: var(--success);
    background: rgba(34,197,94,0.1);
  }

  .task-item.checked .task-text {
    text-decoration: line-through;
    color: var(--fg-muted);
  }

  .task-text { font-size: 13px; }

  .task-due {
    margin-left: auto;
    font-size: 10px;
    padding: 2px 6px;
    border: 1px solid;
    font-family: var(--font-arcade);
    white-space: nowrap;
  }

  .task-due.soon { color: var(--warning); border-color: var(--warning); }
  .task-due.today { color: var(--urgent); border-color: var(--urgent); }

  /* ── Deadlines ── */
  .deadline-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 10px;
    border-bottom: 1px solid var(--border);
    transition: background 0.15s;
  }

  .deadline-item:last-child { border-bottom: none; }
  .deadline-item:hover { background: var(--surface-2); }

  .deadline-name { font-size: 13px; }

  .deadline-course {
    font-size: 10px;
    color: var(--fg-muted);
    margin-top: 2px;
  }

  .deadline-days {
    font-family: var(--font-arcade);
    font-size: 16px;
    padding: 4px 10px;
    border: 1px solid;
    white-space: nowrap;
    min-width: 60px;
    text-align: center;
  }

  .deadline-days.urgent { color: var(--danger); border-color: var(--danger); background: rgba(239,68,68,0.08); }
  .deadline-days.warning { color: var(--warning); border-color: var(--warning); background: rgba(245,158,11,0.08); }
  .deadline-days.ok { color: var(--success); border-color: var(--success); background: rgba(34,197,94,0.06); }

  /* ── Weakness Strip ── */
  .weakness-strip {
    grid-column: 1 / -1;
  }

  .weakness-scroll {
    display: flex;
    gap: 8px;
    overflow-x: auto;
    padding-bottom: 4px;
  }

  .weakness-scroll::-webkit-scrollbar { height: 4px; }
  .weakness-scroll::-webkit-scrollbar-track { background: var(--surface-2); }
  .weakness-scroll::-webkit-scrollbar-thumb { background: var(--primary-dim); }

  .weakness-chip {
    flex-shrink: 0;
    padding: 6px 14px;
    background: var(--surface-2);
    border: 1px solid var(--border);
    font-size: 12px;
    cursor: pointer;
    transition: all 0.15s;
    white-space: nowrap;
  }

  .weakness-chip:hover {
    border-color: var(--primary);
    color: var(--primary);
    background: rgba(204,46,72,0.08);
  }

  .weakness-chip .priority {
    font-family: var(--font-arcade);
    font-size: 10px;
    margin-left: 6px;
    padding: 1px 5px;
    border: 1px solid var(--danger);
    color: var(--danger);
  }

  /* ── Prompt Area ── */
  .prompt-area {
    background: var(--surface-1);
    border-top: 2px solid var(--border);
    padding: 12px 16px;
  }

  .prompt-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }

  .prompt-header span {
    font-family: var(--font-arcade);
    font-size: 13px;
    color: var(--primary);
    letter-spacing: 2px;
  }

  .copy-btn {
    background: var(--surface-2);
    border: 1px solid var(--border);
    color: var(--fg);
    padding: 4px 12px;
    font-family: var(--font-arcade);
    font-size: 12px;
    cursor: pointer;
    transition: all 0.15s;
  }

  .copy-btn:hover {
    border-color: var(--primary);
    color: var(--primary);
  }

  .copy-btn.copied {
    color: var(--success);
    border-color: var(--success);
  }

  .prompt-text {
    font-size: 12px;
    color: var(--fg-muted);
    line-height: 1.5;
    max-height: 80px;
    overflow-y: auto;
    white-space: pre-wrap;
  }

  /* ── Footer ── */
  .dash-footer {
    display: flex;
    justify-content: space-between;
    padding: 6px 12px;
    font-size: 10px;
    color: var(--fg-muted);
    border-top: 1px solid var(--border);
    background: rgba(0,0,0,0.5);
  }

  .dash-footer .status { color: var(--success); }

  /* ── Responsive ── */
  @media (max-width: 900px) {
    .playground {
      grid-template-columns: 1fr;
      grid-template-rows: auto 1fr auto;
    }
    .controls {
      grid-row: auto;
      flex-direction: row;
      flex-wrap: wrap;
      padding: 10px;
      border-right: none;
      border-bottom: 2px solid var(--border);
      max-height: 180px;
      overflow-y: auto;
    }
    .controls h2 { width: 100%; }
    .control-group { min-width: 140px; }
    .crt-overlay { left: 0; }
    .main-grid.layout-40-60,
    .main-grid.layout-30-70,
    .main-grid.layout-50-50 {
      grid-template-columns: 1fr;
      grid-template-rows: auto auto auto;
    }
    .weakness-strip { grid-column: 1; }
    .stats-bar { flex-wrap: wrap; }
    .stat-card { min-width: 80px; }
  }

  /* ── Density variants ── */
  .dashboard.density-compact .panel-body { padding: 8px; }
  .dashboard.density-compact .stat-card { padding: 8px 12px; }
  .dashboard.density-compact .stat-card .stat-value { font-size: 26px; }
  .dashboard.density-compact .next-up-course { font-size: 20px; padding: 8px; }
  .dashboard.density-compact .complete-btn { padding: 8px; font-size: 15px; }

  .dashboard.density-airy .panel-body { padding: 16px; }
  .dashboard.density-airy .stat-card { padding: 16px 20px; }
  .dashboard.density-airy .stat-card .stat-value { font-size: 38px; }
  .dashboard.density-airy .next-up-course { font-size: 28px; padding: 16px; }

  /* ── Scrollbar theme ── */
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: var(--surface-2); }
  ::-webkit-scrollbar-thumb { background: rgba(204,46,72,0.3); }
  ::-webkit-scrollbar-thumb:hover { background: rgba(204,46,72,0.5); }
</style>
</head>
<body>

<div class="playground">
  <!-- Controls -->
  <div class="controls">
    <h2>Dashboard Redesign</h2>

    <div class="control-group">
      <label>Presets</label>
      <div class="presets">
        <button class="preset-btn active" onclick="applyPreset('command-center')">Command Center</button>
        <button class="preset-btn" onclick="applyPreset('focused')">Focused</button>
        <button class="preset-btn" onclick="applyPreset('balanced')">Balanced</button>
      </div>
    </div>

    <div class="control-group">
      <label>Layout Split</label>
      <select id="ctl-layout" onchange="updateAll()">
        <option value="layout-40-60" selected>40 / 60</option>
        <option value="layout-30-70">30 / 70</option>
        <option value="layout-50-50">50 / 50</option>
      </select>
    </div>

    <div class="control-group">
      <label>Density</label>
      <select id="ctl-density" onchange="updateAll()">
        <option value="density-default" selected>Default</option>
        <option value="density-compact">Compact</option>
        <option value="density-airy">Airy</option>
      </select>
    </div>

    <div class="control-group">
      <label>CRT Scanlines</label>
      <input type="range" id="ctl-crt" min="0" max="50" value="20" oninput="updateAll()">
      <span class="range-val" id="crt-val">20%</span>
    </div>

    <div class="control-group">
      <label>Border Style</label>
      <select id="ctl-border" onchange="updateAll()">
        <option value="double" selected>Double (current)</option>
        <option value="solid">Solid</option>
        <option value="mixed">Mixed (accent only)</option>
      </select>
    </div>

    <div class="control-group">
      <label>Stats Position</label>
      <select id="ctl-stats" onchange="updateAll()">
        <option value="bar" selected>Top Bar</option>
        <option value="inline">Inline in Wheel</option>
      </select>
    </div>

    <div class="control-group">
      <label>Weakness Strip</label>
      <select id="ctl-weakness" onchange="updateAll()">
        <option value="bottom" selected>Bottom Strip</option>
        <option value="hidden">Hidden</option>
      </select>
    </div>

    <div class="control-group">
      <label>Body Font</label>
      <select id="ctl-font" onchange="updateAll()">
        <option value="jetbrains" selected>JetBrains Mono (new)</option>
        <option value="vt323">VT323 (current)</option>
      </select>
    </div>
  </div>

  <!-- Preview -->
  <div class="preview-area grid-bg">
    <div class="crt-overlay" id="crt"></div>

    <div class="dashboard" id="dashboard">

      <!-- Header -->
      <div class="dash-header">
        <div class="logo">TREY'S STUDY SYSTEM</div>
        <div class="nav-items">
          <div class="nav-item active">DASHBOARD</div>
          <div class="nav-item">BRAIN</div>
          <div class="nav-item">CALENDAR</div>
          <div class="nav-item">SCHOLAR</div>
          <div class="nav-item">TUTOR</div>
          <div class="nav-item">METHODS</div>
          <div class="nav-item">LIBRARY</div>
        </div>
      </div>

      <!-- Stats Bar -->
      <div class="stats-bar" id="stats-bar">
        <div class="stat-card">
          <div class="stat-value streak" id="streak-val"><span class="streak-flame">&#x1F525;</span> 7</div>
          <div class="stat-label">Day Streak</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="sessions-val">3</div>
          <div class="stat-label">Sessions Today</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">47m</div>
          <div class="stat-label">Study Time</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">3/5</div>
          <div class="stat-label">Courses Touched</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" style="font-size:16px;">Feb 19, 2026</div>
          <div class="stat-label">Wednesday</div>
        </div>
      </div>

      <!-- Main Grid -->
      <div class="main-grid layout-40-60" id="main-grid">

        <!-- Left: Study Wheel -->
        <div class="panel" id="wheel-panel">
          <div class="panel-header">
            <span class="panel-title">Study Wheel</span>
            <span class="panel-badge" style="color:var(--success);border-color:var(--success);" id="round-badge">Round 1</span>
          </div>
          <div class="panel-body">
            <div id="inline-stats" style="display:none;margin-bottom:12px;">
              <div style="display:flex;gap:12px;justify-content:center;margin-bottom:8px;">
                <span style="font-family:var(--font-arcade);color:var(--warning);font-size:20px;"><span class="streak-flame">&#x1F525;</span> 7 day streak</span>
                <span style="font-family:var(--font-arcade);color:var(--fg-muted);font-size:16px;">3 sessions &middot; 47m</span>
              </div>
            </div>
            <div class="next-up-label">&#x25B6; NEXT UP</div>
            <div class="next-up-course" id="next-course">Exercise Physiology</div>
            <button class="complete-btn" onclick="completeSession()">&#x2713; COMPLETE SESSION</button>
            <div class="queue-list" id="queue-list"></div>
          </div>
        </div>

        <!-- Right Column -->
        <div class="right-col">
          <div class="panel" style="flex:1;">
            <div class="panel-header">
              <span class="panel-title">Today's Focus</span>
              <span class="panel-badge" style="color:var(--info);border-color:var(--info);" id="task-count">4 tasks</span>
            </div>
            <div class="panel-body" id="tasks-body"></div>
          </div>

          <div class="panel" style="flex:1;">
            <div class="panel-header">
              <span class="panel-title">Deadlines</span>
              <span class="panel-badge" style="color:var(--urgent);border-color:var(--urgent);">3 upcoming</span>
            </div>
            <div class="panel-body" id="deadlines-body"></div>
          </div>
        </div>

        <!-- Weakness Strip -->
        <div class="panel weakness-strip" id="weakness-panel">
          <div class="panel-header">
            <span class="panel-title">Weakness Queue</span>
            <span class="panel-badge" style="color:var(--danger);border-color:var(--danger);">3 active</span>
          </div>
          <div class="panel-body" style="padding:8px 12px;">
            <div class="weakness-scroll">
              <div class="weakness-chip">Brachial plexus <span class="priority">HIGH</span></div>
              <div class="weakness-chip">Gait cycle phases <span class="priority">HIGH</span></div>
              <div class="weakness-chip">Cardiac output formulas <span class="priority">MED</span></div>
              <div class="weakness-chip">Dermatome map C5-T1</div>
              <div class="weakness-chip">Muscle spindle reflex arc</div>
              <div class="weakness-chip">Blood pressure regulation</div>
              <div class="weakness-chip">Vestibular system anatomy</div>
            </div>
          </div>
        </div>

      </div>

      <!-- Footer -->
      <div class="dash-footer">
        <div>STATUS: <span class="status">ONLINE</span> &nbsp; SYNC: 09:41 AM</div>
        <div>v2.1.0 [REDESIGN MOCKUP]</div>
      </div>

    </div>
  </div>

  <!-- Prompt Output -->
  <div class="prompt-area">
    <div class="prompt-header">
      <span>IMPLEMENTATION PROMPT</span>
      <button class="copy-btn" onclick="copyPrompt()">COPY</button>
    </div>
    <div class="prompt-text" id="prompt-output"></div>
  </div>
</div>

<script>
  const courses = [
    'Exercise Physiology', 'EBP', 'Neuroscience',
    'Movement Science', 'Therapeutic Intervention'
  ];

  let courseQueue = [...courses];
  let completedCourses = new Set();
  let sessionCount = 3;
  let currentRound = 1;

  const tasks = [
    { text: 'Review Ch 4 notes', due: 'today', checked: false },
    { text: 'Complete practice problems', due: 'today', checked: false },
    { text: 'Read assigned article', due: 'tomorrow', checked: false },
    { text: 'Submit discussion post', due: 'tomorrow', checked: false },
  ];

  const deadlines = [
    { name: 'EBP Research Paper', course: 'Evidence Based Practice', days: 2 },
    { name: 'Neuro Lab Report', course: 'Neuroscience', days: 5 },
    { name: 'ExPhys Midterm', course: 'Exercise Physiology', days: 12 },
  ];

  const DEFAULTS = {
    layout: 'layout-40-60',
    density: 'density-default',
    crt: 20,
    border: 'double',
    stats: 'bar',
    weakness: 'bottom',
    font: 'jetbrains',
  };

  const state = { ...DEFAULTS };

  function applyPreset(name) {
    document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
    event.target.classList.add('active');

    if (name === 'command-center') {
      setState({ layout:'layout-40-60', density:'density-default', crt:20, border:'double', stats:'bar', weakness:'bottom', font:'jetbrains' });
    } else if (name === 'focused') {
      setState({ layout:'layout-30-70', density:'density-compact', crt:10, border:'mixed', stats:'inline', weakness:'hidden', font:'jetbrains' });
    } else if (name === 'balanced') {
      setState({ layout:'layout-50-50', density:'density-airy', crt:15, border:'solid', stats:'bar', weakness:'bottom', font:'vt323' });
    }
    syncControls();
    updateAll();
  }

  function setState(s) { Object.assign(state, s); }

  function syncControls() {
    document.getElementById('ctl-layout').value = state.layout;
    document.getElementById('ctl-density').value = state.density;
    document.getElementById('ctl-crt').value = state.crt;
    document.getElementById('ctl-border').value = state.border;
    document.getElementById('ctl-stats').value = state.stats;
    document.getElementById('ctl-weakness').value = state.weakness;
    document.getElementById('ctl-font').value = state.font;
  }

  function updateAll() {
    state.layout = document.getElementById('ctl-layout').value;
    state.density = document.getElementById('ctl-density').value;
    state.crt = parseInt(document.getElementById('ctl-crt').value);
    state.border = document.getElementById('ctl-border').value;
    state.stats = document.getElementById('ctl-stats').value;
    state.weakness = document.getElementById('ctl-weakness').value;
    state.font = document.getElementById('ctl-font').value;

    const crtEl = document.getElementById('crt');
    crtEl.style.opacity = state.crt / 100;
    crtEl.classList.toggle('hidden', state.crt === 0);
    document.getElementById('crt-val').textContent = state.crt + '%';

    const grid = document.getElementById('main-grid');
    grid.className = 'main-grid ' + state.layout;

    const dash = document.getElementById('dashboard');
    dash.className = 'dashboard ' + state.density;

    document.querySelectorAll('.panel').forEach(p => {
      if (state.border === 'double') {
        p.style.borderStyle = 'double';
        p.style.borderWidth = '2px';
        p.style.borderColor = 'var(--border)';
      } else if (state.border === 'solid') {
        p.style.borderStyle = 'solid';
        p.style.borderWidth = '1px';
        p.style.borderColor = 'var(--border)';
      } else if (state.border === 'mixed') {
        p.style.borderStyle = 'solid';
        p.style.borderWidth = '1px';
        p.style.borderColor = 'var(--border)';
      }
    });
    if (state.border === 'mixed') {
      document.getElementById('wheel-panel').style.borderColor = 'var(--primary)';
      document.getElementById('wheel-panel').style.borderStyle = 'double';
      document.getElementById('wheel-panel').style.borderWidth = '2px';
    }

    document.getElementById('stats-bar').style.display = state.stats === 'bar' ? 'flex' : 'none';
    document.getElementById('inline-stats').style.display = state.stats === 'inline' ? 'block' : 'none';

    document.getElementById('weakness-panel').style.display = state.weakness === 'bottom' ? 'flex' : 'none';

    dash.style.fontFamily = state.font === 'jetbrains'
      ? "'JetBrains Mono', monospace"
      : "'VT323', monospace";

    renderQueue();
    renderTasks();
    renderDeadlines();
    updatePrompt();
  }

  function renderQueue() {
    const list = document.getElementById('queue-list');
    list.innerHTML = courseQueue.map((c, i) => {
      const isActive = i === 0;
      const isDone = completedCourses.has(c);
      return '<div class="queue-item ' + (isActive ? 'active' : '') + ' ' + (isDone ? 'done' : '') + '">' +
        '<span class="queue-num">' + (i + 1) + '</span>' +
        '<span>' + c + '</span>' +
        '<span class="queue-check">&#x2713;</span>' +
      '</div>';
    }).join('');

    document.getElementById('next-course').textContent = courseQueue[0];
    document.getElementById('round-badge').textContent = 'Round ' + currentRound;
    document.getElementById('sessions-val').textContent = sessionCount;
  }

  function renderTasks() {
    const body = document.getElementById('tasks-body');
    const remaining = tasks.filter(t => !t.checked).length;
    document.getElementById('task-count').textContent = remaining + ' tasks';
    body.innerHTML = tasks.map((t, i) => {
      const dueClass = t.due === 'today' ? 'today' : 'soon';
      return '<div class="task-item ' + (t.checked ? 'checked' : '') + '" onclick="toggleTask(' + i + ')">' +
        '<div class="task-check">' + (t.checked ? '&#x2713;' : '') + '</div>' +
        '<span class="task-text">' + t.text + '</span>' +
        '<span class="task-due ' + dueClass + '">' + t.due + '</span>' +
      '</div>';
    }).join('');
  }

  function renderDeadlines() {
    const body = document.getElementById('deadlines-body');
    body.innerHTML = deadlines.map(d => {
      const cls = d.days <= 3 ? 'urgent' : d.days <= 7 ? 'warning' : 'ok';
      return '<div class="deadline-item">' +
        '<div>' +
          '<div class="deadline-name">' + d.name + '</div>' +
          '<div class="deadline-course">' + d.course + '</div>' +
        '</div>' +
        '<div class="deadline-days ' + cls + '">' + d.days + 'd</div>' +
      '</div>';
    }).join('');
  }

  function completeSession() {
    const completed = courseQueue.shift();
    completedCourses.add(completed);
    courseQueue.push(completed);
    sessionCount++;

    if (completedCourses.size >= courses.length) {
      currentRound++;
      completedCourses.clear();
    }

    const btn = document.querySelector('.complete-btn');
    btn.innerHTML = '&#x2713; DONE!';
    btn.style.background = '#22c55e';
    setTimeout(function() {
      btn.innerHTML = '&#x2713; COMPLETE SESSION';
      btn.style.background = '';
      updateAll();
    }, 600);
  }

  function toggleTask(i) {
    tasks[i].checked = !tasks[i].checked;
    updateAll();
  }

  function updatePrompt() {
    var parts = [];
    parts.push('Redesign the Dashboard page (`dashboard.tsx`) with the following changes:');
    parts.push('');

    var split = state.layout.replace('layout-','').split('-');
    parts.push('1. LAYOUT: Replace the full-page Study Wheel with a ' + split[0] + '/' + split[1] + ' two-column grid.');
    parts.push('   - Left column: Compact Study Wheel showing "NEXT UP" course with glowing border, "COMPLETE SESSION" CTA, and a numbered queue list (no edit/delete buttons).');
    parts.push('   - Right column: Split into "Today\'s Focus" task checklist (top) and "Academic Deadlines" with urgency color-coding (bottom).');

    if (state.stats === 'bar') {
      parts.push('2. STATS BAR: Add a horizontal stats bar above the grid showing: streak counter, sessions today, study time, courses touched, and current date.');
    } else {
      parts.push('2. STATS: Embed streak/session stats inline within the Study Wheel panel header instead of a separate bar.');
    }

    if (state.weakness === 'bottom') {
      parts.push('3. WEAKNESS STRIP: Add a horizontal scrollable strip below the grid showing weakness queue items as chips with priority badges.');
    } else {
      parts.push('3. WEAKNESS STRIP: Remove from dashboard (accessible elsewhere).');
    }

    if (state.density !== 'density-default') {
      var d = state.density === 'density-compact' ? 'compact (reduced padding, smaller type)' : 'airy (more padding, larger type)';
      parts.push('4. DENSITY: Use ' + d + ' spacing throughout.');
    }

    if (state.border !== 'double') {
      var borderDesc = state.border === 'solid' ? '1px solid' : '1px solid for containers, 2px double for the active Study Wheel only';
      parts.push('5. BORDERS: Switch panels from `3px double` to `' + borderDesc + '` to reduce visual noise.');
    }

    if (state.font === 'jetbrains') {
      parts.push('6. TYPOGRAPHY: Add JetBrains Mono as body font for readability contrast. Keep VT323 for headers/labels only.');
    }

    if (state.crt < 15) {
      parts.push('7. CRT EFFECT: Reduce scanline overlay opacity to ' + state.crt + '% for better content readability.');
    }

    parts.push('');
    parts.push('Key behaviors: "COMPLETE SESSION" rotates the course queue, tasks are checkable, deadline urgency uses red (<3d), orange (<7d), green (>7d).');

    document.getElementById('prompt-output').textContent = parts.join('\n');
  }

  function copyPrompt() {
    var text = document.getElementById('prompt-output').textContent;
    navigator.clipboard.writeText(text).then(function() {
      var btn = document.querySelector('.copy-btn');
      btn.textContent = 'COPIED!';
      btn.classList.add('copied');
      setTimeout(function() {
        btn.textContent = 'COPY';
        btn.classList.remove('copied');
      }, 1500);
    });
  }

  updateAll();
</script>
</body>
</html>
